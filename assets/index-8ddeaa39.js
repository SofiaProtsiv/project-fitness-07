import{A as wl}from"./index-25e3de57.js";import{i as AD}from"./index-a330a9ef.js";import"./quotes-13933ad6.js";const zI=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},RD=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],l=n[t++],h=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},KI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,l=a?n[i+1]:0,h=i+2<n.length,f=h?n[i+2]:0,p=s>>2,m=(s&3)<<4|l>>4;let I=(l&15)<<2|f>>6,A=f&63;h||(A=64,a||(I=64)),r.push(t[p],t[m],t[I],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(zI(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):RD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const f=i<n.length?t[n.charAt(i)]:64;++i;const m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||f==null||m==null)throw new SD;const I=s<<2|l>>4;if(r.push(I),f!==64){const A=l<<4&240|f>>2;if(r.push(A),m!==64){const L=f<<6&192|m;r.push(L)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class SD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bD=function(n){const e=zI(n);return KI.encodeByteArray(e,!0)},$c=function(n){return bD(n).replace(/\./g,"")},HI=function(n){try{return KI.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Wc(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!PD(t)||(n[t]=Wc(n[t],e[t]));return n}function PD(n){return n!=="__proto__"}function CD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const kD=()=>CD().__FIREBASE_DEFAULTS__,DD=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},xD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&HI(n[1]);return e&&JSON.parse(e)},sp=()=>{try{return kD()||DD()||xD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},jI=()=>{var n;return(n=sp())===null||n===void 0?void 0:n.config},ND=n=>{var e;return(e=sp())===null||e===void 0?void 0:e[`_${n}`]};class VD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function OD(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n),l="";return[$c(JSON.stringify(t)),$c(JSON.stringify(a)),l].join(".")}function Fe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function LD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fe())}function op(){var n;const e=(n=sp())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function MD(){return typeof self=="object"&&self.self===self}function QI(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ap(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function YI(){const n=Fe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function FD(){return!op()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _a(){try{return typeof indexedDB=="object"}catch{return!1}}function UD(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}const BD="FirebaseError";class Dt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=BD,Object.setPrototypeOf(this,Dt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gi.prototype.create)}}class Gi{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?qD(s,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new Dt(i,l,r)}}function qD(n,e){return n.replace($D,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const $D=/\{\$([^}]+)}/g;function Oy(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function WD(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function hf(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(Ly(s)&&Ly(a)){if(!hf(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Ly(n){return n!==null&&typeof n=="object"}function Xs(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ss(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Xo(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function JI(n,e){const t=new GD(n,e);return t.subscribe.bind(t)}class GD{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");zD(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=qd),i.error===void 0&&(i.error=qd),i.complete===void 0&&(i.complete=qd);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function zD(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function qd(){}function H(n){return n&&n._delegate?n._delegate:n}class qn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const gi="[DEFAULT]";class KD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new VD;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jD(e))try{this.getOrInitializeService({instanceIdentifier:gi})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=gi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=gi){return this.instances.has(e)}getOptions(e=gi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&a.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:HD(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=gi){return this.component?this.component.multipleInstances?e:gi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function HD(n){return n===gi?void 0:n}function jD(n){return n.instantiationMode==="EAGER"}class QD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new KD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const up=[];var ce;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ce||(ce={}));const XI={debug:ce.DEBUG,verbose:ce.VERBOSE,info:ce.INFO,warn:ce.WARN,error:ce.ERROR,silent:ce.SILENT},YD=ce.INFO,JD={[ce.DEBUG]:"log",[ce.VERBOSE]:"log",[ce.INFO]:"info",[ce.WARN]:"warn",[ce.ERROR]:"error"},XD=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=JD[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class El{constructor(e){this.name=e,this._logLevel=YD,this._logHandler=XD,this._userLogHandler=null,up.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?XI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ce.DEBUG,...e),this._logHandler(this,ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ce.VERBOSE,...e),this._logHandler(this,ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ce.INFO,...e),this._logHandler(this,ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ce.WARN,...e),this._logHandler(this,ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ce.ERROR,...e),this._logHandler(this,ce.ERROR,...e)}}function ZD(n){up.forEach(e=>{e.setLogLevel(n)})}function ex(n,e){for(const t of up){let r=null;e&&e.level&&(r=XI[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...a)=>{const l=a.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");s>=(r??i.logLevel)&&n({level:ce[s].toLowerCase(),message:l,args:a,type:i.name})}}}const tx=(n,e)=>e.some(t=>n instanceof t);let My,Fy;function nx(){return My||(My=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function rx(){return Fy||(Fy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ZI=new WeakMap,df=new WeakMap,ew=new WeakMap,$d=new WeakMap,cp=new WeakMap;function ix(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Lr(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&ZI.set(t,n)}).catch(()=>{}),cp.set(e,n),e}function sx(n){if(df.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});df.set(n,e)}let ff={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return df.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ew.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Lr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ox(n){ff=n(ff)}function ax(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Wd(this),e,...t);return ew.set(r,e.sort?e.sort():[e]),Lr(r)}:rx().includes(n)?function(...e){return n.apply(Wd(this),e),Lr(ZI.get(this))}:function(...e){return Lr(n.apply(Wd(this),e))}}function ux(n){return typeof n=="function"?ax(n):(n instanceof IDBTransaction&&sx(n),tx(n,nx())?new Proxy(n,ff):n)}function Lr(n){if(n instanceof IDBRequest)return ix(n);if($d.has(n))return $d.get(n);const e=ux(n);return e!==n&&($d.set(n,e),cp.set(e,n)),e}const Wd=n=>cp.get(n);function cx(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),l=Lr(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Lr(a.result),h.oldVersion,h.newVersion,Lr(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),l.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const lx=["get","getKey","getAll","getAllKeys","count"],hx=["put","add","delete","clear"],Gd=new Map;function Uy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Gd.get(e))return Gd.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=hx.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||lx.includes(t)))return;const s=async function(a,...l){const h=this.transaction(a,i?"readwrite":"readonly");let f=h.store;return r&&(f=f.index(l.shift())),(await Promise.all([f[t](...l),i&&h.done]))[0]};return Gd.set(e,s),s}ox(n=>({...n,get:(e,t,r)=>Uy(e,t)||n.get(e,t,r),has:(e,t)=>!!Uy(e,t)||n.has(e,t)}));class dx{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(fx(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function fx(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const pf="@firebase/app",By="0.9.25";const Di=new El("@firebase/app"),px="@firebase/app-compat",gx="@firebase/analytics-compat",mx="@firebase/analytics",_x="@firebase/app-check-compat",yx="@firebase/app-check",vx="@firebase/auth",Ix="@firebase/auth-compat",wx="@firebase/database",Ex="@firebase/database-compat",Tx="@firebase/functions",Ax="@firebase/functions-compat",Rx="@firebase/installations",Sx="@firebase/installations-compat",bx="@firebase/messaging",Px="@firebase/messaging-compat",Cx="@firebase/performance",kx="@firebase/performance-compat",Dx="@firebase/remote-config",xx="@firebase/remote-config-compat",Nx="@firebase/storage",Vx="@firebase/storage-compat",Ox="@firebase/firestore",Lx="@firebase/firestore-compat",Mx="firebase",Fx="10.7.1";const Mr="[DEFAULT]",Ux={[pf]:"fire-core",[px]:"fire-core-compat",[mx]:"fire-analytics",[gx]:"fire-analytics-compat",[yx]:"fire-app-check",[_x]:"fire-app-check-compat",[vx]:"fire-auth",[Ix]:"fire-auth-compat",[wx]:"fire-rtdb",[Ex]:"fire-rtdb-compat",[Tx]:"fire-fn",[Ax]:"fire-fn-compat",[Rx]:"fire-iid",[Sx]:"fire-iid-compat",[bx]:"fire-fcm",[Px]:"fire-fcm-compat",[Cx]:"fire-perf",[kx]:"fire-perf-compat",[Dx]:"fire-rc",[xx]:"fire-rc-compat",[Nx]:"fire-gcs",[Vx]:"fire-gcs-compat",[Ox]:"fire-fst",[Lx]:"fire-fst-compat","fire-js":"fire-js",[Mx]:"fire-js-all"};const Fr=new Map,ya=new Map;function Gc(n,e){try{n.container.addComponent(e)}catch(t){Di.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function tw(n,e){n.container.addOrOverwriteComponent(e)}function Ur(n){const e=n.name;if(ya.has(e))return Di.debug(`There were multiple attempts to register component ${e}.`),!1;ya.set(e,n);for(const t of Fr.values())Gc(t,n);return!0}function nw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Bx(n,e,t=Mr){nw(n,e).clearInstance(t)}function qx(){ya.clear()}const $x={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},or=new Gi("app","Firebase",$x);let Wx=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new qn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw or.create("app-deleted",{appName:this._name})}};const Yr=Fx;function lp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Mr,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw or.create("bad-app-name",{appName:String(i)});if(t||(t=jI()),!t)throw or.create("no-options");const s=Fr.get(i);if(s){if(hf(t,s.options)&&hf(r,s.config))return s;throw or.create("duplicate-app",{appName:i})}const a=new QD(i);for(const h of ya.values())a.addComponent(h);const l=new Wx(t,r,a);return Fr.set(i,l),l}function Gx(n=Mr){const e=Fr.get(n);if(!e&&n===Mr&&jI())return lp();if(!e)throw or.create("no-app",{appName:n});return e}function zx(){return Array.from(Fr.values())}async function rw(n){const e=n.name;Fr.has(e)&&(Fr.delete(e),await Promise.all(n.container.getProviders().map(t=>t.delete())),n.isDeleted=!0)}function Mn(n,e,t){var r;let i=(r=Ux[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Di.warn(l.join(" "));return}Ur(new qn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function iw(n,e){if(n!==null&&typeof n!="function")throw or.create("invalid-log-argument");ex(n,e)}function sw(n){ZD(n)}const Kx="firebase-heartbeat-database",Hx=1,va="firebase-heartbeat-store";let zd=null;function ow(){return zd||(zd=cx(Kx,Hx,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(va)}}}).catch(n=>{throw or.create("idb-open",{originalErrorMessage:n.message})})),zd}async function jx(n){try{return await(await ow()).transaction(va).objectStore(va).get(aw(n))}catch(e){if(e instanceof Dt)Di.warn(e.message);else{const t=or.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Di.warn(t.message)}}}async function qy(n,e){try{const r=(await ow()).transaction(va,"readwrite");await r.objectStore(va).put(e,aw(n)),await r.done}catch(t){if(t instanceof Dt)Di.warn(t.message);else{const r=or.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Di.warn(r.message)}}}function aw(n){return`${n.name}!${n.options.appId}`}const Qx=1024,Yx=30*24*60*60*1e3;class Jx{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Zx(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=$y();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Yx}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=$y(),{heartbeatsToSend:r,unsentEntries:i}=Xx(this._heartbeatsCache.heartbeats),s=$c(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function $y(){return new Date().toISOString().substring(0,10)}function Xx(n,e=Qx){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Wy(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Wy(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Zx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _a()?UD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await jx(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return qy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return qy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Wy(n){return $c(JSON.stringify({version:2,heartbeats:n})).length}function eN(n){Ur(new qn("platform-logger",e=>new dx(e),"PRIVATE")),Ur(new qn("heartbeat",e=>new Jx(e),"PRIVATE")),Mn(pf,By,n),Mn(pf,By,"esm2017"),Mn("fire-js","")}eN("");const tN=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:Yr,_DEFAULT_ENTRY_NAME:Mr,_addComponent:Gc,_addOrOverwriteComponent:tw,_apps:Fr,_clearComponents:qx,_components:ya,_getProvider:nw,_registerComponent:Ur,_removeServiceInstance:Bx,deleteApp:rw,getApp:Gx,getApps:zx,initializeApp:lp,onLog:iw,registerVersion:Mn,setLogLevel:sw,FirebaseError:Dt},Symbol.toStringTag,{value:"Module"}));class nN{constructor(e,t){this._delegate=e,this.firebase=t,Gc(e,new qn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),rw(this._delegate)))}_getService(e,t=Mr){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=Mr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Gc(this._delegate,e)}_addOrOverwriteComponent(e){tw(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const rN={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},Gy=new Gi("app-compat","Firebase",rN);function iN(n){const e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Mn,setLogLevel:sw,onLog:iw,apps:null,SDK_VERSION:Yr,INTERNAL:{registerComponent:l,removeApp:r,useAsService:h,modularAPIs:tN}};t.default=t,Object.defineProperty(t,"apps",{get:a});function r(f){delete e[f]}function i(f){if(f=f||Mr,!Oy(e,f))throw Gy.create("no-app",{appName:f});return e[f]}i.App=n;function s(f,p={}){const m=lp(f,p);if(Oy(e,m.name))return e[m.name];const I=new n(m,t);return e[m.name]=I,I}function a(){return Object.keys(e).map(f=>e[f])}function l(f){const p=f.name,m=p.replace("-compat","");if(Ur(f)&&f.type==="PUBLIC"){const I=(A=i())=>{if(typeof A[m]!="function")throw Gy.create("invalid-app-argument",{appName:p});return A[m]()};f.serviceProps!==void 0&&Wc(I,f.serviceProps),t[m]=I,n.prototype[m]=function(...A){return this._getService.bind(this,p).apply(this,f.multipleInstances?A:[])}}return f.type==="PUBLIC"?t[m]:null}function h(f,p){return p==="serverAuth"?null:p}return t}function uw(){const n=iN(nN);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:uw,extendNamespace:e,createSubscribe:JI,ErrorFactory:Gi,deepExtend:Wc});function e(t){Wc(n,t)}return n}const sN=uw();const zy=new El("@firebase/app-compat"),oN="@firebase/app-compat",aN="0.2.25";function uN(n){Mn(oN,aN,n)}if(MD()&&self.firebase!==void 0){zy.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&zy.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const Br=sN;uN();var cN="firebase",lN="10.7.1";Br.registerVersion(cN,lN,"app-compat");function hp(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}const Mo={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},gs={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function hN(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is incorrect, malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-password"]:"A non-empty password must be provided",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.",["missing-recaptcha-token"]:"The reCAPTCHA token is missing when sending request to the backend.",["invalid-recaptcha-token"]:"The reCAPTCHA token is invalid when sending request to the backend.",["invalid-recaptcha-action"]:"The reCAPTCHA action is invalid when sending request to the backend.",["recaptcha-not-enabled"]:"reCAPTCHA Enterprise integration is not enabled for this project.",["missing-client-type"]:"The reCAPTCHA client type is missing when sending request to the backend.",["missing-recaptcha-version"]:"The reCAPTCHA version is missing when sending request to the backend.",["invalid-req-type"]:"Invalid request parameters.",["invalid-recaptcha-version"]:"The reCAPTCHA version is invalid when sending request to the backend.",["unsupported-password-policy-schema-version"]:"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.",["password-does-not-meet-requirements"]:"The password does not meet the requirements."}}function cw(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const dN=hN,fN=cw,lw=new Gi("auth","Firebase",cw());const zc=new El("@firebase/auth");function pN(n,...e){zc.logLevel<=ce.WARN&&zc.warn(`Auth (${Yr}): ${n}`,...e)}function kc(n,...e){zc.logLevel<=ce.ERROR&&zc.error(`Auth (${Yr}): ${n}`,...e)}function yt(n,...e){throw dp(n,...e)}function mt(n,...e){return dp(n,...e)}function hw(n,e,t){const r=Object.assign(Object.assign({},fN()),{[e]:t});return new Gi("auth","Firebase",r).create(e,{appName:n.name})}function Zs(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&yt(n,"argument-error"),hw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function dp(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return lw.create(n,...e)}function O(n,e,...t){if(!n)throw dp(e,...t)}function xn(n){const e="INTERNAL ASSERTION FAILED: "+n;throw kc(e),new Error(e)}function vn(n,e){n||xn(e)}function Ia(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function fp(){return Ky()==="http:"||Ky()==="https:"}function Ky(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function gN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fp()||QI()||"connection"in navigator)?navigator.onLine:!0}function mN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Ja{constructor(e,t){this.shortDelay=e,this.longDelay=t,vn(t>e,"Short delay should be less than long delay!"),this.isMobile=LD()||ap()}get(){return gN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function pp(n,e){vn(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class dw{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;xn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;xn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;xn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const _N={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const yN=new Ja(3e4,6e4);function Ge(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function ze(n,e,t,r,i={}){return fw(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const l=Xs(Object.assign({key:n.config.apiKey},a)).slice(1),h=await n._getAdditionalHeaders();return h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode),dw.fetch()(pw(n,n.config.apiHost,t,l),Object.assign({method:e,headers:h,referrerPolicy:"no-referrer"},s))})}async function fw(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},_N),e);try{const i=new IN(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Zo(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const l=s.ok?a.errorMessage:a.error.message,[h,f]=l.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Zo(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw Zo(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw Zo(n,"user-disabled",a);const p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw hw(n,p,f);yt(n,p)}}catch(i){if(i instanceof Dt)throw i;yt(n,"network-request-failed",{message:String(i)})}}async function dr(n,e,t,r,i={}){const s=await ze(n,e,t,r,i);return"mfaPendingCredential"in s&&yt(n,"multi-factor-auth-required",{_serverResponse:s}),s}function pw(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?pp(n.config,i):`${n.config.apiScheme}://${i}`}function vN(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class IN{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(mt(this.auth,"network-request-failed")),yN.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Zo(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=mt(n,e,r);return i.customData._tokenResponse=t,i}function Hy(n){return n!==void 0&&n.getResponse!==void 0}function jy(n){return n!==void 0&&n.enterprise!==void 0}class wN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return vN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function EN(n){return(await ze(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function TN(n,e){return ze(n,"GET","/v2/recaptchaConfig",Ge(n,e))}async function AN(n,e){return ze(n,"POST","/v1/accounts:delete",e)}async function RN(n,e){return ze(n,"POST","/v1/accounts:update",e)}async function SN(n,e){return ze(n,"POST","/v1/accounts:lookup",e)}function oa(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bN(n,e=!1){const t=H(n),r=await t.getIdToken(e),i=Tl(r);O(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:oa(Kd(i.auth_time)),issuedAtTime:oa(Kd(i.iat)),expirationTime:oa(Kd(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Kd(n){return Number(n)*1e3}function Tl(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return kc("JWT malformed, contained fewer than 3 sections"),null;try{const i=HI(t);return i?JSON.parse(i):(kc("Failed to decode base64 JWT payload"),null)}catch(i){return kc("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function PN(n){const e=Tl(n);return O(e,"internal-error"),O(typeof e.exp<"u","internal-error"),O(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function cr(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Dt&&CN(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function CN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class kN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class gw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=oa(this.lastLoginAt),this.creationTime=oa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function wa(n){var e;const t=n.auth,r=await n.getIdToken(),i=await cr(n,SN(t,{idToken:r}));O(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?NN(s.providerUserInfo):[],l=xN(n.providerData,a),h=n.isAnonymous,f=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=h?f:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new gw(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)}async function DN(n){const e=H(n);await wa(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function xN(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function NN(n){return n.map(e=>{var{providerId:t}=e,r=hp(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function VN(n,e){const t=await fw(n,{},async()=>{const r=Xs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=pw(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",dw.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function ON(n,e){return ze(n,"POST","/v2/accounts:revokeToken",Ge(n,e))}class Ea{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){O(e.idToken,"internal-error"),O(typeof e.idToken<"u","internal-error"),O(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):PN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return O(!this.accessToken||this.refreshToken,e,"user-token-expired"),!t&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await VN(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new Ea;return r&&(O(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(O(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(O(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ea,this.toJSON())}_performRefresh(){return xn("not implemented")}}function br(n,e){O(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class bi{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=hp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new kN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new gw(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await cr(this,this.stsTokenManager.getToken(this.auth,e));return O(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return bN(this,e)}reload(){return DN(this)}_assign(e){this!==e&&(O(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new bi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){O(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await wa(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await cr(this,AN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,l,h,f,p;const m=(r=t.displayName)!==null&&r!==void 0?r:void 0,I=(i=t.email)!==null&&i!==void 0?i:void 0,A=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,L=(a=t.photoURL)!==null&&a!==void 0?a:void 0,M=(l=t.tenantId)!==null&&l!==void 0?l:void 0,V=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,Y=(f=t.createdAt)!==null&&f!==void 0?f:void 0,ae=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:j,emailVerified:ye,isAnonymous:de,providerData:me,stsTokenManager:we}=t;O(j&&we,e,"internal-error");const Vt=Ea.fromJSON(this.name,we);O(typeof j=="string",e,"internal-error"),br(m,e.name),br(I,e.name),O(typeof ye=="boolean",e,"internal-error"),O(typeof de=="boolean",e,"internal-error"),br(A,e.name),br(L,e.name),br(M,e.name),br(V,e.name),br(Y,e.name),br(ae,e.name);const zn=new bi({uid:j,auth:e,email:I,emailVerified:ye,displayName:m,isAnonymous:de,photoURL:L,phoneNumber:A,tenantId:M,stsTokenManager:Vt,createdAt:Y,lastLoginAt:ae});return me&&Array.isArray(me)&&(zn.providerData=me.map(Xi=>Object.assign({},Xi))),V&&(zn._redirectEventId=V),zn}static async _fromIdTokenResponse(e,t,r=!1){const i=new Ea;i.updateFromServerResponse(t);const s=new bi({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await wa(s),s}}const Qy=new Map;function Jt(n){vn(n instanceof Function,"Expected a class definition");let e=Qy.get(n);return e?(vn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Qy.set(n,e),e)}class mw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}mw.type="NONE";const Ms=mw;function Pi(n,e,t){return`firebase:${n}:${e}:${t}`}class Cs{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Pi(this.userKey,i.apiKey,s),this.fullPersistenceKey=Pi("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?bi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Cs(Jt(Ms),e,r);const i=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let s=i[0]||Jt(Ms);const a=Pi(r,e.config.apiKey,e.name);let l=null;for(const f of t)try{const p=await f._get(a);if(p){const m=bi._fromJSON(e,p);f!==s&&(l=m),s=f;break}}catch{}const h=i.filter(f=>f._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new Cs(s,e,r):(s=h[0],l&&await s._set(a,l.toJSON()),await Promise.all(t.map(async f=>{if(f!==s)try{await f._remove(a)}catch{}})),new Cs(s,e,r))}}function Yy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(vw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_w(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Iw(e))return"Blackberry";if(ww(e))return"Webos";if(gp(e))return"Safari";if((e.includes("chrome/")||yw(e))&&!e.includes("edge/"))return"Chrome";if(Xa(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function _w(n=Fe()){return/firefox\//i.test(n)}function gp(n=Fe()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yw(n=Fe()){return/crios\//i.test(n)}function vw(n=Fe()){return/iemobile/i.test(n)}function Xa(n=Fe()){return/android/i.test(n)}function Iw(n=Fe()){return/blackberry/i.test(n)}function ww(n=Fe()){return/webos/i.test(n)}function eo(n=Fe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function LN(n=Fe()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function MN(n=Fe()){var e;return eo(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function FN(){return YI()&&document.documentMode===10}function Ew(n=Fe()){return eo(n)||Xa(n)||ww(n)||Iw(n)||/windows phone/i.test(n)||vw(n)}function UN(){try{return!!(window&&window!==window.top)}catch{return!1}}function Tw(n,e=[]){let t;switch(n){case"Browser":t=Yy(Fe());break;case"Worker":t=`${Yy(Fe())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Yr}/${r}`}class BN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,l)=>{try{const h=e(s);a(h)}catch(h){l(h)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}async function qN(n,e={}){return ze(n,"GET","/v2/passwordPolicy",Ge(n,e))}const $N=6;class WN{constructor(e){var t,r,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:$N,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,l;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(l=h.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),h}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class GN{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jy(this),this.idTokenSubscription=new Jy(this),this.beforeStateQueue=new BN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=lw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Jt(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Cs.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===l)&&(h!=null&&h.user)&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return O(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await wa(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=mN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?H(e):null;return t&&O(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&O(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Jt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await qN(this),t=new WN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Gi("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await ON(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Jt(e)||this._popupRedirectResolver;O(t,this,"argument-error"),this.redirectPersistenceManager=await Cs.create(this,[Jt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(O(l,this,"internal-error"),l.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{const h=e.addObserver(t);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return O(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Tw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&pN(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function qe(n){return H(n)}class Jy{constructor(e){this.auth=e,this.observer=null,this.addObserver=JI(t=>this.observer=t)}get next(){return O(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function zN(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}function mp(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=mt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",zN().appendChild(r)})}function Aw(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const KN="https://www.google.com/recaptcha/enterprise.js?render=",HN="recaptcha-enterprise",jN="NO_RECAPTCHA";class QN{constructor(e){this.type=HN,this.auth=qe(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,l)=>{TN(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const f=new wN(h);return s.tenantId==null?s._agentRecaptchaConfig=f:s._tenantRecaptchaConfigs[s.tenantId]=f,a(f.siteKey)}}).catch(h=>{l(h)})})}function i(s,a,l){const h=window.grecaptcha;jy(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(f=>{a(f)}).catch(()=>{a(jN)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(l=>{if(!t&&jy(window.grecaptcha))i(l,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}mp(KN+l).then(()=>{i(l,s,a)}).catch(h=>{a(h)})}}).catch(l=>{a(l)})})}}async function Xy(n,e,t,r=!1){const i=new QN(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Ta(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Xy(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Xy(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)})}function YN(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Jt);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function JN(n,e,t){const r=qe(n);O(r._canInitEmulator,r,"emulator-config-failed"),O(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=Rw(e),{host:a,port:l}=XN(e),h=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||ZN()}function Rw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function XN(n){const e=Rw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Zy(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:Zy(a)}}}function Zy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function ZN(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class to{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return xn("not implemented")}_getIdTokenResponse(e){return xn("not implemented")}_linkToIdToken(e,t){return xn("not implemented")}_getReauthenticationResolver(e){return xn("not implemented")}}async function Sw(n,e){return ze(n,"POST","/v1/accounts:resetPassword",Ge(n,e))}async function eV(n,e){return ze(n,"POST","/v1/accounts:update",e)}async function tV(n,e){return ze(n,"POST","/v1/accounts:signUp",e)}async function nV(n,e){return ze(n,"POST","/v1/accounts:update",Ge(n,e))}async function rV(n,e){return dr(n,"POST","/v1/accounts:signInWithPassword",Ge(n,e))}async function Al(n,e){return ze(n,"POST","/v1/accounts:sendOobCode",Ge(n,e))}async function iV(n,e){return Al(n,e)}async function sV(n,e){return Al(n,e)}async function oV(n,e){return Al(n,e)}async function aV(n,e){return Al(n,e)}async function uV(n,e){return dr(n,"POST","/v1/accounts:signInWithEmailLink",Ge(n,e))}async function cV(n,e){return dr(n,"POST","/v1/accounts:signInWithEmailLink",Ge(n,e))}class Aa extends to{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Aa(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Aa(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ta(e,t,"signInWithPassword",rV);case"emailLink":return uV(e,{email:this._email,oobCode:this._password});default:yt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ta(e,r,"signUpPassword",tV);case"emailLink":return cV(e,{idToken:t,email:this._email,oobCode:this._password});default:yt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ar(n,e){return dr(n,"POST","/v1/accounts:signInWithIdp",Ge(n,e))}const lV="http://localhost";class $n extends to{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new $n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):yt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=hp(t,["providerId","signInMethod"]);if(!r||!i)return null;const a=new $n(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return ar(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ar(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ar(e,t)}buildRequest(){const e={requestUri:lV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Xs(t)}return e}}async function hV(n,e){return ze(n,"POST","/v1/accounts:sendVerificationCode",Ge(n,e))}async function dV(n,e){return dr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ge(n,e))}async function fV(n,e){const t=await dr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ge(n,e));if(t.temporaryProof)throw Zo(n,"account-exists-with-different-credential",t);return t}const pV={USER_NOT_FOUND:"user-not-found"};async function gV(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return dr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ge(n,t),pV)}class Ci extends to{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ci({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ci({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return dV(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return fV(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return gV(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new Ci({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}}function mV(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function _V(n){const e=Ss(Xo(n)).link,t=e?Ss(Xo(e)).deep_link_id:null,r=Ss(Xo(n)).deep_link_id;return(r?Ss(Xo(r)).link:null)||r||t||e||n}class Rl{constructor(e){var t,r,i,s,a,l;const h=Ss(Xo(e)),f=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,m=mV((i=h.mode)!==null&&i!==void 0?i:null);O(f&&p&&m,"argument-error"),this.apiKey=f,this.operation=m,this.code=p,this.continueUrl=(s=h.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(l=h.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=_V(e);try{return new Rl(t)}catch{return null}}}class Jr{constructor(){this.providerId=Jr.PROVIDER_ID}static credential(e,t){return Aa._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Rl.parseLink(t);return O(r,"argument-error"),Aa._fromEmailAndCode(e,r.code,r.tenantId)}}Jr.PROVIDER_ID="password";Jr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Jr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class fr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class no extends fr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ks extends no{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return O("providerId"in t&&"signInMethod"in t,"argument-error"),$n._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return O(e.idToken||e.accessToken,"argument-error"),$n._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return ks.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ks.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:a,providerId:l}=e;if(!r&&!i&&!t&&!s||!l)return null;try{return new ks(l)._credential({idToken:t,accessToken:r,nonce:a,pendingToken:s})}catch{return null}}}class bn extends no{constructor(){super("facebook.com")}static credential(e){return $n._fromParams({providerId:bn.PROVIDER_ID,signInMethod:bn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bn.credentialFromTaggedObject(e)}static credentialFromError(e){return bn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bn.credential(e.oauthAccessToken)}catch{return null}}}bn.FACEBOOK_SIGN_IN_METHOD="facebook.com";bn.PROVIDER_ID="facebook.com";class Pn extends no{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return $n._fromParams({providerId:Pn.PROVIDER_ID,signInMethod:Pn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Pn.credentialFromTaggedObject(e)}static credentialFromError(e){return Pn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Pn.credential(t,r)}catch{return null}}}Pn.GOOGLE_SIGN_IN_METHOD="google.com";Pn.PROVIDER_ID="google.com";class Cn extends no{constructor(){super("github.com")}static credential(e){return $n._fromParams({providerId:Cn.PROVIDER_ID,signInMethod:Cn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Cn.credentialFromTaggedObject(e)}static credentialFromError(e){return Cn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Cn.credential(e.oauthAccessToken)}catch{return null}}}Cn.GITHUB_SIGN_IN_METHOD="github.com";Cn.PROVIDER_ID="github.com";const yV="http://localhost";class Fs extends to{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return ar(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ar(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ar(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new Fs(r,s)}static _create(e,t){return new Fs(e,t)}buildRequest(){return{requestUri:yV,returnSecureToken:!0,pendingToken:this.pendingToken}}}const vV="saml.";class Kc extends fr{constructor(e){O(e.startsWith(vV),"argument-error"),super(e)}static credentialFromResult(e){return Kc.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Kc.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Fs.fromJSON(e);return O(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Fs._create(r,t)}catch{return null}}}class kn extends no{constructor(){super("twitter.com")}static credential(e,t){return $n._fromParams({providerId:kn.PROVIDER_ID,signInMethod:kn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return kn.credentialFromTaggedObject(e)}static credentialFromError(e){return kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return kn.credential(t,r)}catch{return null}}}kn.TWITTER_SIGN_IN_METHOD="twitter.com";kn.PROVIDER_ID="twitter.com";async function bw(n,e){return dr(n,"POST","/v1/accounts:signUp",Ge(n,e))}class hn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await bi._fromIdTokenResponse(e,r,i),a=ev(r);return new hn({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=ev(r);return new hn({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function ev(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function IV(n){var e;const t=qe(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new hn({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await bw(t,{returnSecureToken:!0}),i=await hn._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(i.user),i}class Hc extends Dt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Hc.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Hc(e,t,r,i)}}function Pw(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Hc._fromErrorAndOperation(n,s,e,r):s})}function Cw(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}async function wV(n,e){const t=H(n);await Sl(!0,t,e);const{providerUserInfo:r}=await RN(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=Cw(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function _p(n,e,t=!1){const r=await cr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return hn._forOperation(n,"link",r)}async function Sl(n,e,t){await wa(e);const r=Cw(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";O(r.has(t)===n,e.auth,i)}async function kw(n,e,t=!1){const{auth:r}=n,i="reauthenticate";try{const s=await cr(n,Pw(r,i,e,n),t);O(s.idToken,r,"internal-error");const a=Tl(s.idToken);O(a,r,"internal-error");const{sub:l}=a;return O(n.uid===l,r,"user-mismatch"),hn._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&yt(r,"user-mismatch"),s}}async function Dw(n,e,t=!1){const r="signIn",i=await Pw(n,r,e),s=await hn._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function bl(n,e){return Dw(qe(n),e)}async function xw(n,e){const t=H(n);return await Sl(!1,t,e.providerId),_p(t,e)}async function Nw(n,e){return kw(H(n),e)}async function EV(n,e){return dr(n,"POST","/v1/accounts:signInWithCustomToken",Ge(n,e))}async function TV(n,e){const t=qe(n),r=await EV(t,{token:e,returnSecureToken:!0}),i=await hn._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}class Za{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?yp._fromServerResponse(e,t):"totpInfo"in t?vp._fromServerResponse(e,t):yt(e,"internal-error")}}class yp extends Za{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new yp(t)}}class vp extends Za{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new vp(t)}}function Pl(n,e,t){var r;O(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),O(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(O(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(O(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function Ip(n){const e=qe(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function AV(n,e,t){const r=qe(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Pl(r,i,t),await Ta(r,i,"getOobCode",sV)}async function RV(n,e,t){await Sw(H(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Ip(n),r})}async function SV(n,e){await nV(H(n),{oobCode:e})}async function Vw(n,e){const t=H(n),r=await Sw(t,{oobCode:e}),i=r.requestType;switch(O(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":O(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":O(r.mfaInfo,t,"internal-error");default:O(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=Za._fromServerResponse(qe(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function bV(n,e){const{data:t}=await Vw(H(n),e);return t.email}async function PV(n,e,t){const r=qe(n),a=await Ta(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",bw).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&Ip(n),h}),l=await hn._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function CV(n,e,t){return bl(H(n),Jr.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Ip(n),r})}async function kV(n,e,t){const r=qe(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(a,l){O(l.handleCodeInApp,r,"argument-error"),l&&Pl(r,a,l)}s(i,t),await Ta(r,i,"getOobCode",oV)}function DV(n,e){const t=Rl.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function xV(n,e,t){const r=H(n),i=Jr.credentialWithLink(e,t||Ia());return O(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),bl(r,i)}async function NV(n,e){return ze(n,"POST","/v1/accounts:createAuthUri",Ge(n,e))}async function VV(n,e){const t=fp()?Ia():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await NV(H(n),r);return i||[]}async function OV(n,e){const t=H(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Pl(t.auth,i,e);const{email:s}=await iV(t.auth,i);s!==n.email&&await n.reload()}async function LV(n,e,t){const r=H(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Pl(r.auth,s,t);const{email:a}=await aV(r.auth,s);a!==n.email&&await n.reload()}async function MV(n,e){return ze(n,"POST","/v1/accounts:update",e)}async function FV(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=H(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},a=await cr(r,MV(r.auth,s));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const l=r.providerData.find(({providerId:h})=>h==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function UV(n,e){return Ow(H(n),e,null)}function BV(n,e){return Ow(H(n),null,e)}async function Ow(n,e,t){const{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);const a=await cr(n,eV(r,s));await n._updateTokensIfNecessary(a,!0)}function qV(n){var e,t;if(!n)return null;const{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const a=(t=(e=Tl(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(a){const l=a!=="anonymous"&&a!=="custom"?a:null;return new Ds(s,l)}}if(!r)return null;switch(r){case"facebook.com":return new $V(s,i);case"github.com":return new WV(s,i);case"google.com":return new GV(s,i);case"twitter.com":return new zV(s,i,n.screenName||null);case"custom":case"anonymous":return new Ds(s,null);default:return new Ds(s,r,i)}}class Ds{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class Lw extends Ds{constructor(e,t,r,i){super(e,t,r),this.username=i}}class $V extends Ds{constructor(e,t){super(e,"facebook.com",t)}}class WV extends Lw{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class GV extends Ds{constructor(e,t){super(e,"google.com",t)}}class zV extends Lw{constructor(e,t,r){super(e,"twitter.com",t,r)}}function KV(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:qV(t)}class Ei{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new Ei("enroll",e,t)}static _fromMfaPendingCredential(e){return new Ei("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return Ei._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Ei._fromIdtoken(e.multiFactorSession.idToken)}return null}}class wp{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=qe(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(l=>Za._fromServerResponse(r,l));O(i.mfaPendingCredential,r,"internal-error");const a=Ei._fromMfaPendingCredential(i.mfaPendingCredential);return new wp(a,s,async l=>{const h=await l._process(r,a);delete i.mfaInfo,delete i.mfaPendingCredential;const f=Object.assign(Object.assign({},i),{idToken:h.idToken,refreshToken:h.refreshToken});switch(t.operationType){case"signIn":const p=await hn._fromIdTokenResponse(r,t.operationType,f);return await r._updateCurrentUser(p.user),p;case"reauthenticate":return O(t.user,r,"internal-error"),hn._forOperation(t.user,t.operationType,f);default:yt(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function HV(n,e){var t;const r=H(n),i=e;return O(e.customData.operationType,r,"argument-error"),O((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),wp._fromError(r,i)}function jV(n,e){return ze(n,"POST","/v2/accounts/mfaEnrollment:start",Ge(n,e))}function QV(n,e){return ze(n,"POST","/v2/accounts/mfaEnrollment:finalize",Ge(n,e))}function YV(n,e){return ze(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Ge(n,e))}class Ep{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Za._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new Ep(e)}async getSession(){return Ei._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),s=await cr(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await cr(this.user,YV(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Hd=new WeakMap;function JV(n){const e=H(n);return Hd.has(e)||Hd.set(e,Ep._fromUser(e)),Hd.get(e)}const jc="__sak";class Mw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(jc,"1"),this.storage.removeItem(jc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}function XV(){const n=Fe();return gp(n)||eo(n)}const ZV=1e3,eO=10;class Fw extends Mw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=XV()&&UN(),this.fallbackToPolling=Ew(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,l,h)=>{this.notifyListeners(a,h)});return}const r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(r);if(e.newValue!==a)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);FN()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,eO):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},ZV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Fw.type="LOCAL";const Tp=Fw;class Uw extends Mw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Uw.type="SESSION";const xi=Uw;function tO(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Cl{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Cl(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(a).map(async f=>f(t.origin,s)),h=await tO(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Cl.receivers=[];function eu(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class nO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((l,h)=>{const f=eu("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(m){const I=m;if(I.data.eventId===f)switch(I.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(I.data.response);break;default:clearTimeout(p),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Je(){return window}function rO(n){Je().location.href=n}function Ap(){return typeof Je().WorkerGlobalScope<"u"&&typeof Je().importScripts=="function"}async function iO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function sO(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function oO(){return Ap()?self:null}const Bw="firebaseLocalStorageDb",aO=1,Qc="firebaseLocalStorage",qw="fbase_key";class tu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function kl(n,e){return n.transaction([Qc],e?"readwrite":"readonly").objectStore(Qc)}function uO(){const n=indexedDB.deleteDatabase(Bw);return new tu(n).toPromise()}function gf(){const n=indexedDB.open(Bw,aO);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Qc,{keyPath:qw})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Qc)?e(r):(r.close(),await uO(),e(await gf()))})})}async function tv(n,e,t){const r=kl(n,!0).put({[qw]:e,value:t});return new tu(r).toPromise()}async function cO(n,e){const t=kl(n,!1).get(e),r=await new tu(t).toPromise();return r===void 0?null:r.value}function nv(n,e){const t=kl(n,!0).delete(e);return new tu(t).toPromise()}const lO=800,hO=3;class $w{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await gf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>hO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ap()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cl._getInstance(oO()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await iO(),!this.activeServiceWorker)return;this.sender=new nO(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||sO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await gf();return await tv(e,jc,"1"),await nv(e,jc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>tv(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>cO(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>nv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=kl(i,!1).getAll();return new tu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),lO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$w.type="LOCAL";const Ra=$w;function dO(n,e){return ze(n,"POST","/v2/accounts/mfaSignIn:start",Ge(n,e))}function fO(n,e){return ze(n,"POST","/v2/accounts/mfaSignIn:finalize",Ge(n,e))}const pO=500,gO=6e4,yc=1e12;class mO{constructor(e){this.auth=e,this.counter=yc,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new _O(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||yc;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||yc;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||yc;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class _O{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;O(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=yO(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},gO)},pO))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function yO(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const jd=Aw("rcb"),vO=new Ja(3e4,6e4),IO="https://www.google.com/recaptcha/api.js?";class wO{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Je().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return O(EO(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Hy(Je().grecaptcha)?Promise.resolve(Je().grecaptcha):new Promise((r,i)=>{const s=Je().setTimeout(()=>{i(mt(e,"network-request-failed"))},vO.get());Je()[jd]=()=>{Je().clearTimeout(s),delete Je()[jd];const l=Je().grecaptcha;if(!l||!Hy(l)){i(mt(e,"internal-error"));return}const h=l.render;l.render=(f,p)=>{const m=h(f,p);return this.counter++,m},this.hostLanguage=t,r(l)};const a=`${IO}?${Xs({onload:jd,render:"explicit",hl:t})}`;mp(a).catch(()=>{clearTimeout(s),i(mt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=Je().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function EO(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class TO{async load(e){return new mO(e)}clearedOneInstance(){}}const Ww="recaptcha",AO={theme:"light",type:"image"};let RO=class{constructor(e,t,r=Object.assign({},AO)){this.parameters=r,this.type=Ww,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=qe(e),this.isInvisible=this.parameters.size==="invisible",O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;O(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new TO:new wO,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const s=a=>{a&&(this.tokenChangeListeners.delete(s),i(a))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){O(!this.parameters.sitekey,this.auth,"argument-error"),O(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=Je()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){O(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){O(fp()&&!Ap(),this.auth,"internal-error"),await SO(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await EN(this.auth);O(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return O(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function SO(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}class Rp{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Ci._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function bO(n,e,t){const r=qe(n),i=await Dl(r,e,H(t));return new Rp(i,s=>bl(r,s))}async function PO(n,e,t){const r=H(n);await Sl(!1,r,"phone");const i=await Dl(r.auth,e,H(t));return new Rp(i,s=>xw(r,s))}async function CO(n,e,t){const r=H(n),i=await Dl(r.auth,e,H(t));return new Rp(i,s=>Nw(r,s))}async function Dl(n,e,t){var r;const i=await t.verify();try{O(typeof i=="string",n,"argument-error"),O(t.type===Ww,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const a=s.session;if("phoneNumber"in s)return O(a.type==="enroll",n,"internal-error"),(await jV(n,{idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{O(a.type==="signin",n,"internal-error");const l=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return O(l,n,"missing-multi-factor-info"),(await dO(n,{mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:a}=await hV(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return a}}finally{t._reset()}}async function kO(n,e){await _p(H(n),e)}let Fn=class{constructor(e){this.providerId=Fn.PROVIDER_ID,this.auth=qe(e)}verifyPhoneNumber(e,t){return Dl(this.auth,e,H(t))}static credential(e,t){return Ci._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Fn.credentialFromTaggedObject(t)}static credentialFromError(e){return Fn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?Ci._fromTokenResponse(t,r):null}};Fn.PROVIDER_ID="phone";Fn.PHONE_SIGN_IN_METHOD="phone";function zi(n,e){return e?Jt(e):(O(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Sp extends to{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ar(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ar(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ar(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function DO(n){return Dw(n.auth,new Sp(n),n.bypassAuthState)}function xO(n){const{auth:e,user:t}=n;return O(t,e,"internal-error"),kw(t,new Sp(n),n.bypassAuthState)}async function NO(n){const{auth:e,user:t}=n;return O(t,e,"internal-error"),_p(t,new Sp(n),n.bypassAuthState)}class Gw{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:l}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(h))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return DO;case"linkViaPopup":case"linkViaRedirect":return NO;case"reauthViaPopup":case"reauthViaRedirect":return xO;default:yt(this.auth,"internal-error")}}resolve(e){vn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){vn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const VO=new Ja(2e3,1e4);async function OO(n,e,t){const r=qe(n);Zs(n,e,fr);const i=zi(r,t);return new rr(r,"signInViaPopup",e,i).executeNotNull()}async function LO(n,e,t){const r=H(n);Zs(r.auth,e,fr);const i=zi(r.auth,t);return new rr(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function MO(n,e,t){const r=H(n);Zs(r.auth,e,fr);const i=zi(r.auth,t);return new rr(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class rr extends Gw{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,rr.currentPopupAction&&rr.currentPopupAction.cancel(),rr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return O(e,this.auth,"internal-error"),e}async onExecution(){vn(this.filter.length===1,"Popup operations only handle one event");const e=eu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(mt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(mt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,rr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,VO.get())};e()}}rr.currentPopupAction=null;const FO="pendingRedirect",aa=new Map;class UO extends Gw{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=aa.get(this.auth._key());if(!e){try{const r=await BO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}aa.set(this.auth._key(),e)}return this.bypassAuthState||aa.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function BO(n,e){const t=Kw(e),r=zw(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function bp(n,e){return zw(n)._set(Kw(e),"true")}function qO(){aa.clear()}function Pp(n,e){aa.set(n._key(),e)}function zw(n){return Jt(n._redirectPersistence)}function Kw(n){return Pi(FO,n.config.apiKey,n.name)}function $O(n,e,t){return WO(n,e,t)}async function WO(n,e,t){const r=qe(n);Zs(n,e,fr),await r._initializationPromise;const i=zi(r,t);return await bp(i,r),i._openRedirect(r,e,"signInViaRedirect")}function GO(n,e,t){return zO(n,e,t)}async function zO(n,e,t){const r=H(n);Zs(r.auth,e,fr),await r.auth._initializationPromise;const i=zi(r.auth,t);await bp(i,r.auth);const s=await Hw(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function KO(n,e,t){return HO(n,e,t)}async function HO(n,e,t){const r=H(n);Zs(r.auth,e,fr),await r.auth._initializationPromise;const i=zi(r.auth,t);await Sl(!1,r,e.providerId),await bp(i,r.auth);const s=await Hw(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function jO(n,e){return await qe(n)._initializationPromise,xl(n,e,!1)}async function xl(n,e,t=!1){const r=qe(n),i=zi(r,e),a=await new UO(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}async function Hw(n){const e=eu(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}const QO=10*60*1e3;class jw{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!YO(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Qw(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(mt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=QO&&this.cachedEventUids.clear(),this.cachedEventUids.has(rv(e))}saveEventToCache(e){this.cachedEventUids.add(rv(e)),this.lastProcessedEventTime=Date.now()}}function rv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Qw({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function YO(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Qw(n);default:return!1}}async function Yw(n,e={}){return ze(n,"GET","/v1/projects",e)}const JO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,XO=/^https?/;async function ZO(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Yw(n);for(const t of e)try{if(eL(t))return}catch{}yt(n,"unauthorized-domain")}function eL(n){const e=Ia(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!XO.test(t))return!1;if(JO.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const tL=new Ja(3e4,6e4);function iv(){const n=Je().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function nL(n){return new Promise((e,t)=>{var r,i,s;function a(){iv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iv(),t(mt(n,"network-request-failed"))},timeout:tL.get()})}if(!((i=(r=Je().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Je().gapi)===null||s===void 0)&&s.load)a();else{const l=Aw("iframefcb");return Je()[l]=()=>{gapi.load?a():t(mt(n,"network-request-failed"))},mp(`https://apis.google.com/js/api.js?onload=${l}`).catch(h=>t(h))}}).catch(e=>{throw Dc=null,e})}let Dc=null;function rL(n){return Dc=Dc||nL(n),Dc}const iL=new Ja(5e3,15e3),sL="__/auth/iframe",oL="emulator/auth/iframe",aL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},uL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function cL(n){const e=n.config;O(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?pp(e,oL):`https://${n.config.authDomain}/${sL}`,r={apiKey:e.apiKey,appName:n.name,v:Yr},i=uL.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Xs(r).slice(1)}`}async function lL(n){const e=await rL(n),t=Je().gapi;return O(t,n,"internal-error"),e.open({where:document.body,url:cL(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:aL,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=mt(n,"network-request-failed"),l=Je().setTimeout(()=>{s(a)},iL.get());function h(){Je().clearTimeout(l),i(r)}r.ping(h).then(h,()=>{s(a)})}))}const hL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},dL=500,fL=600,pL="_blank",gL="http://localhost";class sv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mL(n,e,t,r=dL,i=fL){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const h=Object.assign(Object.assign({},hL),{width:r.toString(),height:i.toString(),top:s,left:a}),f=Fe().toLowerCase();t&&(l=yw(f)?pL:t),_w(f)&&(e=e||gL,h.scrollbars="yes");const p=Object.entries(h).reduce((I,[A,L])=>`${I}${A}=${L},`,"");if(MN(f)&&l!=="_self")return _L(e||"",l),new sv(null);const m=window.open(e||"",l,p);O(m,n,"popup-blocked");try{m.focus()}catch{}return new sv(m)}function _L(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const yL="__/auth/handler",vL="emulator/auth/handler",IL=encodeURIComponent("fac");async function mf(n,e,t,r,i,s){O(n.config.authDomain,n,"auth-domain-config-required"),O(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Yr,eventId:i};if(e instanceof fr){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",WD(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries(s||{}))a[p]=m}if(e instanceof no){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);const l=a;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const h=await n._getAppCheckToken(),f=h?`#${IL}=${encodeURIComponent(h)}`:"";return`${wL(n)}?${Xs(l).slice(1)}${f}`}function wL({config:n}){return n.emulator?pp(n,vL):`https://${n.authDomain}/${yL}`}const Qd="webStorageSupport";class EL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xi,this._completeRedirectFn=xl,this._overrideRedirectResult=Pp}async _openPopup(e,t,r,i){var s;vn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await mf(e,t,r,Ia(),i);return mL(e,a,eu())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await mf(e,t,r,Ia(),i);return rO(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(vn(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await lL(e),r=new jw(e);return t.register("authEvent",i=>(O(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Qd,{type:Qd},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Qd];a!==void 0&&t(!!a),yt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ZO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ew()||gp()||eo()}}const TL=EL;class AL{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return xn("unexpected MultiFactorSessionType")}}}class Cp extends AL{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Cp(e)}_finalizeEnroll(e,t,r){return QV(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return fO(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Jw{constructor(){}static assertion(e){return Cp._fromCredential(e)}}Jw.FACTOR_ID="phone";var ov="@firebase/auth",av="1.5.1";class RL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){O(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function SL(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function bL(n){Ur(new qn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;O(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Tw(n)},f=new GN(r,i,s,h);return YN(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ur(new qn("auth-internal",e=>{const t=qe(e.getProvider("auth").getImmediate());return(r=>new RL(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Mn(ov,av,SL(n)),Mn(ov,av,"esm2017")}const PL=5*60;ND("authIdTokenMaxAge");bL("Browser");function Ni(){return window}const CL=2e3;async function kL(n,e,t){var r;const{BuildInfo:i}=Ni();vn(e.sessionId,"AuthEvent did not contain a session ID");const s=await OL(e.sessionId),a={};return eo()?a.ibi=i.packageName:Xa()?a.apn=i.packageName:yt(n,"operation-not-supported-in-this-environment"),i.displayName&&(a.appDisplayName=i.displayName),a.sessionId=s,mf(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,a)}async function DL(n){const{BuildInfo:e}=Ni(),t={};eo()?t.iosBundleId=e.packageName:Xa()?t.androidPackageName=e.packageName:yt(n,"operation-not-supported-in-this-environment"),await Yw(n,t)}function xL(n){const{cordova:e}=Ni();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,LN()?"_blank":"_system","location=yes"),t(i)})})}async function NL(n,e,t){const{cordova:r}=Ni();let i=()=>{};try{await new Promise((s,a)=>{let l=null;function h(){var m;s();const I=(m=r.plugins.browsertab)===null||m===void 0?void 0:m.close;typeof I=="function"&&I(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function f(){l||(l=window.setTimeout(()=>{a(mt(n,"redirect-cancelled-by-user"))},CL))}function p(){(document==null?void 0:document.visibilityState)==="visible"&&f()}e.addPassiveListener(h),document.addEventListener("resume",f,!1),Xa()&&document.addEventListener("visibilitychange",p,!1),i=()=>{e.removePassiveListener(h),document.removeEventListener("resume",f,!1),document.removeEventListener("visibilitychange",p,!1),l&&window.clearTimeout(l)}})}finally{i()}}function VL(n){var e,t,r,i,s,a,l,h,f,p;const m=Ni();O(typeof((e=m==null?void 0:m.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),O(typeof((t=m==null?void 0:m.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),O(typeof((s=(i=(r=m==null?void 0:m.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((h=(l=(a=m==null?void 0:m.cordova)===null||a===void 0?void 0:a.plugins)===null||l===void 0?void 0:l.browsertab)===null||h===void 0?void 0:h.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((p=(f=m==null?void 0:m.cordova)===null||f===void 0?void 0:f.InAppBrowser)===null||p===void 0?void 0:p.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function OL(n){const e=LL(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function LL(n){if(vn(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}const ML=20;class FL extends jw{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function UL(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:$L(),postBody:null,tenantId:n.tenantId,error:mt(n,"no-auth-event")}}function BL(n,e){return _f()._set(yf(n),e)}async function uv(n){const e=await _f()._get(yf(n));return e&&await _f()._remove(yf(n)),e}function qL(n,e){var t,r;const i=GL(e);if(i.includes("/__/auth/callback")){const s=xc(i),a=s.firebaseError?WL(decodeURIComponent(s.firebaseError)):null,l=(r=(t=a==null?void 0:a.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],h=l?mt(l):null;return h?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:h,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function $L(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<ML;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function _f(){return Jt(Tp)}function yf(n){return Pi("authEvent",n.config.apiKey,n.name)}function WL(n){try{return JSON.parse(n)}catch{return null}}function GL(n){const e=xc(n),t=e.link?decodeURIComponent(e.link):void 0,r=xc(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return xc(i).link||i||r||t||n}function xc(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return Ss(t.join("?"))}const zL=500;class KL{constructor(){this._redirectPersistence=xi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=xl,this._overrideRedirectResult=Pp}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new FL(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){yt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){VL(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),qO(),await this._originValidation(e);const a=UL(e,r,i);await BL(e,a);const l=await kL(e,a,t),h=await xL(l);return NL(e,s,h)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=DL(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Ni(),a=setTimeout(async()=>{await uv(e),t.onEvent(cv())},zL),l=async p=>{clearTimeout(a);const m=await uv(e);let I=null;m&&(p!=null&&p.url)&&(I=qL(m,p.url)),t.onEvent(I||cv())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,l);const h=i,f=`${s.packageName.toLowerCase()}://`;Ni().handleOpenURL=async p=>{if(p.toLowerCase().startsWith(f)&&l({url:p}),typeof h=="function")try{h(p)}catch(m){console.error(m)}}}}const HL=KL;function cv(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:mt("no-auth-event")}}function jL(n,e){qe(n)._logFramework(e)}var QL="@firebase/auth-compat",YL="0.5.1";const JL=1e3;function ua(){var n;return((n=self==null?void 0:self.location)===null||n===void 0?void 0:n.protocol)||null}function XL(){return ua()==="http:"||ua()==="https:"}function Xw(n=Fe()){return!!((ua()==="file:"||ua()==="ionic:"||ua()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function ZL(){return ap()||op()}function eM(){return YI()&&(document==null?void 0:document.documentMode)===11}function tM(n=Fe()){return/Edge\/\d+/.test(n)}function nM(n=Fe()){return eM()||tM(n)}function Zw(){try{const n=self.localStorage,e=eu();if(n)return n.setItem(e,"1"),n.removeItem(e),nM()?_a():!0}catch{return kp()&&_a()}return!1}function kp(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Yd(){return(XL()||QI()||Xw())&&!ZL()&&Zw()&&!kp()}function eE(){return Xw()&&typeof document<"u"}async function rM(){return eE()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},JL);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function iM(){return typeof window<"u"?window:null}const Yt={LOCAL:"local",NONE:"none",SESSION:"session"},Fo=O,tE="persistence";function sM(n,e){if(Fo(Object.values(Yt).includes(e),n,"invalid-persistence-type"),ap()){Fo(e!==Yt.SESSION,n,"unsupported-persistence-type");return}if(op()){Fo(e===Yt.NONE,n,"unsupported-persistence-type");return}if(kp()){Fo(e===Yt.NONE||e===Yt.LOCAL&&_a(),n,"unsupported-persistence-type");return}Fo(e===Yt.NONE||Zw(),n,"unsupported-persistence-type")}async function vf(n){await n._initializationPromise;const e=nE(),t=Pi(tE,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())}function oM(n,e){const t=nE();if(!t)return[];const r=Pi(tE,n,e);switch(t.getItem(r)){case Yt.NONE:return[Ms];case Yt.LOCAL:return[Ra,xi];case Yt.SESSION:return[xi];default:return[]}}function nE(){var n;try{return((n=iM())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}const aM=O;class Nr{constructor(){this.browserResolver=Jt(TL),this.cordovaResolver=Jt(HL),this.underlyingResolver=null,this._redirectPersistence=xi,this._completeRedirectFn=xl,this._overrideRedirectResult=Pp}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return eE()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return aM(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await rM();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function rE(n){return n.unwrap()}function uM(n){return n.wrapped()}function cM(n){return iE(n)}function lM(n,e){var t;const r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new hM(n,HV(n,e))}else if(r){const i=iE(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function iE(n){const{_tokenResponse:e}=n instanceof Dt?n.customData:n;if(!e)return null;if(!(n instanceof Dt)&&"temporaryProof"in e&&"phoneNumber"in e)return Fn.credentialFromResult(n);const t=e.providerId;if(!t||t===Mo.PASSWORD)return null;let r;switch(t){case Mo.GOOGLE:r=Pn;break;case Mo.FACEBOOK:r=bn;break;case Mo.GITHUB:r=Cn;break;case Mo.TWITTER:r=kn;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:h}=e;return!s&&!a&&!i&&!l?null:l?t.startsWith("saml.")?Fs._create(t,l):$n._fromParams({providerId:t,signInMethod:t,pendingToken:l,idToken:i,accessToken:s}):new ks(t).credential({idToken:i,accessToken:s,rawNonce:h})}return n instanceof Dt?r.credentialFromError(n):r.credentialFromResult(n)}function Ut(n,e){return e.catch(t=>{throw t instanceof Dt&&lM(n,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:cM(t),additionalUserInfo:KV(t),user:Vr.getOrCreate(i)}})}async function If(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>Ut(n,t.confirm(r))}}class hM{constructor(e,t){this.resolver=t,this.auth=uM(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Ut(rE(this.auth),this.resolver.resolveSignIn(e))}}let Vr=class{constructor(e){this._delegate=e,this.multiFactor=JV(e)}static getOrCreate(e){return Vr.USER_MAP.has(e)||Vr.USER_MAP.set(e,new Vr(e)),Vr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Ut(this.auth,xw(this._delegate,e))}async linkWithPhoneNumber(e,t){return If(this.auth,PO(this._delegate,e,t))}async linkWithPopup(e){return Ut(this.auth,MO(this._delegate,e,Nr))}async linkWithRedirect(e){return await vf(qe(this.auth)),KO(this._delegate,e,Nr)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Ut(this.auth,Nw(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return If(this.auth,CO(this._delegate,e,t))}reauthenticateWithPopup(e){return Ut(this.auth,LO(this._delegate,e,Nr))}async reauthenticateWithRedirect(e){return await vf(qe(this.auth)),GO(this._delegate,e,Nr)}sendEmailVerification(e){return OV(this._delegate,e)}async unlink(e){return await wV(this._delegate,e),this}updateEmail(e){return UV(this._delegate,e)}updatePassword(e){return BV(this._delegate,e)}updatePhoneNumber(e){return kO(this._delegate,e)}updateProfile(e){return FV(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return LV(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Vr.USER_MAP=new WeakMap;const Uo=O;class wf{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Uo(r,"invalid-api-key",{appName:e.name}),Uo(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?Nr:void 0;this._delegate=t.initialize({options:{persistence:dM(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(dN),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Vr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){JN(this._delegate,e,t)}applyActionCode(e){return SV(this._delegate,e)}checkActionCode(e){return Vw(this._delegate,e)}confirmPasswordReset(e,t){return RV(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Ut(this._delegate,PV(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return VV(this._delegate,e)}isSignInWithEmailLink(e){return DV(this._delegate,e)}async getRedirectResult(){Uo(Yd(),this._delegate,"operation-not-supported-in-this-environment");const e=await jO(this._delegate,Nr);return e?Ut(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){jL(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:s,complete:a}=lv(e,t,r);return this._delegate.onAuthStateChanged(i,s,a)}onIdTokenChanged(e,t,r){const{next:i,error:s,complete:a}=lv(e,t,r);return this._delegate.onIdTokenChanged(i,s,a)}sendSignInLinkToEmail(e,t){return kV(this._delegate,e,t)}sendPasswordResetEmail(e,t){return AV(this._delegate,e,t||void 0)}async setPersistence(e){sM(this._delegate,e);let t;switch(e){case Yt.SESSION:t=xi;break;case Yt.LOCAL:t=await Jt(Ra)._isAvailable()?Ra:Tp;break;case Yt.NONE:t=Ms;break;default:return yt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Ut(this._delegate,IV(this._delegate))}signInWithCredential(e){return Ut(this._delegate,bl(this._delegate,e))}signInWithCustomToken(e){return Ut(this._delegate,TV(this._delegate,e))}signInWithEmailAndPassword(e,t){return Ut(this._delegate,CV(this._delegate,e,t))}signInWithEmailLink(e,t){return Ut(this._delegate,xV(this._delegate,e,t))}signInWithPhoneNumber(e,t){return If(this._delegate,bO(this._delegate,e,t))}async signInWithPopup(e){return Uo(Yd(),this._delegate,"operation-not-supported-in-this-environment"),Ut(this._delegate,OO(this._delegate,e,Nr))}async signInWithRedirect(e){return Uo(Yd(),this._delegate,"operation-not-supported-in-this-environment"),await vf(this._delegate),$O(this._delegate,e,Nr)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return bV(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}wf.Persistence=Yt;function lv(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const i=r;return{next:a=>i(a&&Vr.getOrCreate(a)),error:e,complete:t}}function dM(n,e){const t=oM(n,e);if(typeof self<"u"&&!t.includes(Ra)&&t.push(Ra),typeof window<"u")for(const r of[Tp,xi])t.includes(r)||t.push(r);return t.includes(Ms)||t.push(Ms),t}class Dp{constructor(){this.providerId="phone",this._delegate=new Fn(rE(Br.auth()))}static credential(e,t){return Fn.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}Dp.PHONE_SIGN_IN_METHOD=Fn.PHONE_SIGN_IN_METHOD;Dp.PROVIDER_ID=Fn.PROVIDER_ID;const fM=O;class pM{constructor(e,t,r=Br.app()){var i;fM((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new RO(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const gM="auth-compat";function mM(n){n.INTERNAL.registerComponent(new qn(gM,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new wf(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:gs.EMAIL_SIGNIN,PASSWORD_RESET:gs.PASSWORD_RESET,RECOVER_EMAIL:gs.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:gs.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:gs.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:gs.VERIFY_EMAIL}},EmailAuthProvider:Jr,FacebookAuthProvider:bn,GithubAuthProvider:Cn,GoogleAuthProvider:Pn,OAuthProvider:ks,SAMLAuthProvider:Kc,PhoneAuthProvider:Dp,PhoneMultiFactorGenerator:Jw,RecaptchaVerifier:pM,TwitterAuthProvider:kn,Auth:wf,AuthCredential:to,Error:Dt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(QL,YL)}mM(Br);var _M=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},q,xp=xp||{},Z=_M||self;function Nl(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function nu(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function yM(n){return Object.prototype.hasOwnProperty.call(n,Jd)&&n[Jd]||(n[Jd]=++vM)}var Jd="closure_uid_"+(1e9*Math.random()>>>0),vM=0;function IM(n,e,t){return n.call.apply(n.bind,arguments)}function wM(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function Et(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Et=IM:Et=wM,Et.apply(null,arguments)}function vc(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ot(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var a=Array(arguments.length-2),l=2;l<arguments.length;l++)a[l-2]=arguments[l];return e.prototype[i].apply(r,a)}}function Xr(){this.s=this.s,this.o=this.o}var EM=0;Xr.prototype.s=!1;Xr.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),EM!=0)&&yM(this)};Xr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const sE=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function Np(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function hv(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Nl(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let a=0;a<s;a++)n[i+a]=r[a]}else n.push(r)}}function Tt(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Tt.prototype.h=function(){this.defaultPrevented=!0};var TM=function(){if(!Z.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const t=()=>{};Z.addEventListener("test",t,e),Z.removeEventListener("test",t,e)}catch{}return n}();function Sa(n){return/^[\s\xa0]*$/.test(n)}function Vl(){var n=Z.navigator;return n&&(n=n.userAgent)?n:""}function Dn(n){return Vl().indexOf(n)!=-1}function Vp(n){return Vp[" "](n),n}Vp[" "]=function(){};function AM(n,e){var t=mF;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}var RM=Dn("Opera"),Us=Dn("Trident")||Dn("MSIE"),oE=Dn("Edge"),Ef=oE||Us,aE=Dn("Gecko")&&!(Vl().toLowerCase().indexOf("webkit")!=-1&&!Dn("Edge"))&&!(Dn("Trident")||Dn("MSIE"))&&!Dn("Edge"),SM=Vl().toLowerCase().indexOf("webkit")!=-1&&!Dn("Edge");function uE(){var n=Z.document;return n?n.documentMode:void 0}var Tf;e:{var Xd="",Zd=function(){var n=Vl();if(aE)return/rv:([^\);]+)(\)|;)/.exec(n);if(oE)return/Edge\/([\d\.]+)/.exec(n);if(Us)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(SM)return/WebKit\/(\S+)/.exec(n);if(RM)return/(?:Version)[ \/]?(\S+)/.exec(n)}();if(Zd&&(Xd=Zd?Zd[1]:""),Us){var ef=uE();if(ef!=null&&ef>parseFloat(Xd)){Tf=String(ef);break e}}Tf=Xd}var Af;if(Z.document&&Us){var dv=uE();Af=dv||parseInt(Tf,10)||void 0}else Af=void 0;var bM=Af;function ba(n,e){if(Tt.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(aE){e:{try{Vp(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:PM[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&ba.$.h.call(this)}}ot(ba,Tt);var PM={2:"touch",3:"pen",4:"mouse"};ba.prototype.h=function(){ba.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var ru="closure_listenable_"+(1e6*Math.random()|0),CM=0;function kM(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++CM,this.fa=this.ia=!1}function Ol(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function Op(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function DM(n,e){for(const t in n)e.call(void 0,n[t],t,n)}function cE(n){const e={};for(const t in n)e[t]=n[t];return e}const fv="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function lE(n,e){let t,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(t in r)n[t]=r[t];for(let s=0;s<fv.length;s++)t=fv[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Ll(n){this.src=n,this.g={},this.h=0}Ll.prototype.add=function(n,e,t,r,i){var s=n.toString();n=this.g[s],n||(n=this.g[s]=[],this.h++);var a=Sf(n,e,r,i);return-1<a?(e=n[a],t||(e.ia=!1)):(e=new kM(e,this.src,s,!!r,i),e.ia=t,n.push(e)),e};function Rf(n,e){var t=e.type;if(t in n.g){var r=n.g[t],i=sE(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Ol(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function Sf(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}var Lp="closure_lm_"+(1e6*Math.random()|0),tf={};function hE(n,e,t,r,i){if(r&&r.once)return fE(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)hE(n,e[s],t,r,i);return null}return t=Up(t),n&&n[ru]?n.O(e,t,nu(r)?!!r.capture:!!r,i):dE(n,e,t,!1,r,i)}function dE(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var a=nu(i)?!!i.capture:!!i,l=Fp(n);if(l||(n[Lp]=l=new Ll(n)),t=l.add(e,t,r,a,s),t.proxy)return t;if(r=xM(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)TM||(i=a),i===void 0&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(gE(e.toString()),r);else if(n.addListener&&n.removeListener)n.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return t}function xM(){function n(t){return e.call(n.src,n.listener,t)}const e=NM;return n}function fE(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)fE(n,e[s],t,r,i);return null}return t=Up(t),n&&n[ru]?n.P(e,t,nu(r)?!!r.capture:!!r,i):dE(n,e,t,!0,r,i)}function pE(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)pE(n,e[s],t,r,i);else r=nu(r)?!!r.capture:!!r,t=Up(t),n&&n[ru]?(n=n.i,e=String(e).toString(),e in n.g&&(s=n.g[e],t=Sf(s,t,r,i),-1<t&&(Ol(s[t]),Array.prototype.splice.call(s,t,1),s.length==0&&(delete n.g[e],n.h--)))):n&&(n=Fp(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Sf(e,t,r,i)),(t=-1<n?e[n]:null)&&Mp(t))}function Mp(n){if(typeof n!="number"&&n&&!n.fa){var e=n.src;if(e&&e[ru])Rf(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(gE(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Fp(e))?(Rf(t,n),t.h==0&&(t.src=null,e[Lp]=null)):Ol(n)}}}function gE(n){return n in tf?tf[n]:tf[n]="on"+n}function NM(n,e){if(n.fa)n=!0;else{e=new ba(e,this);var t=n.listener,r=n.la||n.src;n.ia&&Mp(n),n=t.call(r,e)}return n}function Fp(n){return n=n[Lp],n instanceof Ll?n:null}var nf="__closure_events_fn_"+(1e9*Math.random()>>>0);function Up(n){return typeof n=="function"?n:(n[nf]||(n[nf]=function(e){return n.handleEvent(e)}),n[nf])}function st(){Xr.call(this),this.i=new Ll(this),this.S=this,this.J=null}ot(st,Xr);st.prototype[ru]=!0;st.prototype.removeEventListener=function(n,e,t,r){pE(this,n,e,t,r)};function _t(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,typeof e=="string")e=new Tt(e,n);else if(e instanceof Tt)e.target=e.target||n;else{var i=e;e=new Tt(r,n),lE(e,i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var a=e.g=t[s];i=Ic(a,r,!0,e)&&i}if(a=e.g=n,i=Ic(a,r,!0,e)&&i,i=Ic(a,r,!1,e)&&i,t)for(s=0;s<t.length;s++)a=e.g=t[s],i=Ic(a,r,!1,e)&&i}st.prototype.N=function(){if(st.$.N.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Ol(t[r]);delete n.g[e],n.h--}}this.J=null};st.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)};st.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};function Ic(n,e,t,r){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==t){var l=a.listener,h=a.la||a.src;a.ia&&Rf(n.i,a),i=l.call(h,r)!==!1&&i}}return i&&!r.defaultPrevented}var Bp=Z.JSON.stringify;class VM{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function OM(){var n=qp;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}class LM{constructor(){this.h=this.g=null}add(e,t){const r=mE.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}}var mE=new VM(()=>new MM,n=>n.reset());class MM{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function FM(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function UM(n){Z.setTimeout(()=>{throw n},0)}let Pa,Ca=!1,qp=new LM,_E=()=>{const n=Z.Promise.resolve(void 0);Pa=()=>{n.then(BM)}};var BM=()=>{for(var n;n=OM();){try{n.h.call(n.g)}catch(t){UM(t)}var e=mE;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Ca=!1};function Ml(n,e){st.call(this),this.h=n||1,this.g=e||Z,this.j=Et(this.qb,this),this.l=Date.now()}ot(Ml,st);q=Ml.prototype;q.ga=!1;q.T=null;q.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),_t(this,"tick"),this.ga&&($p(this),this.start()))}};q.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function $p(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}q.N=function(){Ml.$.N.call(this),$p(this),delete this.g};function Wp(n,e,t){if(typeof n=="function")t&&(n=Et(n,t));else if(n&&typeof n.handleEvent=="function")n=Et(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Z.setTimeout(n,e||0)}function yE(n){n.g=Wp(()=>{n.g=null,n.i&&(n.i=!1,yE(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}class qM extends Xr{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:yE(this)}N(){super.N(),this.g&&(Z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ka(n){Xr.call(this),this.h=n,this.g={}}ot(ka,Xr);var pv=[];function vE(n,e,t,r){Array.isArray(t)||(t&&(pv[0]=t.toString()),t=pv);for(var i=0;i<t.length;i++){var s=hE(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function IE(n){Op(n.g,function(e,t){this.g.hasOwnProperty(t)&&Mp(e)},n),n.g={}}ka.prototype.N=function(){ka.$.N.call(this),IE(this)};ka.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Fl(){this.g=!0}Fl.prototype.Ea=function(){this.g=!1};function $M(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var a="",l=s.split("&"),h=0;h<l.length;h++){var f=l[h].split("=");if(1<f.length){var p=f[0];f=f[1];var m=p.split("_");a=2<=m.length&&m[1]=="type"?a+(p+"="+f+"&"):a+(p+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+t+`
`+a})}function WM(n,e,t,r,i,s,a){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+t+`
`+s+" "+a})}function bs(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+zM(n,t)+(r?" "+r:"")})}function GM(n,e){n.info(function(){return"TIMEOUT: "+e})}Fl.prototype.info=function(){};function zM(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return Bp(t)}catch{return e}}var Ki={},gv=null;function Ul(){return gv=gv||new st}Ki.Ta="serverreachability";function wE(n){Tt.call(this,Ki.Ta,n)}ot(wE,Tt);function Da(n){const e=Ul();_t(e,new wE(e))}Ki.STAT_EVENT="statevent";function EE(n,e){Tt.call(this,Ki.STAT_EVENT,n),this.stat=e}ot(EE,Tt);function kt(n){const e=Ul();_t(e,new EE(e,n))}Ki.Ua="timingevent";function TE(n,e){Tt.call(this,Ki.Ua,n),this.size=e}ot(TE,Tt);function iu(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return Z.setTimeout(function(){n()},e)}var Bl={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},AE={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Gp(){}Gp.prototype.h=null;function mv(n){return n.h||(n.h=n.i())}function RE(){}var su={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function zp(){Tt.call(this,"d")}ot(zp,Tt);function Kp(){Tt.call(this,"c")}ot(Kp,Tt);var bf;function ql(){}ot(ql,Gp);ql.prototype.g=function(){return new XMLHttpRequest};ql.prototype.i=function(){return{}};bf=new ql;function ou(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new ka(this),this.P=KM,n=Ef?125:void 0,this.V=new Ml(n),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new SE}function SE(){this.i=null,this.g="",this.h=!1}var KM=45e3,bE={},Pf={};q=ou.prototype;q.setTimeout=function(n){this.P=n};function Cf(n,e,t){n.L=1,n.A=Wl(lr(e)),n.u=t,n.S=!0,PE(n,null)}function PE(n,e){n.G=Date.now(),au(n),n.B=lr(n.A);var t=n.B,r=n.W;Array.isArray(r)||(r=[String(r)]),LE(t.i,"t",r),n.o=0,t=n.l.J,n.h=new SE,n.g=rT(n.l,t?e:null,!n.u),0<n.O&&(n.M=new qM(Et(n.Pa,n,n.g),n.O)),vE(n.U,n.g,"readystatechange",n.nb),e=n.I?cE(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),Da(),$M(n.j,n.v,n.B,n.m,n.W,n.u)}q.nb=function(n){n=n.target;const e=this.M;e&&Nn(n)==3?e.l():this.Pa(n)};q.Pa=function(n){try{if(n==this.g)e:{const p=Nn(this.g);var e=this.g.Ia();const m=this.g.da();if(!(3>p)&&(p!=3||Ef||this.g&&(this.h.h||this.g.ja()||Iv(this.g)))){this.J||p!=4||e==7||(e==8||0>=m?Da(3):Da(2)),$l(this);var t=this.g.da();this.ca=t;t:if(CE(this)){var r=Iv(this.g);n="";var i=r.length,s=Nn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ti(this),ca(this);var a="";break t}this.h.i=new Z.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=n,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=t==200,WM(this.j,this.v,this.B,this.m,this.W,p,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var l,h=this.g;if((l=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Sa(l)){var f=l;break t}}f=null}if(t=f)bs(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,kf(this,t);else{this.i=!1,this.s=3,kt(12),Ti(this),ca(this);break e}}this.S?(kE(this,p,a),Ef&&this.i&&p==3&&(vE(this.U,this.V,"tick",this.mb),this.V.start())):(bs(this.j,this.m,a,null),kf(this,a)),p==4&&Ti(this),this.i&&!this.J&&(p==4?ZE(this.l,this):(this.i=!1,au(this)))}else fF(this.g),t==400&&0<a.indexOf("Unknown SID")?(this.s=3,kt(12)):(this.s=0,kt(13)),Ti(this),ca(this)}}}catch{}finally{}};function CE(n){return n.g?n.v=="GET"&&n.L!=2&&n.l.Ha:!1}function kE(n,e,t){let r=!0,i;for(;!n.J&&n.o<t.length;)if(i=HM(n,t),i==Pf){e==4&&(n.s=4,kt(14),r=!1),bs(n.j,n.m,null,"[Incomplete Response]");break}else if(i==bE){n.s=4,kt(15),bs(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}else bs(n.j,n.m,i,null),kf(n,i);CE(n)&&n.o!=0&&(n.h.g=n.h.g.slice(n.o),n.o=0),e!=4||t.length!=0||n.h.h||(n.s=1,kt(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,e=n.l,e.g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),Xp(e),e.M=!0,kt(11))):(bs(n.j,n.m,t,"[Invalid Chunked Response]"),Ti(n),ca(n))}q.mb=function(){if(this.g){var n=Nn(this.g),e=this.g.ja();this.o<e.length&&($l(this),kE(this,n,e),this.i&&n!=4&&au(this))}};function HM(n,e){var t=n.o,r=e.indexOf(`
`,t);return r==-1?Pf:(t=Number(e.substring(t,r)),isNaN(t)?bE:(r+=1,r+t>e.length?Pf:(e=e.slice(r,r+t),n.o=r+t,e)))}q.cancel=function(){this.J=!0,Ti(this)};function au(n){n.Y=Date.now()+n.P,DE(n,n.P)}function DE(n,e){if(n.C!=null)throw Error("WatchDog timer not null");n.C=iu(Et(n.lb,n),e)}function $l(n){n.C&&(Z.clearTimeout(n.C),n.C=null)}q.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(GM(this.j,this.B),this.L!=2&&(Da(),kt(17)),Ti(this),this.s=2,ca(this)):DE(this,this.Y-n)};function ca(n){n.l.H==0||n.J||ZE(n.l,n)}function Ti(n){$l(n);var e=n.M;e&&typeof e.sa=="function"&&e.sa(),n.M=null,$p(n.V),IE(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function kf(n,e){try{var t=n.l;if(t.H!=0&&(t.g==n||Df(t.i,n))){if(!n.K&&Df(t.i,n)&&t.H==3){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<n.G)Xc(t),Hl(t);else break e;Jp(t),kt(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&t.A==0&&!t.v&&(t.v=iu(Et(t.ib,t),6e3));if(1>=UE(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Ai(t,11)}else if((n.K||t.g==n)&&Xc(t),!Sa(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let f=i[e];if(t.V=f[0],f=f[1],t.H==2)if(f[0]=="c"){t.K=f[1],t.pa=f[2];const p=f[3];p!=null&&(t.ra=p,t.l.info("VER="+t.ra));const m=f[4];m!=null&&(t.Ga=m,t.l.info("SVER="+t.Ga));const I=f[5];I!=null&&typeof I=="number"&&0<I&&(r=1.5*I,t.L=r,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const A=n.g;if(A){const L=A.g?A.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(L){var s=r.i;s.g||L.indexOf("spdy")==-1&&L.indexOf("quic")==-1&&L.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Hp(s,s.h),s.h=null))}if(r.F){const M=A.g?A.g.getResponseHeader("X-HTTP-Session-Id"):null;M&&(r.Da=M,ke(r.I,r.F,M))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms")),r=t;var a=n;if(r.wa=nT(r,r.J?r.pa:null,r.Y),a.K){BE(r.i,a);var l=a,h=r.L;h&&l.setTimeout(h),l.C&&($l(l),au(l)),r.g=a}else JE(r);0<t.j.length&&jl(t)}else f[0]!="stop"&&f[0]!="close"||Ai(t,7);else t.H==3&&(f[0]=="stop"||f[0]=="close"?f[0]=="stop"?Ai(t,7):Yp(t):f[0]!="noop"&&t.h&&t.h.Aa(f),t.A=0)}}Da(4)}catch{}}function jM(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(Nl(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}e=[],t=0;for(r in n)e[t++]=n[r];return e}function QM(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Nl(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}function xE(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(Nl(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=QM(n),r=jM(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}var NE=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function YM(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function ki(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof ki){this.h=n.h,Yc(this,n.j),this.s=n.s,this.g=n.g,Jc(this,n.m),this.l=n.l;var e=n.i,t=new xa;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),_v(this,t),this.o=n.o}else n&&(e=String(n).match(NE))?(this.h=!1,Yc(this,e[1]||"",!0),this.s=ea(e[2]||""),this.g=ea(e[3]||"",!0),Jc(this,e[4]),this.l=ea(e[5]||"",!0),_v(this,e[6]||"",!0),this.o=ea(e[7]||"")):(this.h=!1,this.i=new xa(null,this.h))}ki.prototype.toString=function(){var n=[],e=this.j;e&&n.push(ta(e,yv,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(ta(e,yv,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(ta(t,t.charAt(0)=="/"?ZM:XM,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",ta(t,tF)),n.join("")};function lr(n){return new ki(n)}function Yc(n,e,t){n.j=t?ea(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Jc(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function _v(n,e,t){e instanceof xa?(n.i=e,nF(n.i,n.h)):(t||(e=ta(e,eF)),n.i=new xa(e,n.h))}function ke(n,e,t){n.i.set(e,t)}function Wl(n){return ke(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function ea(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function ta(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,JM),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function JM(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var yv=/[#\/\?@]/g,XM=/[#\?:]/g,ZM=/[#\?]/g,eF=/[#\?@]/g,tF=/#/g;function xa(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Zr(n){n.g||(n.g=new Map,n.h=0,n.i&&YM(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}q=xa.prototype;q.add=function(n,e){Zr(this),this.i=null,n=ro(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function VE(n,e){Zr(n),e=ro(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function OE(n,e){return Zr(n),e=ro(n,e),n.g.has(e)}q.forEach=function(n,e){Zr(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)};q.ta=function(){Zr(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t};q.Z=function(n){Zr(this);let e=[];if(typeof n=="string")OE(this,n)&&(e=e.concat(this.g.get(ro(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};q.set=function(n,e){return Zr(this),this.i=null,n=ro(this,n),OE(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};q.get=function(n,e){return n?(n=this.Z(n),0<n.length?String(n[0]):e):e};function LE(n,e,t){VE(n,e),0<t.length&&(n.i=null,n.g.set(ro(n,e),Np(t)),n.h+=t.length)}q.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;a[r]!==""&&(i+="="+encodeURIComponent(String(a[r]))),n.push(i)}}return this.i=n.join("&")};function ro(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function nF(n,e){e&&!n.j&&(Zr(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(VE(this,r),LE(this,i,t))},n)),n.j=e}var rF=class{constructor(n,e){this.g=n,this.map=e}};function ME(n){this.l=n||iF,Z.PerformanceNavigationTiming?(n=Z.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(Z.g&&Z.g.Ka&&Z.g.Ka()&&Z.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var iF=10;function FE(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function UE(n){return n.h?1:n.g?n.g.size:0}function Df(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function Hp(n,e){n.g?n.g.add(e):n.h=e}function BE(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}ME.prototype.cancel=function(){if(this.i=qE(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function qE(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return Np(n.i)}var sF=class{stringify(n){return Z.JSON.stringify(n,void 0)}parse(n){return Z.JSON.parse(n,void 0)}};function oF(){this.g=new sF}function aF(n,e,t){const r=t||"";try{xE(n,function(i,s){let a=i;nu(i)&&(a=Bp(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function uF(n,e){const t=new Fl;if(Z.Image){const r=new Image;r.onload=vc(wc,t,r,"TestLoadImage: loaded",!0,e),r.onerror=vc(wc,t,r,"TestLoadImage: error",!1,e),r.onabort=vc(wc,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=vc(wc,t,r,"TestLoadImage: timeout",!1,e),Z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}function wc(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Gl(n){this.l=n.ec||null,this.j=n.ob||!1}ot(Gl,Gp);Gl.prototype.g=function(){return new zl(this.l,this.j)};Gl.prototype.i=function(n){return function(){return n}}({});function zl(n,e){st.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=jp,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ot(zl,st);var jp=0;q=zl.prototype;q.open=function(n,e){if(this.readyState!=jp)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Na(this)};q.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||Z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};q.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,uu(this)),this.readyState=jp};q.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Na(this)),this.g&&(this.readyState=3,Na(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Z.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;$E(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function $E(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}q.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?uu(this):Na(this),this.readyState==3&&$E(this)}};q.Za=function(n){this.g&&(this.response=this.responseText=n,uu(this))};q.Ya=function(n){this.g&&(this.response=n,uu(this))};q.ka=function(){this.g&&uu(this)};function uu(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Na(n)}q.setRequestHeader=function(n,e){this.v.append(n,e)};q.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};q.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function Na(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(zl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var cF=Z.JSON.parse;function $e(n){st.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=WE,this.L=this.M=!1}ot($e,st);var WE="",lF=/^https?$/i,hF=["POST","PUT"];q=$e.prototype;q.Oa=function(n){this.M=n};q.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():bf.g(),this.C=this.u?mv(this.u):mv(bf),this.g.onreadystatechange=Et(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){vv(this,s);return}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())t.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(t.keys()).find(s=>s.toLowerCase()=="content-type"),i=Z.FormData&&n instanceof Z.FormData,!(0<=sE(hF,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of t)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{KE(this),0<this.B&&((this.L=dF(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Et(this.ua,this)):this.A=Wp(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){vv(this,s)}};function dF(n){return Us&&typeof n.timeout=="number"&&n.ontimeout!==void 0}q.ua=function(){typeof xp<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,_t(this,"timeout"),this.abort(8))};function vv(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,GE(n),Kl(n)}function GE(n){n.F||(n.F=!0,_t(n,"complete"),_t(n,"error"))}q.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,_t(this,"complete"),_t(this,"abort"),Kl(this))};q.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Kl(this,!0)),$e.$.N.call(this)};q.La=function(){this.s||(this.G||this.v||this.l?zE(this):this.kb())};q.kb=function(){zE(this)};function zE(n){if(n.h&&typeof xp<"u"&&(!n.C[1]||Nn(n)!=4||n.da()!=2)){if(n.v&&Nn(n)==4)Wp(n.La,0,n);else if(_t(n,"readystatechange"),Nn(n)==4){n.h=!1;try{const a=n.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=a===0){var i=String(n.I).match(NE)[1]||null;!i&&Z.self&&Z.self.location&&(i=Z.self.location.protocol.slice(0,-1)),r=!lF.test(i?i.toLowerCase():"")}t=r}if(t)_t(n,"complete"),_t(n,"success");else{n.m=6;try{var s=2<Nn(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",GE(n)}}finally{Kl(n)}}}}function Kl(n,e){if(n.g){KE(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||_t(n,"ready");try{t.onreadystatechange=r}catch{}}}function KE(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(Z.clearTimeout(n.A),n.A=null)}q.isActive=function(){return!!this.g};function Nn(n){return n.g?n.g.readyState:0}q.da=function(){try{return 2<Nn(this)?this.g.status:-1}catch{return-1}};q.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};q.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),cF(e)}};function Iv(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case WE:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function fF(n){const e={};n=(n.g&&2<=Nn(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<n.length;r++){if(Sa(n[r]))continue;var t=FM(n[r]);const i=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}DM(e,function(r){return r.join(", ")})}q.Ia=function(){return this.m};q.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function HE(n){let e="";return Op(n,function(t,r){e+=r,e+=":",e+=t,e+=`\r
`}),e}function Qp(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=HE(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):ke(n,e,t))}function Bo(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function jE(n){this.Ga=0,this.j=[],this.l=new Fl,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Bo("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Bo("baseRetryDelayMs",5e3,n),this.hb=Bo("retryDelaySeedMs",1e4,n),this.eb=Bo("forwardChannelMaxRetries",2,n),this.xa=Bo("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new ME(n&&n.concurrentRequestLimit),this.Ja=new oF,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}q=jE.prototype;q.ra=8;q.H=1;function Yp(n){if(QE(n),n.H==3){var e=n.W++,t=lr(n.I);if(ke(t,"SID",n.K),ke(t,"RID",e),ke(t,"TYPE","terminate"),cu(n,t),e=new ou(n,n.l,e),e.L=2,e.A=Wl(lr(t)),t=!1,Z.navigator&&Z.navigator.sendBeacon)try{t=Z.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&Z.Image&&(new Image().src=e.A,t=!0),t||(e.g=rT(e.l,null),e.g.ha(e.A)),e.G=Date.now(),au(e)}tT(n)}function Hl(n){n.g&&(Xp(n),n.g.cancel(),n.g=null)}function QE(n){Hl(n),n.u&&(Z.clearTimeout(n.u),n.u=null),Xc(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&Z.clearTimeout(n.m),n.m=null)}function jl(n){if(!FE(n.i)&&!n.m){n.m=!0;var e=n.Na;Pa||_E(),Ca||(Pa(),Ca=!0),qp.add(e,n),n.C=0}}function pF(n,e){return UE(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=e.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=iu(Et(n.Na,n,e),eT(n,n.C)),n.C++,!0)}q.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new ou(this,this.l,n);let s=this.s;if(this.U&&(s?(s=cE(s),lE(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var r=this.j[t];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=YE(this,i,e),t=lr(this.I),ke(t,"RID",n),ke(t,"CVER",22),this.F&&ke(t,"X-HTTP-Session-Id",this.F),cu(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(HE(s)))+"&"+e:this.o&&Qp(t,this.o,s)),Hp(this.i,i),this.bb&&ke(t,"TYPE","init"),this.P?(ke(t,"$req",e),ke(t,"SID","null"),i.aa=!0,Cf(i,t,null)):Cf(i,t,e),this.H=2}}else this.H==3&&(n?wv(this,n):this.j.length==0||FE(this.i)||wv(this))};function wv(n,e){var t;e?t=e.m:t=n.W++;const r=lr(n.I);ke(r,"SID",n.K),ke(r,"RID",t),ke(r,"AID",n.V),cu(n,r),n.o&&n.s&&Qp(r,n.o,n.s),t=new ou(n,n.l,t,n.C+1),n.o===null&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=YE(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),Hp(n.i,t),Cf(t,r,e)}function cu(n,e){n.na&&Op(n.na,function(t,r){ke(e,r,t)}),n.h&&xE({},function(t,r){ke(e,r,t)})}function YE(n,e,t){t=Math.min(n.j.length,t);var r=n.h?Et(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const a=["count="+t];s==-1?0<t?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let l=!0;for(let h=0;h<t;h++){let f=i[h].g;const p=i[h].map;if(f-=s,0>f)s=Math.max(0,i[h].g-100),l=!1;else try{aF(p,a,"req"+f+"_")}catch{r&&r(p)}}if(l){r=a.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function JE(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Pa||_E(),Ca||(Pa(),Ca=!0),qp.add(e,n),n.A=0}}function Jp(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=iu(Et(n.Ma,n),eT(n,n.A)),n.A++,!0)}q.Ma=function(){if(this.u=null,XE(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=iu(Et(this.jb,this),n)}};q.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,kt(10),Hl(this),XE(this))};function Xp(n){n.B!=null&&(Z.clearTimeout(n.B),n.B=null)}function XE(n){n.g=new ou(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var e=lr(n.wa);ke(e,"RID","rpc"),ke(e,"SID",n.K),ke(e,"AID",n.V),ke(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&ke(e,"TO",n.qa),ke(e,"TYPE","xmlhttp"),cu(n,e),n.o&&n.s&&Qp(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=Wl(lr(e)),t.u=null,t.S=!0,PE(t,n)}q.ib=function(){this.v!=null&&(this.v=null,Hl(this),Jp(this),kt(19))};function Xc(n){n.v!=null&&(Z.clearTimeout(n.v),n.v=null)}function ZE(n,e){var t=null;if(n.g==e){Xc(n),Xp(n),n.g=null;var r=2}else if(Df(n.i,e))t=e.F,BE(n.i,e),r=1;else return;if(n.H!=0){if(e.i)if(r==1){t=e.u?e.u.length:0,e=Date.now()-e.G;var i=n.C;r=Ul(),_t(r,new TE(r,t)),jl(n)}else JE(n);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&pF(n,e)||r==2&&Jp(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Ai(n,5);break;case 4:Ai(n,10);break;case 3:Ai(n,6);break;default:Ai(n,2)}}}function eT(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Ai(n,e){if(n.l.info("Error code "+e),e==2){var t=null;n.h&&(t=null);var r=Et(n.pb,n);t||(t=new ki("//www.google.com/images/cleardot.gif"),Z.location&&Z.location.protocol=="http"||Yc(t,"https"),Wl(t)),uF(t.toString(),r)}else kt(2);n.H=0,n.h&&n.h.za(e),tT(n),QE(n)}q.pb=function(n){n?(this.l.info("Successfully pinged google.com"),kt(2)):(this.l.info("Failed to ping google.com"),kt(1))};function tT(n){if(n.H=0,n.ma=[],n.h){const e=qE(n.i);(e.length!=0||n.j.length!=0)&&(hv(n.ma,e),hv(n.ma,n.j),n.i.i.length=0,Np(n.j),n.j.length=0),n.h.ya()}}function nT(n,e,t){var r=t instanceof ki?lr(t):new ki(t);if(r.g!="")e&&(r.g=e+"."+r.g),Jc(r,r.m);else{var i=Z.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new ki(null);r&&Yc(s,r),e&&(s.g=e),i&&Jc(s,i),t&&(s.l=t),r=s}return t=n.F,e=n.Da,t&&e&&ke(r,t,e),ke(r,"VER",n.ra),cu(n,r),r}function rT(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n.Ha&&!n.va?new $e(new Gl({ob:t})):new $e(n.va),e.Oa(n.J),e}q.isActive=function(){return!!this.h&&this.h.isActive(this)};function iT(){}q=iT.prototype;q.Ba=function(){};q.Aa=function(){};q.za=function(){};q.ya=function(){};q.isActive=function(){return!0};q.Va=function(){};function Zc(){if(Us&&!(10<=Number(bM)))throw Error("Environmental error: no available transport.")}Zc.prototype.g=function(n,e){return new Xt(n,e)};function Xt(n,e){st.call(this),this.g=new jE(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Sa(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Sa(e)&&(this.g.F=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new io(this)}ot(Xt,st);Xt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;kt(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=nT(n,null,n.Y),jl(n)};Xt.prototype.close=function(){Yp(this.g)};Xt.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=Bp(n),n=t);e.j.push(new rF(e.fb++,n)),e.H==3&&jl(e)};Xt.prototype.N=function(){this.g.h=null,delete this.j,Yp(this.g),delete this.g,Xt.$.N.call(this)};function sT(n){zp.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}ot(sT,zp);function oT(){Kp.call(this),this.status=1}ot(oT,Kp);function io(n){this.g=n}ot(io,iT);io.prototype.Ba=function(){_t(this.g,"a")};io.prototype.Aa=function(n){_t(this.g,new sT(n))};io.prototype.za=function(n){_t(this.g,new oT)};io.prototype.ya=function(){_t(this.g,"b")};function gF(){this.blockSize=-1}function In(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ot(In,gF);In.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function rf(n,e,t){t||(t=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=n.g[0],t=n.g[1],i=n.g[2];var s=n.g[3],a=e+(s^t&(i^s))+r[0]+3614090360&4294967295;e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[1]+3905402710&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[3]+3250441966&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[4]+4118548399&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[5]+1200080426&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[7]+4249261313&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[8]+1770035416&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[9]+2336552879&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[11]+2304563134&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[12]+1804603682&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[13]+4254626195&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[15]+1236535329&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(i^s&(t^i))+r[1]+4129170786&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[6]+3225465664&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[0]+3921069994&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[5]+3593408605&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[10]+38016083&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[4]+3889429448&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[9]+568446438&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[14]+3275163606&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[8]+1163531501&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[13]+2850285829&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[2]+4243563512&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[12]+2368359562&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(t^i^s)+r[5]+4294588738&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[8]+2272392833&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[14]+4259657740&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[1]+2763975236&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[4]+1272893353&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[10]+3200236656&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[13]+681279174&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[0]+3936430074&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[6]+76029189&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[9]+3654602809&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[12]+3873151461&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[2]+3299628645&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(i^(t|~s))+r[0]+4096336452&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[7]+1126891415&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[5]+4237533241&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[12]+1700485571&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[3]+2399980690&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[1]+2240044497&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[8]+1873313359&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[15]+4264355552&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[13]+1309151649&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[4]+4149444226&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[11]+3174756917&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}In.prototype.j=function(n,e){e===void 0&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=t;)rf(this,n,s),s+=this.blockSize;if(typeof n=="string"){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){rf(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){rf(this,r),i=0;break}}this.h=i,this.i+=e};In.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=t&255,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};function Ae(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=n[i]|0;r&&s==e||(t[i]=s,r=!1)}this.g=t}var mF={};function Zp(n){return-128<=n&&128>n?AM(n,function(e){return new Ae([e|0],0>e?-1:0)}):new Ae([n|0],0>n?-1:0)}function Vn(n){if(isNaN(n)||!isFinite(n))return xs;if(0>n)return pt(Vn(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=xf;return new Ae(e,0)}function aT(n,e){if(n.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(n.charAt(0)=="-")return pt(aT(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Vn(Math.pow(e,8)),r=xs,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),a=parseInt(n.substring(i,i+s),e);8>s?(s=Vn(Math.pow(e,s)),r=r.R(s).add(Vn(a))):(r=r.R(t),r=r.add(Vn(a)))}return r}var xf=4294967296,xs=Zp(0),Nf=Zp(1),Ev=Zp(16777216);q=Ae.prototype;q.ea=function(){if(cn(this))return-pt(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:xf+r)*e,e*=xf}return n};q.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(ir(this))return"0";if(cn(this))return"-"+pt(this).toString(n);for(var e=Vn(Math.pow(n,6)),t=this,r="";;){var i=tl(t,e).g;t=el(t,i.R(e));var s=((0<t.g.length?t.g[0]:t.h)>>>0).toString(n);if(t=i,ir(t))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};q.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function ir(n){if(n.h!=0)return!1;for(var e=0;e<n.g.length;e++)if(n.g[e]!=0)return!1;return!0}function cn(n){return n.h==-1}q.X=function(n){return n=el(this,n),cn(n)?-1:ir(n)?0:1};function pt(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new Ae(t,~n.h).add(Nf)}q.abs=function(){return cn(this)?pt(this):this};q.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(n.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=a>>>16,s&=65535,a&=65535,t[i]=a<<16|s}return new Ae(t,t[t.length-1]&-2147483648?-1:0)};function el(n,e){return n.add(pt(e))}q.R=function(n){if(ir(this)||ir(n))return xs;if(cn(this))return cn(n)?pt(this).R(pt(n)):pt(pt(this).R(n));if(cn(n))return pt(this.R(pt(n)));if(0>this.X(Ev)&&0>n.X(Ev))return Vn(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,a=this.D(r)&65535,l=n.D(i)>>>16,h=n.D(i)&65535;t[2*r+2*i]+=a*h,Ec(t,2*r+2*i),t[2*r+2*i+1]+=s*h,Ec(t,2*r+2*i+1),t[2*r+2*i+1]+=a*l,Ec(t,2*r+2*i+1),t[2*r+2*i+2]+=s*l,Ec(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new Ae(t,0)};function Ec(n,e){for(;(n[e]&65535)!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function qo(n,e){this.g=n,this.h=e}function tl(n,e){if(ir(e))throw Error("division by zero");if(ir(n))return new qo(xs,xs);if(cn(n))return e=tl(pt(n),e),new qo(pt(e.g),pt(e.h));if(cn(e))return e=tl(n,pt(e)),new qo(pt(e.g),e.h);if(30<n.g.length){if(cn(n)||cn(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Nf,r=e;0>=r.X(n);)t=Tv(t),r=Tv(r);var i=ms(t,1),s=ms(r,1);for(r=ms(r,2),t=ms(t,2);!ir(r);){var a=s.add(r);0>=a.X(n)&&(i=i.add(t),s=a),r=ms(r,1),t=ms(t,1)}return e=el(n,i.R(e)),new qo(i,e)}for(i=xs;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=Math.ceil(Math.log(t)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Vn(t),a=s.R(e);cn(a)||0<a.X(n);)t-=r,s=Vn(t),a=s.R(e);ir(s)&&(s=Nf),i=i.add(s),n=el(n,a)}return new qo(i,n)}q.gb=function(n){return tl(this,n).h};q.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new Ae(t,this.h&n.h)};q.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new Ae(t,this.h|n.h)};q.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new Ae(t,this.h^n.h)};function Tv(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new Ae(t,n.h)}function ms(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new Ae(i,n.h)}Zc.prototype.createWebChannel=Zc.prototype.g;Xt.prototype.send=Xt.prototype.u;Xt.prototype.open=Xt.prototype.m;Xt.prototype.close=Xt.prototype.close;Bl.NO_ERROR=0;Bl.TIMEOUT=8;Bl.HTTP_ERROR=6;AE.COMPLETE="complete";RE.EventType=su;su.OPEN="a";su.CLOSE="b";su.ERROR="c";su.MESSAGE="d";st.prototype.listen=st.prototype.O;$e.prototype.listenOnce=$e.prototype.P;$e.prototype.getLastError=$e.prototype.Sa;$e.prototype.getLastErrorCode=$e.prototype.Ia;$e.prototype.getStatus=$e.prototype.da;$e.prototype.getResponseJson=$e.prototype.Wa;$e.prototype.getResponseText=$e.prototype.ja;$e.prototype.send=$e.prototype.ha;$e.prototype.setWithCredentials=$e.prototype.Oa;In.prototype.digest=In.prototype.l;In.prototype.reset=In.prototype.reset;In.prototype.update=In.prototype.j;Ae.prototype.add=Ae.prototype.add;Ae.prototype.multiply=Ae.prototype.R;Ae.prototype.modulo=Ae.prototype.gb;Ae.prototype.compare=Ae.prototype.X;Ae.prototype.toNumber=Ae.prototype.ea;Ae.prototype.toString=Ae.prototype.toString;Ae.prototype.getBits=Ae.prototype.D;Ae.fromNumber=Vn;Ae.fromString=aT;var _F=function(){return new Zc},yF=function(){return Ul()},sf=Bl,vF=AE,IF=Ki,Av={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Tc=RE,wF=$e,EF=In,Ns=Ae;const Rv="@firebase/firestore";class rt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}rt.UNAUTHENTICATED=new rt(null),rt.GOOGLE_CREDENTIALS=new rt("google-credentials-uid"),rt.FIRST_PARTY=new rt("first-party-uid"),rt.MOCK_USER=new rt("mock-user");let so="10.7.0";const qr=new El("@firebase/firestore");function ws(){return qr.logLevel}function TF(n){qr.setLogLevel(n)}function N(n,...e){if(qr.logLevel<=ce.DEBUG){const t=e.map(eg);qr.debug(`Firestore (${so}): ${n}`,...t)}}function je(n,...e){if(qr.logLevel<=ce.ERROR){const t=e.map(eg);qr.error(`Firestore (${so}): ${n}`,...t)}}function wn(n,...e){if(qr.logLevel<=ce.WARN){const t=e.map(eg);qr.warn(`Firestore (${so}): ${n}`,...t)}}function eg(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function $(n="Unexpected state"){const e=`FIRESTORE (${so}) INTERNAL ASSERTION FAILED: `+n;throw je(e),new Error(e)}function z(n,e){n||$()}function AF(n,e){n||$()}function B(n,e){return n}const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class D extends Dt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class it{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class uT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class RF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(rt.UNAUTHENTICATED))}shutdown(){}}class SF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class bF{constructor(e){this.t=e,this.currentUser=rt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let s=new it;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new it,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=s;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},l=h=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?l(h):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new it)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(z(typeof r.accessToken=="string"),new uT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return z(e===null||typeof e=="string"),new rt(e)}}class PF{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=rt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class CF{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new PF(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(rt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class kF{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class DF{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{s.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,N("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(z(typeof t.token=="string"),this.R=t.token,new kF(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function xF(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class cT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=xF(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function ne(n,e){return n<e?-1:n>e?1:0}function Bs(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function lT(n){return n+"\0"}class Oe{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new D(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new D(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new D(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Oe.fromMillis(Date.now())}static fromDate(e){return Oe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Oe(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class K{constructor(e){this.timestamp=e}static fromTimestamp(e){return new K(e)}static min(){return new K(new Oe(0,0))}static max(){return new K(new Oe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Va{constructor(e,t,r){t===void 0?t=0:t>e.length&&$(),r===void 0?r=e.length-t:r>e.length-t&&$(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Va.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Va?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ge extends Va{construct(e,t,r){return new ge(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new D(b.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new ge(t)}static emptyPath(){return new ge([])}}const NF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ne extends Va{construct(e,t,r){return new Ne(e,t,r)}static isValidIdentifier(e){return NF.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ne.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ne(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new D(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new D(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new D(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(s(),i++)}if(s(),a)throw new D(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ne(t)}static emptyPath(){return new Ne([])}}class F{constructor(e){this.path=e}static fromPath(e){return new F(ge.fromString(e))}static fromName(e){return new F(ge.fromString(e).popFirst(5))}static empty(){return new F(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ge.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new ge(e.slice()))}}class nl{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Vf(n){return n.fields.find(e=>e.kind===2)}function mi(n){return n.fields.filter(e=>e.kind!==2)}nl.UNKNOWN_ID=-1;class Nc{constructor(e,t){this.fieldPath=e,this.kind=t}}class Oa{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Oa(0,Zt.min())}}function hT(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new Oe(t+1,0):new Oe(t,r));return new Zt(i,F.empty(),e)}function dT(n){return new Zt(n.readTime,n.key,-1)}class Zt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Zt(K.min(),F.empty(),-1)}static max(){return new Zt(K.max(),F.empty(),-1)}}function tg(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:ne(n.largestBatchId,e.largestBatchId))}const fT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function ei(n){if(n.code!==b.FAILED_PRECONDITION||n.message!==fT)throw n;N("LocalStore","Unexpectedly lost primary lease")}class R{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new R((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof R?t:R.resolve(t)}catch(t){return R.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):R.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):R.reject(t)}static resolve(e){return new R((t,r)=>{t(e)})}static reject(e){return new R((t,r)=>{r(e)})}static waitFor(e){return new R((t,r)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&t()},h=>r(h))}),a=!0,s===i&&t()})}static or(e){let t=R.resolve(!1);for(const r of e)t=t.next(i=>i?R.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new R((r,i)=>{const s=e.length,a=new Array(s);let l=0;for(let h=0;h<s;h++){const f=h;t(e[f]).next(p=>{a[f]=p,++l,l===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new R((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}class Ql{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new it,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new la(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=ng(r.target.error);this.V.reject(new la(e,i))}}static open(e,t,r,i){try{return new Ql(t,e.transaction(i,r))}catch(s){throw new la(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(N("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new OF(t)}}class yn{constructor(e,t,r){this.name=e,this.version=t,this.p=r,yn.S(Fe())===12.2&&je("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return N("SimpleDb","Removing database:",e),_i(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!_a())return!1;if(yn.C())return!0;const e=Fe(),t=yn.S(e),r=0<t&&t<10,i=yn.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async O(e){return this.db||(N("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new la(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new D(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new D(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new la(e,a))},i.onupgradeneeded=s=>{N("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.p.N(a,i.transaction,s.oldVersion,this.version).next(()=>{N("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.O(e);const l=Ql.open(this.db,e,s?"readonly":"readwrite",r),h=i(l).next(f=>(l.g(),f)).catch(f=>(l.abort(f),R.reject(f))).toPromise();return h.catch(()=>{}),await l.m,h}catch(l){const h=l,f=h.name!=="FirebaseError"&&a<3;if(N("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),this.close(),!f)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}class VF{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return _i(this.k.delete())}}class la extends D{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ti(n){return n.name==="IndexedDbTransactionError"}class OF{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(N("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(N("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),_i(r)}add(e){return N("SimpleDb","ADD",this.store.name,e,e),_i(this.store.add(e))}get(e){return _i(this.store.get(e)).next(t=>(t===void 0&&(t=null),N("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return N("SimpleDb","DELETE",this.store.name,e),_i(this.store.delete(e))}count(){return N("SimpleDb","COUNT",this.store.name),_i(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.G(i,(a,l)=>{s.push(l)}).next(()=>s)}{const i=this.store.getAll(r.range);return new R((s,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{s(l.target.result)}})}}j(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new R((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}H(e,t){N("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.J=!1;const i=this.cursor(r);return this.G(i,(s,a,l)=>l.delete())}Y(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Z(e){const t=this.cursor({});return new R((r,i)=>{t.onerror=s=>{const a=ng(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(l=>{l?a.continue():r()}):r()}})}G(e,t){const r=[];return new R((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const l=a.target.result;if(!l)return void i();const h=new VF(l),f=t(l.primaryKey,l.value,h);if(f instanceof R){const p=f.catch(m=>(h.done(),R.reject(m)));r.push(p)}h.isDone?i():h.$===null?l.continue():l.continue(h.$)}}).next(()=>R.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function _i(n){return new R((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=ng(r.target.error);t(i)}})}let Sv=!1;function ng(n){const e=yn.S(Fe());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new D("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Sv||(Sv=!0,setTimeout(()=>{throw r},0)),r}}return n}class LF{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){N("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{N("IndexBackiller",`Documents written: ${await this.X.te()}`)}catch(t){ti(t)?N("IndexBackiller","Ignoring IndexedDB error during index backfill: ",t):await ei(t)}await this.ee(6e4)})}}class MF{constructor(e,t){this.localStore=e,this.persistence=t}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ne(t,e))}ne(e,t){const r=new Set;let i=t,s=!0;return R.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return N("IndexBackiller",`Processing collection: ${a}`),this.re(e,a,i).next(l=>{i-=l,r.add(a)});s=!1})).next(()=>t-i)}re(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ie(i,s)).next(l=>(N("IndexBackiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>a.size)}))}ie(e,t){let r=e;return t.changes.forEach((i,s)=>{const a=dT(s);tg(a,r)>0&&(r=a)}),new Zt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class qt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.se(r),this.oe=r=>t.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}qt._e=-1;function lu(n){return n==null}function La(n){return n===0&&1/n==-1/0}function gT(n){return typeof n=="number"&&Number.isInteger(n)&&!La(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function xt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=bv(e)),e=FF(n.get(t),e);return bv(e)}function FF(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function bv(n){return n+""}function On(n){const e=n.length;if(z(e>=2),e===2)return z(n.charAt(0)===""&&n.charAt(1)===""),ge.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf("",s);switch((a<0||a>t)&&$(),n.charAt(a+1)){case"":const l=n.substring(s,a);let h;i.length===0?h=l:(i+=l,h=i,i=""),r.push(h);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:$()}s=a+2}return new ge(r)}const Pv=["userId","batchId"];function Vc(n,e){return[n,xt(e)]}function mT(n,e,t){return[n,xt(e),t]}const UF={},BF=["prefixPath","collectionGroup","readTime","documentId"],qF=["prefixPath","collectionGroup","documentId"],$F=["collectionGroup","readTime","prefixPath","documentId"],WF=["canonicalId","targetId"],GF=["targetId","path"],zF=["path","targetId"],KF=["collectionId","parent"],HF=["indexId","uid"],jF=["uid","sequenceNumber"],QF=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],YF=["indexId","uid","orderedDocumentKey"],JF=["userId","collectionPath","documentId"],XF=["userId","collectionPath","largestBatchId"],ZF=["userId","collectionGroup","largestBatchId"],_T=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],e2=[..._T,"documentOverlays"],yT=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],vT=yT,t2=[...vT,"indexConfiguration","indexState","indexEntries"];class Of extends pT{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function at(n,e){const t=B(n);return yn.M(t.ae,e)}function Cv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Hi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function IT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Pe{constructor(e,t){this.comparator=e,this.root=t||ft.EMPTY}insert(e,t){return new Pe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ft.BLACK,null,null))}remove(e){return new Pe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ft.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ac(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ac(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ac(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ac(this.root,e,this.comparator,!0)}}class Ac{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ft{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??ft.RED,this.left=i??ft.EMPTY,this.right=s??ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new ft(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ft.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $();const e=this.left.check();if(e!==this.right.check())throw $();return e+(this.isRed()?0:1)}}ft.EMPTY=null,ft.RED=!0,ft.BLACK=!1;ft.EMPTY=new class{constructor(){this.size=0}get key(){throw $()}get value(){throw $()}get color(){throw $()}get left(){throw $()}get right(){throw $()}copy(e,t,r,i,s){return this}insert(e,t,r){return new ft(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Re{constructor(e){this.comparator=e,this.data=new Pe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new kv(this.data.getIterator())}getIteratorFrom(e){return new kv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Re(this.comparator);return t.data=e,t}}class kv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function _s(n){return n.hasNext()?n.getNext():void 0}class $t{constructor(e){this.fields=e,e.sort(Ne.comparator)}static empty(){return new $t([])}unionWith(e){let t=new Re(Ne.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new $t(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Bs(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class wT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function n2(){return typeof atob<"u"}class et{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new wT("Invalid base64 string: "+s):s}}(e);return new et(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new et(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}et.EMPTY_BYTE_STRING=new et("");const r2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $r(n){if(z(!!n),typeof n=="string"){let e=0;const t=r2.exec(n);if(z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Be(n.seconds),nanos:Be(n.nanos)}}function Be(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Wr(n){return typeof n=="string"?et.fromBase64String(n):et.fromUint8Array(n)}function Yl(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function rg(n){const e=n.mapValue.fields.__previous_value__;return Yl(e)?rg(e):e}function Ma(n){const e=$r(n.mapValue.fields.__local_write_time__.timestampValue);return new Oe(e.seconds,e.nanos)}class i2{constructor(e,t,r,i,s,a,l,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=f}}class Gr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Gr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Gr&&e.projectId===this.projectId&&e.database===this.database}}const Or={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Oc={nullValue:"NULL_VALUE"};function Vi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Yl(n)?4:ET(n)?9007199254740991:10:$()}function Wn(n,e){if(n===e)return!0;const t=Vi(n);if(t!==Vi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ma(n).isEqual(Ma(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=$r(i.timestampValue),l=$r(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Wr(i.bytesValue).isEqual(Wr(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Be(i.geoPointValue.latitude)===Be(s.geoPointValue.latitude)&&Be(i.geoPointValue.longitude)===Be(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Be(i.integerValue)===Be(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Be(i.doubleValue),l=Be(s.doubleValue);return a===l?La(a)===La(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return Bs(n.arrayValue.values||[],e.arrayValue.values||[],Wn);case 10:return function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(Cv(a)!==Cv(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(l[h]===void 0||!Wn(a[h],l[h])))return!1;return!0}(n,e);default:return $()}}function Fa(n,e){return(n.values||[]).find(t=>Wn(t,e))!==void 0}function zr(n,e){if(n===e)return 0;const t=Vi(n),r=Vi(e);if(t!==r)return ne(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ne(n.booleanValue,e.booleanValue);case 2:return function(s,a){const l=Be(s.integerValue||s.doubleValue),h=Be(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return Dv(n.timestampValue,e.timestampValue);case 4:return Dv(Ma(n),Ma(e));case 5:return ne(n.stringValue,e.stringValue);case 6:return function(s,a){const l=Wr(s),h=Wr(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),h=a.split("/");for(let f=0;f<l.length&&f<h.length;f++){const p=ne(l[f],h[f]);if(p!==0)return p}return ne(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){const l=ne(Be(s.latitude),Be(a.latitude));return l!==0?l:ne(Be(s.longitude),Be(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,a){const l=s.values||[],h=a.values||[];for(let f=0;f<l.length&&f<h.length;++f){const p=zr(l[f],h[f]);if(p)return p}return ne(l.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===Or.mapValue&&a===Or.mapValue)return 0;if(s===Or.mapValue)return 1;if(a===Or.mapValue)return-1;const l=s.fields||{},h=Object.keys(l),f=a.fields||{},p=Object.keys(f);h.sort(),p.sort();for(let m=0;m<h.length&&m<p.length;++m){const I=ne(h[m],p[m]);if(I!==0)return I;const A=zr(l[h[m]],f[p[m]]);if(A!==0)return A}return ne(h.length,p.length)}(n.mapValue,e.mapValue);default:throw $()}}function Dv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ne(n,e);const t=$r(n),r=$r(e),i=ne(t.seconds,r.seconds);return i!==0?i:ne(t.nanos,r.nanos)}function qs(n){return Lf(n)}function Lf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=$r(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Wr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return F.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Lf(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${Lf(t.fields[a])}`;return i+"}"}(n.mapValue):$()}function Oi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Mf(n){return!!n&&"integerValue"in n}function Ua(n){return!!n&&"arrayValue"in n}function xv(n){return!!n&&"nullValue"in n}function Nv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Lc(n){return!!n&&"mapValue"in n}function ha(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Hi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ha(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ha(n.arrayValue.values[t]);return e}return Object.assign({},n)}function ET(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function s2(n){return"nullValue"in n?Oc:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Oi(Gr.empty(),F.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:$()}function o2(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Oi(Gr.empty(),F.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Or:$()}function Vv(n,e){const t=zr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Ov(n,e){const t=zr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class gt{constructor(e){this.value=e}static empty(){return new gt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Lc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ha(t)}setAll(e){let t=Ne.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!t.isImmediateParentOf(l)){const h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=l.popLast()}a?r[l.lastSegment()]=ha(a):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Lc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Lc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Hi(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new gt(ha(this.value))}}function TT(n){const e=[];return Hi(n.fields,(t,r)=>{const i=new Ne([t]);if(Lc(r)){const s=TT(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new $t(e)}class De{constructor(e,t,r,i,s,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new De(e,0,K.min(),K.min(),K.min(),gt.empty(),0)}static newFoundDocument(e,t,r,i){return new De(e,1,t,K.min(),r,i,0)}static newNoDocument(e,t){return new De(e,2,t,K.min(),K.min(),gt.empty(),0)}static newUnknownDocument(e,t){return new De(e,3,t,K.min(),K.min(),gt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof De&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new De(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Kr{constructor(e,t){this.position=e,this.inclusive=t}}function Lv(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=zr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Mv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Wn(n.position[t],e.position[t]))return!1;return!0}class Ba{constructor(e,t="asc"){this.field=e,this.dir=t}}function a2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class AT{}class he extends AT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new u2(e,t,r):t==="array-contains"?new h2(e,r):t==="in"?new kT(e,r):t==="not-in"?new d2(e,r):t==="array-contains-any"?new f2(e,r):new he(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new c2(e,r):new l2(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(zr(t,this.value)):t!==null&&Vi(this.value)===Vi(t)&&this.matchesComparison(zr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Te extends AT{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Te(e,t)}matches(e){return $s(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function $s(n){return n.op==="and"}function Ff(n){return n.op==="or"}function ig(n){return RT(n)&&$s(n)}function RT(n){for(const e of n.filters)if(e instanceof Te)return!1;return!0}function Uf(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+qs(n.value);if(ig(n))return n.filters.map(e=>Uf(e)).join(",");{const e=n.filters.map(t=>Uf(t)).join(",");return`${n.op}(${e})`}}function ST(n,e){return n instanceof he?function(r,i){return i instanceof he&&r.op===i.op&&r.field.isEqual(i.field)&&Wn(r.value,i.value)}(n,e):n instanceof Te?function(r,i){return i instanceof Te&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,l)=>s&&ST(a,i.filters[l]),!0):!1}(n,e):void $()}function bT(n,e){const t=n.filters.concat(e);return Te.create(t,n.op)}function PT(n){return n instanceof he?function(t){return`${t.field.canonicalString()} ${t.op} ${qs(t.value)}`}(n):n instanceof Te?function(t){return t.op.toString()+" {"+t.getFilters().map(PT).join(" ,")+"}"}(n):"Filter"}class u2 extends he{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){const t=F.comparator(e.key,this.key);return this.matchesComparison(t)}}class c2 extends he{constructor(e,t){super(e,"in",t),this.keys=CT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class l2 extends he{constructor(e,t){super(e,"not-in",t),this.keys=CT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function CT(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>F.fromName(r.referenceValue))}class h2 extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ua(t)&&Fa(t.arrayValue,this.value)}}class kT extends he{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Fa(this.value.arrayValue,t)}}class d2 extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(Fa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Fa(this.value.arrayValue,t)}}class f2 extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ua(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Fa(this.value.arrayValue,r))}}class p2{constructor(e,t=null,r=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.ce=null}}function Bf(n,e=null,t=[],r=[],i=null,s=null,a=null){return new p2(n,e,t,r,i,s,a)}function Li(n){const e=B(n);if(e.ce===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Uf(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),lu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>qs(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>qs(r)).join(",")),e.ce=t}return e.ce}function hu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!a2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ST(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Mv(n.startAt,e.startAt)&&Mv(n.endAt,e.endAt)}function rl(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function il(n,e){return n.filters.filter(t=>t instanceof he&&t.field.isEqual(e))}function Fv(n,e,t){let r=Oc,i=!0;for(const s of il(n,e)){let a=Oc,l=!0;switch(s.op){case"<":case"<=":a=s2(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,l=!1;break;case"!=":case"not-in":a=Oc}Vv({value:r,inclusive:i},{value:a,inclusive:l})<0&&(r=a,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Vv({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function Uv(n,e,t){let r=Or,i=!0;for(const s of il(n,e)){let a=Or,l=!0;switch(s.op){case">=":case">":a=o2(s.value),l=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,l=!1;break;case"!=":case"not-in":a=Or}Ov({value:r,inclusive:i},{value:a,inclusive:l})>0&&(r=a,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Ov({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class pr{constructor(e,t=null,r=[],i=[],s=null,a="F",l=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=h,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function DT(n,e,t,r,i,s,a,l){return new pr(n,e,t,r,i,s,a,l)}function oo(n){return new pr(n)}function Bv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function sg(n){return n.collectionGroup!==null}function Vs(n){const e=B(n);if(e.le===null){e.le=[];const t=new Set;for(const s of e.explicitOrderBy)e.le.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Re(Ne.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.le.push(new Ba(s,r))}),t.has(Ne.keyField().canonicalString())||e.le.push(new Ba(Ne.keyField(),r))}return e.le}function Nt(n){const e=B(n);return e.he||(e.he=g2(e,Vs(n))),e.he}function g2(n,e){if(n.limitType==="F")return Bf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ba(i.field,s)});const t=n.endAt?new Kr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Kr(n.startAt.position,n.startAt.inclusive):null;return Bf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function qf(n,e){const t=n.filters.concat([e]);return new pr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function sl(n,e,t){return new pr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function du(n,e){return hu(Nt(n),Nt(e))&&n.limitType===e.limitType}function xT(n){return`${Li(Nt(n))}|lt:${n.limitType}`}function Es(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>PT(i)).join(", ")}]`),lu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>qs(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>qs(i)).join(",")),`Target(${r})`}(Nt(n))}; limitType=${n.limitType})`}function fu(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):F.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Vs(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,l,h){const f=Lv(a,l,h);return a.inclusive?f<=0:f<0}(r.startAt,Vs(r),i)||r.endAt&&!function(a,l,h){const f=Lv(a,l,h);return a.inclusive?f>=0:f>0}(r.endAt,Vs(r),i))}(n,e)}function NT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function VT(n){return(e,t)=>{let r=!1;for(const i of Vs(n)){const s=m2(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function m2(n,e,t){const r=n.field.isKeyField()?F.comparator(e.key,t.key):function(s,a,l){const h=a.data.field(s),f=l.data.field(s);return h!==null&&f!==null?zr(h,f):$()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return $()}}class ni{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Hi(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return IT(this.inner)}size(){return this.innerSize}}const _2=new Pe(F.comparator);function Wt(){return _2}const OT=new Pe(F.comparator);function na(...n){let e=OT;for(const t of n)e=e.insert(t.key,t);return e}function LT(n){let e=OT;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ln(){return da()}function MT(){return da()}function da(){return new ni(n=>n.toString(),(n,e)=>n.isEqual(e))}const y2=new Pe(F.comparator),v2=new Re(F.comparator);function re(...n){let e=v2;for(const t of n)e=e.add(t);return e}const I2=new Re(ne);function og(){return I2}function FT(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:La(e)?"-0":e}}function UT(n){return{integerValue:""+n}}function BT(n,e){return gT(e)?UT(e):FT(n,e)}class Jl{constructor(){this._=void 0}}function w2(n,e,t){return n instanceof Ws?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Yl(s)&&(s=rg(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof Mi?$T(n,e):n instanceof Fi?WT(n,e):function(i,s){const a=qT(i,s),l=qv(a)+qv(i.Ie);return Mf(a)&&Mf(i.Ie)?UT(l):FT(i.serializer,l)}(n,e)}function E2(n,e,t){return n instanceof Mi?$T(n,e):n instanceof Fi?WT(n,e):t}function qT(n,e){return n instanceof Gs?function(r){return Mf(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ws extends Jl{}class Mi extends Jl{constructor(e){super(),this.elements=e}}function $T(n,e){const t=GT(e);for(const r of n.elements)t.some(i=>Wn(i,r))||t.push(r);return{arrayValue:{values:t}}}class Fi extends Jl{constructor(e){super(),this.elements=e}}function WT(n,e){let t=GT(e);for(const r of n.elements)t=t.filter(i=>!Wn(i,r));return{arrayValue:{values:t}}}class Gs extends Jl{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function qv(n){return Be(n.integerValue||n.doubleValue)}function GT(n){return Ua(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class pu{constructor(e,t){this.field=e,this.transform=t}}function T2(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Mi&&i instanceof Mi||r instanceof Fi&&i instanceof Fi?Bs(r.elements,i.elements,Wn):r instanceof Gs&&i instanceof Gs?Wn(r.Ie,i.Ie):r instanceof Ws&&i instanceof Ws}(n.transform,e.transform)}class A2{constructor(e,t){this.version=e,this.transformResults=t}}class Ve{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ve}static exists(e){return new Ve(void 0,e)}static updateTime(e){return new Ve(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Mc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Xl{}function zT(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new uo(n.key,Ve.none()):new ao(n.key,n.data,Ve.none());{const t=n.data,r=gt.empty();let i=new Re(Ne.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new gr(n.key,r,new $t(i.toArray()),Ve.none())}}function R2(n,e,t){n instanceof ao?function(i,s,a){const l=i.value.clone(),h=Wv(i.fieldTransforms,s,a.transformResults);l.setAll(h),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof gr?function(i,s,a){if(!Mc(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=Wv(i.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(KT(i)),h.setAll(l),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function fa(n,e,t,r){return n instanceof ao?function(s,a,l,h){if(!Mc(s.precondition,a))return l;const f=s.value.clone(),p=Gv(s.fieldTransforms,h,a);return f.setAll(p),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof gr?function(s,a,l,h){if(!Mc(s.precondition,a))return l;const f=Gv(s.fieldTransforms,h,a),p=a.data;return p.setAll(KT(s)),p.setAll(f),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,a,l){return Mc(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(n,e,t)}function S2(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=qT(r.transform,i||null);s!=null&&(t===null&&(t=gt.empty()),t.set(r.field,s))}return t||null}function $v(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Bs(r,i,(s,a)=>T2(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ao extends Xl{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class gr extends Xl{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function KT(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Wv(n,e,t){const r=new Map;z(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,l=e.data.field(s.field);r.set(s.field,E2(a,l,t[i]))}return r}function Gv(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,w2(s,a,e))}return r}class uo extends Xl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ag extends Xl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ug{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&R2(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=fa(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=fa(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=MT();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=t.has(i.key)?null:l;const h=zT(a,l);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),re())}isEqual(e){return this.batchId===e.batchId&&Bs(this.mutations,e.mutations,(t,r)=>$v(t,r))&&Bs(this.baseMutations,e.baseMutations,(t,r)=>$v(t,r))}}class cg{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){z(e.mutations.length===r.length);let i=function(){return y2}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new cg(e,t,r,i)}}class lg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class b2{constructor(e,t){this.count=e,this.unchangedNames=t}}var Ye,pe;function HT(n){switch(n){default:return $();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function jT(n){if(n===void 0)return je("GRPC error has no .code"),b.UNKNOWN;switch(n){case Ye.OK:return b.OK;case Ye.CANCELLED:return b.CANCELLED;case Ye.UNKNOWN:return b.UNKNOWN;case Ye.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Ye.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Ye.INTERNAL:return b.INTERNAL;case Ye.UNAVAILABLE:return b.UNAVAILABLE;case Ye.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Ye.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Ye.NOT_FOUND:return b.NOT_FOUND;case Ye.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Ye.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Ye.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Ye.ABORTED:return b.ABORTED;case Ye.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Ye.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Ye.DATA_LOSS:return b.DATA_LOSS;default:return $()}}(pe=Ye||(Ye={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";function QT(){return new TextEncoder}const P2=new Ns([4294967295,4294967295],0);function zv(n){const e=QT().encode(n),t=new EF;return t.update(e),new Uint8Array(t.digest())}function Kv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ns([t,r],0),new Ns([i,s],0)]}class hg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ra(`Invalid padding: ${t}`);if(r<0)throw new ra(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ra(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ra(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=Ns.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(Ns.fromNumber(r)));return i.compare(P2)===1&&(i=new Ns([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const t=zv(e),[r,i]=Kv(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);if(!this.Ae(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new hg(s,i,t);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Te===0)return;const t=zv(e),[r,i]=Kv(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);this.Re(a)}}Re(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ra extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class gu{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,mu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new gu(K.min(),i,new Pe(ne),Wt(),re())}}class mu{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new mu(r,t,re(),re(),re())}}class Fc{constructor(e,t,r,i){this.Ve=e,this.removedTargetIds=t,this.key=r,this.me=i}}class YT{constructor(e,t){this.targetId=e,this.fe=t}}class JT{constructor(e,t,r=et.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Hv{constructor(){this.ge=0,this.pe=Qv(),this.ye=et.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=re(),t=re(),r=re();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:$()}}),new mu(this.ye,this.we,e,t,r)}Fe(){this.Se=!1,this.pe=Qv()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,z(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class C2{constructor(e){this.Le=e,this.ke=new Map,this.qe=Wt(),this.Qe=jv(),this.Ke=new Pe(ne)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(t);break;case 3:this.je(t)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.Ce(e.resumeToken));break;default:$()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){const t=e.targetId,r=e.fe.count,i=this.Ye(t);if(i){const s=i.target;if(rl(s))if(r===0){const a=new F(s.path);this.We(t,a,De.newNoDocument(a,K.min()))}else z(r===1);else{const a=this.Ze(t);if(a!==r){const l=this.Xe(e),h=l?this.et(l,e,a):1;if(h!==0){this.He(t);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,f)}}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,l;try{a=Wr(r).toUint8Array()}catch(h){if(h instanceof wT)return wn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{l=new hg(a,i,s)}catch(h){return wn(h instanceof ra?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return l.Te===0?null:l}et(e,t,r){return t.fe.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const a=this.Le.nt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.We(t,s,null),i++)}),i}it(e){const t=new Map;this.ke.forEach((s,a)=>{const l=this.Ye(a);if(l){if(s.current&&rl(l.target)){const h=new F(l.target.path);this.qe.get(h)!==null||this.st(a,h)||this.We(a,h,De.newNoDocument(h,e))}s.De&&(t.set(a,s.ve()),s.Fe())}});let r=re();this.Qe.forEach((s,a)=>{let l=!0;a.forEachWhile(h=>{const f=this.Ye(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(e));const i=new gu(e,t,this.Ke,this.qe,r);return this.qe=Wt(),this.Qe=jv(),this.Ke=new Pe(ne),i}Ue(e,t){if(!this.je(e))return;const r=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,r),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,t)?i.Me(t,1):i.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),r&&(this.qe=this.qe.insert(t,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new Hv,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new Re(ne),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=this.Ye(e)!==null;return t||N("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Hv),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function jv(){return new Pe(F.comparator)}function Qv(){return new Pe(F.comparator)}const k2=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),D2=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),x2=(()=>({and:"AND",or:"OR"}))();class N2{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $f(n,e){return n.useProto3Json||lu(e)?e:{value:e}}function zs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function XT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function V2(n,e){return zs(n,e.toTimestamp())}function Qe(n){return z(!!n),K.fromTimestamp(function(t){const r=$r(t);return new Oe(r.seconds,r.nanos)}(n))}function dg(n,e){return function(r){return new ge(["projects",r.projectId,"databases",r.database])}(n).child("documents").child(e).canonicalString()}function ZT(n){const e=ge.fromString(n);return z(uA(e)),e}function qa(n,e){return dg(n.databaseId,e.path)}function Un(n,e){const t=ZT(e);if(t.get(1)!==n.databaseId.projectId)throw new D(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new D(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(tA(t))}function Wf(n,e){return dg(n.databaseId,e)}function eA(n){const e=ZT(n);return e.length===4?ge.emptyPath():tA(e)}function $a(n){return new ge(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function tA(n){return z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Yv(n,e,t){return{name:qa(n,e),fields:t.value.mapValue.fields}}function nA(n,e,t){const r=Un(n,e.name),i=Qe(e.updateTime),s=e.createTime?Qe(e.createTime):K.min(),a=new gt({mapValue:{fields:e.fields}}),l=De.newFoundDocument(r,i,s,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function O2(n,e){return"found"in e?function(r,i){z(!!i.found),i.found.name,i.found.updateTime;const s=Un(r,i.found.name),a=Qe(i.found.updateTime),l=i.found.createTime?Qe(i.found.createTime):K.min(),h=new gt({mapValue:{fields:i.found.fields}});return De.newFoundDocument(s,a,l,h)}(n,e):"missing"in e?function(r,i){z(!!i.missing),z(!!i.readTime);const s=Un(r,i.missing),a=Qe(i.readTime);return De.newNoDocument(s,a)}(n,e):$()}function L2(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:$()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(f,p){return f.useProto3Json?(z(p===void 0||typeof p=="string"),et.fromBase64String(p||"")):(z(p===void 0||p instanceof Uint8Array),et.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(f){const p=f.code===void 0?b.UNKNOWN:jT(f.code);return new D(p,f.message||"")}(a);t=new JT(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Un(n,r.document.name),s=Qe(r.document.updateTime),a=r.document.createTime?Qe(r.document.createTime):K.min(),l=new gt({mapValue:{fields:r.document.fields}}),h=De.newFoundDocument(i,s,a,l),f=r.targetIds||[],p=r.removedTargetIds||[];t=new Fc(f,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Un(n,r.document),s=r.readTime?Qe(r.readTime):K.min(),a=De.newNoDocument(i,s),l=r.removedTargetIds||[];t=new Fc([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Un(n,r.document),s=r.removedTargetIds||[];t=new Fc([],s,i,null)}else{if(!("filter"in e))return $();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new b2(i,s),l=r.targetId;t=new YT(l,a)}}return t}function Wa(n,e){let t;if(e instanceof ao)t={update:Yv(n,e.key,e.value)};else if(e instanceof uo)t={delete:qa(n,e.key)};else if(e instanceof gr)t={update:Yv(n,e.key,e.data),updateMask:$2(e.fieldMask)};else{if(!(e instanceof ag))return $();t={verify:qa(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const l=a.transform;if(l instanceof Ws)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Mi)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Fi)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Gs)return{fieldPath:a.field.canonicalString(),increment:l.Ie};throw $()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:V2(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:$()}(n,e.precondition)),t}function Gf(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Ve.updateTime(Qe(s.updateTime)):s.exists!==void 0?Ve.exists(s.exists):Ve.none()}(e.currentDocument):Ve.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;if("setToServerValue"in l)z(l.setToServerValue==="REQUEST_TIME"),h=new Ws;else if("appendMissingElements"in l){const p=l.appendMissingElements.values||[];h=new Mi(p)}else if("removeAllFromArray"in l){const p=l.removeAllFromArray.values||[];h=new Fi(p)}else"increment"in l?h=new Gs(a,l.increment):$();const f=Ne.fromServerFormat(l.fieldPath);return new pu(f,h)}(n,i)):[];if(e.update){e.update.name;const i=Un(n,e.update.name),s=new gt({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(h){const f=h.fieldPaths||[];return new $t(f.map(p=>Ne.fromServerFormat(p)))}(e.updateMask);return new gr(i,s,a,t,r)}return new ao(i,s,t,r)}if(e.delete){const i=Un(n,e.delete);return new uo(i,t)}if(e.verify){const i=Un(n,e.verify);return new ag(i,t)}return $()}function M2(n,e){return n&&n.length>0?(z(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?Qe(i.updateTime):Qe(s);return a.isEqual(K.min())&&(a=Qe(s)),new A2(a,i.transformResults||[])}(t,e))):[]}function rA(n,e){return{documents:[Wf(n,e.path)]}}function iA(n,e){const t={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(t.parent=Wf(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Wf(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(h){if(h.length!==0)return aA(Te.create(h,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(h){if(h.length!==0)return h.map(f=>function(m){return{field:Ts(m.field),direction:U2(m.dir)}}(f))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=$f(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),t}function sA(n){let e=eA(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){z(r===1);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){const I=oA(m);return I instanceof Te&&ig(I)?I.getFilters():[I]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(I=>function(L){return new Ba(As(L.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(L.direction))}(I))}(t.orderBy));let l=null;t.limit&&(l=function(m){let I;return I=typeof m=="object"?m.value:m,lu(I)?null:I}(t.limit));let h=null;t.startAt&&(h=function(m){const I=!!m.before,A=m.values||[];return new Kr(A,I)}(t.startAt));let f=null;return t.endAt&&(f=function(m){const I=!m.before,A=m.values||[];return new Kr(A,I)}(t.endAt)),DT(e,i,a,s,l,"F",h,f)}function F2(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function oA(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=As(t.unaryFilter.field);return he.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=As(t.unaryFilter.field);return he.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=As(t.unaryFilter.field);return he.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=As(t.unaryFilter.field);return he.create(a,"!=",{nullValue:"NULL_VALUE"});default:return $()}}(n):n.fieldFilter!==void 0?function(t){return he.create(As(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Te.create(t.compositeFilter.filters.map(r=>oA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $()}}(t.compositeFilter.op))}(n):$()}function U2(n){return k2[n]}function B2(n){return D2[n]}function q2(n){return x2[n]}function Ts(n){return{fieldPath:n.canonicalString()}}function As(n){return Ne.fromServerFormat(n.fieldPath)}function aA(n){return n instanceof he?function(t){if(t.op==="=="){if(Nv(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NAN"}};if(xv(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Nv(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NOT_NAN"}};if(xv(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ts(t.field),op:B2(t.op),value:t.value}}}(n):n instanceof Te?function(t){const r=t.getFilters().map(i=>aA(i));return r.length===1?r[0]:{compositeFilter:{op:q2(t.op),filters:r}}}(n):$()}function $2(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function uA(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class sr{constructor(e,t,r,i,s=K.min(),a=K.min(),l=et.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(e){return new sr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class cA{constructor(e){this.ut=e}}function W2(n,e){let t;if(e.document)t=nA(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=F.fromSegments(e.noDocument.path),i=Bi(e.noDocument.readTime);t=De.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return $();{const r=F.fromSegments(e.unknownDocument.path),i=Bi(e.unknownDocument.version);t=De.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Oe(i[0],i[1]);return K.fromTimestamp(s)}(e.readTime)),t}function Jv(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ol(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,a){return{name:qa(s,a.key),fields:a.data.value.mapValue.fields,updateTime:zs(s,a.version.toTimestamp()),createTime:zs(s,a.createTime.toTimestamp())}}(n.ut,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ui(e.version)};else{if(!e.isUnknownDocument())return $();r.unknownDocument={path:t.path.toArray(),version:Ui(e.version)}}return r}function ol(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ui(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Bi(n){const e=new Oe(n.seconds,n.nanoseconds);return K.fromTimestamp(e)}function yi(n,e){const t=(e.baseMutations||[]).map(s=>Gf(n.ut,s));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];a.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Gf(n.ut,s)),i=Oe.fromMillis(e.localWriteTimeMs);return new ug(e.batchId,i,t,r)}function ia(n){const e=Bi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Bi(n.lastLimboFreeSnapshotVersion):K.min();let r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return z(s.documents.length===1),Nt(oo(eA(s.documents[0])))}(n.query):function(s){return Nt(sA(s))}(n.query),new sr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,et.fromBase64String(n.resumeToken))}function lA(n,e){const t=Ui(e.snapshotVersion),r=Ui(e.lastLimboFreeSnapshotVersion);let i;i=rl(e.target)?rA(n.ut,e.target):iA(n.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Li(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function fg(n){const e=sA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?sl(e,e.limit,"L"):e}function of(n,e){return new lg(e.largestBatchId,Gf(n.ut,e.overlayMutation))}function Xv(n,e){const t=e.path.lastSegment();return[n,xt(e.path.popLast()),t]}function Zv(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Ui(r.readTime),documentKey:xt(r.documentKey.path),largestBatchId:r.largestBatchId}}class G2{getBundleMetadata(e,t){return eI(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Bi(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return eI(e).put(function(i){return{bundleId:i.id,createTime:Ui(Qe(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return tI(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:fg(s.bundledQuery),readTime:Bi(s.readTime)}}(r)})}saveNamedQuery(e,t){return tI(e).put(function(i){return{name:i.name,readTime:Ui(Qe(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function eI(n){return at(n,"bundles")}function tI(n){return at(n,"namedQueries")}class Zl{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){const r=t.uid||"";return new Zl(e,r)}getOverlay(e,t){return $o(e).get(Xv(this.userId,t)).next(r=>r?of(this.serializer,r):null)}getOverlays(e,t){const r=Ln();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,a)=>{const l=new lg(t,a);i.push(this.lt(e,l))}),R.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(a=>i.add(xt(a.getCollectionPath())));const s=[];return i.forEach(a=>{const l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push($o(e).H("collectionPathOverlayIndex",l))}),R.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Ln(),s=xt(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return $o(e).W("collectionPathOverlayIndex",a).next(l=>{for(const h of l){const f=of(this.serializer,h);i.set(f.getKey(),f)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Ln();let a;const l=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return $o(e).Y({index:"collectionGroupOverlayIndex",range:l},(h,f,p)=>{const m=of(this.serializer,f);s.size()<i||m.largestBatchId===a?(s.set(m.getKey(),m),a=m.largestBatchId):p.done()}).next(()=>s)}lt(e,t){return $o(e).put(function(i,s,a){const[l,h,f]=Xv(s,a.mutation.key);return{userId:s,collectionPath:h,documentId:f,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Wa(i.ut,a.mutation)}}(this.serializer,this.userId,t))}}function $o(n){return at(n,"documentOverlays")}class vi{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(Be(e.integerValue));else if("doubleValue"in e){const r=Be(e.doubleValue);isNaN(r)?this.Tt(t,13):(this.Tt(t,15),La(r)?t.Et(0):t.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(t,20),typeof r=="string"?t.dt(r):(t.dt(`${r.seconds||""}`),t.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(Wr(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(t,45),t.Et(r.latitude||0),t.Et(r.longitude||0)}else"mapValue"in e?ET(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):$()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const r=e.fields||{};this.Tt(t,55);for(const i of Object.keys(r))this.At(i,t),this.Pt(r[i],t)}yt(e,t){const r=e.values||[];this.Tt(t,50);for(const i of r)this.Pt(i,t)}ft(e,t){this.Tt(t,37),F.fromName(e).path.forEach(r=>{this.Tt(t,60),this.wt(r,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}vi.St=new vi;function z2(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function nI(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const a=z2(255&r[s]);if(i+=a,a!==8)break}return i}(n);return Math.ceil(e/8)}class K2{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Dt(r.value),r=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=t.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const t=this.Bt(e),r=nI(t);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}kt(e){const t=this.Bt(e),r=nI(t);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Dt(e){const t=255&e;t===0?(this.Qt(0),this.Qt(255)):t===255?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;t===0?(this.$t(0),this.$t(255)):t===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class H2{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class j2{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class Wo{constructor(){this.Wt=new K2,this.Gt=new H2(this.Wt),this.zt=new j2(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class Ii{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ii(this.indexId,this.documentKey,this.arrayValue,r)}}function Pr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=rI(n.arrayValue,e.arrayValue),t!==0?t:(t=rI(n.directionalValue,e.directionalValue),t!==0?t:F.comparator(n.documentKey,e.documentKey)))}function rI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}class iI{constructor(e){this.Jt=new Re((t,r)=>Ne.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const r=t;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(z(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=Vf(e);if(t!==void 0&&!this.tn(t))return!1;const r=mi(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const l=this.Jt.getIterator().getNext();if(!i.has(l.field.canonicalString())){const h=r[s];if(!this.nn(l,h)||!this.rn(this.Yt[a++],h))return!1}++s}for(;s<r.length;++s){const l=r[s];if(a>=this.Yt.length||!this.rn(this.Yt[a++],l))return!1}return!0}sn(){if(this.Xt)return null;let e=new Re(Ne.comparator);const t=[];for(const r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Nc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Nc(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Nc(r.field,r.dir==="asc"?0:1)));return new nl(nl.UNKNOWN_ID,this.collectionId,t,Oa.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function hA(n){var e,t;if(z(n instanceof he||n instanceof Te),n instanceof he){if(n instanceof kT){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>he.create(n.field,"==",s)))||[];return Te.create(i,"or")}return n}const r=n.filters.map(i=>hA(i));return Te.create(r,n.op)}function Q2(n){if(n.getFilters().length===0)return[];const e=Hf(hA(n));return z(dA(e)),zf(e)||Kf(e)?[e]:e.getFilters()}function zf(n){return n instanceof he}function Kf(n){return n instanceof Te&&ig(n)}function dA(n){return zf(n)||Kf(n)||function(t){if(t instanceof Te&&Ff(t)){for(const r of t.getFilters())if(!zf(r)&&!Kf(r))return!1;return!0}return!1}(n)}function Hf(n){if(z(n instanceof he||n instanceof Te),n instanceof he)return n;if(n.filters.length===1)return Hf(n.filters[0]);const e=n.filters.map(r=>Hf(r));let t=Te.create(e,n.op);return t=al(t),dA(t)?t:(z(t instanceof Te),z($s(t)),z(t.filters.length>1),t.filters.reduce((r,i)=>pg(r,i)))}function pg(n,e){let t;return z(n instanceof he||n instanceof Te),z(e instanceof he||e instanceof Te),t=n instanceof he?e instanceof he?function(i,s){return Te.create([i,s],"and")}(n,e):sI(n,e):e instanceof he?sI(e,n):function(i,s){if(z(i.filters.length>0&&s.filters.length>0),$s(i)&&$s(s))return bT(i,s.getFilters());const a=Ff(i)?i:s,l=Ff(i)?s:i,h=a.filters.map(f=>pg(f,l));return Te.create(h,"or")}(n,e),al(t)}function sI(n,e){if($s(e))return bT(e,n.getFilters());{const t=e.filters.map(r=>pg(n,r));return Te.create(t,"or")}}function al(n){if(z(n instanceof he||n instanceof Te),n instanceof he)return n;const e=n.getFilters();if(e.length===1)return al(e[0]);if(RT(n))return n;const t=e.map(i=>al(i)),r=[];return t.forEach(i=>{i instanceof he?r.push(i):i instanceof Te&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Te.create(r,n.op)}class Y2{constructor(){this.on=new gg}addToCollectionParentIndex(e,t){return this.on.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(Zt.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(Zt.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}}class gg{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Re(ge.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Re(ge.comparator)).toArray()}}const Rc=new Uint8Array(0);class J2{constructor(e,t){this.user=e,this.databaseId=t,this._n=new gg,this.an=new ni(r=>Li(r),(r,i)=>hu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:r,parent:xt(i)};return oI(e).put(s)}return R.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[lT(t),""],!1,!0);return oI(e).W(i).next(s=>{for(const a of s){if(a.collectionId!==t)break;r.push(On(a.parent))}return r})}addFieldIndex(e,t){const r=Go(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=vs(e);return s.next(l=>{a.put(Zv(l,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=Go(e),i=vs(e),s=ys(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Go(e),r=ys(e),i=vs(e);return t.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,t){return R.forEach(this.un(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new iI(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=ys(e);let i=!0;const s=new Map;return R.forEach(this.un(t),a=>this.cn(e,a).next(l=>{i&&(i=!!l),s.set(a,l)})).next(()=>{if(i){let a=re();const l=[];return R.forEach(s,(h,f)=>{N("IndexedDbIndexManager",`Using index ${function(j){return`id=${j.indexId}|cg=${j.collectionGroup}|f=${j.fields.map(ye=>`${ye.fieldPath}:${ye.kind}`).join(",")}`}(h)} to execute ${Li(t)}`);const p=function(j,ye){const de=Vf(ye);if(de===void 0)return null;for(const me of il(j,de.fieldPath))switch(me.op){case"array-contains-any":return me.value.arrayValue.values||[];case"array-contains":return[me.value]}return null}(f,h),m=function(j,ye){const de=new Map;for(const me of mi(ye))for(const we of il(j,me.fieldPath))switch(we.op){case"==":case"in":de.set(me.fieldPath.canonicalString(),we.value);break;case"not-in":case"!=":return de.set(me.fieldPath.canonicalString(),we.value),Array.from(de.values())}return null}(f,h),I=function(j,ye){const de=[];let me=!0;for(const we of mi(ye)){const Vt=we.kind===0?Fv(j,we.fieldPath,j.startAt):Uv(j,we.fieldPath,j.startAt);de.push(Vt.value),me&&(me=Vt.inclusive)}return new Kr(de,me)}(f,h),A=function(j,ye){const de=[];let me=!0;for(const we of mi(ye)){const Vt=we.kind===0?Uv(j,we.fieldPath,j.endAt):Fv(j,we.fieldPath,j.endAt);de.push(Vt.value),me&&(me=Vt.inclusive)}return new Kr(de,me)}(f,h),L=this.ln(h,f,I),M=this.ln(h,f,A),V=this.hn(h,f,m),Y=this.Pn(h.indexId,p,L,I.inclusive,M,A.inclusive,V);return R.forEach(Y,ae=>r.j(ae,t.limit).next(j=>{j.forEach(ye=>{const de=F.fromSegments(ye.documentKey);a.has(de)||(a=a.add(de),l.push(de))})}))}).next(()=>l)}return R.resolve(null)})}un(e){let t=this.an.get(e);return t||(e.filters.length===0?t=[e]:t=Q2(Te.create(e.filters,"and")).map(r=>Bf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,r,i,s,a,l){const h=(t!=null?t.length:1)*Math.max(r.length,s.length),f=h/(t!=null?t.length:1),p=[];for(let m=0;m<h;++m){const I=t?this.In(t[m/f]):Rc,A=this.Tn(e,I,r[m%f],i),L=this.En(e,I,s[m%f],a),M=l.map(V=>this.Tn(e,I,V,!0));p.push(...this.createRange(A,L,M))}return p}Tn(e,t,r,i){const s=new Ii(e,F.empty(),t,r);return i?s:s.Ht()}En(e,t,r,i){const s=new Ii(e,F.empty(),t,r);return i?s.Ht():s}cn(e,t){const r=new iI(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const l of s)r.en(l)&&(!a||l.fields.length>a.fields.length)&&(a=l);return a})}getIndexType(e,t){let r=2;const i=this.un(t);return R.forEach(i,s=>this.cn(e,s).next(a=>{a?r!==0&&a.fields.length<function(h){let f=new Re(Ne.comparator),p=!1;for(const m of h.filters)for(const I of m.getFlattenedFilters())I.field.isKeyField()||(I.op==="array-contains"||I.op==="array-contains-any"?p=!0:f=f.add(I.field));for(const m of h.orderBy)m.field.isKeyField()||(f=f.add(m.field));return f.size+(p?1:0)}(s)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(t)&&i.length>1&&r===2?1:r)}dn(e,t){const r=new Wo;for(const i of mi(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.jt(i.kind);vi.St.ht(s,a)}return r.Ut()}In(e){const t=new Wo;return vi.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const r=new Wo;return vi.St.ht(Oi(this.databaseId,t),r.jt(function(s){const a=mi(s);return a.length===0?0:a[a.length-1].kind}(e))),r.Ut()}hn(e,t,r){if(r===null)return[];let i=[];i.push(new Wo);let s=0;for(const a of mi(e)){const l=r[s++];for(const h of i)if(this.Rn(t,a.fieldPath)&&Ua(l))i=this.Vn(i,a,l);else{const f=h.jt(a.kind);vi.St.ht(l,f)}}return this.mn(i)}ln(e,t,r){return this.hn(e,t,r.position)}mn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ut();return t}Vn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const l of i){const h=new Wo;h.seed(l.Ut()),vi.St.ht(a,h.jt(t.kind)),s.push(h)}return s}Rn(e,t){return!!e.filters.find(r=>r instanceof he&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Go(e),i=vs(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(s=>{const a=[];return R.forEach(s,l=>i.get([l.indexId,this.uid]).next(h=>{a.push(function(p,m){const I=m?new Oa(m.sequenceNumber,new Zt(Bi(m.readTime),new F(On(m.documentKey)),m.largestBatchId)):Oa.empty(),A=p.fields.map(([L,M])=>new Nc(Ne.fromServerFormat(L),M));return new nl(p.indexId,p.collectionGroup,A,I)}(l,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ne(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Go(e),s=vs(e);return this.fn(e).next(a=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(l=>R.forEach(l,h=>s.put(Zv(h.indexId,this.user,a,r)))))}updateIndexEntries(e,t){const r=new Map;return R.forEach(t,(i,s)=>{const a=r.get(i.collectionGroup);return(a?R.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(r.set(i.collectionGroup,l),R.forEach(l,h=>this.gn(e,i,h).next(f=>{const p=this.pn(s,h);return f.isEqual(p)?R.resolve():this.yn(e,s,h,f,p)}))))})}wn(e,t,r,i){return ys(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,r,i){return ys(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,t.key),t.key.path.toArray()])}gn(e,t,r){const i=ys(e);let s=new Re(Pr);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,t)])},(a,l)=>{s=s.add(new Ii(r.indexId,t,l.arrayValue,l.directionalValue))}).next(()=>s)}pn(e,t){let r=new Re(Pr);const i=this.dn(t,e);if(i==null)return r;const s=Vf(t);if(s!=null){const a=e.data.field(s.fieldPath);if(Ua(a))for(const l of a.arrayValue.values||[])r=r.add(new Ii(t.indexId,e.key,this.In(l),i))}else r=r.add(new Ii(t.indexId,e.key,Rc,i));return r}yn(e,t,r,i,s){N("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(h,f,p,m,I){const A=h.getIterator(),L=f.getIterator();let M=_s(A),V=_s(L);for(;M||V;){let Y=!1,ae=!1;if(M&&V){const j=p(M,V);j<0?ae=!0:j>0&&(Y=!0)}else M!=null?ae=!0:Y=!0;Y?(m(V),V=_s(L)):ae?(I(M),M=_s(A)):(M=_s(A),V=_s(L))}}(i,s,Pr,l=>{a.push(this.wn(e,t,r,l))},l=>{a.push(this.Sn(e,t,r,l))}),R.waitFor(a)}fn(e){let t=1;return vs(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((a,l)=>Pr(a,l)).filter((a,l,h)=>!l||Pr(a,h[l-1])!==0);const i=[];i.push(e);for(const a of r){const l=Pr(a,e),h=Pr(a,t);if(l===0)i[0]=e.Ht();else if(l>0&&h<0)i.push(a),i.push(a.Ht());else if(h>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.bn(i[a],i[a+1]))return[];const l=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Rc,[]],h=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Rc,[]];s.push(IDBKeyRange.bound(l,h))}return s}bn(e,t){return Pr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(aI)}getMinOffset(e,t){return R.mapArray(this.un(t),r=>this.cn(e,r).next(i=>i||$())).next(aI)}}function oI(n){return at(n,"collectionParents")}function ys(n){return at(n,"indexEntries")}function Go(n){return at(n,"indexConfiguration")}function vs(n){return at(n,"indexState")}function aI(n){z(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;tg(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Zt(e.readTime,e.documentKey,t)}const uI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Bt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Bt(e,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function fA(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let l=0;const h=r.Y({range:a},(p,m,I)=>(l++,I.delete()));s.push(h.next(()=>{z(l===1)}));const f=[];for(const p of t.mutations){const m=mT(e,p.key.path,t.batchId);s.push(i.delete(m)),f.push(p.key)}return R.waitFor(s).next(()=>f)}function ul(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw $();e=n.noDocument}return JSON.stringify(e).length}Bt.DEFAULT_COLLECTION_PERCENTILE=10,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bt.DEFAULT=new Bt(41943040,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bt.DISABLED=new Bt(-1,0,0);class eh{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,t,r,i){z(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new eh(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Cr(e).Y({index:"userMutationsIndex",range:r},(i,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Rs(e),a=Cr(e);return a.add({}).next(l=>{z(typeof l=="number");const h=new ug(l,t,r,i),f=function(A,L,M){const V=M.baseMutations.map(ae=>Wa(A.ut,ae)),Y=M.mutations.map(ae=>Wa(A.ut,ae));return{userId:L,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:V,mutations:Y}}(this.serializer,this.userId,h),p=[];let m=new Re((I,A)=>ne(I.canonicalString(),A.canonicalString()));for(const I of i){const A=mT(this.userId,I.key.path,l);m=m.add(I.key.path.popLast()),p.push(a.put(f)),p.push(s.put(A,UF))}return m.forEach(I=>{p.push(this.indexManager.addToCollectionParentIndex(e,I))}),e.addOnCommittedListener(()=>{this.Dn[l]=h.keys()}),R.waitFor(p).next(()=>h)})}lookupMutationBatch(e,t){return Cr(e).get(t).next(r=>r?(z(r.userId===this.userId),yi(this.serializer,r)):null)}Cn(e,t){return this.Dn[t]?R.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Dn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Cr(e).Y({index:"userMutationsIndex",range:i},(a,l,h)=>{l.userId===this.userId&&(z(l.batchId>=r),s=yi(this.serializer,l)),h.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Cr(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(i,s,a)=>{r=s.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Cr(e).W("userMutationsIndex",t).next(r=>r.map(i=>yi(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Vc(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Rs(e).Y({range:i},(a,l,h)=>{const[f,p,m]=a,I=On(p);if(f===this.userId&&t.path.isEqual(I))return Cr(e).get(m).next(A=>{if(!A)throw $();z(A.userId===this.userId),s.push(yi(this.serializer,A))});h.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(ne);const i=[];return t.forEach(s=>{const a=Vc(this.userId,s.path),l=IDBKeyRange.lowerBound(a),h=Rs(e).Y({range:l},(f,p,m)=>{const[I,A,L]=f,M=On(A);I===this.userId&&s.path.isEqual(M)?r=r.add(L):m.done()});i.push(h)}),R.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Vc(this.userId,r),a=IDBKeyRange.lowerBound(s);let l=new Re(ne);return Rs(e).Y({range:a},(h,f,p)=>{const[m,I,A]=h,L=On(I);m===this.userId&&r.isPrefixOf(L)?L.length===i&&(l=l.add(A)):p.done()}).next(()=>this.vn(e,l))}vn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(Cr(e).get(s).next(a=>{if(a===null)throw $();z(a.userId===this.userId),r.push(yi(this.serializer,a))}))}),R.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return fA(e.ae,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),R.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return R.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return Rs(e).Y({range:r},(s,a,l)=>{if(s[0]===this.userId){const h=On(s[1]);i.push(h)}else l.done()}).next(()=>{z(i.length===0)})})}containsKey(e,t){return pA(e,this.userId,t)}Mn(e){return gA(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function pA(n,e,t){const r=Vc(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Rs(n).Y({range:s,J:!0},(l,h,f)=>{const[p,m,I]=l;p===e&&m===i&&(a=!0),f.done()}).next(()=>a)}function Cr(n){return at(n,"mutations")}function Rs(n){return at(n,"documentMutations")}function gA(n){return at(n,"mutationQueues")}class qi{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new qi(0)}static Nn(){return new qi(-1)}}class X2{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const r=new qi(t.highestTargetId);return t.highestTargetId=r.next(),this.Ln(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>K.fromTimestamp(new Oe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Ln(e,i)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(t,r),this.Ln(e,r))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Is(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(z(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Is(e).Y((a,l)=>{const h=ia(l);h.sequenceNumber<=t&&r.get(h.targetId)===null&&(i++,s.push(this.removeTargetData(e,h)))}).next(()=>R.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Is(e).Y((r,i)=>{const s=ia(i);t(s)})}Bn(e){return cI(e).get("targetGlobalKey").next(t=>(z(t!==null),t))}Ln(e,t){return cI(e).put("targetGlobalKey",t)}kn(e,t){return Is(e).put(lA(this.serializer,t))}qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Li(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Is(e).Y({range:i,index:"queryTargetsIndex"},(a,l,h)=>{const f=ia(l);hu(t,f.target)&&(s=f,h.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=Dr(e);return t.forEach(a=>{const l=xt(a.path);i.push(s.put({targetId:r,path:l})),i.push(this.referenceDelegate.addReference(e,r,a))}),R.waitFor(i)}removeMatchingKeys(e,t,r){const i=Dr(e);return R.forEach(t,s=>{const a=xt(s.path);return R.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=Dr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Dr(e);let s=re();return i.Y({range:r,J:!0},(a,l,h)=>{const f=On(a[1]),p=new F(f);s=s.add(p)}).next(()=>s)}containsKey(e,t){const r=xt(t.path),i=IDBKeyRange.bound([r],[lT(r)],!1,!0);let s=0;return Dr(e).Y({index:"documentTargetsIndex",J:!0,range:i},([a,l],h,f)=>{a!==0&&(s++,f.done())}).next(()=>s>0)}_t(e,t){return Is(e).get(t).next(r=>r?ia(r):null)}}function Is(n){return at(n,"targets")}function cI(n){return at(n,"targetGlobal")}function Dr(n){return at(n,"targetDocuments")}function lI([n,e],[t,r]){const i=ne(n,t);return i===0?ne(e,r):i}class Z2{constructor(e){this.Qn=e,this.buffer=new Re(lI),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();lI(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class eU{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){N("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ti(t)?N("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await ei(t)}await this.Gn(3e5)})}}class tU{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(qt._e);const r=new Z2(t);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(N("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(uI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(N("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uI):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let r,i,s,a,l,h,f;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(N("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,a=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,t))).next(m=>(s=m,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(f=Date.now(),ws()<=ce.DEBUG&&N("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${s} targets in `+(h-l)+`ms
	Removed ${m} documents in `+(f-h)+`ms
Total Duration: ${f-p}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function nU(n,e){return new tU(n,e)}class rU{constructor(e,t){this.db=e,this.garbageCollector=nU(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Yn(e){let t=0;return this.Hn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(r,i)=>t(i))}addReference(e,t,r){return Sc(e,r)}removeReference(e,t,r){return Sc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Sc(e,t)}Xn(e,t){return function(i,s){let a=!1;return gA(i).Z(l=>pA(i,l,s).next(h=>(h&&(a=!0),R.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(a,l)=>{if(l<=t){const h=this.Xn(e,a).next(f=>{if(!f)return s++,r.getEntry(e,a).next(()=>(r.removeEntry(a,K.min()),Dr(e).delete(function(m){return[0,xt(m.path)]}(a))))});i.push(h)}}).next(()=>R.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Sc(e,t)}Zn(e,t){const r=Dr(e);let i,s=qt._e;return r.Y({index:"documentTargetsIndex"},([a,l],{path:h,sequenceNumber:f})=>{a===0?(s!==qt._e&&t(new F(On(i)),s),s=f,i=h):s=qt._e}).next(()=>{s!==qt._e&&t(new F(On(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Sc(n,e){return Dr(n).put(function(r,i){return{targetId:0,path:xt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}class mA{constructor(){this.changes=new ni(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,De.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class iU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return pi(e).put(r)}removeEntry(e,t,r){return pi(e).delete(function(s,a){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],ol(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.er(e,r)))}getEntry(e,t){let r=De.newInvalidDocument(t);return pi(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(zo(t))},(i,s)=>{r=this.tr(t,s)}).next(()=>r)}nr(e,t){let r={size:0,document:De.newInvalidDocument(t)};return pi(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(zo(t))},(i,s)=>{r={document:this.tr(t,s),size:ul(s)}}).next(()=>r)}getEntries(e,t){let r=Wt();return this.rr(e,t,(i,s)=>{const a=this.tr(i,s);r=r.insert(i,a)}).next(()=>r)}ir(e,t){let r=Wt(),i=new Pe(F.comparator);return this.rr(e,t,(s,a)=>{const l=this.tr(s,a);r=r.insert(s,l),i=i.insert(s,ul(a))}).next(()=>({documents:r,sr:i}))}rr(e,t,r){if(t.isEmpty())return R.resolve();let i=new Re(fI);t.forEach(h=>i=i.add(h));const s=IDBKeyRange.bound(zo(i.first()),zo(i.last())),a=i.getIterator();let l=a.getNext();return pi(e).Y({index:"documentKeyIndex",range:s},(h,f,p)=>{const m=F.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;l&&fI(l,m)<0;)r(l,null),l=a.getNext();l&&l.isEqual(m)&&(r(l,f),l=a.hasNext()?a.getNext():null),l?p.U(zo(l)):p.done()}).next(()=>{for(;l;)r(l,null),l=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,l=[a.popLast().toArray(),a.lastSegment(),ol(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return pi(e).W(IDBKeyRange.bound(l,h,!0)).next(f=>{s==null||s.incrementDocumentReadCount(f.length);let p=Wt();for(const m of f){const I=this.tr(F.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);I.isFoundDocument()&&(fu(t,I)||i.has(I.key))&&(p=p.insert(I.key,I))}return p})}getAllFromCollectionGroup(e,t,r,i){let s=Wt();const a=dI(t,r),l=dI(t,Zt.max());return pi(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,l,!0)},(h,f,p)=>{const m=this.tr(F.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(m.key,m),s.size===i&&p.done()}).next(()=>s)}newChangeBuffer(e){return new sU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return hI(e).get("remoteDocumentGlobalKey").next(t=>(z(!!t),t))}er(e,t){return hI(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const r=W2(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(K.min())))return r}return De.newInvalidDocument(e)}}function _A(n){return new iU(n)}class sU extends mA{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new ni(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Re((s,a)=>ne(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const l=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,l.readTime)),a.isValidDocument()){const h=Jv(this._r.serializer,a);i=i.add(s.path.popLast());const f=ul(h);r+=f-l.size,t.push(this._r.addEntry(e,s,h))}else if(r-=l.size,this.trackRemovals){const h=Jv(this._r.serializer,a.convertToNoDocument(K.min()));t.push(this._r.addEntry(e,s,h))}}),i.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,r)),R.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(r=>(this.ar.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:r,sr:i})=>(i.forEach((s,a)=>{this.ar.set(s,{size:a,readTime:r.get(s).readTime})}),r))}}function hI(n){return at(n,"remoteDocumentGlobal")}function pi(n){return at(n,"remoteDocumentsV14")}function zo(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function dI(n,e){const t=e.documentKey.path.toArray();return[n,ol(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function fI(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ne(t[s],r[s]),i)return i;return i=ne(t.length,r.length),i||(i=ne(t[t.length-2],r[r.length-2]),i||ne(t[t.length-1],r[r.length-1]))}class oU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class yA{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&fa(r.mutation,i,$t.empty(),Oe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,t,r=re()){const i=Ln();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=na();return s.forEach((l,h)=>{a=a.insert(l,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=Ln();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,re()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{t.set(a,l)})})}computeViews(e,t,r,i){let s=Wt();const a=da(),l=function(){return da()}();return t.forEach((h,f)=>{const p=r.get(f.key);i.has(f.key)&&(p===void 0||p.mutation instanceof gr)?s=s.insert(f.key,f):p!==void 0?(a.set(f.key,p.mutation.getFieldMask()),fa(p.mutation,f,p.mutation.getFieldMask(),Oe.now())):a.set(f.key,$t.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((f,p)=>a.set(f,p)),t.forEach((f,p)=>{var m;return l.set(f,new oU(p,(m=a.get(f))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,t){const r=da();let i=new Pe((a,l)=>a-l),s=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const l of a)l.keys().forEach(h=>{const f=t.get(h);if(f===null)return;let p=r.get(h)||$t.empty();p=l.applyToLocalView(f,p),r.set(h,p);const m=(i.get(l.batchId)||re()).add(h);i=i.insert(l.batchId,m)})}).next(()=>{const a=[],l=i.getReverseIterator();for(;l.hasNext();){const h=l.getNext(),f=h.key,p=h.value,m=MT();p.forEach(I=>{if(!s.has(I)){const A=zT(t.get(I),r.get(I));A!==null&&m.set(I,A),s=s.add(I)}}),a.push(this.documentOverlayCache.saveOverlays(e,f,m))}return R.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):sg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):R.resolve(Ln());let l=-1,h=s;return a.next(f=>R.forEach(f,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(p)?R.resolve():this.remoteDocumentCache.getEntry(e,p).next(I=>{h=h.insert(p,I)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,h,f,re())).next(p=>({batchId:l,changes:LT(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=na();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=na();return this.indexManager.getCollectionParents(e,s).next(l=>R.forEach(l,h=>{const f=function(m,I){return new pr(I,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next(p=>{p.forEach((m,I)=>{a=a.insert(m,I)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((h,f)=>{const p=f.getKey();a.get(p)===null&&(a=a.insert(p,De.newInvalidDocument(p)))});let l=na();return a.forEach((h,f)=>{const p=s.get(h);p!==void 0&&fa(p.mutation,f,$t.empty(),Oe.now()),fu(t,f)&&(l=l.insert(h,f))}),l})}}class aU{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return R.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Qe(i.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,function(i){return{name:i.name,query:fg(i.bundledQuery),readTime:Qe(i.readTime)}}(t)),R.resolve()}}class uU{constructor(){this.overlays=new Pe(F.comparator),this.lr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ln();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.lt(e,t,s)}),R.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){const i=Ln(),s=t.length+1,a=new F(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const h=l.getNext().value,f=h.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Pe((f,p)=>f-p);const a=this.overlays.getIterator();for(;a.hasNext();){const f=a.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let p=s.get(f.largestBatchId);p===null&&(p=Ln(),s=s.insert(f.largestBatchId,p)),p.set(f.getKey(),f)}}const l=Ln(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((f,p)=>l.set(f,p)),!(l.size()>=i)););return R.resolve(l)}lt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new lg(t,r));let s=this.lr.get(t);s===void 0&&(s=re(),this.lr.set(t,s)),this.lr.set(t,s.add(r.key))}}class mg{constructor(){this.hr=new Re(nt.Pr),this.Ir=new Re(nt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const r=new nt(e,t);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.dr(new nt(e,t))}Ar(e,t){e.forEach(r=>this.removeReference(r,t))}Rr(e){const t=new F(new ge([])),r=new nt(t,e),i=new nt(t,e+1),s=[];return this.Ir.forEachInRange([r,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new F(new ge([])),r=new nt(t,e),i=new nt(t,e+1);let s=re();return this.Ir.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new nt(e,0),r=this.hr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class nt{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return F.comparator(e.key,t.key)||ne(e.gr,t.gr)}static Tr(e,t){return ne(e.gr,t.gr)||F.comparator(e.key,t.key)}}class cU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new Re(nt.Pr)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ug(s,t,r,i);this.mutationQueue.push(a);for(const l of i)this.yr=this.yr.add(new nt(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Sr(r),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new nt(t,0),i=new nt(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],a=>{const l=this.wr(a.gr);s.push(l)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(ne);return t.forEach(i=>{const s=new nt(i,0),a=new nt(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],l=>{r=r.add(l.gr)})}),R.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;F.isDocumentKey(s)||(s=s.child(""));const a=new nt(new F(s),0);let l=new Re(ne);return this.yr.forEachWhile(h=>{const f=h.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(l=l.add(h.gr)),!0)},a),R.resolve(this.br(l))}br(e){const t=[];return e.forEach(r=>{const i=this.wr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){z(this.Dr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return R.forEach(t.mutations,i=>{const s=new nt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,t){const r=new nt(t,0),i=this.yr.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class lU{constructor(e){this.Cr=e,this.docs=function(){return new Pe(F.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Cr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():De.newInvalidDocument(t))}getEntries(e,t){let r=Wt();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():De.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Wt();const a=t.path,l=new F(a.child("")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){const{key:f,value:{document:p}}=h.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||tg(dT(p),r)<=0||(i.has(p.key)||fu(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,t,r,i){$()}vr(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new hU(this)}getSize(e){return R.resolve(this.size)}}class hU extends mA{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class dU{constructor(e){this.persistence=e,this.Fr=new ni(t=>Li(t),hu),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Mr=0,this.Or=new mg,this.targetCount=0,this.Nr=qi.On()}forEachTarget(e,t){return this.Fr.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Mr&&(this.Mr=t),R.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new qi(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.kn(t),R.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Fr.forEach((a,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){const r=this.Fr.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.Or.Er(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.Or.Ar(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),R.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Or.mr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.Or.containsKey(t))}}class vA{constructor(e,t){this.Br={},this.overlays={},this.Lr=new qt(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new dU(this),this.indexManager=new Y2,this.remoteDocumentCache=function(i){return new lU(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new cA(t),this.Kr=new aU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new uU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new cU(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,r){N("MemoryPersistence","Starting transaction:",e);const i=new fU(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,t){return R.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class fU extends pT{constructor(e){super(),this.currentSequenceNumber=e}}class th{constructor(e){this.persistence=e,this.Gr=new mg,this.zr=null}static jr(e){return new th(e)}get Hr(){if(this.zr)return this.zr;throw $()}addReference(e,t,r){return this.Gr.addReference(r,t),this.Hr.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Gr.removeReference(r,t),this.Hr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Hr,r=>{const i=F.fromPath(r);return this.Jr(e,i).next(s=>{s||t.removeEntry(i,K.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(r=>{r?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return R.or([()=>R.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class pU{constructor(e){this.serializer=e}N(e,t,r,i){const s=new Ql("createOrUpgrade",t);r<1&&i>=1&&(function(h){h.createObjectStore("owner")}(e),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Pv,{unique:!0}),h.createObjectStore("documentMutations")}(e),pI(e),function(h){h.createObjectStore("remoteDocuments")}(e));let a=R.resolve();return r<3&&i>=3&&(r!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),pI(e)),a=a.next(()=>function(h){const f=h.store("targetGlobal"),p={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:K.min().toTimestamp(),targetCount:0};return f.put("targetGlobalKey",p)}(s))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(h,f){return f.store("mutations").W().next(p=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Pv,{unique:!0});const m=f.store("mutations"),I=p.map(A=>m.put(A));return R.waitFor(I)})}(e,s))),a=a.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.Zr(s))),r<6&&i>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(a=a.next(()=>this.ei(s))),r<8&&i>=8&&(a=a.next(()=>this.ti(e,s))),r<9&&i>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.ni(s))),r<11&&i>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(h){const f=h.createObjectStore("documentOverlays",{keyPath:JF});f.createIndex("collectionPathOverlayIndex",XF,{unique:!1}),f.createIndex("collectionGroupOverlayIndex",ZF,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(h){const f=h.createObjectStore("remoteDocumentsV14",{keyPath:BF});f.createIndex("documentKeyIndex",qF),f.createIndex("collectionGroupIndex",$F)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ii(e,s))),r<15&&i>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:HF}).createIndex("sequenceNumberIndex",jF,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:QF}).createIndex("documentKeyIndex",YF,{unique:!1})}(e))),a}Xr(e){let t=0;return e.store("remoteDocuments").Y((r,i)=>{t+=ul(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>R.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next(l=>R.forEach(l,h=>{z(h.userId===s.userId);const f=yi(this.serializer,h);return fA(e,s.userId,f).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((a,l)=>{const h=new ge(a),f=function(m){return[0,xt(m)]}(h);s.push(t.get(f).next(p=>p?R.resolve():(m=>t.put({targetId:0,path:xt(m),sequenceNumber:i.highestListenSequenceNumber}))(h)))}).next(()=>R.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:KF});const r=t.store("collectionParents"),i=new gg,s=a=>{if(i.add(a)){const l=a.lastSegment(),h=a.popLast();return r.put({collectionId:l,parent:xt(h)})}};return t.store("remoteDocuments").Y({J:!0},(a,l)=>{const h=new ge(a);return s(h.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([a,l,h],f)=>{const p=On(l);return s(p.popLast())}))}ni(e){const t=e.store("targets");return t.Y((r,i)=>{const s=ia(i),a=lA(this.serializer,s);return t.put(a)})}ri(e,t){const r=t.store("remoteDocuments"),i=[];return r.Y((s,a)=>{const l=t.store("remoteDocumentsV14"),h=function(m){return m.document?new F(ge.fromString(m.document.name).popFirst(5)):m.noDocument?F.fromSegments(m.noDocument.path):m.unknownDocument?F.fromSegments(m.unknownDocument.path):$()}(a).path.toArray(),f={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(l.put(f))}).next(()=>R.waitFor(i))}ii(e,t){const r=t.store("mutations"),i=_A(this.serializer),s=new vA(th.jr,this.serializer.ut);return r.W().next(a=>{const l=new Map;return a.forEach(h=>{var f;let p=(f=l.get(h.userId))!==null&&f!==void 0?f:re();yi(this.serializer,h).keys().forEach(m=>p=p.add(m)),l.set(h.userId,p)}),R.forEach(l,(h,f)=>{const p=new rt(f),m=Zl.ct(this.serializer,p),I=s.getIndexManager(p),A=eh.ct(p,this.serializer,I,s.referenceDelegate);return new yA(i,A,m,I).recalculateAndSaveOverlaysForDocumentKeys(new Of(t,qt._e),h).next()})})}}function pI(n){n.createObjectStore("targetDocuments",{keyPath:GF}).createIndex("documentTargetsIndex",zF,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",WF,{unique:!0}),n.createObjectStore("targetGlobal")}const af="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class _g{constructor(e,t,r,i,s,a,l,h,f,p,m=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.si=s,this.window=a,this.document=l,this.oi=f,this._i=p,this.ai=m,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=I=>Promise.resolve(),!_g.D())throw new D(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new rU(this,i),this.Ii=t+"main",this.serializer=new cA(h),this.Ti=new yn(this.Ii,this.ai,new pU(this.serializer)),this.qr=new X2(this.referenceDelegate,this.serializer),this.remoteDocumentCache=_A(this.serializer),this.Kr=new G2,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,p===!1&&je("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new D(b.FAILED_PRECONDITION,af);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new qt(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.di()}))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>bc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if(ti(e))return N("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return N("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return Ko(e).get("owner").next(t=>R.resolve(this.wi(t)))}Si(e){return bc(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=at(t,"clientMetadata");return r.W().next(i=>{const s=this.Ci(i,18e5),a=i.filter(l=>s.indexOf(l)===-1);return R.forEach(a,l=>r.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ei)for(const t of e)this.Ei.removeItem(this.vi(t.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?R.resolve(!0):Ko(e).get("owner").next(t=>{if(t!==null&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new D(b.FAILED_PRECONDITION,af);return!1}}return!(!this.networkEnabled||!this.inForeground)||bc(e).W().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||a&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&N("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new Of(e,qt._e);return this.pi(t).next(()=>this.Si(t))}),this.Ti.close(),this.Ni()}Ci(e,t){return e.filter(r=>this.Di(r.updateTimeMs,t)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>bc(e).W().next(t=>this.Ci(t,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return eh.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new J2(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Zl.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,r){N("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(h){return h===15?t2:h===14?vT:h===13?yT:h===12?e2:h===11?_T:void $()}(this.ai);let a;return this.Ti.runTransaction(e,i,s,l=>(a=new Of(l,this.Lr?this.Lr.next():qt._e),t==="readwrite-primary"?this.fi(a).next(h=>!!h||this.gi(a)).next(h=>{if(!h)throw je(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new D(b.FAILED_PRECONDITION,fT);return r(a)}).next(h=>this.yi(a).next(()=>h)):this.Li(a).next(()=>r(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Li(e){return Ko(e).get("owner").next(t=>{if(t!==null&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new D(b.FAILED_PRECONDITION,af)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ko(e).put("owner",t)}static D(){return yn.D()}pi(e){const t=Ko(e);return t.get("owner").next(r=>this.wi(r)?(N("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):R.resolve())}Di(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(je(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;FD()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const r=((t=this.Ei)===null||t===void 0?void 0:t.getItem(this.vi(e)))!==null;return N("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return je("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){je("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ko(n){return at(n,"owner")}function bc(n){return at(n,"clientMetadata")}function yg(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class vg{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ki=r,this.qi=i}static Qi(e,t){let r=re(),i=re();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new vg(e,t.fromCache,r,i)}}class gU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class IA{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.zi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new gU;return this.Hi(e,t,a).next(l=>{if(s.result=l,this.$i)return this.Ji(e,t,a,l.size)})}).next(()=>s.result)}Ji(e,t,r,i){return r.documentReadCount<this.Ui?(ws()<=ce.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",Es(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),R.resolve()):(ws()<=ce.DEBUG&&N("QueryEngine","Query:",Es(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(ws()<=ce.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",Es(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Nt(t))):R.resolve())}zi(e,t){if(Bv(t))return R.resolve(null);let r=Nt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=sl(t,null,"F"),r=Nt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=re(...s);return this.Gi.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(h=>{const f=this.Yi(t,l);return this.Zi(t,f,a,h.readTime)?this.zi(e,sl(t,null,"F")):this.Xi(e,f,t,h)}))})))}ji(e,t,r,i){return Bv(t)||i.isEqual(K.min())?R.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const a=this.Yi(t,s);return this.Zi(t,a,r,i)?R.resolve(null):(ws()<=ce.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Es(t)),this.Xi(e,a,t,hT(i,-1)).next(l=>l))})}Yi(e,t){let r=new Re(VT(e));return t.forEach((i,s)=>{fu(e,s)&&(r=r.add(s))}),r}Zi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,t,r){return ws()<=ce.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",Es(t)),this.Gi.getDocumentsMatchingQuery(e,t,Zt.min(),r)}Xi(e,t,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}class mU{constructor(e,t,r,i){this.persistence=e,this.es=t,this.serializer=i,this.ts=new Pe(ne),this.ns=new ni(s=>Li(s),hu),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new yA(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function wA(n,e,t,r){return new mU(n,e,t,r)}async function EA(n,e){const t=B(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.os(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],l=[];let h=re();for(const f of i){a.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}for(const f of s){l.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(f=>({_s:f,removedBatchIds:a,addedBatchIds:l}))})})}function _U(n,e){const t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(l,h,f,p){const m=f.batch,I=m.keys();let A=R.resolve();return I.forEach(L=>{A=A.next(()=>p.getEntry(h,L)).next(M=>{const V=f.docVersions.get(L);z(V!==null),M.version.compareTo(V)<0&&(m.applyToRemoteDocument(M,f),M.isValidDocument()&&(M.setReadTime(f.commitVersion),p.addEntry(M)))})}),A.next(()=>l.mutationQueue.removeMutationBatch(h,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=re();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(h=h.add(l.batch.mutations[f].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function TA(n){const e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function yU(n,e){const t=B(n),r=e.snapshotVersion;let i=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.ss.newChangeBuffer({trackRemovals:!0});i=t.ts;const l=[];e.targetChanges.forEach((p,m)=>{const I=i.get(m);if(!I)return;l.push(t.qr.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.qr.addMatchingKeys(s,p.addedDocuments,m)));let A=I.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?A=A.withResumeToken(et.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):p.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(p.resumeToken,r)),i=i.insert(m,A),function(M,V,Y){return M.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0}(I,A,p)&&l.push(t.qr.updateTargetData(s,A))});let h=Wt(),f=re();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(AA(s,a,e.documentUpdates).next(p=>{h=p.us,f=p.cs})),!r.isEqual(K.min())){const p=t.qr.getLastRemoteSnapshotVersion(s).next(m=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(p)}return R.waitFor(l).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,h,f)).next(()=>h)}).then(s=>(t.ts=i,s))}function AA(n,e,t){let r=re(),i=re();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Wt();return t.forEach((l,h)=>{const f=s.get(l);h.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(l)),h.isNoDocument()&&h.version.isEqual(K.min())?(e.removeEntry(l,h.readTime),a=a.insert(l,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(h),a=a.insert(l,h)):N("LocalStore","Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",h.version)}),{us:a,cs:i}})}function vU(n,e){const t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ks(n,e){const t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.qr.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):t.qr.allocateTargetId(r).next(a=>(i=new sr(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ts=t.ts.insert(r.targetId,r),t.ns.set(e,r.targetId)),r})}async function Hs(n,e,t){const r=B(n),i=r.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!ti(a))throw a;N("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}function cl(n,e,t){const r=B(n);let i=K.min(),s=re();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,f,p){const m=B(h),I=m.ns.get(p);return I!==void 0?R.resolve(m.ts.get(I)):m.qr.getTargetData(f,p)}(r,a,Nt(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(a,l.targetId).next(h=>{s=h})}).next(()=>r.es.getDocumentsMatchingQuery(a,e,t?i:K.min(),t?s:re())).next(l=>(bA(r,NT(e),l),{documents:l,ls:s})))}function RA(n,e){const t=B(n),r=B(t.qr),i=t.ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(a=>a?a.target:null))}function SA(n,e){const t=B(n),r=t.rs.get(e)||K.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ss.getAllFromCollectionGroup(i,e,hT(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(bA(t,e,i),i))}function bA(n,e,t){let r=n.rs.get(e)||K.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.rs.set(e,r)}async function IU(n,e,t,r){const i=B(n);let s=re(),a=Wt();for(const f of t){const p=e.hs(f.metadata.name);f.document&&(s=s.add(p));const m=e.Ps(f);m.setReadTime(e.Is(f.metadata.readTime)),a=a.insert(p,m)}const l=i.ss.newChangeBuffer({trackRemovals:!0}),h=await Ks(i,function(p){return Nt(oo(ge.fromString(`__bundle__/docs/${p}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",f=>AA(f,l,a).next(p=>(l.apply(f),p)).next(p=>i.qr.removeMatchingKeysForTargetId(f,h.targetId).next(()=>i.qr.addMatchingKeys(f,s,h.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(f,p.us,p.cs)).next(()=>p.us)))}async function wU(n,e,t=re()){const r=await Ks(n,Nt(fg(e.bundledQuery))),i=B(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const a=Qe(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return i.Kr.saveNamedQuery(s,e);const l=r.withResumeToken(et.EMPTY_BYTE_STRING,a);return i.ts=i.ts.insert(l.targetId,l),i.qr.updateTargetData(s,l).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,t,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}function gI(n,e){return`firestore_clients_${n}_${e}`}function mI(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function uf(n,e){return`firestore_targets_${n}_${e}`}class ll{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ts(e,t,r){const i=JSON.parse(r);let s,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new D(i.error.code,i.error.message))),a?new ll(e,t,i.state,s):(je("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pa{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ts(e,t){const r=JSON.parse(t);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new D(r.error.code,r.error.message))),s?new pa(e,r.state,i):(je("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class hl{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=og();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=gT(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return i?new hl(e,s):(je("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Ig{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Ig(t.clientId,t.onlineState):(je("SharedClientState",`Failed to parse online state: ${e}`),null)}}class jf{constructor(){this.activeTargetIds=og()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class cf{constructor(e,t,r,i,s){this.window=e,this.si=t,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Pe(ne),this.started=!1,this.ps=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=gI(this.persistenceKey,this.Rs),this.ws=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new jf),this.Ss=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.Cs=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.vs=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const r of e){if(r===this.Rs)continue;const i=this.getItem(gI(this.persistenceKey,r));if(i){const s=hl.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();const t=this.storage.getItem(this.Cs);if(t){const r=this.Ms(t);r&&this.xs(r)}for(const r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,r){this.Ns(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(uf(this.persistenceKey,e));if(r){const i=pa.Ts(e,r);i&&(t=i.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(uf(this.persistenceKey,e))}updateQueryState(e,t,r){this.ks(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return N("SharedClientState","READ",e,t),t}setItem(e,t){N("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){N("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const t=e;if(t.storageArea===this.storage){if(N("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ys)return void je("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Ss.test(t.key)){if(t.newValue==null){const r=this.Ks(t.key);return this.$s(r,null)}{const r=this.Us(t.key,t.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(t.key)){if(t.newValue!==null){const r=this.Ws(t.key,t.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){const r=this.zs(t.key,t.newValue);if(r)return this.js(r)}}else if(t.key===this.Cs){if(t.newValue!==null){const r=this.Ms(t.newValue);if(r)return this.xs(r)}}else if(t.key===this.ws){const r=function(s){let a=qt._e;if(s!=null)try{const l=JSON.parse(s);z(typeof l=="number"),a=l}catch(l){je("SharedClientState","Failed to read sequence number from WebStorage",l)}return a}(t.newValue);r!==qt._e&&this.sequenceNumberHandler(r)}else if(t.key===this.vs){const r=this.Hs(t.newValue);await Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(t)})}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,r){const i=new ll(this.currentUser,e,t,r),s=mI(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const t=mI(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){const t={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(t))}ks(e,t,r){const i=uf(this.persistenceKey,e),s=new pa(e,t,r);this.setItem(i,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const r=this.Ks(e);return hl.Ts(r,t)}Ws(e,t){const r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return ll.Ts(new rt(s),i,t)}zs(e,t){const r=this.Ds.exec(e),i=Number(r[1]);return pa.Ts(i,t)}Ms(e){return Ig.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);N("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const r=t?this.gs.insert(e,t):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),a=[],l=[];return s.forEach(h=>{i.has(h)||a.push(h)}),i.forEach(h=>{s.has(h)||l.push(h)}),this.syncEngine.Xs(a,l).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=og();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class PA{constructor(){this.eo=new jf,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,r){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new jf,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class EU{ro(e){}shutdown(){}}class _I{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){N("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){N("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Pc=null;function lf(){return Pc===null?Pc=function(){return 268435456+Math.round(2147483648*Math.random())}():Pc++,"0x"+Pc.toString(16)}const TU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class AU{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const wt="WebChannelConnection";class RU extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+t.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(t,r,i,s,a){const l=lf(),h=this.So(t,r);N("RestConnection",`Sending RPC '${t}' ${l}:`,h,i);const f={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(f,s,a),this.Do(t,h,f,i).then(p=>(N("RestConnection",`Received RPC '${t}' ${l}: `,p),p),p=>{throw wn("RestConnection",`RPC '${t}' ${l} failed with error: `,p,"url: ",h,"request:",i),p})}Co(t,r,i,s,a,l){return this.wo(t,r,i,s,a)}bo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+so}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}So(t,r){const i=TU[t];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,r,i){const s=lf();return new Promise((a,l)=>{const h=new wF;h.setWithCredentials(!0),h.listenOnce(vF.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case sf.NO_ERROR:const p=h.getResponseJson();N(wt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case sf.TIMEOUT:N(wt,`RPC '${e}' ${s} timed out`),l(new D(b.DEADLINE_EXCEEDED,"Request time out"));break;case sf.HTTP_ERROR:const m=h.getStatus();if(N(wt,`RPC '${e}' ${s} failed with status:`,m,"response text:",h.getResponseText()),m>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);const A=I==null?void 0:I.error;if(A&&A.status&&A.message){const L=function(V){const Y=V.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(Y)>=0?Y:b.UNKNOWN}(A.status);l(new D(L,A.message))}else l(new D(b.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new D(b.UNAVAILABLE,"Connection failed."));break;default:$()}}finally{N(wt,`RPC '${e}' ${s} completed.`)}});const f=JSON.stringify(i);N(wt,`RPC '${e}' ${s} sending request:`,i),h.send(t,"POST",f,r,15)})}vo(e,t,r){const i=lf(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=_F(),l=yF(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.bo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const p=s.join("");N(wt,`Creating RPC '${e}' stream ${i}: ${p}`,h);const m=a.createWebChannel(p,h);let I=!1,A=!1;const L=new AU({co:V=>{A?N(wt,`Not sending because RPC '${e}' stream ${i} is closed:`,V):(I||(N(wt,`Opening RPC '${e}' stream ${i} transport.`),m.open(),I=!0),N(wt,`RPC '${e}' stream ${i} sending:`,V),m.send(V))},lo:()=>m.close()}),M=(V,Y,ae)=>{V.listen(Y,j=>{try{ae(j)}catch(ye){setTimeout(()=>{throw ye},0)}})};return M(m,Tc.EventType.OPEN,()=>{A||N(wt,`RPC '${e}' stream ${i} transport opened.`)}),M(m,Tc.EventType.CLOSE,()=>{A||(A=!0,N(wt,`RPC '${e}' stream ${i} transport closed`),L.Ro())}),M(m,Tc.EventType.ERROR,V=>{A||(A=!0,wn(wt,`RPC '${e}' stream ${i} transport errored:`,V),L.Ro(new D(b.UNAVAILABLE,"The operation could not be completed")))}),M(m,Tc.EventType.MESSAGE,V=>{var Y;if(!A){const ae=V.data[0];z(!!ae);const j=ae,ye=j.error||((Y=j[0])===null||Y===void 0?void 0:Y.error);if(ye){N(wt,`RPC '${e}' stream ${i} received error:`,ye);const de=ye.status;let me=function(zn){const Xi=Ye[zn];if(Xi!==void 0)return jT(Xi)}(de),we=ye.message;me===void 0&&(me=b.INTERNAL,we="Unknown error status: "+de+" with message "+ye.message),A=!0,L.Ro(new D(me,we)),m.close()}else N(wt,`RPC '${e}' stream ${i} received:`,ae),L.Vo(ae)}}),M(l,IF.STAT_EVENT,V=>{V.stat===Av.PROXY?N(wt,`RPC '${e}' stream ${i} detected buffering proxy`):V.stat===Av.NOPROXY&&N(wt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{L.Ao()},0),L}}function CA(){return typeof window<"u"?window:null}function Uc(){return typeof document<"u"?document:null}function _u(n){return new N2(n,!0)}class wg{constructor(e,t,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=t,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,t-r);i>0&&N("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class kA{constructor(e,t,r,i,s,a,l,h){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new wg(e,t)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,t){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(je(t.toString()),je("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):t&&t.code===b.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(t)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===t&&this.s_(r,i)},r=>{e(()=>{const i=new D(b.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,t){const r=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return N("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(N("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class SU extends kA{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=L2(this.serializer,e),r=function(s){if(!("targetChange"in s))return K.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?K.min():a.readTime?Qe(a.readTime):K.min()}(e);return this.listener.a_(t,r)}u_(e){const t={};t.database=$a(this.serializer),t.addTarget=function(s,a){let l;const h=a.target;if(l=rl(h)?{documents:rA(s,h)}:{query:iA(s,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=XT(s,a.resumeToken);const f=$f(s,a.expectedCount);f!==null&&(l.expectedCount=f)}else if(a.snapshotVersion.compareTo(K.min())>0){l.readTime=zs(s,a.snapshotVersion.toTimestamp());const f=$f(s,a.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,e);const r=F2(this.serializer,e);r&&(t.labels=r),this.e_(t)}c_(e){const t={};t.database=$a(this.serializer),t.removeTarget=e,this.e_(t)}}class bU extends kA{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=M2(e.writeResults,e.commitTime),r=Qe(e.commitTime);return this.listener.I_(r,t)}return z(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=$a(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Wa(this.serializer,r))};this.e_(t)}}class PU extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new D(b.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,t,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new D(b.UNKNOWN,i.toString())})}Co(e,t,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,t,r,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new D(b.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class CU{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(je(t),this.f_=!1):N("OnlineStateTracker",t)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}class kU{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget(async()=>{ri(this)&&(N("RemoteStore","Restarting streams for network reachability change."),await async function(h){const f=B(h);f.C_.add(4),await co(f),f.M_.set("Unknown"),f.C_.delete(4),await yu(f)}(this))})}),this.M_=new CU(r,i)}}async function yu(n){if(ri(n))for(const e of n.v_)await e(!0)}async function co(n){for(const e of n.v_)await e(!1)}function nh(n,e){const t=B(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),Ag(t)?Tg(t):ho(t).Ho()&&Eg(t,e))}function Ga(n,e){const t=B(n),r=ho(t);t.D_.delete(e),r.Ho()&&DA(t,e),t.D_.size===0&&(r.Ho()?r.Zo():ri(t)&&t.M_.set("Unknown"))}function Eg(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ho(n).u_(e)}function DA(n,e){n.x_.Oe(e),ho(n).c_(e)}function Tg(n){n.x_=new C2({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),ho(n).start(),n.M_.g_()}function Ag(n){return ri(n)&&!ho(n).jo()&&n.D_.size>0}function ri(n){return B(n).C_.size===0}function xA(n){n.x_=void 0}async function DU(n){n.D_.forEach((e,t)=>{Eg(n,e)})}async function xU(n,e){xA(n),Ag(n)?(n.M_.w_(e),Tg(n)):n.M_.set("Unknown")}async function NU(n,e,t){if(n.M_.set("Online"),e instanceof JT&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const l of s.targetIds)i.D_.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.D_.delete(l),i.x_.removeTarget(l))}(n,e)}catch(r){N("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await dl(n,r)}else if(e instanceof Fc?n.x_.$e(e):e instanceof YT?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(K.min()))try{const r=await TA(n.localStore);t.compareTo(r)>=0&&await function(s,a){const l=s.x_.it(a);return l.targetChanges.forEach((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const p=s.D_.get(f);p&&s.D_.set(f,p.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach((h,f)=>{const p=s.D_.get(h);if(!p)return;s.D_.set(h,p.withResumeToken(et.EMPTY_BYTE_STRING,p.snapshotVersion)),DA(s,h);const m=new sr(p.target,h,f,p.sequenceNumber);Eg(s,m)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(r){N("RemoteStore","Failed to raise snapshot:",r),await dl(n,r)}}async function dl(n,e,t){if(!ti(e))throw e;n.C_.add(1),await co(n),n.M_.set("Offline"),t||(t=()=>TA(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{N("RemoteStore","Retrying IndexedDB access"),await t(),n.C_.delete(1),await yu(n)})}function NA(n,e){return e().catch(t=>dl(n,t,e))}async function lo(n){const e=B(n),t=Hr(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;VU(e);)try{const i=await vU(e.localStore,r);if(i===null){e.b_.length===0&&t.Zo();break}r=i.batchId,OU(e,i)}catch(i){await dl(e,i)}VA(e)&&OA(e)}function VU(n){return ri(n)&&n.b_.length<10}function OU(n,e){n.b_.push(e);const t=Hr(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function VA(n){return ri(n)&&!Hr(n).jo()&&n.b_.length>0}function OA(n){Hr(n).start()}async function LU(n){Hr(n).E_()}async function MU(n){const e=Hr(n);for(const t of n.b_)e.P_(t.mutations)}async function FU(n,e,t){const r=n.b_.shift(),i=cg.from(r,e,t);await NA(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await lo(n)}async function UU(n,e){e&&Hr(n).h_&&await async function(r,i){if(function(a){return HT(a)&&a!==b.ABORTED}(i.code)){const s=r.b_.shift();Hr(r).Yo(),await NA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await lo(r)}}(n,e),VA(n)&&OA(n)}async function yI(n,e){const t=B(n);t.asyncQueue.verifyOperationInProgress(),N("RemoteStore","RemoteStore received new credentials");const r=ri(t);t.C_.add(3),await co(t),r&&t.M_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),await yu(t)}async function Qf(n,e){const t=B(n);e?(t.C_.delete(2),await yu(t)):e||(t.C_.add(2),await co(t),t.M_.set("Unknown"))}function ho(n){return n.O_||(n.O_=function(t,r,i){const s=B(t);return s.A_(),new SU(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:DU.bind(null,n),Io:xU.bind(null,n),a_:NU.bind(null,n)}),n.v_.push(async e=>{e?(n.O_.Yo(),Ag(n)?Tg(n):n.M_.set("Unknown")):(await n.O_.stop(),xA(n))})),n.O_}function Hr(n){return n.N_||(n.N_=function(t,r,i){const s=B(t);return s.A_(),new bU(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:LU.bind(null,n),Io:UU.bind(null,n),T_:MU.bind(null,n),I_:FU.bind(null,n)}),n.v_.push(async e=>{e?(n.N_.Yo(),await lo(n)):(await n.N_.stop(),n.b_.length>0&&(N("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))})),n.N_}class Rg{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new it,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,l=new Rg(e,t,a,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fo(n,e){if(je("AsyncQueue",`${e}: ${n}`),ti(n))return new D(b.UNAVAILABLE,`${e}: ${n}`);throw n}class Os{constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=na(),this.sortedSet=new Pe(this.comparator)}static emptySet(e){return new Os(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Os)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Os;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class vI{constructor(){this.B_=new Pe(F.comparator)}track(e){const t=e.doc.key,r=this.B_.get(t);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(t,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(t):e.type===1&&r.type===2?this.B_=this.B_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):$():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,r)=>{e.push(r)}),e}}class js{constructor(e,t,r,i,s,a,l,h,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new js(e,t,Os.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&du(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class BU{constructor(){this.k_=void 0,this.listeners=[]}}class qU{constructor(){this.queries=new ni(e=>xT(e),du),this.onlineState="Unknown",this.q_=new Set}}async function Sg(n,e){const t=B(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new BU),i)try{s.k_=await t.onListen(r)}catch(a){const l=fo(a,`Initialization of query '${Es(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,s),s.listeners.push(e),e.Q_(t.onlineState),s.k_&&e.K_(s.k_)&&Pg(t)}async function bg(n,e){const t=B(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return t.queries.delete(r),t.onUnlisten(r)}function $U(n,e){const t=B(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const l of a.listeners)l.K_(i)&&(r=!0);a.k_=i}}r&&Pg(t)}function WU(n,e,t){const r=B(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function Pg(n){n.q_.forEach(e=>{e.next()})}class Cg{constructor(e,t,r){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new js(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){if(!e.fromCache)return!0;const r=t!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const t=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}H_(e){e=js.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class GU{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class II{constructor(e){this.serializer=e}hs(e){return Un(this.serializer,e)}Ps(e){return e.metadata.exists?nA(this.serializer,e.document,!1):De.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return Qe(e)}}class zU{constructor(e,t,r){this.X_=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=LA(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const r=ge.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,r=new II(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const a of i.metadata.queries){const l=(t.get(a)||re()).add(s);t.set(a,l)}}return t}async complete(){const e=await IU(this.localStore,new II(this.serializer),this.documents,this.X_.id),t=this.ta(this.documents);for(const r of this.queries)await wU(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,na:this.collectionGroups,ra:e}}}function LA(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class MA{constructor(e){this.key=e}}class FA{constructor(e){this.key=e}}class UA{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=re(),this.mutatedKeys=re(),this._a=VT(e),this.aa=new Os(this._a)}get ua(){return this.ia}ca(e,t){const r=t?t.la:new vI,i=t?t.aa:this.aa;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,l=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{const I=i.get(p),A=fu(this.query,m)?m:null,L=!!I&&this.mutatedKeys.has(I.key),M=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let V=!1;I&&A?I.data.isEqual(A.data)?L!==M&&(r.track({type:3,doc:A}),V=!0):this.ha(I,A)||(r.track({type:2,doc:A}),V=!0,(h&&this._a(A,h)>0||f&&this._a(A,f)<0)&&(l=!0)):!I&&A?(r.track({type:0,doc:A}),V=!0):I&&!A&&(r.track({type:1,doc:I}),V=!0,(h||f)&&(l=!0)),V&&(A?(a=a.add(A),s=M?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{aa:a,la:r,Zi:l,mutatedKeys:s}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const a=e.la.L_();a.sort((p,m)=>function(A,L){const M=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $()}};return M(A)-M(L)}(p.type,m.type)||this._a(p.doc,m.doc)),this.Pa(r),i=i!=null&&i;const l=t&&!i?this.Ia():[],h=this.oa.size===0&&this.current&&!i?1:0,f=h!==this.sa;return this.sa=h,a.length!==0||f?{snapshot:new js(this.query,e.aa,s,a,e.mutatedKeys,h===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:l}:{Ta:l}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new vI,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=re(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const t=[];return e.forEach(r=>{this.oa.has(r)||t.push(new FA(r))}),this.oa.forEach(r=>{e.has(r)||t.push(new MA(r))}),t}da(e){this.ia=e.ls,this.oa=re();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return js.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class KU{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class HU{constructor(e){this.key=e,this.Ra=!1}}class jU{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new ni(l=>xT(l),du),this.fa=new Map,this.ga=new Set,this.pa=new Pe(F.comparator),this.ya=new Map,this.wa=new mg,this.Sa={},this.ba=new Map,this.Da=qi.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function QU(n,e){const t=Vg(n);let r,i;const s=t.ma.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const a=await Ks(t.localStore,Nt(e)),l=t.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=await kg(t,e,r,l==="current",a.resumeToken),t.isPrimaryClient&&nh(t.remoteStore,a)}return i}async function kg(n,e,t,r,i){n.va=(m,I,A)=>async function(M,V,Y,ae){let j=V.view.ca(Y);j.Zi&&(j=await cl(M.localStore,V.query,!1).then(({documents:we})=>V.view.ca(we,j)));const ye=ae&&ae.targetChanges.get(V.targetId),de=ae&&ae.targetMismatches.get(V.targetId)!=null,me=V.view.applyChanges(j,M.isPrimaryClient,ye,de);return Yf(M,V.targetId,me.Ta),me.snapshot}(n,m,I,A);const s=await cl(n.localStore,e,!0),a=new UA(e,s.ls),l=a.ca(s.documents),h=mu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),f=a.applyChanges(l,n.isPrimaryClient,h);Yf(n,t,f.Ta);const p=new KU(e,t,a);return n.ma.set(e,p),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),f.snapshot}async function YU(n,e){const t=B(n),r=t.ma.get(e),i=t.fa.get(r.targetId);if(i.length>1)return t.fa.set(r.targetId,i.filter(s=>!du(s,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||await Hs(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Ga(t.remoteStore,r.targetId),Qs(t,r.targetId)}).catch(ei)):(Qs(t,r.targetId),await Hs(t.localStore,r.targetId,!0))}async function JU(n,e,t){const r=Og(n);try{const i=await function(a,l){const h=B(a),f=Oe.now(),p=l.reduce((A,L)=>A.add(L.key),re());let m,I;return h.persistence.runTransaction("Locally write mutations","readwrite",A=>{let L=Wt(),M=re();return h.ss.getEntries(A,p).next(V=>{L=V,L.forEach((Y,ae)=>{ae.isValidDocument()||(M=M.add(Y))})}).next(()=>h.localDocuments.getOverlayedDocuments(A,L)).next(V=>{m=V;const Y=[];for(const ae of l){const j=S2(ae,m.get(ae.key).overlayedDocument);j!=null&&Y.push(new gr(ae.key,j,TT(j.value.mapValue),Ve.exists(!0)))}return h.mutationQueue.addMutationBatch(A,f,Y,l)}).next(V=>{I=V;const Y=V.applyToLocalDocumentSet(m,M);return h.documentOverlayCache.saveOverlays(A,V.batchId,Y)})}).then(()=>({batchId:I.batchId,changes:LT(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let f=a.Sa[a.currentUser.toKey()];f||(f=new Pe(ne)),f=f.insert(l,h),a.Sa[a.currentUser.toKey()]=f}(r,i.batchId,t),await mr(r,i.changes),await lo(r.remoteStore)}catch(i){const s=fo(i,"Failed to persist write");t.reject(s)}}async function BA(n,e){const t=B(n);try{const r=await yU(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.ya.get(s);a&&(z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?z(a.Ra):i.removedDocuments.size>0&&(z(a.Ra),a.Ra=!1))}),await mr(t,r,e)}catch(r){await ei(r)}}function wI(n,e,t){const r=B(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.ma.forEach((s,a)=>{const l=a.view.Q_(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){const h=B(a);h.onlineState=l;let f=!1;h.queries.forEach((p,m)=>{for(const I of m.listeners)I.Q_(l)&&(f=!0)}),f&&Pg(h)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function XU(n,e,t){const r=B(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ya.get(e),s=i&&i.key;if(s){let a=new Pe(F.comparator);a=a.insert(s,De.newNoDocument(s,K.min()));const l=re().add(s),h=new gu(K.min(),new Map,new Pe(ne),a,l);await BA(r,h),r.pa=r.pa.remove(s),r.ya.delete(e),Ng(r)}else await Hs(r.localStore,e,!1).then(()=>Qs(r,e,t)).catch(ei)}async function ZU(n,e){const t=B(n),r=e.batch.batchId;try{const i=await _U(t.localStore,e);xg(t,r,null),Dg(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await mr(t,i)}catch(i){await ei(i)}}async function eB(n,e,t){const r=B(n);try{const i=await function(a,l){const h=B(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let p;return h.mutationQueue.lookupMutationBatch(f,l).next(m=>(z(m!==null),p=m.keys(),h.mutationQueue.removeMutationBatch(f,m))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,p,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,p)).next(()=>h.localDocuments.getDocuments(f,p))})}(r.localStore,e);xg(r,e,t),Dg(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await mr(r,i)}catch(i){await ei(i)}}async function tB(n,e){const t=B(n);ri(t.remoteStore)||N("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(a){const l=B(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(r===-1)return void e.resolve();const i=t.ba.get(r)||[];i.push(e),t.ba.set(r,i)}catch(r){const i=fo(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Dg(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function xg(n,e,t){const r=B(n);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Qs(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.fa.get(e))n.ma.delete(r),t&&n.Va.Fa(r,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(r=>{n.wa.containsKey(r)||qA(n,r)})}function qA(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);t!==null&&(Ga(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),Ng(n))}function Yf(n,e,t){for(const r of t)r instanceof MA?(n.wa.addReference(r.key,e),nB(n,r)):r instanceof FA?(N("SyncEngine","Document no longer in limbo: "+r.key),n.wa.removeReference(r.key,e),n.wa.containsKey(r.key)||qA(n,r.key)):$()}function nB(n,e){const t=e.key,r=t.path.canonicalString();n.pa.get(t)||n.ga.has(r)||(N("SyncEngine","New document in limbo: "+t),n.ga.add(r),Ng(n))}function Ng(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new F(ge.fromString(e)),r=n.Da.next();n.ya.set(r,new HU(t)),n.pa=n.pa.insert(t,r),nh(n.remoteStore,new sr(Nt(oo(t.path)),r,"TargetPurposeLimboResolution",qt._e))}}async function mr(n,e,t){const r=B(n),i=[],s=[],a=[];r.ma.isEmpty()||(r.ma.forEach((l,h)=>{a.push(r.va(h,e,t).then(f=>{if((f||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(h.targetId,f!=null&&f.fromCache?"not-current":"current"),f){i.push(f);const p=vg.Qi(h.targetId,f);s.push(p)}}))}),await Promise.all(a),r.Va.a_(i),await async function(h,f){const p=B(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>R.forEach(f,I=>R.forEach(I.ki,A=>p.persistence.referenceDelegate.addReference(m,I.targetId,A)).next(()=>R.forEach(I.qi,A=>p.persistence.referenceDelegate.removeReference(m,I.targetId,A)))))}catch(m){if(!ti(m))throw m;N("LocalStore","Failed to update sequence numbers: "+m)}for(const m of f){const I=m.targetId;if(!m.fromCache){const A=p.ts.get(I),L=A.snapshotVersion,M=A.withLastLimboFreeSnapshotVersion(L);p.ts=p.ts.insert(I,M)}}}(r.localStore,s))}async function rB(n,e){const t=B(n);if(!t.currentUser.isEqual(e)){N("SyncEngine","User change. New user:",e.toKey());const r=await EA(t.localStore,e);t.currentUser=e,function(s,a){s.ba.forEach(l=>{l.forEach(h=>{h.reject(new D(b.CANCELLED,a))})}),s.ba.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await mr(t,r._s)}}function iB(n,e){const t=B(n),r=t.ya.get(e);if(r&&r.Ra)return re().add(r.key);{let i=re();const s=t.fa.get(e);if(!s)return i;for(const a of s){const l=t.ma.get(a);i=i.unionWith(l.view.ua)}return i}}async function sB(n,e){const t=B(n),r=await cl(t.localStore,e.query,!0),i=e.view.da(r);return t.isPrimaryClient&&Yf(t,e.targetId,i.Ta),i}async function oB(n,e){const t=B(n);return SA(t.localStore,e).then(r=>mr(t,r))}async function aB(n,e,t,r){const i=B(n),s=await function(l,h){const f=B(l),p=B(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",m=>p.Cn(m,h).next(I=>I?f.localDocuments.getDocuments(m,I):R.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await lo(i.remoteStore):t==="acknowledged"||t==="rejected"?(xg(i,e,r||null),Dg(i,e),function(l,h){B(B(l).mutationQueue).Fn(h)}(i.localStore,e)):$(),await mr(i,s)):N("SyncEngine","Cannot apply mutation batch with id: "+e)}async function uB(n,e){const t=B(n);if(Vg(t),Og(t),e===!0&&t.Ca!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await EI(t,r.toArray());t.Ca=!0,await Qf(t.remoteStore,!0);for(const s of i)nh(t.remoteStore,s)}else if(e===!1&&t.Ca!==!1){const r=[];let i=Promise.resolve();t.fa.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(Qs(t,a),Hs(t.localStore,a,!0))),Ga(t.remoteStore,a)}),await i,await EI(t,r),function(a){const l=B(a);l.ya.forEach((h,f)=>{Ga(l.remoteStore,f)}),l.wa.Vr(),l.ya=new Map,l.pa=new Pe(F.comparator)}(t),t.Ca=!1,await Qf(t.remoteStore,!1)}}async function EI(n,e,t){const r=B(n),i=[],s=[];for(const a of e){let l;const h=r.fa.get(a);if(h&&h.length!==0){l=await Ks(r.localStore,Nt(h[0]));for(const f of h){const p=r.ma.get(f),m=await sB(r,p);m.snapshot&&s.push(m.snapshot)}}else{const f=await RA(r.localStore,a);l=await Ks(r.localStore,f),await kg(r,$A(f),a,!1,l.resumeToken)}i.push(l)}return r.Va.a_(s),i}function $A(n){return DT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function cB(n){return function(t){return B(B(t).persistence).Bi()}(B(n).localStore)}async function lB(n,e,t,r){const i=B(n);if(i.Ca)return void N("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=await SA(i.localStore,NT(s[0])),l=gu.createSynthesizedRemoteEventForCurrentChange(e,t==="current",et.EMPTY_BYTE_STRING);await mr(i,a,l);break}case"rejected":await Hs(i.localStore,e,!0),Qs(i,e,r);break;default:$()}}async function hB(n,e,t){const r=Vg(n);if(r.Ca){for(const i of e){if(r.fa.has(i)){N("SyncEngine","Adding an already active target "+i);continue}const s=await RA(r.localStore,i),a=await Ks(r.localStore,s);await kg(r,$A(s),a.targetId,!1,a.resumeToken),nh(r.remoteStore,a)}for(const i of t)r.fa.has(i)&&await Hs(r.localStore,i,!1).then(()=>{Ga(r.remoteStore,i),Qs(r,i)}).catch(ei)}}function Vg(n){const e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=BA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=XU.bind(null,e),e.Va.a_=$U.bind(null,e.eventManager),e.Va.Fa=WU.bind(null,e.eventManager),e}function Og(n){const e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ZU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eB.bind(null,e),e}function dB(n,e,t){const r=B(n);(async function(s,a,l){try{const h=await a.getMetadata();if(await function(A,L){const M=B(A),V=Qe(L.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",Y=>M.Kr.getBundleMetadata(Y,L.id)).then(Y=>!!Y&&Y.createTime.compareTo(V)>=0)}(s.localStore,h))return await a.close(),l._completeWith(function(A){return{taskState:"Success",documentsLoaded:A.totalDocuments,bytesLoaded:A.totalBytes,totalDocuments:A.totalDocuments,totalBytes:A.totalBytes}}(h)),Promise.resolve(new Set);l._updateProgress(LA(h));const f=new zU(h,s.localStore,a.serializer);let p=await a.Ma();for(;p;){const I=await f.ea(p);I&&l._updateProgress(I),p=await a.Ma()}const m=await f.complete();return await mr(s,m.ra,void 0),await function(A,L){const M=B(A);return M.persistence.runTransaction("Save bundle","readwrite",V=>M.Kr.saveBundleMetadata(V,L))}(s.localStore,h),l._completeWith(m.progress),Promise.resolve(m.na)}catch(h){return wn("SyncEngine",`Loading bundle failed with ${h}`),l._failWith(h),Promise.resolve(new Set)}})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class Jf{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=_u(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return wA(this.persistence,new IA,e.initialUser,this.serializer)}createPersistence(e){return new vA(th.jr,this.serializer)}createSharedClientState(e){return new PA}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class WA extends Jf{constructor(e,t,r){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xa.initialize(this,e),await Og(this.xa.syncEngine),await lo(this.xa.remoteStore),await this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return wA(this.persistence,new IA,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new eU(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new MF(t,this.persistence);return new LF(e.asyncQueue,r)}createPersistence(e){const t=yg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Bt.withCacheSize(this.cacheSizeBytes):Bt.DEFAULT;return new _g(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,CA(),Uc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new PA}}class fB extends WA{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xa.syncEngine;this.sharedClientState instanceof cf&&(this.sharedClientState.syncEngine={Ys:aB.bind(null,t),Zs:lB.bind(null,t),Xs:hB.bind(null,t),Bi:cB.bind(null,t),Js:oB.bind(null,t)},await this.sharedClientState.start()),await this.persistence.mi(async r=>{await uB(this.xa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const t=CA();if(!cf.D(t))throw new D(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=yg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new cf(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Lg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>wI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=rB.bind(null,this.syncEngine),await Qf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new qU}()}createDatastore(e){const t=_u(e.databaseInfo.databaseId),r=function(s){return new RU(s)}(e.databaseInfo);return function(s,a,l,h){return new PU(s,a,l,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,a,l){return new kU(r,i,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,t=>wI(this.syncEngine,t,0),function(){return _I.D()?new _I:new EU}())}createSyncEngine(e,t){return function(i,s,a,l,h,f,p){const m=new jU(i,s,a,l,h,f);return p&&(m.Ca=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(t){const r=B(t);N("RemoteStore","RemoteStore shutting down."),r.C_.add(5),await co(r),r.F_.shutdown(),r.M_.set("Unknown")}(this.remoteStore)}}function TI(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class rh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):je("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class pB{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new it,this.buffer=new Uint8Array,this.La=function(){return new TextDecoder("utf-8")}(),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}async getMetadata(){return this.metadata.promise}async Ma(){return await this.getMetadata(),this.ka()}async ka(){const e=await this.qa();if(e===null)return null;const t=this.La.decode(e),r=Number(t);isNaN(r)&&this.Qa(`length string (${t}) is not valid number`);const i=await this.Ka(r);return new GU(JSON.parse(i),e.length+r)}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async qa(){for(;this.$a()<0&&!await this.Ua(););if(this.buffer.length===0)return null;const e=this.$a();e<0&&this.Qa("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Ka(e){for(;this.buffer.length<e;)await this.Ua()&&this.Qa("Reached the end of bundle when more is expected.");const t=this.La.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ua(){const e=await this.Ba.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class gB{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new D(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(i,s){const a=B(i),l=$a(a.serializer)+"/documents",h={documents:s.map(I=>qa(a.serializer,I))},f=await a.Co("BatchGetDocuments",l,h,s.length),p=new Map;f.forEach(I=>{const A=O2(a.serializer,I);p.set(A.key.toString(),A)});const m=[];return s.forEach(I=>{const A=p.get(I.toString());z(!!A),m.push(A)}),m}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new uo(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=F.fromPath(r);this.mutations.push(new ag(i,this.precondition(i)))}),await async function(r,i){const s=B(r),a=$a(s.serializer)+"/documents",l={writes:i.map(h=>Wa(s.serializer,h))};await s.wo("Commit",a,l)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw $();t=K.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new D(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(K.min())?Ve.exists(!1):Ve.updateTime(t):Ve.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(K.min()))throw new D(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ve.updateTime(t)}return Ve.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class mB{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new wg(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko(async()=>{const e=new gB(this.datastore),t=this.za(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ja(i)}))}).catch(r=>{this.ja(r)})})}za(e){try{const t=this.updateFunction(e);return!lu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!HT(t)}return!1}}class _B{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=rt.UNAUTHENTICATED,this.clientId=cT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{N("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(N("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new D(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new it;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=fo(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Bc(n,e){n.asyncQueue.verifyOperationInProgress(),N("FirestoreClient","Initializing OfflineComponentProvider");const t=await n.getConfiguration();await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await EA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Xf(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Mg(n);N("FirestoreClient","Initializing OnlineComponentProvider");const r=await n.getConfiguration();await e.initialize(t,r),n.setCredentialChangeListener(i=>yI(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>yI(e.remoteStore,s)),n._onlineComponents=e}function GA(n){return n.name==="FirebaseError"?n.code===b.FAILED_PRECONDITION||n.code===b.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function Mg(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){N("FirestoreClient","Using user provided OfflineComponentProvider");try{await Bc(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!GA(t))throw t;wn("Error using user provided cache. Falling back to memory cache: "+t),await Bc(n,new Jf)}}else N("FirestoreClient","Using default OfflineComponentProvider"),await Bc(n,new Jf);return n._offlineComponents}async function ih(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(N("FirestoreClient","Using user provided OnlineComponentProvider"),await Xf(n,n._uninitializedComponentsProvider._online)):(N("FirestoreClient","Using default OnlineComponentProvider"),await Xf(n,new Lg))),n._onlineComponents}function zA(n){return Mg(n).then(e=>e.persistence)}function Fg(n){return Mg(n).then(e=>e.localStore)}function KA(n){return ih(n).then(e=>e.remoteStore)}function Ug(n){return ih(n).then(e=>e.syncEngine)}function yB(n){return ih(n).then(e=>e.datastore)}async function Ys(n){const e=await ih(n),t=e.eventManager;return t.onListen=QU.bind(null,e.syncEngine),t.onUnlisten=YU.bind(null,e.syncEngine),t}function vB(n){return n.asyncQueue.enqueue(async()=>{const e=await zA(n),t=await KA(n);return e.setNetworkEnabled(!0),function(i){const s=B(i);return s.C_.delete(0),yu(s)}(t)})}function IB(n){return n.asyncQueue.enqueue(async()=>{const e=await zA(n),t=await KA(n);return e.setNetworkEnabled(!1),async function(i){const s=B(i);s.C_.add(0),await co(s),s.M_.set("Offline")}(t)})}function wB(n,e){const t=new it;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await function(f,p){const m=B(f);return m.persistence.runTransaction("read document","readonly",I=>m.localDocuments.getDocument(I,p))}(i,s);l.isFoundDocument()?a.resolve(l):l.isNoDocument()?a.resolve(null):a.reject(new D(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const h=fo(l,`Failed to get document '${s} from cache`);a.reject(h)}}(await Fg(n),e,t)),t.promise}function HA(n,e,t={}){const r=new it;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const p=new rh({next:I=>{a.enqueueAndForget(()=>bg(s,m));const A=I.docs.has(l);!A&&I.fromCache?f.reject(new D(b.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&I.fromCache&&h&&h.source==="server"?f.reject(new D(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(I)},error:I=>f.reject(I)}),m=new Cg(oo(l.path),p,{includeMetadataChanges:!0,J_:!0});return Sg(s,m)}(await Ys(n),n.asyncQueue,e,t,r)),r.promise}function EB(n,e){const t=new it;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await cl(i,s,!0),h=new UA(s,l.ls),f=h.ca(l.documents),p=h.applyChanges(f,!1);a.resolve(p.snapshot)}catch(l){const h=fo(l,`Failed to execute query '${s} against cache`);a.reject(h)}}(await Fg(n),e,t)),t.promise}function jA(n,e,t={}){const r=new it;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const p=new rh({next:I=>{a.enqueueAndForget(()=>bg(s,m)),I.fromCache&&h.source==="server"?f.reject(new D(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(I)},error:I=>f.reject(I)}),m=new Cg(l,p,{includeMetadataChanges:!0,J_:!0});return Sg(s,m)}(await Ys(n),n.asyncQueue,e,t,r)),r.promise}function TB(n,e){const t=new rh(e);return n.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).q_.add(s),s.next()}(await Ys(n),t)),()=>{t.Na(),n.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).q_.delete(s)}(await Ys(n),t))}}function AB(n,e,t,r){const i=function(a,l){let h;return h=typeof a=="string"?QT().encode(a):a,function(p,m){return new pB(p,m)}(function(p,m){if(p instanceof Uint8Array)return TI(p,m);if(p instanceof ArrayBuffer)return TI(new Uint8Array(p),m);if(p instanceof ReadableStream)return p.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),l)}(t,_u(e));n.asyncQueue.enqueueAndForget(async()=>{dB(await Ug(n),i,r)})}function RB(n,e){return n.asyncQueue.enqueue(async()=>function(r,i){const s=B(r);return s.persistence.runTransaction("Get named query","readonly",a=>s.Kr.getNamedQuery(a,i))}(await Fg(n),e))}function QA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const AI=new Map;function Bg(n,e,t){if(!t)throw new D(b.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function YA(n,e,t,r){if(e===!0&&r===!0)throw new D(b.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function RI(n){if(!F.isDocumentKey(n))throw new D(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function SI(n){if(F.isDocumentKey(n))throw new D(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function sh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$()}function _e(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new D(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=sh(n);throw new D(b.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function JA(n,e){if(e<=0)throw new D(b.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class bI{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new D(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new D(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}YA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=QA((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new D(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new D(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new D(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vu{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bI({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new D(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new D(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bI(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new RF;switch(r.type){case"firstParty":return new CF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new D(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=AI.get(t);r&&(N("ComponentProvider","Removing Datastore"),AI.delete(t),r.terminate())}(this),Promise.resolve()}}function SB(n,e,t,r={}){var i;const s=(n=_e(n,vu))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&wn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let l,h;if(typeof r.mockUserToken=="string")l=r.mockUserToken,h=rt.MOCK_USER;else{l=OD(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new D(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new rt(f)}n._authCredentials=new SF(new uT(l,h))}}let At=class{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new At(this.firestore,e,this._query)}},Le=class{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ur(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Le(this.firestore,e,this._key)}},ur=class extends At{constructor(e,t,r){super(e,t,oo(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Le(this.firestore,null,new F(e))}withConverter(e){return new ur(this.firestore,e,this._path)}};function XA(n,e,...t){if(n=H(n),Bg("collection","path",e),n instanceof vu){const r=ge.fromString(e,...t);return SI(r),new ur(n,null,r)}{if(!(n instanceof Le||n instanceof ur))throw new D(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ge.fromString(e,...t));return SI(r),new ur(n.firestore,null,r)}}function bB(n,e){if(n=_e(n,vu),Bg("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new D(b.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new At(n,null,function(r){return new pr(ge.emptyPath(),r)}(e))}function za(n,e,...t){if(n=H(n),arguments.length===1&&(e=cT.newId()),Bg("doc","path",e),n instanceof vu){const r=ge.fromString(e,...t);return RI(r),new Le(n,null,new F(r))}{if(!(n instanceof Le||n instanceof ur))throw new D(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ge.fromString(e,...t));return RI(r),new Le(n.firestore,n instanceof ur?n.converter:null,new F(r))}}function ZA(n,e){return n=H(n),e=H(e),(n instanceof Le||n instanceof ur)&&(e instanceof Le||e instanceof ur)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function e0(n,e){return n=H(n),e=H(e),n instanceof At&&e instanceof At&&n.firestore===e.firestore&&du(n._query,e._query)&&n.converter===e.converter}class PB{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new wg(this,"async_queue_retry"),this.iu=()=>{const t=Uc();t&&N("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=Uc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=Uc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new it;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!ti(e))throw e;N("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;const i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw je("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=t,t}enqueueAfterDelay(e,t,r){this.su(),this.ru.indexOf(e)>-1&&(t=0);const i=Rg.createAndSchedule(this,e,t,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&$()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function Zf(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class CB{constructor(){this._progressObserver={},this._taskCompletionResolver=new it,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const kB=-1;let We=class extends vu{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new PB}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||t0(this),this._firestoreClient.terminate()}};function ut(n){return n._firestoreClient||t0(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function t0(n){var e,t,r;const i=n._freezeSettings(),s=function(l,h,f,p){return new i2(l,h,f,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,QA(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new _B(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function DB(n,e){r0(n=_e(n,We));const t=ut(n);if(t._uninitializedComponentsProvider)throw new D(b.FAILED_PRECONDITION,"SDK cache is already specified.");wn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new Lg;return n0(t,i,new WA(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function xB(n){r0(n=_e(n,We));const e=ut(n);if(e._uninitializedComponentsProvider)throw new D(b.FAILED_PRECONDITION,"SDK cache is already specified.");wn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new Lg;return n0(e,r,new fB(r,t.cacheSizeBytes))}function n0(n,e,t){const r=new it;return n.asyncQueue.enqueue(async()=>{try{await Bc(n,t),await Xf(n,e),r.resolve()}catch(i){const s=i;if(!GA(s))throw s;wn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function NB(n){if(n._initialized&&!n._terminated)throw new D(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new it;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!yn.D())return Promise.resolve();const i=r+"main";await yn.delete(i)}(yg(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function VB(n){return function(t){const r=new it;return t.asyncQueue.enqueueAndForget(async()=>tB(await Ug(t),r)),r.promise}(ut(n=_e(n,We)))}function OB(n){return vB(ut(n=_e(n,We)))}function LB(n){return IB(ut(n=_e(n,We)))}function MB(n,e){const t=ut(n=_e(n,We)),r=new CB;return AB(t,n._databaseId,e,r),r}function FB(n,e){return RB(ut(n=_e(n,We)),e).then(t=>t?new At(n,null,t.query):null)}function r0(n){if(n._initialized||n._terminated)throw new D(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Gn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gn(et.fromBase64String(e))}catch(t){throw new D(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Gn(et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}let jr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new D(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ne(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let ji=class{constructor(e){this._methodName=e}};class oh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new D(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new D(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}}const UB=/^__.*__$/;class BB{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new gr(e,this.data,this.fieldMask,t,this.fieldTransforms):new ao(e,this.data,t,this.fieldTransforms)}}class i0{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new gr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function s0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $()}}class ah{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new ah(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return fl(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(s0(this.Iu)&&UB.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class qB{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||_u(e)}pu(e,t,r,i=!1){return new ah({Iu:e,methodName:t,gu:r,path:Ne.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Qi(n){const e=n._freezeSettings(),t=_u(n._databaseId);return new qB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function uh(n,e,t,r,i,s={}){const a=n.pu(s.merge||s.mergeFields?2:0,e,t,i);Gg("Data must be an object, but it was:",a,r);const l=u0(r,a);let h,f;if(s.merge)h=new $t(a.fieldMask),f=a.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const I=ep(e,m,t);if(!a.contains(I))throw new D(b.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);l0(p,I)||p.push(I)}h=new $t(p),f=a.fieldTransforms.filter(m=>h.covers(m.field))}else h=null,f=a.fieldTransforms;return new BB(new gt(l),h,f)}class Iu extends ji{_toFieldTransform(e){if(e.Iu!==2)throw e.Iu===1?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Iu}}function o0(n,e,t){return new ah({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class qg extends ji{_toFieldTransform(e){return new pu(e.path,new Ws)}isEqual(e){return e instanceof qg}}class $B extends ji{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=o0(this,e,!0),r=this.yu.map(s=>Yi(s,t)),i=new Mi(r);return new pu(e.path,i)}isEqual(e){return this===e}}class WB extends ji{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=o0(this,e,!0),r=this.yu.map(s=>Yi(s,t)),i=new Fi(r);return new pu(e.path,i)}isEqual(e){return this===e}}class GB extends ji{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new Gs(e.serializer,BT(e.serializer,this.wu));return new pu(e.path,t)}isEqual(e){return this===e}}function $g(n,e,t,r){const i=n.pu(1,e,t);Gg("Data must be an object, but it was:",i,r);const s=[],a=gt.empty();Hi(r,(h,f)=>{const p=zg(e,h,t);f=H(f);const m=i.Ru(p);if(f instanceof Iu)s.push(p);else{const I=Yi(f,m);I!=null&&(s.push(p),a.set(p,I))}});const l=new $t(s);return new i0(a,l,i.fieldTransforms)}function Wg(n,e,t,r,i,s){const a=n.pu(1,e,t),l=[ep(e,r,t)],h=[i];if(s.length%2!=0)throw new D(b.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<s.length;I+=2)l.push(ep(e,s[I])),h.push(s[I+1]);const f=[],p=gt.empty();for(let I=l.length-1;I>=0;--I)if(!l0(f,l[I])){const A=l[I];let L=h[I];L=H(L);const M=a.Ru(A);if(L instanceof Iu)f.push(A);else{const V=Yi(L,M);V!=null&&(f.push(A),p.set(A,V))}}const m=new $t(f);return new i0(p,m,a.fieldTransforms)}function a0(n,e,t,r=!1){return Yi(t,n.pu(r?4:3,e))}function Yi(n,e){if(c0(n=H(n)))return Gg("Unsupported field value:",e,n),u0(n,e);if(n instanceof ji)return function(r,i){if(!s0(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const l of r){let h=Yi(l,i.Vu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=H(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return BT(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Oe.fromDate(r);return{timestampValue:zs(i.serializer,s)}}if(r instanceof Oe){const s=new Oe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:zs(i.serializer,s)}}if(r instanceof oh)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Gn)return{bytesValue:XT(i.serializer,r._byteString)};if(r instanceof Le){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:dg(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${sh(r)}`)}(n,e)}function u0(n,e){const t={};return IT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hi(n,(r,i)=>{const s=Yi(i,e.Eu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function c0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Oe||n instanceof oh||n instanceof Gn||n instanceof Le||n instanceof ji)}function Gg(n,e,t){if(!c0(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=sh(t);throw r==="an object"?e.mu(n+" a custom object"):e.mu(n+" "+r)}}function ep(n,e,t){if((e=H(e))instanceof jr)return e._internalPath;if(typeof e=="string")return zg(n,e);throw fl("Field path arguments must be of type string or ",n,!1,void 0,t)}const zB=new RegExp("[~\\*/\\[\\]]");function zg(n,e,t){if(e.search(zB)>=0)throw fl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new jr(...e.split("."))._internalPath}catch{throw fl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fl(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new D(b.INVALID_ARGUMENT,l+n+h)}function l0(n,e){return n.some(t=>t.isEqual(e))}class Ka{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Le(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new KB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ch("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class KB extends Ka{data(){return super.data()}}function ch(n,e){return typeof e=="string"?zg(n,e):e instanceof jr?e._internalPath:e._delegate._internalPath}function h0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new D(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Kg{}class wu extends Kg{}function kr(n,e,...t){let r=[];e instanceof Kg&&r.push(e),r=r.concat(t),function(s){const a=s.filter(h=>h instanceof Hg).length,l=s.filter(h=>h instanceof lh).length;if(a>1||a>0&&l>0)throw new D(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class lh extends wu{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new lh(e,t,r)}_apply(e){const t=this._parse(e);return f0(e._query,t),new At(e.firestore,e.converter,qf(e._query,t))}_parse(e){const t=Qi(e.firestore);return function(s,a,l,h,f,p,m){let I;if(f.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new D(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){CI(m,p);const A=[];for(const L of m)A.push(PI(h,s,L));I={arrayValue:{values:A}}}else I=PI(h,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||CI(m,p),I=a0(l,a,m,p==="in"||p==="not-in");return he.create(f,p,I)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function HB(n,e,t){const r=e,i=ch("where",n);return lh._create(i,r,t)}class Hg extends Kg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Hg(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Te.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i;const l=s.getFlattenedFilters();for(const h of l)f0(a,h),a=qf(a,h)}(e._query,t),new At(e.firestore,e.converter,qf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class jg extends wu{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new jg(e,t)}_apply(e){const t=function(i,s,a){if(i.startAt!==null)throw new D(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new D(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ba(s,a)}(e._query,this._field,this._direction);return new At(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new pr(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function jB(n,e="asc"){const t=e,r=ch("orderBy",n);return jg._create(r,t)}class hh extends wu{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new hh(e,t,r)}_apply(e){return new At(e.firestore,e.converter,sl(e._query,this._limit,this._limitType))}}function QB(n){return JA("limit",n),hh._create("limit",n,"F")}function YB(n){return JA("limitToLast",n),hh._create("limitToLast",n,"L")}class dh extends wu{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new dh(e,t,r)}_apply(e){const t=d0(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new pr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}}function JB(...n){return dh._create("startAt",n,!0)}function XB(...n){return dh._create("startAfter",n,!1)}class fh extends wu{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new fh(e,t,r)}_apply(e){const t=d0(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new pr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}}function ZB(...n){return fh._create("endBefore",n,!1)}function eq(...n){return fh._create("endAt",n,!0)}function d0(n,e,t,r){if(t[0]=H(t[0]),t[0]instanceof Ka)return function(s,a,l,h,f){if(!h)throw new D(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const p=[];for(const m of Vs(s))if(m.field.isKeyField())p.push(Oi(a,h.key));else{const I=h.data.field(m.field);if(Yl(I))throw new D(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+m.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(I===null){const A=m.field.canonicalString();throw new D(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${A}' (used as the orderBy) does not exist.`)}p.push(I)}return new Kr(p,f)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Qi(n.firestore);return function(a,l,h,f,p,m){const I=a.explicitOrderBy;if(p.length>I.length)throw new D(b.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const A=[];for(let L=0;L<p.length;L++){const M=p[L];if(I[L].field.isKeyField()){if(typeof M!="string")throw new D(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof M}`);if(!sg(a)&&M.indexOf("/")!==-1)throw new D(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${M}' contains a slash.`);const V=a.path.child(ge.fromString(M));if(!F.isDocumentKey(V))throw new D(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${V}' is not because it contains an odd number of segments.`);const Y=new F(V);A.push(Oi(l,Y))}else{const V=a0(h,f,M);A.push(V)}}return new Kr(A,m)}(n._query,n.firestore._databaseId,i,e,t,r)}}function PI(n,e,t){if(typeof(t=H(t))=="string"){if(t==="")throw new D(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sg(e)&&t.indexOf("/")!==-1)throw new D(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ge.fromString(t));if(!F.isDocumentKey(r))throw new D(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Oi(n,new F(r))}if(t instanceof Le)return Oi(n,t._key);throw new D(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sh(t)}.`)}function CI(n,e){if(!Array.isArray(n)||n.length===0)throw new D(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function f0(n,e){const t=function(i,s){for(const a of i)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new D(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Qg{convertValue(e,t="none"){switch(Vi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Wr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw $()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Hi(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new oh(Be(e.latitude),Be(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=rg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ma(e));default:return null}}convertTimestamp(e){const t=$r(e);return new Oe(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ge.fromString(e);z(uA(r));const i=new Gr(r.get(1),r.get(3)),s=new F(r.popFirst(5));return i.isEqual(t)||je(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function ph(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class tq extends Qg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,t)}}class Ri{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let hr=class extends Ka{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ga(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(ch("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},ga=class extends hr{data(e={}){return super.data(e)}},Qr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ri(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ga(this._firestore,this._userDataWriter,r.key,r,new Ri(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new D(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{const h=new ga(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ri(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const h=new ga(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ri(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,p=-1;return l.type!==0&&(f=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:nq(l.type),doc:h,oldIndex:f,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function nq(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $()}}function p0(n,e){return n instanceof hr&&e instanceof hr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Qr&&e instanceof Qr&&n._firestore===e._firestore&&e0(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function g0(n){n=_e(n,Le);const e=_e(n.firestore,We);return HA(ut(e),n._key).then(t=>Yg(e,n,t))}class Ji extends Qg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,t)}}function rq(n){n=_e(n,Le);const e=_e(n.firestore,We),t=ut(e),r=new Ji(e);return wB(t,n._key).then(i=>new hr(e,r,n._key,i,new Ri(i!==null&&i.hasLocalMutations,!0),n.converter))}function iq(n){n=_e(n,Le);const e=_e(n.firestore,We);return HA(ut(e),n._key,{source:"server"}).then(t=>Yg(e,n,t))}function sq(n){n=_e(n,At);const e=_e(n.firestore,We),t=ut(e),r=new Ji(e);return h0(n._query),jA(t,n._query).then(i=>new Qr(e,r,n,i))}function oq(n){n=_e(n,At);const e=_e(n.firestore,We),t=ut(e),r=new Ji(e);return EB(t,n._query).then(i=>new Qr(e,r,n,i))}function aq(n){n=_e(n,At);const e=_e(n.firestore,We),t=ut(e),r=new Ji(e);return jA(t,n._query,{source:"server"}).then(i=>new Qr(e,r,n,i))}function kI(n,e,t){n=_e(n,Le);const r=_e(n.firestore,We),i=ph(n.converter,e,t);return Eu(r,[uh(Qi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Ve.none())])}function DI(n,e,t,...r){n=_e(n,Le);const i=_e(n.firestore,We),s=Qi(i);let a;return a=typeof(e=H(e))=="string"||e instanceof jr?Wg(s,"updateDoc",n._key,e,t,r):$g(s,"updateDoc",n._key,e),Eu(i,[a.toMutation(n._key,Ve.exists(!0))])}function uq(n){return Eu(_e(n.firestore,We),[new uo(n._key,Ve.none())])}function cq(n,e){const t=_e(n.firestore,We),r=za(n),i=ph(n.converter,e);return Eu(t,[uh(Qi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Ve.exists(!1))]).then(()=>r)}function m0(n,...e){var t,r,i;n=H(n);let s={includeMetadataChanges:!1},a=0;typeof e[a]!="object"||Zf(e[a])||(s=e[a],a++);const l={includeMetadataChanges:s.includeMetadataChanges};if(Zf(e[a])){const m=e[a];e[a]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[a+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[a+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let h,f,p;if(n instanceof Le)f=_e(n.firestore,We),p=oo(n._key.path),h={next:m=>{e[a]&&e[a](Yg(f,n,m))},error:e[a+1],complete:e[a+2]};else{const m=_e(n,At);f=_e(m.firestore,We),p=m._query;const I=new Ji(f);h={next:A=>{e[a]&&e[a](new Qr(f,I,m,A))},error:e[a+1],complete:e[a+2]},h0(n._query)}return function(I,A,L,M){const V=new rh(M),Y=new Cg(A,V,L);return I.asyncQueue.enqueueAndForget(async()=>Sg(await Ys(I),Y)),()=>{V.Na(),I.asyncQueue.enqueueAndForget(async()=>bg(await Ys(I),Y))}}(ut(f),p,l,h)}function lq(n,e){return TB(ut(n=_e(n,We)),Zf(e)?e:{next:e})}function Eu(n,e){return function(r,i){const s=new it;return r.asyncQueue.enqueueAndForget(async()=>JU(await Ug(r),i,s)),s.promise}(ut(n),e)}function Yg(n,e,t){const r=t.docs.get(e._key),i=new Ji(n);return new hr(n,i,e._key,r,new Ri(t.hasPendingWrites,t.fromCache),e.converter)}const hq={maxAttempts:5};let dq=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Qi(e)}set(e,t,r){this._verifyNotCommitted();const i=xr(e,this._firestore),s=ph(i.converter,t,r),a=uh(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(a.toMutation(i._key,Ve.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=xr(e,this._firestore);let a;return a=typeof(t=H(t))=="string"||t instanceof jr?Wg(this._dataReader,"WriteBatch.update",s._key,t,r,i):$g(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Ve.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=xr(e,this._firestore);return this._mutations=this._mutations.concat(new uo(t._key,Ve.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new D(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function xr(n,e){if((n=H(n)).firestore!==e)throw new D(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}let fq=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Qi(t)}get(t){const r=xr(t,this._firestore),i=new tq(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return $();const a=s[0];if(a.isFoundDocument())return new Ka(this._firestore,i,a.key,a,r.converter);if(a.isNoDocument())return new Ka(this._firestore,i,r._key,null,r.converter);throw $()})}set(t,r,i){const s=xr(t,this._firestore),a=ph(s.converter,r,i),l=uh(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(t,r,i,...s){const a=xr(t,this._firestore);let l;return l=typeof(r=H(r))=="string"||r instanceof jr?Wg(this._dataReader,"Transaction.update",a._key,r,i,s):$g(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,l),this}delete(t){const r=xr(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=xr(e,this._firestore),r=new Ji(this._firestore);return super.get(e).then(i=>new hr(this._firestore,r,t._key,i._document,new Ri(!1,!1),t.converter))}};function pq(n,e,t){n=_e(n,We);const r=Object.assign(Object.assign({},hq),t);return function(s){if(s.maxAttempts<1)throw new D(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,a,l){const h=new it;return s.asyncQueue.enqueueAndForget(async()=>{const f=await yB(s);new mB(s.asyncQueue,f,l,a,h).run()}),h.promise}(ut(n),i=>e(new fq(n,i)),r)}function gq(){return new Iu("deleteField")}function mq(){return new qg("serverTimestamp")}function _q(...n){return new $B("arrayUnion",n)}function yq(...n){return new WB("arrayRemove",n)}function vq(n){return new GB("increment",n)}(function(e,t=!0){(function(i){so=i})(Yr),Ur(new qn("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),l=new We(new bF(r.getProvider("auth-internal")),new DF(r.getProvider("app-check-internal")),function(f,p){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new D(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gr(f.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Mn(Rv,"4.4.0",e),Mn(Rv,"4.4.0","esm2017")})();const Iq="@firebase/firestore-compat",wq="0.3.23";function Jg(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new D("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function xI(){if(typeof Uint8Array>"u")throw new D("unimplemented","Uint8Arrays are not available in this environment.")}function NI(){if(!n2())throw new D("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Ha{constructor(e){this._delegate=e}static fromBase64String(e){return NI(),new Ha(Gn.fromBase64String(e))}static fromUint8Array(e){return xI(),new Ha(Gn.fromUint8Array(e))}toBase64(){return NI(),this._delegate.toBase64()}toUint8Array(){return xI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function tp(n){return Eq(n,["next","error","complete"])}function Eq(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class Tq{enableIndexedDbPersistence(e,t){return DB(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return xB(e._delegate)}clearIndexedDbPersistence(e){return NB(e._delegate)}}class _0{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Gr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&wn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){SB(this._delegate,e,t,r)}enableNetwork(){return OB(this._delegate)}disableNetwork(){return LB(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,YA("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return VB(this._delegate)}onSnapshotsInSync(e){return lq(this._delegate,e)}get app(){if(!this._appCompat)throw new D("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Js(this,XA(this._delegate,e))}catch(t){throw Ct(t,"collection()","Firestore.collection()")}}doc(e){try{return new ln(this,za(this._delegate,e))}catch(t){throw Ct(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Pt(this,bB(this._delegate,e))}catch(t){throw Ct(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return pq(this._delegate,t=>e(new y0(this,t)))}batch(){return ut(this._delegate),new v0(new dq(this._delegate,e=>Eu(this._delegate,e)))}loadBundle(e){return MB(this._delegate,e)}namedQuery(e){return FB(this._delegate,e).then(t=>t?new Pt(this,t):null)}}class gh extends Qg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ha(new Gn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return ln.forKey(t,this.firestore,null)}}function Aq(n){TF(n)}class y0{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new gh(e)}get(e){const t=Si(e);return this._delegate.get(t).then(r=>new ja(this._firestore,new hr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Si(e);return r?(Jg("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Si(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Si(e);return this._delegate.delete(t),this}}class v0{constructor(e){this._delegate=e}set(e,t,r){const i=Si(e);return r?(Jg("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Si(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Si(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class $i{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new ga(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Qa(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=$i.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new $i(e,new gh(e),t),i.set(t,s)),s}}$i.INSTANCES=new WeakMap;class ln{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new gh(e)}static forPath(e,t,r){if(e.length%2!==0)throw new D("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new ln(t,new Le(t._delegate,r,new F(e)))}static forKey(e,t,r){return new ln(t,new Le(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Js(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Js(this.firestore,XA(this._delegate,e))}catch(t){throw Ct(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=H(e),e instanceof Le?ZA(this._delegate,e):!1}set(e,t){t=Jg("DocumentReference.set",t);try{return t?kI(this._delegate,e,t):kI(this._delegate,e)}catch(r){throw Ct(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?DI(this._delegate,e):DI(this._delegate,e,t,...r)}catch(i){throw Ct(i,"updateDoc()","DocumentReference.update()")}}delete(){return uq(this._delegate)}onSnapshot(...e){const t=I0(e),r=w0(e,i=>new ja(this.firestore,new hr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return m0(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=rq(this._delegate):(e==null?void 0:e.source)==="server"?t=iq(this._delegate):t=g0(this._delegate),t.then(r=>new ja(this.firestore,new hr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new ln(this.firestore,e?this._delegate.withConverter($i.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ct(n,e,t){return n.message=n.message.replace(e,t),n}function I0(n){for(const e of n)if(typeof e=="object"&&!tp(e))return e;return{}}function w0(n,e){var t,r;let i;return tp(n[0])?i=n[0]:tp(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class ja{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new ln(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return p0(this._delegate,e._delegate)}}class Qa extends ja{data(e){const t=this._delegate.data(e);return this._delegate._converter||AF(t!==void 0),t}}class Pt{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new gh(e)}where(e,t,r){try{return new Pt(this.firestore,kr(this._delegate,HB(e,t,r)))}catch(i){throw Ct(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Pt(this.firestore,kr(this._delegate,jB(e,t)))}catch(r){throw Ct(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Pt(this.firestore,kr(this._delegate,QB(e)))}catch(t){throw Ct(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Pt(this.firestore,kr(this._delegate,YB(e)))}catch(t){throw Ct(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Pt(this.firestore,kr(this._delegate,JB(...e)))}catch(t){throw Ct(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Pt(this.firestore,kr(this._delegate,XB(...e)))}catch(t){throw Ct(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Pt(this.firestore,kr(this._delegate,ZB(...e)))}catch(t){throw Ct(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Pt(this.firestore,kr(this._delegate,eq(...e)))}catch(t){throw Ct(t,"endAt()","Query.endAt()")}}isEqual(e){return e0(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=oq(this._delegate):(e==null?void 0:e.source)==="server"?t=aq(this._delegate):t=sq(this._delegate),t.then(r=>new np(this.firestore,new Qr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=I0(e),r=w0(e,i=>new np(this.firestore,new Qr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return m0(this._delegate,t,r)}withConverter(e){return new Pt(this.firestore,e?this._delegate.withConverter($i.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Rq{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Qa(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class np{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Pt(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Qa(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Rq(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Qa(this._firestore,r))})}isEqual(e){return p0(this._delegate,e._delegate)}}class Js extends Pt{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new ln(this.firestore,e):null}doc(e){try{return e===void 0?new ln(this.firestore,za(this._delegate)):new ln(this.firestore,za(this._delegate,e))}catch(t){throw Ct(t,"doc()","CollectionReference.doc()")}}add(e){return cq(this._delegate,e).then(t=>new ln(this.firestore,t))}isEqual(e){return ZA(this._delegate,e._delegate)}withConverter(e){return new Js(this.firestore,e?this._delegate.withConverter($i.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Si(n){return _e(n,Le)}class Xg{constructor(...e){this._delegate=new jr(...e)}static documentId(){return new Xg(Ne.keyField().canonicalString())}isEqual(e){return e=H(e),e instanceof jr?this._delegate._internalPath.isEqual(e._internalPath):!1}}class wi{constructor(e){this._delegate=e}static serverTimestamp(){const e=mq();return e._methodName="FieldValue.serverTimestamp",new wi(e)}static delete(){const e=gq();return e._methodName="FieldValue.delete",new wi(e)}static arrayUnion(...e){const t=_q(...e);return t._methodName="FieldValue.arrayUnion",new wi(t)}static arrayRemove(...e){const t=yq(...e);return t._methodName="FieldValue.arrayRemove",new wi(t)}static increment(e){const t=vq(e);return t._methodName="FieldValue.increment",new wi(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Sq={Firestore:_0,GeoPoint:oh,Timestamp:Oe,Blob:Ha,Transaction:y0,WriteBatch:v0,DocumentReference:ln,DocumentSnapshot:ja,Query:Pt,QueryDocumentSnapshot:Qa,QuerySnapshot:np,CollectionReference:Js,FieldPath:Xg,FieldValue:wi,setLogLevel:Aq,CACHE_SIZE_UNLIMITED:kB};function bq(n,e){n.INTERNAL.registerComponent(new qn("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Sq)))}function Pq(n){bq(n,(e,t)=>new _0(e,t,new Tq)),n.registerVersion(Iq,wq)}Pq(Br);const Cq={apiKey:"AIzaSyCfFGZC07caKFCARPJmMU-qsuAW8jLIu3E",authDomain:"project-fitness-07.firebaseapp.com",projectId:"project-fitness-07",storageBucket:"project-fitness-07.appspot.com",messagingSenderId:"607206642972",appId:"1:607206642972:web:ea1d5c525a976b668cd6d9"},Wi=Br.initializeApp(Cq);async function kq({email:n,password:e,name:t}){await Wi.auth().createUserWithEmailAndPassword(n,e),await(await Wi.auth().currentUser).updateProfile({displayName:t})}async function Dq({email:n,password:e}){try{await Wi.auth().signInWithEmailAndPassword(n,e)}catch(t){console.log(t.message)}}async function xq(){await Wi.auth().signOut()}const Ho={fs:Br.firestore(),getCurrentUserID:async function(){return new Promise((n,e)=>{Wi.auth().onAuthStateChanged(t=>{t?n(t.uid):e("User not authenticated")})})},addData:async function(n,e){const t=await this.getCurrentUserID();this.fs.collection("users").doc(t).set({[n]:e},{merge:!0}).then(()=>!0).catch(r=>(console.error("Error writing document: ",r),!1))},removeData:async function(n){const e=await this.getCurrentUserID();this.fs.collection("users").doc(e).update({[n]:Br.firestore.FieldValue.delete()},{merge:!0}).then(()=>!0).catch(t=>(console.error("Error writing document: ",t),!1))},getData:async function(){const n=await this.getCurrentUserID(),e=za(this.fs,"users",n),t=await g0(e);if(t.exists())return t.data();console.error("No such document")}},Ya=document.querySelector(".user-icon"),pl=document.querySelector(".authModal__backdrop"),E0=document.querySelector(".authModal__button-close"),mh=document.querySelector(".authForm"),VI=document.querySelector(".action__text"),sa=document.querySelector(".action__button"),OI=document.querySelector(".authForm__fieldset.username"),LI=document.querySelector(".authForm__title"),gl=document.querySelector(".header__username"),MI=document.querySelector(".header_main_nav"),ml=document.querySelector(".button-logout");let qc=!0;const Tu=()=>{pl.classList.remove("open"),E0.removeEventListener("click",Tu),Ya.addEventListener("click",Zg),document.body.style.overflow="visible"},Zg=()=>{pl.classList.add("open"),E0.addEventListener("click",Tu),Ya.removeEventListener("click",Zg),document.body.style.overflow="hidden"},rp=()=>{mh.reset()},Nq=async n=>{var r;n.preventDefault();const e=[...mh.elements].reduce((i,s)=>(s.name&&(i[s.name]=s.value),i),{});qc&&await kq(e),await Dq(e),rp();const t=(r=await Wi.auth().currentUser)==null?void 0:r.displayName;gl.textContent=t,Tu()},Vq=()=>{qc?(sa.textContent="Registration",OI.classList.add("hidden"),sa.setAttribute("data-action","log_in"),LI.textContent="Log in",VI.textContent="Don't have an account?",rp(),qc=!1):(sa.textContent="Log in",sa.setAttribute("data-action","reg"),OI.classList.remove("hidden"),LI.textContent="Registration",VI.textContent="Already have an account?",rp(),qc=!0),mh.elements.name.toggleAttribute("required")},Oq=async()=>{await Wi.auth().onAuthStateChanged(n=>{n?(gl.textContent=n.displayName,gl.classList.remove("hidden"),Ya.classList.add("hidden"),MI.classList.add("visible"),ml.classList.add("visible")):(Ya.classList.remove("hidden"),ml.classList.remove("visible"),MI.classList.remove("visible"))})},Lq=async()=>{await xq(),ml.classList.add("hidden"),gl.classList.add("hidden")};Ya.addEventListener("click",Zg);mh.addEventListener("submit",Nq);sa.addEventListener("click",Vq);ml.addEventListener("click",Lq);document.addEventListener("keydown",n=>{n.key==="Escape"&&Tu()});pl.addEventListener("click",n=>{n.target===pl&&Tu()});Oq();function Mq(){const n=document.querySelector(".hero__hashtags-wrap"),e=document.createElement("ul");e.classList.add("hashtags__list");const t=["Sport","Healthy","Workout","Diet"].map(r=>`
  <li class='hashtags__item'>#${r}</li>
`).join("");e.innerHTML=t,n.insertAdjacentElement("beforeend",e)}window.addEventListener("load",Mq);const _h=document.querySelector(".js-cards"),Ls="/project-fitness-07/";function Fq(n){const e=n.map(({filter:t,name:r,imgURL:i})=>`
        <a class="exercise-cards__gallery-link js-card" data-card-name="${r}" href="">
            <div class="exercise-cards__gallery-card">
                <div class="exercise-cards__gradient"></div>
                <img class="exercise-cards__gallery-image"  src="${i}" alt="${t+"-"+r}" loading="lazy" />
                <div class="exercise-cards__gallery-info">
                    <h3 class="exercise-cards__head3-name">${r}</h3>
                    <p class="exercise-cards__parag-filter">${t}</p>
                </div>
            </div>
        </a>
        `).join("");_h.insertAdjacentHTML("beforeend",e)}function Uq(n){const e=n.map(({_id:t,bodyPart:r,name:i,target:s,burnedCalories:a,time:l,rating:h})=>`
        <a class="workout-cards__gallery-link js-workout-card" data-id="${t}"  href="">
            <div class="workout-cards__gallery-card" >
                <div class="workout-cards__first-line-wrapper">
                    <p class="workout-cards__parag-workout">Workout</p>
                    <p class="workout-cards__parag-rating">${Math.round(h*10)/10}</p>
                    <svg class="workout-cards__icon-star">
                        <use href="${Ls}images/icons-sprite.svg#icon-star"></use>
                    </svg>
                    <p class="workout-cards__parag-start">Start</p>
                    <svg class="workout-cards__icon-arrow-up">
                        <use href="${Ls}images/icons-sprite.svg#icon-arrow-up"></use>
                    </svg>
                </div>
                <div class="workout-cards__second-line-wrapper">
                    <div class="workout-cards__wrapper-icon-running-stick">
                        <svg class="workout-cards__icon-running-stick">
                            <use href="${Ls}images/icons-sprite.svg#icon-running-stick"></use>
                        </svg>
                    </div>
                    <h3 class="workout-cards__head3-name">${i}</h3>
                </div>
                <div class="workout-cards__third-line-wrapper">
                    <p class="workout-cards__parag-burned-calories">Burned calories:</p>
                    <p class="workout-cards__parag-burned-calories-result">${a} / ${l} min<p>
                    <p class="workout-cards__parag-body-part">Body part:</p>
                    <p class="workout-cards__parag-body-part-result">${r}<p>
                    <p class="workout-cards__parag-target">Target:</p>
                    <p class="workout-cards__parag-target-result">${s}<p>
                </div>
            </div>
        </a>
        `).join("");_h.insertAdjacentHTML("beforeend",e)}function Bq(n){const e=n.map(({_id:t,bodyPart:r,name:i,target:s,burnedCalories:a,time:l})=>`
        <a class="favori-cards__gallery-link" href="">
            <div class="favorite-cards__gallery-card" data-id="${t}">
                <div class="favorite-cards__first-line-wrapper">
                    <p class="favorite-cards__parag-workout">favorite</p>
                    <svg class="favorite-cards__icon-trash">
                        <use href="${Ls}images/icons-sprite.svg#icon-trash"></use>
                    </svg>
                    <p class="favorite-cards__parag-start">Start</p>
                    <svg class="favorite-cards__icon-arrow-up">
                        <use href="${Ls}images/icons-sprite.svg#icon-arrow-up"></use>
                    </svg>
                </div>
                <div class="favorite-cards__second-line-wrapper">
                    <svg class="favorite-cards__icon-running-stick">
                        <use href="${Ls}images/icons-sprite.svg#icon-running-stick"></use>
                    </svg>
                    <h3 class="favorite-cards__head3-name">${i}</h3>
                </div>
                <div class="favorite-cards__third-line-wrapper">
                    <p class="favorite-cards__parag-burned-calories">
                    Burned calories: <span class="favorite-cards__span-text">${a} / ${l} min<span></p>
                    <p class="favorite-cards__parag-body-part">
                    Body part: <span class="favorite-cards__span-text">${r} min<span></p>
                    <p class="favorite-cards__parag-target">
                    Target: <span class="favorite-cards__span-text">${s} min<span></p>
                </div>
            </div>
        </a>
        `).join("");_h.insertAdjacentHTML("beforeend",e)}function FI(){_h.innerHTML=""}function qq(){return Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)}function jo(n){let e="";for(let t=0;t<n;t+=1)e+=`
    <li class="exercises__skeleton-loader">
      <div class="card">
        <div class="cover-image-skeleton"></div>
      </div>
    </li>
    `;return e}const Qo=(n,e)=>{n.innerHTML=e},Sn=document.querySelector(".js-cards");function $q(n,e){if(e>=768)return n!=3?(Sn.classList.contains("workout-cards__wrapper")||Qo(Sn,jo(10)),10):(Sn.classList.contains("workout-cards__wrapper")||Qo(Sn,jo(12)),12);if(e<768){if(n==1)return Sn.classList.contains("workout-cards__wrapper")||Qo(Sn,jo(10)),10;if(n==2)return Sn.classList.contains("workout-cards__wrapper")||Qo(Sn,jo(8)),8}return Sn.classList.contains("workout-cards__wrapper")||Qo(Sn,jo(9)),9}function T0(n){const e={filter:"Body%20parts",bodypart:"",keyword:"",muscles:"",equipment:""};for(const t in n)if(n.hasOwnProperty(t)&&n[t]!==e[t])return!0;return!1}function Wq(n,e,t,r,i){return T0(r)?(t.bodyPart=r.bodypart,t.keyword=r.keyword,t.muscles=r.muscles,t.equipment=r.equipment,i=_l(n,e,t).fetchFilteredExercises()):i=_l(n,e,t).fetchExercise(),i}function Gq(n,e,t,r,i){return T0(r)&&(t.filter=r.filter),i=_l(n,e,t).fetchMuscles(),i}function _l(n,e,t){const r=qq(),i=$q(e,r);return t.pageCounter=n,t.limit=i,t}function UI(n){return n.then(e=>e).catch(e=>{throw console.error("Error in getData:",e),e})}function zq(n,e){const t=document.querySelector(".filters__list .active");if(t){const r=t.id.includes("-")?(t.id.charAt(0).toUpperCase()+t.id.slice(1)).replace("-","%20"):t.id.charAt(0).toUpperCase()+t.id.slice(1);if(r!=n.filter||n.filter===""){n.filter=r;for(const i in n)i!=="filter"&&(n[i]="");e.currentPage=1,e.endPoint=3}}else console.error("No child elements found in filters.")}const A0=document.querySelector(".exercise-cards__wrapper");function Kq(){A0.classList.add("workout-cards__wrapper")}function Hq(){A0.classList.remove("workout-cards__wrapper")}const ip=document.querySelector(".js-pages");function BI(n,e){const t=[];if(e>1){for(let i=n-3;i<=n+3;i++)if(i>0&&i<=e){const s=i===n?"exercise-cards__wrapper-page exercise-cards__current-page":"exercise-cards__wrapper-page js-pages";t.push(`
                    <div class="${s}">
                        <a class="exercise-cards__page js-page" data-page="${i}" href="">
                            ${i}
                        </a>
                    </div>
                `)}ip.innerHTML="";for(const i of t)ip.insertAdjacentHTML("beforeend",i)}}function qI(){ip.innerHTML=""}function jq(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-cards")?void 0:e.closest(".js-card").dataset.cardName}function Qq(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-page")?e.closest(".js-page").dataset.page:void 0}function Yq(n){n.preventDefault();const{target:e}=n;if(e.classList.contains("js-cards"))return;const t=e.closest(".js-workout-card");return console.log(t),t.dataset.id}const ma={add:function(n,e){return new Promise((t,r)=>{try{Ho.addData(n,e),t(!0)}catch{r(!1)}})},get:function(){return new Promise(async(n,e)=>{try{const t=await Ho.getData();n(Object.values(t))}catch{e([])}})},idIsFavorite:async function(n){try{return(await this.get()).some(t=>t._id===n)}catch{return!1}},getObjectById:async function(n){try{const t=(await this.get()).find(r=>r._id===n)||null;return t?{...t,isFavorite:!0}:null}catch{return null}},addAndGet:async function(n,e){return new Promise(async(t,r)=>{try{await Ho.addData(n,e),setTimeout(async()=>{const i=await Ho.getData();t(Object.values(i))},200)}catch{r([])}})},remove:async function(n){return new Promise((e,t)=>{try{Ho.removeData(n),e(!0)}catch{t(!1)}})}},Jq=async function(n){const{_id:e}=n;try{if(await ma.idIsFavorite(e)){const r=await ma.remove(e);return console.log(`Object with _id ${e} removed from favorites.`),!1}else{const r=await ma.add(e,n);return console.log(`Object with _id ${e} added to favorites.`),r}}catch(t){return console.error(t),!1}},Xq=n=>{const e="js-toggle-favorit",t=document.getElementById(e);return t.addEventListener("click",async i=>{const s=await Jq(n),a=s?"Remove from favorites":"Add to favorites",l=s?"icon-trash":"icon-heart";t.innerHTML=`<span >${a}</span>
       <svg class="btn-icon">
            <use href="/images/icons-sprite.svg#${l}" />
          </svg>`})},Zq=n=>typeof n!="string"?n:n.split(" ").filter(e=>e).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),$I=n=>typeof n!="string"?n:n.charAt(0).toUpperCase()+n.slice(1),e4=n=>typeof n!="string"?n:n.replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase(),t4=n=>{const e=getComputedStyle(document.documentElement).getPropertyValue("--rating-color-inactive"),t=getComputedStyle(document.documentElement).getPropertyValue("--rating-color-active");return`
<!-- DEFINE SVGs -->
<svg height="0" width="0">
  <defs>
    <!-- DEFINE ONE STAR -->
    <symbol viewBox="0 0 32 32" id="iconstar">
      <path
        d="M13.826 3.262c.684-2.106 3.663-2.106 4.348 0l1.932 5.945a2.285 2.285 0 0 0 2.174 1.579h6.251c2.214 0 3.135 2.833 1.344 4.135l-5.057 3.674a2.286 2.286 0 0 0-.83 2.556l1.931 5.945c.684 2.106-1.726 3.857-3.517 2.555l-5.057-3.674a2.286 2.286 0 0 0-2.687 0l-5.057 3.674c-1.791 1.302-4.202-.45-3.517-2.555l1.932-5.945a2.287 2.287 0 0 0-.83-2.556l-5.057-3.674c-1.791-1.302-.871-4.135 1.344-4.135h6.251c.99 0 1.868-.638 2.174-1.579l1.932-5.945z" />
    </symbol>
    <!-- DEFINE PATTERN FOR EMPTY STARS -->
    <pattern id="stars-empty" patternUnits="userSpaceOnUse" width="24" height="24">
      <use x="0" y="0" xlink:href="#iconstar" fill="${e}" height="24" width="24"/>
    </pattern>
    <!-- DEFINE PATTERN FOR FULL STARS -->
    <pattern id="stars-full" patternUnits="userSpaceOnUse" width="24" height="24">
      <use x="0" y="0" xlink:href="#iconstar" fill="${t}" height="24" width="24"/>
    </pattern>
  </defs>
</svg>

<!-- INSERT STARS -->
<svg height="24" viewBox="0 0 120 24" width="120">
  <rect fill="url(#stars-empty)" x="0" y="0" height="24" width="120"/>
  <rect fill="url(#stars-full)" x="0" y="0" height="24" width="${n}%"/>
</svg>
`},yl=document.querySelector(".js-backdrop"),po=document.querySelector(".modalExercise"),R0=po.querySelector(".x-button"),WI=po.querySelector(".modalExercise__img-wrapper"),Yo=po.querySelector(".exercise-content"),Cc=po.querySelector(".button-box"),n4="/project-fitness-07/",r4=5;let S0;const i4=n=>{const{gifUrl:e,name:t,rating:r,_id:i,isFavorite:s,description:a}=n,l=s4(n);WI.innerHTML="",WI.insertAdjacentHTML("afterbegin",c4(e,t)),Yo.innerHTML="",Yo.insertAdjacentHTML("beforeend",a4(t)),Yo.insertAdjacentHTML("beforeend",u4(r)),Yo.insertAdjacentHTML("beforeend",l4(l)),Yo.insertAdjacentHTML("beforeend",h4(a)),o4(s)},s4=n=>({bodyPart:n.bodyPart,equipment:n.equipment,rating:n.rating,burnedCalories:n.burnedCalories,time:n.time,popular:n.popularity}),o4=(n=!1)=>{Cc.innerHTML="",n?Cc.insertAdjacentHTML("beforeend",f4()):Cc.insertAdjacentHTML("beforeend",d4()),Cc.insertAdjacentHTML("beforeend",p4())},a4=n=>`
    <h3 class="title">${Zq(n)}</h3>
  `,u4=n=>{const e=[],t=Math.round(n*10)/10;e.push(`<li class="rating__item value">${t}</li>`);const r=Math.round(n/r4*100);return e.push(`<li ${t4(r)}</li>`),`<ul class="rating">${e.join("")}</ul>`},c4=(n,e)=>`
    <img src="${n}" alt="${e}"/>
  `,l4=({burnedCalories:n,time:e,...t})=>{const r=[];for(const[i,s]of Object.entries(t)){const a=e4(i),l=$I(a),h=$I(s);r.push(`
      <li class="exercise_details-item">
        <p class="detail-name">${l}</p>
        <p class="detail-value">${h}</p>
      </li>
    `)}return r.push(`
      <li class="exercise_details-item">
        <p class="detail-name">Burned Calories</p>
        <p class="detail-value">${n}/${e} min</p>
      </li>
  `),`<ul class="exercise_details">${r.join("")}</ul>`},h4=n=>`
    <p class="exercise_description">${n}</p>

  `,d4=()=>em({text:"Add to favorites",iconId:"icon-heart",className:"js-toggle-favorite"}),f4=()=>em({text:"Remove from favorites",iconId:"icon-trash",className:"js-toggle-favorite"}),p4=()=>em({text:"Give a rating",className:"js-give-rating ghost"}),em=({text:n,iconId:e,className:t=""})=>{let r;return e&&(r=`
      <svg class="btn-icon">
        <use href=${n4}images/icons-sprite.svg#${e} />
      </svg>
    `),`
    <button id="js-toggle-favorit" type="button" class="button ${t}">
      <span>${n}</span>
      ${e?r:""}
    </button>
  `},yh=()=>{yl.classList.remove("open"),po.classList.remove("open"),R0.removeEventListener("click",yh),document.body.style.overflow="visible";const n="js-toggle-favorit";try{document.getElementById(n).removeEventListener("click",S0)}catch{console.error(`${n} not found!`)}},g4=async n=>{const{_id:e}=n;n.isFavorite=await ma.idIsFavorite(e),i4(n),yl.classList.add("open"),po.classList.add("open"),R0.addEventListener("click",yh),document.body.style.overflow="hidden",S0=Xq(n)};document.addEventListener("keydown",n=>{n.key==="Escape"&&yh()});yl.addEventListener("click",n=>{n.target===yl&&yh()});window.addEventListener("resize",Au);let nr={filter:"Muscles",bodypart:"",keyword:"",muscles:"",equipment:""};const dt={currentPage:1,endPoint:3},Bn={cardsLinks:null,pageLinks:null,workoutLinks:null};async function Au(){document.querySelector(".exercise-cards__section").offsetHeight;const e=new wl;let t,r;zq(nr,dt);try{switch(dt.endPoint){case 1:Bq(t);break;case 2:Kq(),r=Wq(dt.currentPage,dt.endPoint,e,nr,r),t=await UI(r),FI(),qI(),Uq(t),BI(dt.currentPage,e.maxPages),GI(dt.endPoint),v4();break;case 3:Hq(),r=Gq(dt.currentPage,dt.endPoint,e,nr,r),t=await UI(r),FI(),qI(),Fq(t),BI(dt.currentPage,e.maxPages),m4(),GI(dt.endPoint);break}}catch(i){console.log("Error: ",i)}}function m4(){Bn.cardsLinks=document.querySelector(".js-cards"),Bn.cardsLinks?Bn.cardsLinks.addEventListener("click",b0):console.error("Element with class 'js-cards' not found.")}function b0(n){const e=jq(n);_4(e),e!=null&&(nr.filter==="Muscles"?(dt.endPoint=2,nr.muscles=e):nr.filter==="Body%20parts"?(dt.endPoint=2,nr.bodypart=e):nr.filter==="Equipment"&&(dt.endPoint=2,nr.equipment=e)),Bn.cardsLinks.removeEventListener("click",b0),dt.currentPage=1,Au()}function _4(n){return n.includes(" ")?n.replace(" ","%20"):n}function GI(){Bn.pageLinks=document.querySelector(".js-pages"),Bn.pageLinks?Bn.pageLinks.addEventListener("click",y4):console.error("Element with class 'js-pages' not found.")}function y4(n){const e=Qq(n);dt.currentPage!=e&&e!=null&&(dt.currentPage=+e,Au())}function v4(){Bn.workoutLinks=document.querySelector(".js-cards"),Bn.workoutLinks?Bn.workoutLinks.addEventListener("click",I4):console.error("Element with class 'js-cards' not found for workout.")}async function I4(n){const e=Yq(n);if(!e)return;const t=new wl;try{t.id=e;const r=await t.fetchExerciseById();if(!r)throw new Error("Exercise not found!");r.isFavorite=ma.getObjectById(e),g4(r)}catch(r){console.error(r)}}var Jo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},vl={},w4={get exports(){return vl},set exports(n){vl=n}};(function(n,e){(function(){var t,r="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",l="Invalid `variable` option passed into `_.template`",h="__lodash_hash_undefined__",f=500,p="__lodash_placeholder__",m=1,I=2,A=4,L=1,M=2,V=1,Y=2,ae=4,j=8,ye=16,de=32,me=64,we=128,Vt=256,zn=512,Xi=30,k0="...",D0=800,x0=16,rm=1,N0=2,V0=3,ii=1/0,_r=9007199254740991,O0=17976931348623157e292,Ru=0/0,En=4294967295,L0=En-1,M0=En>>>1,F0=[["ary",we],["bind",V],["bindKey",Y],["curry",j],["curryRight",ye],["flip",zn],["partial",de],["partialRight",me],["rearg",Vt]],Zi="[object Arguments]",Su="[object Array]",U0="[object AsyncFunction]",go="[object Boolean]",mo="[object Date]",B0="[object DOMException]",bu="[object Error]",Pu="[object Function]",im="[object GeneratorFunction]",dn="[object Map]",_o="[object Number]",q0="[object Null]",Kn="[object Object]",sm="[object Promise]",$0="[object Proxy]",yo="[object RegExp]",fn="[object Set]",vo="[object String]",Cu="[object Symbol]",W0="[object Undefined]",Io="[object WeakMap]",G0="[object WeakSet]",wo="[object ArrayBuffer]",es="[object DataView]",Ih="[object Float32Array]",wh="[object Float64Array]",Eh="[object Int8Array]",Th="[object Int16Array]",Ah="[object Int32Array]",Rh="[object Uint8Array]",Sh="[object Uint8ClampedArray]",bh="[object Uint16Array]",Ph="[object Uint32Array]",z0=/\b__p \+= '';/g,K0=/\b(__p \+=) '' \+/g,H0=/(__e\(.*?\)|\b__t\)) \+\n'';/g,om=/&(?:amp|lt|gt|quot|#39);/g,am=/[&<>"']/g,j0=RegExp(om.source),Q0=RegExp(am.source),Y0=/<%-([\s\S]+?)%>/g,J0=/<%([\s\S]+?)%>/g,um=/<%=([\s\S]+?)%>/g,X0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Z0=/^\w*$/,eR=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ch=/[\\^$.*+?()[\]{}|]/g,tR=RegExp(Ch.source),kh=/^\s+/,nR=/\s/,rR=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,iR=/\{\n\/\* \[wrapped with (.+)\] \*/,sR=/,? & /,oR=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,aR=/[()=,{}\[\]\/\s]/,uR=/\\(\\)?/g,cR=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,cm=/\w*$/,lR=/^[-+]0x[0-9a-f]+$/i,hR=/^0b[01]+$/i,dR=/^\[object .+?Constructor\]$/,fR=/^0o[0-7]+$/i,pR=/^(?:0|[1-9]\d*)$/,gR=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ku=/($^)/,mR=/['\n\r\u2028\u2029\\]/g,Du="\\ud800-\\udfff",_R="\\u0300-\\u036f",yR="\\ufe20-\\ufe2f",vR="\\u20d0-\\u20ff",lm=_R+yR+vR,hm="\\u2700-\\u27bf",dm="a-z\\xdf-\\xf6\\xf8-\\xff",IR="\\xac\\xb1\\xd7\\xf7",wR="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ER="\\u2000-\\u206f",TR=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",fm="A-Z\\xc0-\\xd6\\xd8-\\xde",pm="\\ufe0e\\ufe0f",gm=IR+wR+ER+TR,Dh="['’]",AR="["+Du+"]",mm="["+gm+"]",xu="["+lm+"]",_m="\\d+",RR="["+hm+"]",ym="["+dm+"]",vm="[^"+Du+gm+_m+hm+dm+fm+"]",xh="\\ud83c[\\udffb-\\udfff]",SR="(?:"+xu+"|"+xh+")",Im="[^"+Du+"]",Nh="(?:\\ud83c[\\udde6-\\uddff]){2}",Vh="[\\ud800-\\udbff][\\udc00-\\udfff]",ts="["+fm+"]",wm="\\u200d",Em="(?:"+ym+"|"+vm+")",bR="(?:"+ts+"|"+vm+")",Tm="(?:"+Dh+"(?:d|ll|m|re|s|t|ve))?",Am="(?:"+Dh+"(?:D|LL|M|RE|S|T|VE))?",Rm=SR+"?",Sm="["+pm+"]?",PR="(?:"+wm+"(?:"+[Im,Nh,Vh].join("|")+")"+Sm+Rm+")*",CR="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",kR="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",bm=Sm+Rm+PR,DR="(?:"+[RR,Nh,Vh].join("|")+")"+bm,xR="(?:"+[Im+xu+"?",xu,Nh,Vh,AR].join("|")+")",NR=RegExp(Dh,"g"),VR=RegExp(xu,"g"),Oh=RegExp(xh+"(?="+xh+")|"+xR+bm,"g"),OR=RegExp([ts+"?"+ym+"+"+Tm+"(?="+[mm,ts,"$"].join("|")+")",bR+"+"+Am+"(?="+[mm,ts+Em,"$"].join("|")+")",ts+"?"+Em+"+"+Tm,ts+"+"+Am,kR,CR,_m,DR].join("|"),"g"),LR=RegExp("["+wm+Du+lm+pm+"]"),MR=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,FR=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],UR=-1,Ce={};Ce[Ih]=Ce[wh]=Ce[Eh]=Ce[Th]=Ce[Ah]=Ce[Rh]=Ce[Sh]=Ce[bh]=Ce[Ph]=!0,Ce[Zi]=Ce[Su]=Ce[wo]=Ce[go]=Ce[es]=Ce[mo]=Ce[bu]=Ce[Pu]=Ce[dn]=Ce[_o]=Ce[Kn]=Ce[yo]=Ce[fn]=Ce[vo]=Ce[Io]=!1;var be={};be[Zi]=be[Su]=be[wo]=be[es]=be[go]=be[mo]=be[Ih]=be[wh]=be[Eh]=be[Th]=be[Ah]=be[dn]=be[_o]=be[Kn]=be[yo]=be[fn]=be[vo]=be[Cu]=be[Rh]=be[Sh]=be[bh]=be[Ph]=!0,be[bu]=be[Pu]=be[Io]=!1;var BR={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},qR={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$R={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},WR={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},GR=parseFloat,zR=parseInt,Pm=typeof Jo=="object"&&Jo&&Jo.Object===Object&&Jo,KR=typeof self=="object"&&self&&self.Object===Object&&self,ct=Pm||KR||Function("return this")(),Lh=e&&!e.nodeType&&e,si=Lh&&!0&&n&&!n.nodeType&&n,Cm=si&&si.exports===Lh,Mh=Cm&&Pm.process,en=function(){try{var E=si&&si.require&&si.require("util").types;return E||Mh&&Mh.binding&&Mh.binding("util")}catch{}}(),km=en&&en.isArrayBuffer,Dm=en&&en.isDate,xm=en&&en.isMap,Nm=en&&en.isRegExp,Vm=en&&en.isSet,Om=en&&en.isTypedArray;function Gt(E,P,S){switch(S.length){case 0:return E.call(P);case 1:return E.call(P,S[0]);case 2:return E.call(P,S[0],S[1]);case 3:return E.call(P,S[0],S[1],S[2])}return E.apply(P,S)}function HR(E,P,S,W){for(var ee=-1,ve=E==null?0:E.length;++ee<ve;){var Xe=E[ee];P(W,Xe,S(Xe),E)}return W}function tn(E,P){for(var S=-1,W=E==null?0:E.length;++S<W&&P(E[S],S,E)!==!1;);return E}function jR(E,P){for(var S=E==null?0:E.length;S--&&P(E[S],S,E)!==!1;);return E}function Lm(E,P){for(var S=-1,W=E==null?0:E.length;++S<W;)if(!P(E[S],S,E))return!1;return!0}function yr(E,P){for(var S=-1,W=E==null?0:E.length,ee=0,ve=[];++S<W;){var Xe=E[S];P(Xe,S,E)&&(ve[ee++]=Xe)}return ve}function Nu(E,P){var S=E==null?0:E.length;return!!S&&ns(E,P,0)>-1}function Fh(E,P,S){for(var W=-1,ee=E==null?0:E.length;++W<ee;)if(S(P,E[W]))return!0;return!1}function xe(E,P){for(var S=-1,W=E==null?0:E.length,ee=Array(W);++S<W;)ee[S]=P(E[S],S,E);return ee}function vr(E,P){for(var S=-1,W=P.length,ee=E.length;++S<W;)E[ee+S]=P[S];return E}function Uh(E,P,S,W){var ee=-1,ve=E==null?0:E.length;for(W&&ve&&(S=E[++ee]);++ee<ve;)S=P(S,E[ee],ee,E);return S}function QR(E,P,S,W){var ee=E==null?0:E.length;for(W&&ee&&(S=E[--ee]);ee--;)S=P(S,E[ee],ee,E);return S}function Bh(E,P){for(var S=-1,W=E==null?0:E.length;++S<W;)if(P(E[S],S,E))return!0;return!1}var YR=qh("length");function JR(E){return E.split("")}function XR(E){return E.match(oR)||[]}function Mm(E,P,S){var W;return S(E,function(ee,ve,Xe){if(P(ee,ve,Xe))return W=ve,!1}),W}function Vu(E,P,S,W){for(var ee=E.length,ve=S+(W?1:-1);W?ve--:++ve<ee;)if(P(E[ve],ve,E))return ve;return-1}function ns(E,P,S){return P===P?lS(E,P,S):Vu(E,Fm,S)}function ZR(E,P,S,W){for(var ee=S-1,ve=E.length;++ee<ve;)if(W(E[ee],P))return ee;return-1}function Fm(E){return E!==E}function Um(E,P){var S=E==null?0:E.length;return S?Wh(E,P)/S:Ru}function qh(E){return function(P){return P==null?t:P[E]}}function $h(E){return function(P){return E==null?t:E[P]}}function Bm(E,P,S,W,ee){return ee(E,function(ve,Xe,Se){S=W?(W=!1,ve):P(S,ve,Xe,Se)}),S}function eS(E,P){var S=E.length;for(E.sort(P);S--;)E[S]=E[S].value;return E}function Wh(E,P){for(var S,W=-1,ee=E.length;++W<ee;){var ve=P(E[W]);ve!==t&&(S=S===t?ve:S+ve)}return S}function Gh(E,P){for(var S=-1,W=Array(E);++S<E;)W[S]=P(S);return W}function tS(E,P){return xe(P,function(S){return[S,E[S]]})}function qm(E){return E&&E.slice(0,zm(E)+1).replace(kh,"")}function zt(E){return function(P){return E(P)}}function zh(E,P){return xe(P,function(S){return E[S]})}function Eo(E,P){return E.has(P)}function $m(E,P){for(var S=-1,W=E.length;++S<W&&ns(P,E[S],0)>-1;);return S}function Wm(E,P){for(var S=E.length;S--&&ns(P,E[S],0)>-1;);return S}function nS(E,P){for(var S=E.length,W=0;S--;)E[S]===P&&++W;return W}var rS=$h(BR),iS=$h(qR);function sS(E){return"\\"+WR[E]}function oS(E,P){return E==null?t:E[P]}function rs(E){return LR.test(E)}function aS(E){return MR.test(E)}function uS(E){for(var P,S=[];!(P=E.next()).done;)S.push(P.value);return S}function Kh(E){var P=-1,S=Array(E.size);return E.forEach(function(W,ee){S[++P]=[ee,W]}),S}function Gm(E,P){return function(S){return E(P(S))}}function Ir(E,P){for(var S=-1,W=E.length,ee=0,ve=[];++S<W;){var Xe=E[S];(Xe===P||Xe===p)&&(E[S]=p,ve[ee++]=S)}return ve}function Ou(E){var P=-1,S=Array(E.size);return E.forEach(function(W){S[++P]=W}),S}function cS(E){var P=-1,S=Array(E.size);return E.forEach(function(W){S[++P]=[W,W]}),S}function lS(E,P,S){for(var W=S-1,ee=E.length;++W<ee;)if(E[W]===P)return W;return-1}function hS(E,P,S){for(var W=S+1;W--;)if(E[W]===P)return W;return W}function is(E){return rs(E)?fS(E):YR(E)}function pn(E){return rs(E)?pS(E):JR(E)}function zm(E){for(var P=E.length;P--&&nR.test(E.charAt(P)););return P}var dS=$h($R);function fS(E){for(var P=Oh.lastIndex=0;Oh.test(E);)++P;return P}function pS(E){return E.match(Oh)||[]}function gS(E){return E.match(OR)||[]}var mS=function E(P){P=P==null?ct:ss.defaults(ct.Object(),P,ss.pick(ct,FR));var S=P.Array,W=P.Date,ee=P.Error,ve=P.Function,Xe=P.Math,Se=P.Object,Hh=P.RegExp,_S=P.String,nn=P.TypeError,Lu=S.prototype,yS=ve.prototype,os=Se.prototype,Mu=P["__core-js_shared__"],Fu=yS.toString,Ee=os.hasOwnProperty,vS=0,Km=function(){var o=/[^.]+$/.exec(Mu&&Mu.keys&&Mu.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Uu=os.toString,IS=Fu.call(Se),wS=ct._,ES=Hh("^"+Fu.call(Ee).replace(Ch,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bu=Cm?P.Buffer:t,wr=P.Symbol,qu=P.Uint8Array,Hm=Bu?Bu.allocUnsafe:t,$u=Gm(Se.getPrototypeOf,Se),jm=Se.create,Qm=os.propertyIsEnumerable,Wu=Lu.splice,Ym=wr?wr.isConcatSpreadable:t,To=wr?wr.iterator:t,oi=wr?wr.toStringTag:t,Gu=function(){try{var o=hi(Se,"defineProperty");return o({},"",{}),o}catch{}}(),TS=P.clearTimeout!==ct.clearTimeout&&P.clearTimeout,AS=W&&W.now!==ct.Date.now&&W.now,RS=P.setTimeout!==ct.setTimeout&&P.setTimeout,zu=Xe.ceil,Ku=Xe.floor,jh=Se.getOwnPropertySymbols,SS=Bu?Bu.isBuffer:t,Jm=P.isFinite,bS=Lu.join,PS=Gm(Se.keys,Se),Ze=Xe.max,vt=Xe.min,CS=W.now,kS=P.parseInt,Xm=Xe.random,DS=Lu.reverse,Qh=hi(P,"DataView"),Ao=hi(P,"Map"),Yh=hi(P,"Promise"),as=hi(P,"Set"),Ro=hi(P,"WeakMap"),So=hi(Se,"create"),Hu=Ro&&new Ro,us={},xS=di(Qh),NS=di(Ao),VS=di(Yh),OS=di(as),LS=di(Ro),ju=wr?wr.prototype:t,bo=ju?ju.valueOf:t,Zm=ju?ju.toString:t;function _(o){if(Ue(o)&&!te(o)&&!(o instanceof le)){if(o instanceof rn)return o;if(Ee.call(o,"__wrapped__"))return ey(o)}return new rn(o)}var cs=function(){function o(){}return function(u){if(!Me(u))return{};if(jm)return jm(u);o.prototype=u;var c=new o;return o.prototype=t,c}}();function Qu(){}function rn(o,u){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=t}_.templateSettings={escape:Y0,evaluate:J0,interpolate:um,variable:"",imports:{_}},_.prototype=Qu.prototype,_.prototype.constructor=_,rn.prototype=cs(Qu.prototype),rn.prototype.constructor=rn;function le(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=En,this.__views__=[]}function MS(){var o=new le(this.__wrapped__);return o.__actions__=Ot(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=Ot(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=Ot(this.__views__),o}function FS(){if(this.__filtered__){var o=new le(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function US(){var o=this.__wrapped__.value(),u=this.__dir__,c=te(o),d=u<0,g=c?o.length:0,y=Jb(0,g,this.__views__),v=y.start,w=y.end,T=w-v,C=d?w:v-1,k=this.__iteratees__,x=k.length,U=0,G=vt(T,this.__takeCount__);if(!c||!d&&g==T&&G==T)return T_(o,this.__actions__);var J=[];e:for(;T--&&U<G;){C+=u;for(var se=-1,X=o[C];++se<x;){var ue=k[se],fe=ue.iteratee,jt=ue.type,bt=fe(X);if(jt==N0)X=bt;else if(!bt){if(jt==rm)continue e;break e}}J[U++]=X}return J}le.prototype=cs(Qu.prototype),le.prototype.constructor=le;function ai(o){var u=-1,c=o==null?0:o.length;for(this.clear();++u<c;){var d=o[u];this.set(d[0],d[1])}}function BS(){this.__data__=So?So(null):{},this.size=0}function qS(o){var u=this.has(o)&&delete this.__data__[o];return this.size-=u?1:0,u}function $S(o){var u=this.__data__;if(So){var c=u[o];return c===h?t:c}return Ee.call(u,o)?u[o]:t}function WS(o){var u=this.__data__;return So?u[o]!==t:Ee.call(u,o)}function GS(o,u){var c=this.__data__;return this.size+=this.has(o)?0:1,c[o]=So&&u===t?h:u,this}ai.prototype.clear=BS,ai.prototype.delete=qS,ai.prototype.get=$S,ai.prototype.has=WS,ai.prototype.set=GS;function Hn(o){var u=-1,c=o==null?0:o.length;for(this.clear();++u<c;){var d=o[u];this.set(d[0],d[1])}}function zS(){this.__data__=[],this.size=0}function KS(o){var u=this.__data__,c=Yu(u,o);if(c<0)return!1;var d=u.length-1;return c==d?u.pop():Wu.call(u,c,1),--this.size,!0}function HS(o){var u=this.__data__,c=Yu(u,o);return c<0?t:u[c][1]}function jS(o){return Yu(this.__data__,o)>-1}function QS(o,u){var c=this.__data__,d=Yu(c,o);return d<0?(++this.size,c.push([o,u])):c[d][1]=u,this}Hn.prototype.clear=zS,Hn.prototype.delete=KS,Hn.prototype.get=HS,Hn.prototype.has=jS,Hn.prototype.set=QS;function jn(o){var u=-1,c=o==null?0:o.length;for(this.clear();++u<c;){var d=o[u];this.set(d[0],d[1])}}function YS(){this.size=0,this.__data__={hash:new ai,map:new(Ao||Hn),string:new ai}}function JS(o){var u=uc(this,o).delete(o);return this.size-=u?1:0,u}function XS(o){return uc(this,o).get(o)}function ZS(o){return uc(this,o).has(o)}function eb(o,u){var c=uc(this,o),d=c.size;return c.set(o,u),this.size+=c.size==d?0:1,this}jn.prototype.clear=YS,jn.prototype.delete=JS,jn.prototype.get=XS,jn.prototype.has=ZS,jn.prototype.set=eb;function ui(o){var u=-1,c=o==null?0:o.length;for(this.__data__=new jn;++u<c;)this.add(o[u])}function tb(o){return this.__data__.set(o,h),this}function nb(o){return this.__data__.has(o)}ui.prototype.add=ui.prototype.push=tb,ui.prototype.has=nb;function gn(o){var u=this.__data__=new Hn(o);this.size=u.size}function rb(){this.__data__=new Hn,this.size=0}function ib(o){var u=this.__data__,c=u.delete(o);return this.size=u.size,c}function sb(o){return this.__data__.get(o)}function ob(o){return this.__data__.has(o)}function ab(o,u){var c=this.__data__;if(c instanceof Hn){var d=c.__data__;if(!Ao||d.length<i-1)return d.push([o,u]),this.size=++c.size,this;c=this.__data__=new jn(d)}return c.set(o,u),this.size=c.size,this}gn.prototype.clear=rb,gn.prototype.delete=ib,gn.prototype.get=sb,gn.prototype.has=ob,gn.prototype.set=ab;function e_(o,u){var c=te(o),d=!c&&fi(o),g=!c&&!d&&Sr(o),y=!c&&!d&&!g&&fs(o),v=c||d||g||y,w=v?Gh(o.length,_S):[],T=w.length;for(var C in o)(u||Ee.call(o,C))&&!(v&&(C=="length"||g&&(C=="offset"||C=="parent")||y&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||Xn(C,T)))&&w.push(C);return w}function t_(o){var u=o.length;return u?o[ad(0,u-1)]:t}function ub(o,u){return cc(Ot(o),ci(u,0,o.length))}function cb(o){return cc(Ot(o))}function Jh(o,u,c){(c!==t&&!mn(o[u],c)||c===t&&!(u in o))&&Qn(o,u,c)}function Po(o,u,c){var d=o[u];(!(Ee.call(o,u)&&mn(d,c))||c===t&&!(u in o))&&Qn(o,u,c)}function Yu(o,u){for(var c=o.length;c--;)if(mn(o[c][0],u))return c;return-1}function lb(o,u,c,d){return Er(o,function(g,y,v){u(d,g,c(g),v)}),d}function n_(o,u){return o&&An(u,tt(u),o)}function hb(o,u){return o&&An(u,Mt(u),o)}function Qn(o,u,c){u=="__proto__"&&Gu?Gu(o,u,{configurable:!0,enumerable:!0,value:c,writable:!0}):o[u]=c}function Xh(o,u){for(var c=-1,d=u.length,g=S(d),y=o==null;++c<d;)g[c]=y?t:xd(o,u[c]);return g}function ci(o,u,c){return o===o&&(c!==t&&(o=o<=c?o:c),u!==t&&(o=o>=u?o:u)),o}function sn(o,u,c,d,g,y){var v,w=u&m,T=u&I,C=u&A;if(c&&(v=g?c(o,d,g,y):c(o)),v!==t)return v;if(!Me(o))return o;var k=te(o);if(k){if(v=Zb(o),!w)return Ot(o,v)}else{var x=It(o),U=x==Pu||x==im;if(Sr(o))return S_(o,w);if(x==Kn||x==Zi||U&&!g){if(v=T||U?{}:z_(o),!w)return T?$b(o,hb(v,o)):qb(o,n_(v,o))}else{if(!be[x])return g?o:{};v=eP(o,x,w)}}y||(y=new gn);var G=y.get(o);if(G)return G;y.set(o,v),Iy(o)?o.forEach(function(X){v.add(sn(X,u,c,X,o,y))}):yy(o)&&o.forEach(function(X,ue){v.set(ue,sn(X,u,c,ue,o,y))});var J=C?T?yd:_d:T?Mt:tt,se=k?t:J(o);return tn(se||o,function(X,ue){se&&(ue=X,X=o[ue]),Po(v,ue,sn(X,u,c,ue,o,y))}),v}function db(o){var u=tt(o);return function(c){return r_(c,o,u)}}function r_(o,u,c){var d=c.length;if(o==null)return!d;for(o=Se(o);d--;){var g=c[d],y=u[g],v=o[g];if(v===t&&!(g in o)||!y(v))return!1}return!0}function i_(o,u,c){if(typeof o!="function")throw new nn(a);return Oo(function(){o.apply(t,c)},u)}function Co(o,u,c,d){var g=-1,y=Nu,v=!0,w=o.length,T=[],C=u.length;if(!w)return T;c&&(u=xe(u,zt(c))),d?(y=Fh,v=!1):u.length>=i&&(y=Eo,v=!1,u=new ui(u));e:for(;++g<w;){var k=o[g],x=c==null?k:c(k);if(k=d||k!==0?k:0,v&&x===x){for(var U=C;U--;)if(u[U]===x)continue e;T.push(k)}else y(u,x,d)||T.push(k)}return T}var Er=D_(Tn),s_=D_(ed,!0);function fb(o,u){var c=!0;return Er(o,function(d,g,y){return c=!!u(d,g,y),c}),c}function Ju(o,u,c){for(var d=-1,g=o.length;++d<g;){var y=o[d],v=u(y);if(v!=null&&(w===t?v===v&&!Ht(v):c(v,w)))var w=v,T=y}return T}function pb(o,u,c,d){var g=o.length;for(c=ie(c),c<0&&(c=-c>g?0:g+c),d=d===t||d>g?g:ie(d),d<0&&(d+=g),d=c>d?0:Ey(d);c<d;)o[c++]=u;return o}function o_(o,u){var c=[];return Er(o,function(d,g,y){u(d,g,y)&&c.push(d)}),c}function lt(o,u,c,d,g){var y=-1,v=o.length;for(c||(c=nP),g||(g=[]);++y<v;){var w=o[y];u>0&&c(w)?u>1?lt(w,u-1,c,d,g):vr(g,w):d||(g[g.length]=w)}return g}var Zh=x_(),a_=x_(!0);function Tn(o,u){return o&&Zh(o,u,tt)}function ed(o,u){return o&&a_(o,u,tt)}function Xu(o,u){return yr(u,function(c){return Zn(o[c])})}function li(o,u){u=Ar(u,o);for(var c=0,d=u.length;o!=null&&c<d;)o=o[Rn(u[c++])];return c&&c==d?o:t}function u_(o,u,c){var d=u(o);return te(o)?d:vr(d,c(o))}function Rt(o){return o==null?o===t?W0:q0:oi&&oi in Se(o)?Yb(o):cP(o)}function td(o,u){return o>u}function gb(o,u){return o!=null&&Ee.call(o,u)}function mb(o,u){return o!=null&&u in Se(o)}function _b(o,u,c){return o>=vt(u,c)&&o<Ze(u,c)}function nd(o,u,c){for(var d=c?Fh:Nu,g=o[0].length,y=o.length,v=y,w=S(y),T=1/0,C=[];v--;){var k=o[v];v&&u&&(k=xe(k,zt(u))),T=vt(k.length,T),w[v]=!c&&(u||g>=120&&k.length>=120)?new ui(v&&k):t}k=o[0];var x=-1,U=w[0];e:for(;++x<g&&C.length<T;){var G=k[x],J=u?u(G):G;if(G=c||G!==0?G:0,!(U?Eo(U,J):d(C,J,c))){for(v=y;--v;){var se=w[v];if(!(se?Eo(se,J):d(o[v],J,c)))continue e}U&&U.push(J),C.push(G)}}return C}function yb(o,u,c,d){return Tn(o,function(g,y,v){u(d,c(g),y,v)}),d}function ko(o,u,c){u=Ar(u,o),o=Q_(o,u);var d=o==null?o:o[Rn(an(u))];return d==null?t:Gt(d,o,c)}function c_(o){return Ue(o)&&Rt(o)==Zi}function vb(o){return Ue(o)&&Rt(o)==wo}function Ib(o){return Ue(o)&&Rt(o)==mo}function Do(o,u,c,d,g){return o===u?!0:o==null||u==null||!Ue(o)&&!Ue(u)?o!==o&&u!==u:wb(o,u,c,d,Do,g)}function wb(o,u,c,d,g,y){var v=te(o),w=te(u),T=v?Su:It(o),C=w?Su:It(u);T=T==Zi?Kn:T,C=C==Zi?Kn:C;var k=T==Kn,x=C==Kn,U=T==C;if(U&&Sr(o)){if(!Sr(u))return!1;v=!0,k=!1}if(U&&!k)return y||(y=new gn),v||fs(o)?$_(o,u,c,d,g,y):jb(o,u,T,c,d,g,y);if(!(c&L)){var G=k&&Ee.call(o,"__wrapped__"),J=x&&Ee.call(u,"__wrapped__");if(G||J){var se=G?o.value():o,X=J?u.value():u;return y||(y=new gn),g(se,X,c,d,y)}}return U?(y||(y=new gn),Qb(o,u,c,d,g,y)):!1}function Eb(o){return Ue(o)&&It(o)==dn}function rd(o,u,c,d){var g=c.length,y=g,v=!d;if(o==null)return!y;for(o=Se(o);g--;){var w=c[g];if(v&&w[2]?w[1]!==o[w[0]]:!(w[0]in o))return!1}for(;++g<y;){w=c[g];var T=w[0],C=o[T],k=w[1];if(v&&w[2]){if(C===t&&!(T in o))return!1}else{var x=new gn;if(d)var U=d(C,k,T,o,u,x);if(!(U===t?Do(k,C,L|M,d,x):U))return!1}}return!0}function l_(o){if(!Me(o)||iP(o))return!1;var u=Zn(o)?ES:dR;return u.test(di(o))}function Tb(o){return Ue(o)&&Rt(o)==yo}function Ab(o){return Ue(o)&&It(o)==fn}function Rb(o){return Ue(o)&&gc(o.length)&&!!Ce[Rt(o)]}function h_(o){return typeof o=="function"?o:o==null?Ft:typeof o=="object"?te(o)?p_(o[0],o[1]):f_(o):Ny(o)}function id(o){if(!Vo(o))return PS(o);var u=[];for(var c in Se(o))Ee.call(o,c)&&c!="constructor"&&u.push(c);return u}function Sb(o){if(!Me(o))return uP(o);var u=Vo(o),c=[];for(var d in o)d=="constructor"&&(u||!Ee.call(o,d))||c.push(d);return c}function sd(o,u){return o<u}function d_(o,u){var c=-1,d=Lt(o)?S(o.length):[];return Er(o,function(g,y,v){d[++c]=u(g,y,v)}),d}function f_(o){var u=Id(o);return u.length==1&&u[0][2]?H_(u[0][0],u[0][1]):function(c){return c===o||rd(c,o,u)}}function p_(o,u){return Ed(o)&&K_(u)?H_(Rn(o),u):function(c){var d=xd(c,o);return d===t&&d===u?Nd(c,o):Do(u,d,L|M)}}function Zu(o,u,c,d,g){o!==u&&Zh(u,function(y,v){if(g||(g=new gn),Me(y))bb(o,u,v,c,Zu,d,g);else{var w=d?d(Ad(o,v),y,v+"",o,u,g):t;w===t&&(w=y),Jh(o,v,w)}},Mt)}function bb(o,u,c,d,g,y,v){var w=Ad(o,c),T=Ad(u,c),C=v.get(T);if(C){Jh(o,c,C);return}var k=y?y(w,T,c+"",o,u,v):t,x=k===t;if(x){var U=te(T),G=!U&&Sr(T),J=!U&&!G&&fs(T);k=T,U||G||J?te(w)?k=w:Ke(w)?k=Ot(w):G?(x=!1,k=S_(T,!0)):J?(x=!1,k=b_(T,!0)):k=[]:Lo(T)||fi(T)?(k=w,fi(w)?k=Ty(w):(!Me(w)||Zn(w))&&(k=z_(T))):x=!1}x&&(v.set(T,k),g(k,T,d,y,v),v.delete(T)),Jh(o,c,k)}function g_(o,u){var c=o.length;if(c)return u+=u<0?c:0,Xn(u,c)?o[u]:t}function m_(o,u,c){u.length?u=xe(u,function(y){return te(y)?function(v){return li(v,y.length===1?y[0]:y)}:y}):u=[Ft];var d=-1;u=xe(u,zt(Q()));var g=d_(o,function(y,v,w){var T=xe(u,function(C){return C(y)});return{criteria:T,index:++d,value:y}});return eS(g,function(y,v){return Bb(y,v,c)})}function Pb(o,u){return __(o,u,function(c,d){return Nd(o,d)})}function __(o,u,c){for(var d=-1,g=u.length,y={};++d<g;){var v=u[d],w=li(o,v);c(w,v)&&xo(y,Ar(v,o),w)}return y}function Cb(o){return function(u){return li(u,o)}}function od(o,u,c,d){var g=d?ZR:ns,y=-1,v=u.length,w=o;for(o===u&&(u=Ot(u)),c&&(w=xe(o,zt(c)));++y<v;)for(var T=0,C=u[y],k=c?c(C):C;(T=g(w,k,T,d))>-1;)w!==o&&Wu.call(w,T,1),Wu.call(o,T,1);return o}function y_(o,u){for(var c=o?u.length:0,d=c-1;c--;){var g=u[c];if(c==d||g!==y){var y=g;Xn(g)?Wu.call(o,g,1):ld(o,g)}}return o}function ad(o,u){return o+Ku(Xm()*(u-o+1))}function kb(o,u,c,d){for(var g=-1,y=Ze(zu((u-o)/(c||1)),0),v=S(y);y--;)v[d?y:++g]=o,o+=c;return v}function ud(o,u){var c="";if(!o||u<1||u>_r)return c;do u%2&&(c+=o),u=Ku(u/2),u&&(o+=o);while(u);return c}function oe(o,u){return Rd(j_(o,u,Ft),o+"")}function Db(o){return t_(ps(o))}function xb(o,u){var c=ps(o);return cc(c,ci(u,0,c.length))}function xo(o,u,c,d){if(!Me(o))return o;u=Ar(u,o);for(var g=-1,y=u.length,v=y-1,w=o;w!=null&&++g<y;){var T=Rn(u[g]),C=c;if(T==="__proto__"||T==="constructor"||T==="prototype")return o;if(g!=v){var k=w[T];C=d?d(k,T,w):t,C===t&&(C=Me(k)?k:Xn(u[g+1])?[]:{})}Po(w,T,C),w=w[T]}return o}var v_=Hu?function(o,u){return Hu.set(o,u),o}:Ft,Nb=Gu?function(o,u){return Gu(o,"toString",{configurable:!0,enumerable:!1,value:Od(u),writable:!0})}:Ft;function Vb(o){return cc(ps(o))}function on(o,u,c){var d=-1,g=o.length;u<0&&(u=-u>g?0:g+u),c=c>g?g:c,c<0&&(c+=g),g=u>c?0:c-u>>>0,u>>>=0;for(var y=S(g);++d<g;)y[d]=o[d+u];return y}function Ob(o,u){var c;return Er(o,function(d,g,y){return c=u(d,g,y),!c}),!!c}function ec(o,u,c){var d=0,g=o==null?d:o.length;if(typeof u=="number"&&u===u&&g<=M0){for(;d<g;){var y=d+g>>>1,v=o[y];v!==null&&!Ht(v)&&(c?v<=u:v<u)?d=y+1:g=y}return g}return cd(o,u,Ft,c)}function cd(o,u,c,d){var g=0,y=o==null?0:o.length;if(y===0)return 0;u=c(u);for(var v=u!==u,w=u===null,T=Ht(u),C=u===t;g<y;){var k=Ku((g+y)/2),x=c(o[k]),U=x!==t,G=x===null,J=x===x,se=Ht(x);if(v)var X=d||J;else C?X=J&&(d||U):w?X=J&&U&&(d||!G):T?X=J&&U&&!G&&(d||!se):G||se?X=!1:X=d?x<=u:x<u;X?g=k+1:y=k}return vt(y,L0)}function I_(o,u){for(var c=-1,d=o.length,g=0,y=[];++c<d;){var v=o[c],w=u?u(v):v;if(!c||!mn(w,T)){var T=w;y[g++]=v===0?0:v}}return y}function w_(o){return typeof o=="number"?o:Ht(o)?Ru:+o}function Kt(o){if(typeof o=="string")return o;if(te(o))return xe(o,Kt)+"";if(Ht(o))return Zm?Zm.call(o):"";var u=o+"";return u=="0"&&1/o==-ii?"-0":u}function Tr(o,u,c){var d=-1,g=Nu,y=o.length,v=!0,w=[],T=w;if(c)v=!1,g=Fh;else if(y>=i){var C=u?null:Kb(o);if(C)return Ou(C);v=!1,g=Eo,T=new ui}else T=u?[]:w;e:for(;++d<y;){var k=o[d],x=u?u(k):k;if(k=c||k!==0?k:0,v&&x===x){for(var U=T.length;U--;)if(T[U]===x)continue e;u&&T.push(x),w.push(k)}else g(T,x,c)||(T!==w&&T.push(x),w.push(k))}return w}function ld(o,u){return u=Ar(u,o),o=Q_(o,u),o==null||delete o[Rn(an(u))]}function E_(o,u,c,d){return xo(o,u,c(li(o,u)),d)}function tc(o,u,c,d){for(var g=o.length,y=d?g:-1;(d?y--:++y<g)&&u(o[y],y,o););return c?on(o,d?0:y,d?y+1:g):on(o,d?y+1:0,d?g:y)}function T_(o,u){var c=o;return c instanceof le&&(c=c.value()),Uh(u,function(d,g){return g.func.apply(g.thisArg,vr([d],g.args))},c)}function hd(o,u,c){var d=o.length;if(d<2)return d?Tr(o[0]):[];for(var g=-1,y=S(d);++g<d;)for(var v=o[g],w=-1;++w<d;)w!=g&&(y[g]=Co(y[g]||v,o[w],u,c));return Tr(lt(y,1),u,c)}function A_(o,u,c){for(var d=-1,g=o.length,y=u.length,v={};++d<g;){var w=d<y?u[d]:t;c(v,o[d],w)}return v}function dd(o){return Ke(o)?o:[]}function fd(o){return typeof o=="function"?o:Ft}function Ar(o,u){return te(o)?o:Ed(o,u)?[o]:Z_(Ie(o))}var Lb=oe;function Rr(o,u,c){var d=o.length;return c=c===t?d:c,!u&&c>=d?o:on(o,u,c)}var R_=TS||function(o){return ct.clearTimeout(o)};function S_(o,u){if(u)return o.slice();var c=o.length,d=Hm?Hm(c):new o.constructor(c);return o.copy(d),d}function pd(o){var u=new o.constructor(o.byteLength);return new qu(u).set(new qu(o)),u}function Mb(o,u){var c=u?pd(o.buffer):o.buffer;return new o.constructor(c,o.byteOffset,o.byteLength)}function Fb(o){var u=new o.constructor(o.source,cm.exec(o));return u.lastIndex=o.lastIndex,u}function Ub(o){return bo?Se(bo.call(o)):{}}function b_(o,u){var c=u?pd(o.buffer):o.buffer;return new o.constructor(c,o.byteOffset,o.length)}function P_(o,u){if(o!==u){var c=o!==t,d=o===null,g=o===o,y=Ht(o),v=u!==t,w=u===null,T=u===u,C=Ht(u);if(!w&&!C&&!y&&o>u||y&&v&&T&&!w&&!C||d&&v&&T||!c&&T||!g)return 1;if(!d&&!y&&!C&&o<u||C&&c&&g&&!d&&!y||w&&c&&g||!v&&g||!T)return-1}return 0}function Bb(o,u,c){for(var d=-1,g=o.criteria,y=u.criteria,v=g.length,w=c.length;++d<v;){var T=P_(g[d],y[d]);if(T){if(d>=w)return T;var C=c[d];return T*(C=="desc"?-1:1)}}return o.index-u.index}function C_(o,u,c,d){for(var g=-1,y=o.length,v=c.length,w=-1,T=u.length,C=Ze(y-v,0),k=S(T+C),x=!d;++w<T;)k[w]=u[w];for(;++g<v;)(x||g<y)&&(k[c[g]]=o[g]);for(;C--;)k[w++]=o[g++];return k}function k_(o,u,c,d){for(var g=-1,y=o.length,v=-1,w=c.length,T=-1,C=u.length,k=Ze(y-w,0),x=S(k+C),U=!d;++g<k;)x[g]=o[g];for(var G=g;++T<C;)x[G+T]=u[T];for(;++v<w;)(U||g<y)&&(x[G+c[v]]=o[g++]);return x}function Ot(o,u){var c=-1,d=o.length;for(u||(u=S(d));++c<d;)u[c]=o[c];return u}function An(o,u,c,d){var g=!c;c||(c={});for(var y=-1,v=u.length;++y<v;){var w=u[y],T=d?d(c[w],o[w],w,c,o):t;T===t&&(T=o[w]),g?Qn(c,w,T):Po(c,w,T)}return c}function qb(o,u){return An(o,wd(o),u)}function $b(o,u){return An(o,W_(o),u)}function nc(o,u){return function(c,d){var g=te(c)?HR:lb,y=u?u():{};return g(c,o,Q(d,2),y)}}function ls(o){return oe(function(u,c){var d=-1,g=c.length,y=g>1?c[g-1]:t,v=g>2?c[2]:t;for(y=o.length>3&&typeof y=="function"?(g--,y):t,v&&St(c[0],c[1],v)&&(y=g<3?t:y,g=1),u=Se(u);++d<g;){var w=c[d];w&&o(u,w,d,y)}return u})}function D_(o,u){return function(c,d){if(c==null)return c;if(!Lt(c))return o(c,d);for(var g=c.length,y=u?g:-1,v=Se(c);(u?y--:++y<g)&&d(v[y],y,v)!==!1;);return c}}function x_(o){return function(u,c,d){for(var g=-1,y=Se(u),v=d(u),w=v.length;w--;){var T=v[o?w:++g];if(c(y[T],T,y)===!1)break}return u}}function Wb(o,u,c){var d=u&V,g=No(o);function y(){var v=this&&this!==ct&&this instanceof y?g:o;return v.apply(d?c:this,arguments)}return y}function N_(o){return function(u){u=Ie(u);var c=rs(u)?pn(u):t,d=c?c[0]:u.charAt(0),g=c?Rr(c,1).join(""):u.slice(1);return d[o]()+g}}function hs(o){return function(u){return Uh(Dy(ky(u).replace(NR,"")),o,"")}}function No(o){return function(){var u=arguments;switch(u.length){case 0:return new o;case 1:return new o(u[0]);case 2:return new o(u[0],u[1]);case 3:return new o(u[0],u[1],u[2]);case 4:return new o(u[0],u[1],u[2],u[3]);case 5:return new o(u[0],u[1],u[2],u[3],u[4]);case 6:return new o(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new o(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var c=cs(o.prototype),d=o.apply(c,u);return Me(d)?d:c}}function Gb(o,u,c){var d=No(o);function g(){for(var y=arguments.length,v=S(y),w=y,T=ds(g);w--;)v[w]=arguments[w];var C=y<3&&v[0]!==T&&v[y-1]!==T?[]:Ir(v,T);if(y-=C.length,y<c)return F_(o,u,rc,g.placeholder,t,v,C,t,t,c-y);var k=this&&this!==ct&&this instanceof g?d:o;return Gt(k,this,v)}return g}function V_(o){return function(u,c,d){var g=Se(u);if(!Lt(u)){var y=Q(c,3);u=tt(u),c=function(w){return y(g[w],w,g)}}var v=o(u,c,d);return v>-1?g[y?u[v]:v]:t}}function O_(o){return Jn(function(u){var c=u.length,d=c,g=rn.prototype.thru;for(o&&u.reverse();d--;){var y=u[d];if(typeof y!="function")throw new nn(a);if(g&&!v&&ac(y)=="wrapper")var v=new rn([],!0)}for(d=v?d:c;++d<c;){y=u[d];var w=ac(y),T=w=="wrapper"?vd(y):t;T&&Td(T[0])&&T[1]==(we|j|de|Vt)&&!T[4].length&&T[9]==1?v=v[ac(T[0])].apply(v,T[3]):v=y.length==1&&Td(y)?v[w]():v.thru(y)}return function(){var C=arguments,k=C[0];if(v&&C.length==1&&te(k))return v.plant(k).value();for(var x=0,U=c?u[x].apply(this,C):k;++x<c;)U=u[x].call(this,U);return U}})}function rc(o,u,c,d,g,y,v,w,T,C){var k=u&we,x=u&V,U=u&Y,G=u&(j|ye),J=u&zn,se=U?t:No(o);function X(){for(var ue=arguments.length,fe=S(ue),jt=ue;jt--;)fe[jt]=arguments[jt];if(G)var bt=ds(X),Qt=nS(fe,bt);if(d&&(fe=C_(fe,d,g,G)),y&&(fe=k_(fe,y,v,G)),ue-=Qt,G&&ue<C){var He=Ir(fe,bt);return F_(o,u,rc,X.placeholder,c,fe,He,w,T,C-ue)}var _n=x?c:this,tr=U?_n[o]:o;return ue=fe.length,w?fe=lP(fe,w):J&&ue>1&&fe.reverse(),k&&T<ue&&(fe.length=T),this&&this!==ct&&this instanceof X&&(tr=se||No(tr)),tr.apply(_n,fe)}return X}function L_(o,u){return function(c,d){return yb(c,o,u(d),{})}}function ic(o,u){return function(c,d){var g;if(c===t&&d===t)return u;if(c!==t&&(g=c),d!==t){if(g===t)return d;typeof c=="string"||typeof d=="string"?(c=Kt(c),d=Kt(d)):(c=w_(c),d=w_(d)),g=o(c,d)}return g}}function gd(o){return Jn(function(u){return u=xe(u,zt(Q())),oe(function(c){var d=this;return o(u,function(g){return Gt(g,d,c)})})})}function sc(o,u){u=u===t?" ":Kt(u);var c=u.length;if(c<2)return c?ud(u,o):u;var d=ud(u,zu(o/is(u)));return rs(u)?Rr(pn(d),0,o).join(""):d.slice(0,o)}function zb(o,u,c,d){var g=u&V,y=No(o);function v(){for(var w=-1,T=arguments.length,C=-1,k=d.length,x=S(k+T),U=this&&this!==ct&&this instanceof v?y:o;++C<k;)x[C]=d[C];for(;T--;)x[C++]=arguments[++w];return Gt(U,g?c:this,x)}return v}function M_(o){return function(u,c,d){return d&&typeof d!="number"&&St(u,c,d)&&(c=d=t),u=er(u),c===t?(c=u,u=0):c=er(c),d=d===t?u<c?1:-1:er(d),kb(u,c,d,o)}}function oc(o){return function(u,c){return typeof u=="string"&&typeof c=="string"||(u=un(u),c=un(c)),o(u,c)}}function F_(o,u,c,d,g,y,v,w,T,C){var k=u&j,x=k?v:t,U=k?t:v,G=k?y:t,J=k?t:y;u|=k?de:me,u&=~(k?me:de),u&ae||(u&=~(V|Y));var se=[o,u,g,G,x,J,U,w,T,C],X=c.apply(t,se);return Td(o)&&Y_(X,se),X.placeholder=d,J_(X,o,u)}function md(o){var u=Xe[o];return function(c,d){if(c=un(c),d=d==null?0:vt(ie(d),292),d&&Jm(c)){var g=(Ie(c)+"e").split("e"),y=u(g[0]+"e"+(+g[1]+d));return g=(Ie(y)+"e").split("e"),+(g[0]+"e"+(+g[1]-d))}return u(c)}}var Kb=as&&1/Ou(new as([,-0]))[1]==ii?function(o){return new as(o)}:Fd;function U_(o){return function(u){var c=It(u);return c==dn?Kh(u):c==fn?cS(u):tS(u,o(u))}}function Yn(o,u,c,d,g,y,v,w){var T=u&Y;if(!T&&typeof o!="function")throw new nn(a);var C=d?d.length:0;if(C||(u&=~(de|me),d=g=t),v=v===t?v:Ze(ie(v),0),w=w===t?w:ie(w),C-=g?g.length:0,u&me){var k=d,x=g;d=g=t}var U=T?t:vd(o),G=[o,u,c,d,g,k,x,y,v,w];if(U&&aP(G,U),o=G[0],u=G[1],c=G[2],d=G[3],g=G[4],w=G[9]=G[9]===t?T?0:o.length:Ze(G[9]-C,0),!w&&u&(j|ye)&&(u&=~(j|ye)),!u||u==V)var J=Wb(o,u,c);else u==j||u==ye?J=Gb(o,u,w):(u==de||u==(V|de))&&!g.length?J=zb(o,u,c,d):J=rc.apply(t,G);var se=U?v_:Y_;return J_(se(J,G),o,u)}function B_(o,u,c,d){return o===t||mn(o,os[c])&&!Ee.call(d,c)?u:o}function q_(o,u,c,d,g,y){return Me(o)&&Me(u)&&(y.set(u,o),Zu(o,u,t,q_,y),y.delete(u)),o}function Hb(o){return Lo(o)?t:o}function $_(o,u,c,d,g,y){var v=c&L,w=o.length,T=u.length;if(w!=T&&!(v&&T>w))return!1;var C=y.get(o),k=y.get(u);if(C&&k)return C==u&&k==o;var x=-1,U=!0,G=c&M?new ui:t;for(y.set(o,u),y.set(u,o);++x<w;){var J=o[x],se=u[x];if(d)var X=v?d(se,J,x,u,o,y):d(J,se,x,o,u,y);if(X!==t){if(X)continue;U=!1;break}if(G){if(!Bh(u,function(ue,fe){if(!Eo(G,fe)&&(J===ue||g(J,ue,c,d,y)))return G.push(fe)})){U=!1;break}}else if(!(J===se||g(J,se,c,d,y))){U=!1;break}}return y.delete(o),y.delete(u),U}function jb(o,u,c,d,g,y,v){switch(c){case es:if(o.byteLength!=u.byteLength||o.byteOffset!=u.byteOffset)return!1;o=o.buffer,u=u.buffer;case wo:return!(o.byteLength!=u.byteLength||!y(new qu(o),new qu(u)));case go:case mo:case _o:return mn(+o,+u);case bu:return o.name==u.name&&o.message==u.message;case yo:case vo:return o==u+"";case dn:var w=Kh;case fn:var T=d&L;if(w||(w=Ou),o.size!=u.size&&!T)return!1;var C=v.get(o);if(C)return C==u;d|=M,v.set(o,u);var k=$_(w(o),w(u),d,g,y,v);return v.delete(o),k;case Cu:if(bo)return bo.call(o)==bo.call(u)}return!1}function Qb(o,u,c,d,g,y){var v=c&L,w=_d(o),T=w.length,C=_d(u),k=C.length;if(T!=k&&!v)return!1;for(var x=T;x--;){var U=w[x];if(!(v?U in u:Ee.call(u,U)))return!1}var G=y.get(o),J=y.get(u);if(G&&J)return G==u&&J==o;var se=!0;y.set(o,u),y.set(u,o);for(var X=v;++x<T;){U=w[x];var ue=o[U],fe=u[U];if(d)var jt=v?d(fe,ue,U,u,o,y):d(ue,fe,U,o,u,y);if(!(jt===t?ue===fe||g(ue,fe,c,d,y):jt)){se=!1;break}X||(X=U=="constructor")}if(se&&!X){var bt=o.constructor,Qt=u.constructor;bt!=Qt&&"constructor"in o&&"constructor"in u&&!(typeof bt=="function"&&bt instanceof bt&&typeof Qt=="function"&&Qt instanceof Qt)&&(se=!1)}return y.delete(o),y.delete(u),se}function Jn(o){return Rd(j_(o,t,ry),o+"")}function _d(o){return u_(o,tt,wd)}function yd(o){return u_(o,Mt,W_)}var vd=Hu?function(o){return Hu.get(o)}:Fd;function ac(o){for(var u=o.name+"",c=us[u],d=Ee.call(us,u)?c.length:0;d--;){var g=c[d],y=g.func;if(y==null||y==o)return g.name}return u}function ds(o){var u=Ee.call(_,"placeholder")?_:o;return u.placeholder}function Q(){var o=_.iteratee||Ld;return o=o===Ld?h_:o,arguments.length?o(arguments[0],arguments[1]):o}function uc(o,u){var c=o.__data__;return rP(u)?c[typeof u=="string"?"string":"hash"]:c.map}function Id(o){for(var u=tt(o),c=u.length;c--;){var d=u[c],g=o[d];u[c]=[d,g,K_(g)]}return u}function hi(o,u){var c=oS(o,u);return l_(c)?c:t}function Yb(o){var u=Ee.call(o,oi),c=o[oi];try{o[oi]=t;var d=!0}catch{}var g=Uu.call(o);return d&&(u?o[oi]=c:delete o[oi]),g}var wd=jh?function(o){return o==null?[]:(o=Se(o),yr(jh(o),function(u){return Qm.call(o,u)}))}:Ud,W_=jh?function(o){for(var u=[];o;)vr(u,wd(o)),o=$u(o);return u}:Ud,It=Rt;(Qh&&It(new Qh(new ArrayBuffer(1)))!=es||Ao&&It(new Ao)!=dn||Yh&&It(Yh.resolve())!=sm||as&&It(new as)!=fn||Ro&&It(new Ro)!=Io)&&(It=function(o){var u=Rt(o),c=u==Kn?o.constructor:t,d=c?di(c):"";if(d)switch(d){case xS:return es;case NS:return dn;case VS:return sm;case OS:return fn;case LS:return Io}return u});function Jb(o,u,c){for(var d=-1,g=c.length;++d<g;){var y=c[d],v=y.size;switch(y.type){case"drop":o+=v;break;case"dropRight":u-=v;break;case"take":u=vt(u,o+v);break;case"takeRight":o=Ze(o,u-v);break}}return{start:o,end:u}}function Xb(o){var u=o.match(iR);return u?u[1].split(sR):[]}function G_(o,u,c){u=Ar(u,o);for(var d=-1,g=u.length,y=!1;++d<g;){var v=Rn(u[d]);if(!(y=o!=null&&c(o,v)))break;o=o[v]}return y||++d!=g?y:(g=o==null?0:o.length,!!g&&gc(g)&&Xn(v,g)&&(te(o)||fi(o)))}function Zb(o){var u=o.length,c=new o.constructor(u);return u&&typeof o[0]=="string"&&Ee.call(o,"index")&&(c.index=o.index,c.input=o.input),c}function z_(o){return typeof o.constructor=="function"&&!Vo(o)?cs($u(o)):{}}function eP(o,u,c){var d=o.constructor;switch(u){case wo:return pd(o);case go:case mo:return new d(+o);case es:return Mb(o,c);case Ih:case wh:case Eh:case Th:case Ah:case Rh:case Sh:case bh:case Ph:return b_(o,c);case dn:return new d;case _o:case vo:return new d(o);case yo:return Fb(o);case fn:return new d;case Cu:return Ub(o)}}function tP(o,u){var c=u.length;if(!c)return o;var d=c-1;return u[d]=(c>1?"& ":"")+u[d],u=u.join(c>2?", ":" "),o.replace(rR,`{
/* [wrapped with `+u+`] */
`)}function nP(o){return te(o)||fi(o)||!!(Ym&&o&&o[Ym])}function Xn(o,u){var c=typeof o;return u=u??_r,!!u&&(c=="number"||c!="symbol"&&pR.test(o))&&o>-1&&o%1==0&&o<u}function St(o,u,c){if(!Me(c))return!1;var d=typeof u;return(d=="number"?Lt(c)&&Xn(u,c.length):d=="string"&&u in c)?mn(c[u],o):!1}function Ed(o,u){if(te(o))return!1;var c=typeof o;return c=="number"||c=="symbol"||c=="boolean"||o==null||Ht(o)?!0:Z0.test(o)||!X0.test(o)||u!=null&&o in Se(u)}function rP(o){var u=typeof o;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?o!=="__proto__":o===null}function Td(o){var u=ac(o),c=_[u];if(typeof c!="function"||!(u in le.prototype))return!1;if(o===c)return!0;var d=vd(c);return!!d&&o===d[0]}function iP(o){return!!Km&&Km in o}var sP=Mu?Zn:Bd;function Vo(o){var u=o&&o.constructor,c=typeof u=="function"&&u.prototype||os;return o===c}function K_(o){return o===o&&!Me(o)}function H_(o,u){return function(c){return c==null?!1:c[o]===u&&(u!==t||o in Se(c))}}function oP(o){var u=fc(o,function(d){return c.size===f&&c.clear(),d}),c=u.cache;return u}function aP(o,u){var c=o[1],d=u[1],g=c|d,y=g<(V|Y|we),v=d==we&&c==j||d==we&&c==Vt&&o[7].length<=u[8]||d==(we|Vt)&&u[7].length<=u[8]&&c==j;if(!(y||v))return o;d&V&&(o[2]=u[2],g|=c&V?0:ae);var w=u[3];if(w){var T=o[3];o[3]=T?C_(T,w,u[4]):w,o[4]=T?Ir(o[3],p):u[4]}return w=u[5],w&&(T=o[5],o[5]=T?k_(T,w,u[6]):w,o[6]=T?Ir(o[5],p):u[6]),w=u[7],w&&(o[7]=w),d&we&&(o[8]=o[8]==null?u[8]:vt(o[8],u[8])),o[9]==null&&(o[9]=u[9]),o[0]=u[0],o[1]=g,o}function uP(o){var u=[];if(o!=null)for(var c in Se(o))u.push(c);return u}function cP(o){return Uu.call(o)}function j_(o,u,c){return u=Ze(u===t?o.length-1:u,0),function(){for(var d=arguments,g=-1,y=Ze(d.length-u,0),v=S(y);++g<y;)v[g]=d[u+g];g=-1;for(var w=S(u+1);++g<u;)w[g]=d[g];return w[u]=c(v),Gt(o,this,w)}}function Q_(o,u){return u.length<2?o:li(o,on(u,0,-1))}function lP(o,u){for(var c=o.length,d=vt(u.length,c),g=Ot(o);d--;){var y=u[d];o[d]=Xn(y,c)?g[y]:t}return o}function Ad(o,u){if(!(u==="constructor"&&typeof o[u]=="function")&&u!="__proto__")return o[u]}var Y_=X_(v_),Oo=RS||function(o,u){return ct.setTimeout(o,u)},Rd=X_(Nb);function J_(o,u,c){var d=u+"";return Rd(o,tP(d,hP(Xb(d),c)))}function X_(o){var u=0,c=0;return function(){var d=CS(),g=x0-(d-c);if(c=d,g>0){if(++u>=D0)return arguments[0]}else u=0;return o.apply(t,arguments)}}function cc(o,u){var c=-1,d=o.length,g=d-1;for(u=u===t?d:u;++c<u;){var y=ad(c,g),v=o[y];o[y]=o[c],o[c]=v}return o.length=u,o}var Z_=oP(function(o){var u=[];return o.charCodeAt(0)===46&&u.push(""),o.replace(eR,function(c,d,g,y){u.push(g?y.replace(uR,"$1"):d||c)}),u});function Rn(o){if(typeof o=="string"||Ht(o))return o;var u=o+"";return u=="0"&&1/o==-ii?"-0":u}function di(o){if(o!=null){try{return Fu.call(o)}catch{}try{return o+""}catch{}}return""}function hP(o,u){return tn(F0,function(c){var d="_."+c[0];u&c[1]&&!Nu(o,d)&&o.push(d)}),o.sort()}function ey(o){if(o instanceof le)return o.clone();var u=new rn(o.__wrapped__,o.__chain__);return u.__actions__=Ot(o.__actions__),u.__index__=o.__index__,u.__values__=o.__values__,u}function dP(o,u,c){(c?St(o,u,c):u===t)?u=1:u=Ze(ie(u),0);var d=o==null?0:o.length;if(!d||u<1)return[];for(var g=0,y=0,v=S(zu(d/u));g<d;)v[y++]=on(o,g,g+=u);return v}function fP(o){for(var u=-1,c=o==null?0:o.length,d=0,g=[];++u<c;){var y=o[u];y&&(g[d++]=y)}return g}function pP(){var o=arguments.length;if(!o)return[];for(var u=S(o-1),c=arguments[0],d=o;d--;)u[d-1]=arguments[d];return vr(te(c)?Ot(c):[c],lt(u,1))}var gP=oe(function(o,u){return Ke(o)?Co(o,lt(u,1,Ke,!0)):[]}),mP=oe(function(o,u){var c=an(u);return Ke(c)&&(c=t),Ke(o)?Co(o,lt(u,1,Ke,!0),Q(c,2)):[]}),_P=oe(function(o,u){var c=an(u);return Ke(c)&&(c=t),Ke(o)?Co(o,lt(u,1,Ke,!0),t,c):[]});function yP(o,u,c){var d=o==null?0:o.length;return d?(u=c||u===t?1:ie(u),on(o,u<0?0:u,d)):[]}function vP(o,u,c){var d=o==null?0:o.length;return d?(u=c||u===t?1:ie(u),u=d-u,on(o,0,u<0?0:u)):[]}function IP(o,u){return o&&o.length?tc(o,Q(u,3),!0,!0):[]}function wP(o,u){return o&&o.length?tc(o,Q(u,3),!0):[]}function EP(o,u,c,d){var g=o==null?0:o.length;return g?(c&&typeof c!="number"&&St(o,u,c)&&(c=0,d=g),pb(o,u,c,d)):[]}function ty(o,u,c){var d=o==null?0:o.length;if(!d)return-1;var g=c==null?0:ie(c);return g<0&&(g=Ze(d+g,0)),Vu(o,Q(u,3),g)}function ny(o,u,c){var d=o==null?0:o.length;if(!d)return-1;var g=d-1;return c!==t&&(g=ie(c),g=c<0?Ze(d+g,0):vt(g,d-1)),Vu(o,Q(u,3),g,!0)}function ry(o){var u=o==null?0:o.length;return u?lt(o,1):[]}function TP(o){var u=o==null?0:o.length;return u?lt(o,ii):[]}function AP(o,u){var c=o==null?0:o.length;return c?(u=u===t?1:ie(u),lt(o,u)):[]}function RP(o){for(var u=-1,c=o==null?0:o.length,d={};++u<c;){var g=o[u];d[g[0]]=g[1]}return d}function iy(o){return o&&o.length?o[0]:t}function SP(o,u,c){var d=o==null?0:o.length;if(!d)return-1;var g=c==null?0:ie(c);return g<0&&(g=Ze(d+g,0)),ns(o,u,g)}function bP(o){var u=o==null?0:o.length;return u?on(o,0,-1):[]}var PP=oe(function(o){var u=xe(o,dd);return u.length&&u[0]===o[0]?nd(u):[]}),CP=oe(function(o){var u=an(o),c=xe(o,dd);return u===an(c)?u=t:c.pop(),c.length&&c[0]===o[0]?nd(c,Q(u,2)):[]}),kP=oe(function(o){var u=an(o),c=xe(o,dd);return u=typeof u=="function"?u:t,u&&c.pop(),c.length&&c[0]===o[0]?nd(c,t,u):[]});function DP(o,u){return o==null?"":bS.call(o,u)}function an(o){var u=o==null?0:o.length;return u?o[u-1]:t}function xP(o,u,c){var d=o==null?0:o.length;if(!d)return-1;var g=d;return c!==t&&(g=ie(c),g=g<0?Ze(d+g,0):vt(g,d-1)),u===u?hS(o,u,g):Vu(o,Fm,g,!0)}function NP(o,u){return o&&o.length?g_(o,ie(u)):t}var VP=oe(sy);function sy(o,u){return o&&o.length&&u&&u.length?od(o,u):o}function OP(o,u,c){return o&&o.length&&u&&u.length?od(o,u,Q(c,2)):o}function LP(o,u,c){return o&&o.length&&u&&u.length?od(o,u,t,c):o}var MP=Jn(function(o,u){var c=o==null?0:o.length,d=Xh(o,u);return y_(o,xe(u,function(g){return Xn(g,c)?+g:g}).sort(P_)),d});function FP(o,u){var c=[];if(!(o&&o.length))return c;var d=-1,g=[],y=o.length;for(u=Q(u,3);++d<y;){var v=o[d];u(v,d,o)&&(c.push(v),g.push(d))}return y_(o,g),c}function Sd(o){return o==null?o:DS.call(o)}function UP(o,u,c){var d=o==null?0:o.length;return d?(c&&typeof c!="number"&&St(o,u,c)?(u=0,c=d):(u=u==null?0:ie(u),c=c===t?d:ie(c)),on(o,u,c)):[]}function BP(o,u){return ec(o,u)}function qP(o,u,c){return cd(o,u,Q(c,2))}function $P(o,u){var c=o==null?0:o.length;if(c){var d=ec(o,u);if(d<c&&mn(o[d],u))return d}return-1}function WP(o,u){return ec(o,u,!0)}function GP(o,u,c){return cd(o,u,Q(c,2),!0)}function zP(o,u){var c=o==null?0:o.length;if(c){var d=ec(o,u,!0)-1;if(mn(o[d],u))return d}return-1}function KP(o){return o&&o.length?I_(o):[]}function HP(o,u){return o&&o.length?I_(o,Q(u,2)):[]}function jP(o){var u=o==null?0:o.length;return u?on(o,1,u):[]}function QP(o,u,c){return o&&o.length?(u=c||u===t?1:ie(u),on(o,0,u<0?0:u)):[]}function YP(o,u,c){var d=o==null?0:o.length;return d?(u=c||u===t?1:ie(u),u=d-u,on(o,u<0?0:u,d)):[]}function JP(o,u){return o&&o.length?tc(o,Q(u,3),!1,!0):[]}function XP(o,u){return o&&o.length?tc(o,Q(u,3)):[]}var ZP=oe(function(o){return Tr(lt(o,1,Ke,!0))}),eC=oe(function(o){var u=an(o);return Ke(u)&&(u=t),Tr(lt(o,1,Ke,!0),Q(u,2))}),tC=oe(function(o){var u=an(o);return u=typeof u=="function"?u:t,Tr(lt(o,1,Ke,!0),t,u)});function nC(o){return o&&o.length?Tr(o):[]}function rC(o,u){return o&&o.length?Tr(o,Q(u,2)):[]}function iC(o,u){return u=typeof u=="function"?u:t,o&&o.length?Tr(o,t,u):[]}function bd(o){if(!(o&&o.length))return[];var u=0;return o=yr(o,function(c){if(Ke(c))return u=Ze(c.length,u),!0}),Gh(u,function(c){return xe(o,qh(c))})}function oy(o,u){if(!(o&&o.length))return[];var c=bd(o);return u==null?c:xe(c,function(d){return Gt(u,t,d)})}var sC=oe(function(o,u){return Ke(o)?Co(o,u):[]}),oC=oe(function(o){return hd(yr(o,Ke))}),aC=oe(function(o){var u=an(o);return Ke(u)&&(u=t),hd(yr(o,Ke),Q(u,2))}),uC=oe(function(o){var u=an(o);return u=typeof u=="function"?u:t,hd(yr(o,Ke),t,u)}),cC=oe(bd);function lC(o,u){return A_(o||[],u||[],Po)}function hC(o,u){return A_(o||[],u||[],xo)}var dC=oe(function(o){var u=o.length,c=u>1?o[u-1]:t;return c=typeof c=="function"?(o.pop(),c):t,oy(o,c)});function ay(o){var u=_(o);return u.__chain__=!0,u}function fC(o,u){return u(o),o}function lc(o,u){return u(o)}var pC=Jn(function(o){var u=o.length,c=u?o[0]:0,d=this.__wrapped__,g=function(y){return Xh(y,o)};return u>1||this.__actions__.length||!(d instanceof le)||!Xn(c)?this.thru(g):(d=d.slice(c,+c+(u?1:0)),d.__actions__.push({func:lc,args:[g],thisArg:t}),new rn(d,this.__chain__).thru(function(y){return u&&!y.length&&y.push(t),y}))});function gC(){return ay(this)}function mC(){return new rn(this.value(),this.__chain__)}function _C(){this.__values__===t&&(this.__values__=wy(this.value()));var o=this.__index__>=this.__values__.length,u=o?t:this.__values__[this.__index__++];return{done:o,value:u}}function yC(){return this}function vC(o){for(var u,c=this;c instanceof Qu;){var d=ey(c);d.__index__=0,d.__values__=t,u?g.__wrapped__=d:u=d;var g=d;c=c.__wrapped__}return g.__wrapped__=o,u}function IC(){var o=this.__wrapped__;if(o instanceof le){var u=o;return this.__actions__.length&&(u=new le(this)),u=u.reverse(),u.__actions__.push({func:lc,args:[Sd],thisArg:t}),new rn(u,this.__chain__)}return this.thru(Sd)}function wC(){return T_(this.__wrapped__,this.__actions__)}var EC=nc(function(o,u,c){Ee.call(o,c)?++o[c]:Qn(o,c,1)});function TC(o,u,c){var d=te(o)?Lm:fb;return c&&St(o,u,c)&&(u=t),d(o,Q(u,3))}function AC(o,u){var c=te(o)?yr:o_;return c(o,Q(u,3))}var RC=V_(ty),SC=V_(ny);function bC(o,u){return lt(hc(o,u),1)}function PC(o,u){return lt(hc(o,u),ii)}function CC(o,u,c){return c=c===t?1:ie(c),lt(hc(o,u),c)}function uy(o,u){var c=te(o)?tn:Er;return c(o,Q(u,3))}function cy(o,u){var c=te(o)?jR:s_;return c(o,Q(u,3))}var kC=nc(function(o,u,c){Ee.call(o,c)?o[c].push(u):Qn(o,c,[u])});function DC(o,u,c,d){o=Lt(o)?o:ps(o),c=c&&!d?ie(c):0;var g=o.length;return c<0&&(c=Ze(g+c,0)),mc(o)?c<=g&&o.indexOf(u,c)>-1:!!g&&ns(o,u,c)>-1}var xC=oe(function(o,u,c){var d=-1,g=typeof u=="function",y=Lt(o)?S(o.length):[];return Er(o,function(v){y[++d]=g?Gt(u,v,c):ko(v,u,c)}),y}),NC=nc(function(o,u,c){Qn(o,c,u)});function hc(o,u){var c=te(o)?xe:d_;return c(o,Q(u,3))}function VC(o,u,c,d){return o==null?[]:(te(u)||(u=u==null?[]:[u]),c=d?t:c,te(c)||(c=c==null?[]:[c]),m_(o,u,c))}var OC=nc(function(o,u,c){o[c?0:1].push(u)},function(){return[[],[]]});function LC(o,u,c){var d=te(o)?Uh:Bm,g=arguments.length<3;return d(o,Q(u,4),c,g,Er)}function MC(o,u,c){var d=te(o)?QR:Bm,g=arguments.length<3;return d(o,Q(u,4),c,g,s_)}function FC(o,u){var c=te(o)?yr:o_;return c(o,pc(Q(u,3)))}function UC(o){var u=te(o)?t_:Db;return u(o)}function BC(o,u,c){(c?St(o,u,c):u===t)?u=1:u=ie(u);var d=te(o)?ub:xb;return d(o,u)}function qC(o){var u=te(o)?cb:Vb;return u(o)}function $C(o){if(o==null)return 0;if(Lt(o))return mc(o)?is(o):o.length;var u=It(o);return u==dn||u==fn?o.size:id(o).length}function WC(o,u,c){var d=te(o)?Bh:Ob;return c&&St(o,u,c)&&(u=t),d(o,Q(u,3))}var GC=oe(function(o,u){if(o==null)return[];var c=u.length;return c>1&&St(o,u[0],u[1])?u=[]:c>2&&St(u[0],u[1],u[2])&&(u=[u[0]]),m_(o,lt(u,1),[])}),dc=AS||function(){return ct.Date.now()};function zC(o,u){if(typeof u!="function")throw new nn(a);return o=ie(o),function(){if(--o<1)return u.apply(this,arguments)}}function ly(o,u,c){return u=c?t:u,u=o&&u==null?o.length:u,Yn(o,we,t,t,t,t,u)}function hy(o,u){var c;if(typeof u!="function")throw new nn(a);return o=ie(o),function(){return--o>0&&(c=u.apply(this,arguments)),o<=1&&(u=t),c}}var Pd=oe(function(o,u,c){var d=V;if(c.length){var g=Ir(c,ds(Pd));d|=de}return Yn(o,d,u,c,g)}),dy=oe(function(o,u,c){var d=V|Y;if(c.length){var g=Ir(c,ds(dy));d|=de}return Yn(u,d,o,c,g)});function fy(o,u,c){u=c?t:u;var d=Yn(o,j,t,t,t,t,t,u);return d.placeholder=fy.placeholder,d}function py(o,u,c){u=c?t:u;var d=Yn(o,ye,t,t,t,t,t,u);return d.placeholder=py.placeholder,d}function gy(o,u,c){var d,g,y,v,w,T,C=0,k=!1,x=!1,U=!0;if(typeof o!="function")throw new nn(a);u=un(u)||0,Me(c)&&(k=!!c.leading,x="maxWait"in c,y=x?Ze(un(c.maxWait)||0,u):y,U="trailing"in c?!!c.trailing:U);function G(He){var _n=d,tr=g;return d=g=t,C=He,v=o.apply(tr,_n),v}function J(He){return C=He,w=Oo(ue,u),k?G(He):v}function se(He){var _n=He-T,tr=He-C,Vy=u-_n;return x?vt(Vy,y-tr):Vy}function X(He){var _n=He-T,tr=He-C;return T===t||_n>=u||_n<0||x&&tr>=y}function ue(){var He=dc();if(X(He))return fe(He);w=Oo(ue,se(He))}function fe(He){return w=t,U&&d?G(He):(d=g=t,v)}function jt(){w!==t&&R_(w),C=0,d=T=g=w=t}function bt(){return w===t?v:fe(dc())}function Qt(){var He=dc(),_n=X(He);if(d=arguments,g=this,T=He,_n){if(w===t)return J(T);if(x)return R_(w),w=Oo(ue,u),G(T)}return w===t&&(w=Oo(ue,u)),v}return Qt.cancel=jt,Qt.flush=bt,Qt}var KC=oe(function(o,u){return i_(o,1,u)}),HC=oe(function(o,u,c){return i_(o,un(u)||0,c)});function jC(o){return Yn(o,zn)}function fc(o,u){if(typeof o!="function"||u!=null&&typeof u!="function")throw new nn(a);var c=function(){var d=arguments,g=u?u.apply(this,d):d[0],y=c.cache;if(y.has(g))return y.get(g);var v=o.apply(this,d);return c.cache=y.set(g,v)||y,v};return c.cache=new(fc.Cache||jn),c}fc.Cache=jn;function pc(o){if(typeof o!="function")throw new nn(a);return function(){var u=arguments;switch(u.length){case 0:return!o.call(this);case 1:return!o.call(this,u[0]);case 2:return!o.call(this,u[0],u[1]);case 3:return!o.call(this,u[0],u[1],u[2])}return!o.apply(this,u)}}function QC(o){return hy(2,o)}var YC=Lb(function(o,u){u=u.length==1&&te(u[0])?xe(u[0],zt(Q())):xe(lt(u,1),zt(Q()));var c=u.length;return oe(function(d){for(var g=-1,y=vt(d.length,c);++g<y;)d[g]=u[g].call(this,d[g]);return Gt(o,this,d)})}),Cd=oe(function(o,u){var c=Ir(u,ds(Cd));return Yn(o,de,t,u,c)}),my=oe(function(o,u){var c=Ir(u,ds(my));return Yn(o,me,t,u,c)}),JC=Jn(function(o,u){return Yn(o,Vt,t,t,t,u)});function XC(o,u){if(typeof o!="function")throw new nn(a);return u=u===t?u:ie(u),oe(o,u)}function ZC(o,u){if(typeof o!="function")throw new nn(a);return u=u==null?0:Ze(ie(u),0),oe(function(c){var d=c[u],g=Rr(c,0,u);return d&&vr(g,d),Gt(o,this,g)})}function e1(o,u,c){var d=!0,g=!0;if(typeof o!="function")throw new nn(a);return Me(c)&&(d="leading"in c?!!c.leading:d,g="trailing"in c?!!c.trailing:g),gy(o,u,{leading:d,maxWait:u,trailing:g})}function t1(o){return ly(o,1)}function n1(o,u){return Cd(fd(u),o)}function r1(){if(!arguments.length)return[];var o=arguments[0];return te(o)?o:[o]}function i1(o){return sn(o,A)}function s1(o,u){return u=typeof u=="function"?u:t,sn(o,A,u)}function o1(o){return sn(o,m|A)}function a1(o,u){return u=typeof u=="function"?u:t,sn(o,m|A,u)}function u1(o,u){return u==null||r_(o,u,tt(u))}function mn(o,u){return o===u||o!==o&&u!==u}var c1=oc(td),l1=oc(function(o,u){return o>=u}),fi=c_(function(){return arguments}())?c_:function(o){return Ue(o)&&Ee.call(o,"callee")&&!Qm.call(o,"callee")},te=S.isArray,h1=km?zt(km):vb;function Lt(o){return o!=null&&gc(o.length)&&!Zn(o)}function Ke(o){return Ue(o)&&Lt(o)}function d1(o){return o===!0||o===!1||Ue(o)&&Rt(o)==go}var Sr=SS||Bd,f1=Dm?zt(Dm):Ib;function p1(o){return Ue(o)&&o.nodeType===1&&!Lo(o)}function g1(o){if(o==null)return!0;if(Lt(o)&&(te(o)||typeof o=="string"||typeof o.splice=="function"||Sr(o)||fs(o)||fi(o)))return!o.length;var u=It(o);if(u==dn||u==fn)return!o.size;if(Vo(o))return!id(o).length;for(var c in o)if(Ee.call(o,c))return!1;return!0}function m1(o,u){return Do(o,u)}function _1(o,u,c){c=typeof c=="function"?c:t;var d=c?c(o,u):t;return d===t?Do(o,u,t,c):!!d}function kd(o){if(!Ue(o))return!1;var u=Rt(o);return u==bu||u==B0||typeof o.message=="string"&&typeof o.name=="string"&&!Lo(o)}function y1(o){return typeof o=="number"&&Jm(o)}function Zn(o){if(!Me(o))return!1;var u=Rt(o);return u==Pu||u==im||u==U0||u==$0}function _y(o){return typeof o=="number"&&o==ie(o)}function gc(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=_r}function Me(o){var u=typeof o;return o!=null&&(u=="object"||u=="function")}function Ue(o){return o!=null&&typeof o=="object"}var yy=xm?zt(xm):Eb;function v1(o,u){return o===u||rd(o,u,Id(u))}function I1(o,u,c){return c=typeof c=="function"?c:t,rd(o,u,Id(u),c)}function w1(o){return vy(o)&&o!=+o}function E1(o){if(sP(o))throw new ee(s);return l_(o)}function T1(o){return o===null}function A1(o){return o==null}function vy(o){return typeof o=="number"||Ue(o)&&Rt(o)==_o}function Lo(o){if(!Ue(o)||Rt(o)!=Kn)return!1;var u=$u(o);if(u===null)return!0;var c=Ee.call(u,"constructor")&&u.constructor;return typeof c=="function"&&c instanceof c&&Fu.call(c)==IS}var Dd=Nm?zt(Nm):Tb;function R1(o){return _y(o)&&o>=-_r&&o<=_r}var Iy=Vm?zt(Vm):Ab;function mc(o){return typeof o=="string"||!te(o)&&Ue(o)&&Rt(o)==vo}function Ht(o){return typeof o=="symbol"||Ue(o)&&Rt(o)==Cu}var fs=Om?zt(Om):Rb;function S1(o){return o===t}function b1(o){return Ue(o)&&It(o)==Io}function P1(o){return Ue(o)&&Rt(o)==G0}var C1=oc(sd),k1=oc(function(o,u){return o<=u});function wy(o){if(!o)return[];if(Lt(o))return mc(o)?pn(o):Ot(o);if(To&&o[To])return uS(o[To]());var u=It(o),c=u==dn?Kh:u==fn?Ou:ps;return c(o)}function er(o){if(!o)return o===0?o:0;if(o=un(o),o===ii||o===-ii){var u=o<0?-1:1;return u*O0}return o===o?o:0}function ie(o){var u=er(o),c=u%1;return u===u?c?u-c:u:0}function Ey(o){return o?ci(ie(o),0,En):0}function un(o){if(typeof o=="number")return o;if(Ht(o))return Ru;if(Me(o)){var u=typeof o.valueOf=="function"?o.valueOf():o;o=Me(u)?u+"":u}if(typeof o!="string")return o===0?o:+o;o=qm(o);var c=hR.test(o);return c||fR.test(o)?zR(o.slice(2),c?2:8):lR.test(o)?Ru:+o}function Ty(o){return An(o,Mt(o))}function D1(o){return o?ci(ie(o),-_r,_r):o===0?o:0}function Ie(o){return o==null?"":Kt(o)}var x1=ls(function(o,u){if(Vo(u)||Lt(u)){An(u,tt(u),o);return}for(var c in u)Ee.call(u,c)&&Po(o,c,u[c])}),Ay=ls(function(o,u){An(u,Mt(u),o)}),_c=ls(function(o,u,c,d){An(u,Mt(u),o,d)}),N1=ls(function(o,u,c,d){An(u,tt(u),o,d)}),V1=Jn(Xh);function O1(o,u){var c=cs(o);return u==null?c:n_(c,u)}var L1=oe(function(o,u){o=Se(o);var c=-1,d=u.length,g=d>2?u[2]:t;for(g&&St(u[0],u[1],g)&&(d=1);++c<d;)for(var y=u[c],v=Mt(y),w=-1,T=v.length;++w<T;){var C=v[w],k=o[C];(k===t||mn(k,os[C])&&!Ee.call(o,C))&&(o[C]=y[C])}return o}),M1=oe(function(o){return o.push(t,q_),Gt(Ry,t,o)});function F1(o,u){return Mm(o,Q(u,3),Tn)}function U1(o,u){return Mm(o,Q(u,3),ed)}function B1(o,u){return o==null?o:Zh(o,Q(u,3),Mt)}function q1(o,u){return o==null?o:a_(o,Q(u,3),Mt)}function $1(o,u){return o&&Tn(o,Q(u,3))}function W1(o,u){return o&&ed(o,Q(u,3))}function G1(o){return o==null?[]:Xu(o,tt(o))}function z1(o){return o==null?[]:Xu(o,Mt(o))}function xd(o,u,c){var d=o==null?t:li(o,u);return d===t?c:d}function K1(o,u){return o!=null&&G_(o,u,gb)}function Nd(o,u){return o!=null&&G_(o,u,mb)}var H1=L_(function(o,u,c){u!=null&&typeof u.toString!="function"&&(u=Uu.call(u)),o[u]=c},Od(Ft)),j1=L_(function(o,u,c){u!=null&&typeof u.toString!="function"&&(u=Uu.call(u)),Ee.call(o,u)?o[u].push(c):o[u]=[c]},Q),Q1=oe(ko);function tt(o){return Lt(o)?e_(o):id(o)}function Mt(o){return Lt(o)?e_(o,!0):Sb(o)}function Y1(o,u){var c={};return u=Q(u,3),Tn(o,function(d,g,y){Qn(c,u(d,g,y),d)}),c}function J1(o,u){var c={};return u=Q(u,3),Tn(o,function(d,g,y){Qn(c,g,u(d,g,y))}),c}var X1=ls(function(o,u,c){Zu(o,u,c)}),Ry=ls(function(o,u,c,d){Zu(o,u,c,d)}),Z1=Jn(function(o,u){var c={};if(o==null)return c;var d=!1;u=xe(u,function(y){return y=Ar(y,o),d||(d=y.length>1),y}),An(o,yd(o),c),d&&(c=sn(c,m|I|A,Hb));for(var g=u.length;g--;)ld(c,u[g]);return c});function ek(o,u){return Sy(o,pc(Q(u)))}var tk=Jn(function(o,u){return o==null?{}:Pb(o,u)});function Sy(o,u){if(o==null)return{};var c=xe(yd(o),function(d){return[d]});return u=Q(u),__(o,c,function(d,g){return u(d,g[0])})}function nk(o,u,c){u=Ar(u,o);var d=-1,g=u.length;for(g||(g=1,o=t);++d<g;){var y=o==null?t:o[Rn(u[d])];y===t&&(d=g,y=c),o=Zn(y)?y.call(o):y}return o}function rk(o,u,c){return o==null?o:xo(o,u,c)}function ik(o,u,c,d){return d=typeof d=="function"?d:t,o==null?o:xo(o,u,c,d)}var by=U_(tt),Py=U_(Mt);function sk(o,u,c){var d=te(o),g=d||Sr(o)||fs(o);if(u=Q(u,4),c==null){var y=o&&o.constructor;g?c=d?new y:[]:Me(o)?c=Zn(y)?cs($u(o)):{}:c={}}return(g?tn:Tn)(o,function(v,w,T){return u(c,v,w,T)}),c}function ok(o,u){return o==null?!0:ld(o,u)}function ak(o,u,c){return o==null?o:E_(o,u,fd(c))}function uk(o,u,c,d){return d=typeof d=="function"?d:t,o==null?o:E_(o,u,fd(c),d)}function ps(o){return o==null?[]:zh(o,tt(o))}function ck(o){return o==null?[]:zh(o,Mt(o))}function lk(o,u,c){return c===t&&(c=u,u=t),c!==t&&(c=un(c),c=c===c?c:0),u!==t&&(u=un(u),u=u===u?u:0),ci(un(o),u,c)}function hk(o,u,c){return u=er(u),c===t?(c=u,u=0):c=er(c),o=un(o),_b(o,u,c)}function dk(o,u,c){if(c&&typeof c!="boolean"&&St(o,u,c)&&(u=c=t),c===t&&(typeof u=="boolean"?(c=u,u=t):typeof o=="boolean"&&(c=o,o=t)),o===t&&u===t?(o=0,u=1):(o=er(o),u===t?(u=o,o=0):u=er(u)),o>u){var d=o;o=u,u=d}if(c||o%1||u%1){var g=Xm();return vt(o+g*(u-o+GR("1e-"+((g+"").length-1))),u)}return ad(o,u)}var fk=hs(function(o,u,c){return u=u.toLowerCase(),o+(c?Cy(u):u)});function Cy(o){return Vd(Ie(o).toLowerCase())}function ky(o){return o=Ie(o),o&&o.replace(gR,rS).replace(VR,"")}function pk(o,u,c){o=Ie(o),u=Kt(u);var d=o.length;c=c===t?d:ci(ie(c),0,d);var g=c;return c-=u.length,c>=0&&o.slice(c,g)==u}function gk(o){return o=Ie(o),o&&Q0.test(o)?o.replace(am,iS):o}function mk(o){return o=Ie(o),o&&tR.test(o)?o.replace(Ch,"\\$&"):o}var _k=hs(function(o,u,c){return o+(c?"-":"")+u.toLowerCase()}),yk=hs(function(o,u,c){return o+(c?" ":"")+u.toLowerCase()}),vk=N_("toLowerCase");function Ik(o,u,c){o=Ie(o),u=ie(u);var d=u?is(o):0;if(!u||d>=u)return o;var g=(u-d)/2;return sc(Ku(g),c)+o+sc(zu(g),c)}function wk(o,u,c){o=Ie(o),u=ie(u);var d=u?is(o):0;return u&&d<u?o+sc(u-d,c):o}function Ek(o,u,c){o=Ie(o),u=ie(u);var d=u?is(o):0;return u&&d<u?sc(u-d,c)+o:o}function Tk(o,u,c){return c||u==null?u=0:u&&(u=+u),kS(Ie(o).replace(kh,""),u||0)}function Ak(o,u,c){return(c?St(o,u,c):u===t)?u=1:u=ie(u),ud(Ie(o),u)}function Rk(){var o=arguments,u=Ie(o[0]);return o.length<3?u:u.replace(o[1],o[2])}var Sk=hs(function(o,u,c){return o+(c?"_":"")+u.toLowerCase()});function bk(o,u,c){return c&&typeof c!="number"&&St(o,u,c)&&(u=c=t),c=c===t?En:c>>>0,c?(o=Ie(o),o&&(typeof u=="string"||u!=null&&!Dd(u))&&(u=Kt(u),!u&&rs(o))?Rr(pn(o),0,c):o.split(u,c)):[]}var Pk=hs(function(o,u,c){return o+(c?" ":"")+Vd(u)});function Ck(o,u,c){return o=Ie(o),c=c==null?0:ci(ie(c),0,o.length),u=Kt(u),o.slice(c,c+u.length)==u}function kk(o,u,c){var d=_.templateSettings;c&&St(o,u,c)&&(u=t),o=Ie(o),u=_c({},u,d,B_);var g=_c({},u.imports,d.imports,B_),y=tt(g),v=zh(g,y),w,T,C=0,k=u.interpolate||ku,x="__p += '",U=Hh((u.escape||ku).source+"|"+k.source+"|"+(k===um?cR:ku).source+"|"+(u.evaluate||ku).source+"|$","g"),G="//# sourceURL="+(Ee.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++UR+"]")+`
`;o.replace(U,function(X,ue,fe,jt,bt,Qt){return fe||(fe=jt),x+=o.slice(C,Qt).replace(mR,sS),ue&&(w=!0,x+=`' +
__e(`+ue+`) +
'`),bt&&(T=!0,x+=`';
`+bt+`;
__p += '`),fe&&(x+=`' +
((__t = (`+fe+`)) == null ? '' : __t) +
'`),C=Qt+X.length,X}),x+=`';
`;var J=Ee.call(u,"variable")&&u.variable;if(!J)x=`with (obj) {
`+x+`
}
`;else if(aR.test(J))throw new ee(l);x=(T?x.replace(z0,""):x).replace(K0,"$1").replace(H0,"$1;"),x="function("+(J||"obj")+`) {
`+(J?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+x+`return __p
}`;var se=xy(function(){return ve(y,G+"return "+x).apply(t,v)});if(se.source=x,kd(se))throw se;return se}function Dk(o){return Ie(o).toLowerCase()}function xk(o){return Ie(o).toUpperCase()}function Nk(o,u,c){if(o=Ie(o),o&&(c||u===t))return qm(o);if(!o||!(u=Kt(u)))return o;var d=pn(o),g=pn(u),y=$m(d,g),v=Wm(d,g)+1;return Rr(d,y,v).join("")}function Vk(o,u,c){if(o=Ie(o),o&&(c||u===t))return o.slice(0,zm(o)+1);if(!o||!(u=Kt(u)))return o;var d=pn(o),g=Wm(d,pn(u))+1;return Rr(d,0,g).join("")}function Ok(o,u,c){if(o=Ie(o),o&&(c||u===t))return o.replace(kh,"");if(!o||!(u=Kt(u)))return o;var d=pn(o),g=$m(d,pn(u));return Rr(d,g).join("")}function Lk(o,u){var c=Xi,d=k0;if(Me(u)){var g="separator"in u?u.separator:g;c="length"in u?ie(u.length):c,d="omission"in u?Kt(u.omission):d}o=Ie(o);var y=o.length;if(rs(o)){var v=pn(o);y=v.length}if(c>=y)return o;var w=c-is(d);if(w<1)return d;var T=v?Rr(v,0,w).join(""):o.slice(0,w);if(g===t)return T+d;if(v&&(w+=T.length-w),Dd(g)){if(o.slice(w).search(g)){var C,k=T;for(g.global||(g=Hh(g.source,Ie(cm.exec(g))+"g")),g.lastIndex=0;C=g.exec(k);)var x=C.index;T=T.slice(0,x===t?w:x)}}else if(o.indexOf(Kt(g),w)!=w){var U=T.lastIndexOf(g);U>-1&&(T=T.slice(0,U))}return T+d}function Mk(o){return o=Ie(o),o&&j0.test(o)?o.replace(om,dS):o}var Fk=hs(function(o,u,c){return o+(c?" ":"")+u.toUpperCase()}),Vd=N_("toUpperCase");function Dy(o,u,c){return o=Ie(o),u=c?t:u,u===t?aS(o)?gS(o):XR(o):o.match(u)||[]}var xy=oe(function(o,u){try{return Gt(o,t,u)}catch(c){return kd(c)?c:new ee(c)}}),Uk=Jn(function(o,u){return tn(u,function(c){c=Rn(c),Qn(o,c,Pd(o[c],o))}),o});function Bk(o){var u=o==null?0:o.length,c=Q();return o=u?xe(o,function(d){if(typeof d[1]!="function")throw new nn(a);return[c(d[0]),d[1]]}):[],oe(function(d){for(var g=-1;++g<u;){var y=o[g];if(Gt(y[0],this,d))return Gt(y[1],this,d)}})}function qk(o){return db(sn(o,m))}function Od(o){return function(){return o}}function $k(o,u){return o==null||o!==o?u:o}var Wk=O_(),Gk=O_(!0);function Ft(o){return o}function Ld(o){return h_(typeof o=="function"?o:sn(o,m))}function zk(o){return f_(sn(o,m))}function Kk(o,u){return p_(o,sn(u,m))}var Hk=oe(function(o,u){return function(c){return ko(c,o,u)}}),jk=oe(function(o,u){return function(c){return ko(o,c,u)}});function Md(o,u,c){var d=tt(u),g=Xu(u,d);c==null&&!(Me(u)&&(g.length||!d.length))&&(c=u,u=o,o=this,g=Xu(u,tt(u)));var y=!(Me(c)&&"chain"in c)||!!c.chain,v=Zn(o);return tn(g,function(w){var T=u[w];o[w]=T,v&&(o.prototype[w]=function(){var C=this.__chain__;if(y||C){var k=o(this.__wrapped__),x=k.__actions__=Ot(this.__actions__);return x.push({func:T,args:arguments,thisArg:o}),k.__chain__=C,k}return T.apply(o,vr([this.value()],arguments))})}),o}function Qk(){return ct._===this&&(ct._=wS),this}function Fd(){}function Yk(o){return o=ie(o),oe(function(u){return g_(u,o)})}var Jk=gd(xe),Xk=gd(Lm),Zk=gd(Bh);function Ny(o){return Ed(o)?qh(Rn(o)):Cb(o)}function eD(o){return function(u){return o==null?t:li(o,u)}}var tD=M_(),nD=M_(!0);function Ud(){return[]}function Bd(){return!1}function rD(){return{}}function iD(){return""}function sD(){return!0}function oD(o,u){if(o=ie(o),o<1||o>_r)return[];var c=En,d=vt(o,En);u=Q(u),o-=En;for(var g=Gh(d,u);++c<o;)u(c);return g}function aD(o){return te(o)?xe(o,Rn):Ht(o)?[o]:Ot(Z_(Ie(o)))}function uD(o){var u=++vS;return Ie(o)+u}var cD=ic(function(o,u){return o+u},0),lD=md("ceil"),hD=ic(function(o,u){return o/u},1),dD=md("floor");function fD(o){return o&&o.length?Ju(o,Ft,td):t}function pD(o,u){return o&&o.length?Ju(o,Q(u,2),td):t}function gD(o){return Um(o,Ft)}function mD(o,u){return Um(o,Q(u,2))}function _D(o){return o&&o.length?Ju(o,Ft,sd):t}function yD(o,u){return o&&o.length?Ju(o,Q(u,2),sd):t}var vD=ic(function(o,u){return o*u},1),ID=md("round"),wD=ic(function(o,u){return o-u},0);function ED(o){return o&&o.length?Wh(o,Ft):0}function TD(o,u){return o&&o.length?Wh(o,Q(u,2)):0}return _.after=zC,_.ary=ly,_.assign=x1,_.assignIn=Ay,_.assignInWith=_c,_.assignWith=N1,_.at=V1,_.before=hy,_.bind=Pd,_.bindAll=Uk,_.bindKey=dy,_.castArray=r1,_.chain=ay,_.chunk=dP,_.compact=fP,_.concat=pP,_.cond=Bk,_.conforms=qk,_.constant=Od,_.countBy=EC,_.create=O1,_.curry=fy,_.curryRight=py,_.debounce=gy,_.defaults=L1,_.defaultsDeep=M1,_.defer=KC,_.delay=HC,_.difference=gP,_.differenceBy=mP,_.differenceWith=_P,_.drop=yP,_.dropRight=vP,_.dropRightWhile=IP,_.dropWhile=wP,_.fill=EP,_.filter=AC,_.flatMap=bC,_.flatMapDeep=PC,_.flatMapDepth=CC,_.flatten=ry,_.flattenDeep=TP,_.flattenDepth=AP,_.flip=jC,_.flow=Wk,_.flowRight=Gk,_.fromPairs=RP,_.functions=G1,_.functionsIn=z1,_.groupBy=kC,_.initial=bP,_.intersection=PP,_.intersectionBy=CP,_.intersectionWith=kP,_.invert=H1,_.invertBy=j1,_.invokeMap=xC,_.iteratee=Ld,_.keyBy=NC,_.keys=tt,_.keysIn=Mt,_.map=hc,_.mapKeys=Y1,_.mapValues=J1,_.matches=zk,_.matchesProperty=Kk,_.memoize=fc,_.merge=X1,_.mergeWith=Ry,_.method=Hk,_.methodOf=jk,_.mixin=Md,_.negate=pc,_.nthArg=Yk,_.omit=Z1,_.omitBy=ek,_.once=QC,_.orderBy=VC,_.over=Jk,_.overArgs=YC,_.overEvery=Xk,_.overSome=Zk,_.partial=Cd,_.partialRight=my,_.partition=OC,_.pick=tk,_.pickBy=Sy,_.property=Ny,_.propertyOf=eD,_.pull=VP,_.pullAll=sy,_.pullAllBy=OP,_.pullAllWith=LP,_.pullAt=MP,_.range=tD,_.rangeRight=nD,_.rearg=JC,_.reject=FC,_.remove=FP,_.rest=XC,_.reverse=Sd,_.sampleSize=BC,_.set=rk,_.setWith=ik,_.shuffle=qC,_.slice=UP,_.sortBy=GC,_.sortedUniq=KP,_.sortedUniqBy=HP,_.split=bk,_.spread=ZC,_.tail=jP,_.take=QP,_.takeRight=YP,_.takeRightWhile=JP,_.takeWhile=XP,_.tap=fC,_.throttle=e1,_.thru=lc,_.toArray=wy,_.toPairs=by,_.toPairsIn=Py,_.toPath=aD,_.toPlainObject=Ty,_.transform=sk,_.unary=t1,_.union=ZP,_.unionBy=eC,_.unionWith=tC,_.uniq=nC,_.uniqBy=rC,_.uniqWith=iC,_.unset=ok,_.unzip=bd,_.unzipWith=oy,_.update=ak,_.updateWith=uk,_.values=ps,_.valuesIn=ck,_.without=sC,_.words=Dy,_.wrap=n1,_.xor=oC,_.xorBy=aC,_.xorWith=uC,_.zip=cC,_.zipObject=lC,_.zipObjectDeep=hC,_.zipWith=dC,_.entries=by,_.entriesIn=Py,_.extend=Ay,_.extendWith=_c,Md(_,_),_.add=cD,_.attempt=xy,_.camelCase=fk,_.capitalize=Cy,_.ceil=lD,_.clamp=lk,_.clone=i1,_.cloneDeep=o1,_.cloneDeepWith=a1,_.cloneWith=s1,_.conformsTo=u1,_.deburr=ky,_.defaultTo=$k,_.divide=hD,_.endsWith=pk,_.eq=mn,_.escape=gk,_.escapeRegExp=mk,_.every=TC,_.find=RC,_.findIndex=ty,_.findKey=F1,_.findLast=SC,_.findLastIndex=ny,_.findLastKey=U1,_.floor=dD,_.forEach=uy,_.forEachRight=cy,_.forIn=B1,_.forInRight=q1,_.forOwn=$1,_.forOwnRight=W1,_.get=xd,_.gt=c1,_.gte=l1,_.has=K1,_.hasIn=Nd,_.head=iy,_.identity=Ft,_.includes=DC,_.indexOf=SP,_.inRange=hk,_.invoke=Q1,_.isArguments=fi,_.isArray=te,_.isArrayBuffer=h1,_.isArrayLike=Lt,_.isArrayLikeObject=Ke,_.isBoolean=d1,_.isBuffer=Sr,_.isDate=f1,_.isElement=p1,_.isEmpty=g1,_.isEqual=m1,_.isEqualWith=_1,_.isError=kd,_.isFinite=y1,_.isFunction=Zn,_.isInteger=_y,_.isLength=gc,_.isMap=yy,_.isMatch=v1,_.isMatchWith=I1,_.isNaN=w1,_.isNative=E1,_.isNil=A1,_.isNull=T1,_.isNumber=vy,_.isObject=Me,_.isObjectLike=Ue,_.isPlainObject=Lo,_.isRegExp=Dd,_.isSafeInteger=R1,_.isSet=Iy,_.isString=mc,_.isSymbol=Ht,_.isTypedArray=fs,_.isUndefined=S1,_.isWeakMap=b1,_.isWeakSet=P1,_.join=DP,_.kebabCase=_k,_.last=an,_.lastIndexOf=xP,_.lowerCase=yk,_.lowerFirst=vk,_.lt=C1,_.lte=k1,_.max=fD,_.maxBy=pD,_.mean=gD,_.meanBy=mD,_.min=_D,_.minBy=yD,_.stubArray=Ud,_.stubFalse=Bd,_.stubObject=rD,_.stubString=iD,_.stubTrue=sD,_.multiply=vD,_.nth=NP,_.noConflict=Qk,_.noop=Fd,_.now=dc,_.pad=Ik,_.padEnd=wk,_.padStart=Ek,_.parseInt=Tk,_.random=dk,_.reduce=LC,_.reduceRight=MC,_.repeat=Ak,_.replace=Rk,_.result=nk,_.round=ID,_.runInContext=E,_.sample=UC,_.size=$C,_.snakeCase=Sk,_.some=WC,_.sortedIndex=BP,_.sortedIndexBy=qP,_.sortedIndexOf=$P,_.sortedLastIndex=WP,_.sortedLastIndexBy=GP,_.sortedLastIndexOf=zP,_.startCase=Pk,_.startsWith=Ck,_.subtract=wD,_.sum=ED,_.sumBy=TD,_.template=kk,_.times=oD,_.toFinite=er,_.toInteger=ie,_.toLength=Ey,_.toLower=Dk,_.toNumber=un,_.toSafeInteger=D1,_.toString=Ie,_.toUpper=xk,_.trim=Nk,_.trimEnd=Vk,_.trimStart=Ok,_.truncate=Lk,_.unescape=Mk,_.uniqueId=uD,_.upperCase=Fk,_.upperFirst=Vd,_.each=uy,_.eachRight=cy,_.first=iy,Md(_,function(){var o={};return Tn(_,function(u,c){Ee.call(_.prototype,c)||(o[c]=u)}),o}(),{chain:!1}),_.VERSION=r,tn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){_[o].placeholder=_}),tn(["drop","take"],function(o,u){le.prototype[o]=function(c){c=c===t?1:Ze(ie(c),0);var d=this.__filtered__&&!u?new le(this):this.clone();return d.__filtered__?d.__takeCount__=vt(c,d.__takeCount__):d.__views__.push({size:vt(c,En),type:o+(d.__dir__<0?"Right":"")}),d},le.prototype[o+"Right"]=function(c){return this.reverse()[o](c).reverse()}}),tn(["filter","map","takeWhile"],function(o,u){var c=u+1,d=c==rm||c==V0;le.prototype[o]=function(g){var y=this.clone();return y.__iteratees__.push({iteratee:Q(g,3),type:c}),y.__filtered__=y.__filtered__||d,y}}),tn(["head","last"],function(o,u){var c="take"+(u?"Right":"");le.prototype[o]=function(){return this[c](1).value()[0]}}),tn(["initial","tail"],function(o,u){var c="drop"+(u?"":"Right");le.prototype[o]=function(){return this.__filtered__?new le(this):this[c](1)}}),le.prototype.compact=function(){return this.filter(Ft)},le.prototype.find=function(o){return this.filter(o).head()},le.prototype.findLast=function(o){return this.reverse().find(o)},le.prototype.invokeMap=oe(function(o,u){return typeof o=="function"?new le(this):this.map(function(c){return ko(c,o,u)})}),le.prototype.reject=function(o){return this.filter(pc(Q(o)))},le.prototype.slice=function(o,u){o=ie(o);var c=this;return c.__filtered__&&(o>0||u<0)?new le(c):(o<0?c=c.takeRight(-o):o&&(c=c.drop(o)),u!==t&&(u=ie(u),c=u<0?c.dropRight(-u):c.take(u-o)),c)},le.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},le.prototype.toArray=function(){return this.take(En)},Tn(le.prototype,function(o,u){var c=/^(?:filter|find|map|reject)|While$/.test(u),d=/^(?:head|last)$/.test(u),g=_[d?"take"+(u=="last"?"Right":""):u],y=d||/^find/.test(u);g&&(_.prototype[u]=function(){var v=this.__wrapped__,w=d?[1]:arguments,T=v instanceof le,C=w[0],k=T||te(v),x=function(ue){var fe=g.apply(_,vr([ue],w));return d&&U?fe[0]:fe};k&&c&&typeof C=="function"&&C.length!=1&&(T=k=!1);var U=this.__chain__,G=!!this.__actions__.length,J=y&&!U,se=T&&!G;if(!y&&k){v=se?v:new le(this);var X=o.apply(v,w);return X.__actions__.push({func:lc,args:[x],thisArg:t}),new rn(X,U)}return J&&se?o.apply(this,w):(X=this.thru(x),J?d?X.value()[0]:X.value():X)})}),tn(["pop","push","shift","sort","splice","unshift"],function(o){var u=Lu[o],c=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",d=/^(?:pop|shift)$/.test(o);_.prototype[o]=function(){var g=arguments;if(d&&!this.__chain__){var y=this.value();return u.apply(te(y)?y:[],g)}return this[c](function(v){return u.apply(te(v)?v:[],g)})}}),Tn(le.prototype,function(o,u){var c=_[u];if(c){var d=c.name+"";Ee.call(us,d)||(us[d]=[]),us[d].push({name:u,func:c})}}),us[rc(t,Y).name]=[{name:"wrapper",func:t}],le.prototype.clone=MS,le.prototype.reverse=FS,le.prototype.value=US,_.prototype.at=pC,_.prototype.chain=gC,_.prototype.commit=mC,_.prototype.next=_C,_.prototype.plant=vC,_.prototype.reverse=IC,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=wC,_.prototype.first=_.prototype.head,To&&(_.prototype[To]=yC),_},ss=mS();si?((si.exports=ss)._=ss,Lh._=ss):ct._=ss}).call(Jo)})(w4,vl);const E4=vl,T4=document.querySelector(".search__input"),tm=document.querySelector(".filters__list"),A4=new wl;R4();async function R4(){const n=await A4.fetchFilters(),t=[...new Set(n.map(({filter:r})=>r))].map((r,i)=>{const s=r.toLowerCase().split(" ").join("-");return i===0?`<li id=${s} class="filters__item active">${r}</li>`:`<li id=${s} class="filters__item">${r}</li>`}).join("");tm.insertAdjacentHTML("afterbegin",t),Au()}function S4(n){const e=n.target.value.toLowerCase().trim();console.log(e)}function b4(n){const e=n.target;n.target.id,[...tm.children].forEach(t=>{t.classList.remove("active")}),e.classList.add("active"),dt.currentPage=1,Au()}const P4=E4.debounce(S4,500);T4.addEventListener("input",P4);tm.addEventListener("click",b4);const Ps={exersiseId:"64f389465ae26083f39b17a2",ratingText:"Rating",iconStar:"/images/icons-sprite.svg#icon-star",ratingMax:5,closeKeyBoardBtn:"Escape",beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null},C4=document.querySelector("form.modal-form"),Il=document.querySelector(".rating-modal-window"),k4=document.querySelector(".rating-close"),D4=()=>{const n=[];for(let e=0;e<Ps.ratingMax;e++){let t=Ps.ratingMax-e;n.push(`
        <input type="radio" class="visually-hidden" id="star${t}" name="rating" value="${t}">
        <label class="rating-star" for="star${t}">
            <svg class="rating-star-icon">
                <use href=${Ps.iconStar} />
            </svg>
        </label>
        `)}return`
    <div class="rating-wrapper">
        <p class="rating-text">${Ps.ratingText}</p>
        <div class="rating-stars">
            ${n.join("")}
            <p class="rating-count">0.0</p>
        </div>
    </div>
    `},P0=n=>{n.key===Ps.closeKeyBoardBtn&&vh()},C0=n=>{nm.forEach(e=>{delete e.dataset.dataChecked}),n.target.dataset.dataChecked="checked",x4.innerHTML=n.target.value};C4.insertAdjacentHTML("afterbegin",D4());const nm=document.querySelectorAll(".rating-stars input"),x4=document.querySelector(".rating-count"),vh=()=>{nm.forEach(n=>{n.removeEventListener("change",C0)}),Il.classList.remove("open"),document.body.style.overflow="visible",document.removeEventListener("keydown",P0)},N4=()=>{Il.classList.add("open"),document.body.style.overflow="hidden",document.addEventListener("keydown",P0),nm.forEach(n=>{n.addEventListener("change",C0)})};k4.addEventListener("click",vh);Il.addEventListener("click",n=>{n.target===Il&&vh()});const V4={modalConfig:Ps,openRatingModal:N4,closeRatingModal:vh},ht={form:document.querySelector(".modal-form"),ratings:document.querySelectorAll(".rating-stars input"),emailInput:document.querySelector(".modal-form-email"),validateEmailMessage:document.querySelector(".modal-email-validate"),btn:document.querySelector(".feedback-submit")};ht.form.addEventListener("submit",O4);async function O4(n){n.preventDefault();const e=n.target.elements.email.value.trim().toLowerCase();if(AD(e))try{const t=new wl;let r=Array.from(ht.ratings).find(i=>i.dataset.dataChecked);t.rating=parseInt(r.value),t.email=e,t.review=ht.validateEmailMessage.value,t.exerciseId=V4.modalConfig.exersiseId,await t.addRating(),ht.validateEmailMessage.textContent="✅ Thank you for you subscription",ht.validateEmailMessage.classList.remove("full_hidden","validate-form-message"),ht.validateEmailMessage.classList.add("validate-form-message_ok"),console.log("ok"),n.target.reset()}catch(t){console.log(t),ht.validateEmailMessage.textContent="⚠️ This email address was previously added",ht.validateEmailMessage.classList.remove("full_hidden","validate-form-message_ok"),ht.validateEmailMessage.classList.add("validate-form-message_warning")}else ht.validateEmailMessage.textContent="⚠️ Your email has wrong format",ht.validateEmailMessage.classList.remove("full_hidden","validate-form-message_ok"),ht.validateEmailMessage.classList.add("validate-form-message_warning")}ht.emailInput.addEventListener("input",L4);function L4(n){n.target.value.trim()?ht.btn.disabled=!1:ht.btn.disabled=!0}ht.emailInput.addEventListener("focus",M4);function M4(){ht.validateEmailMessage.classList.add("full_hidden")}
