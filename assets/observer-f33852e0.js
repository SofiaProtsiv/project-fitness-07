import{A as Al,i as Zk}from"./index-a55b4bf9.js";const Ky=document.getElementById("daily-quote"),Hy=document.getElementById("quote-author"),ex=new Al;function uw(){const n=new Date,e=n.getFullYear(),t=(n.getMonth()+1).toString().padStart(2,"0");return`${n.getDate().toString().padStart(2,"0")}/${t}/${e}`}async function tx(){try{const n=await ex.fetchQuote(),e=n.quote,t=n.author,r=uw();return localStorage.setItem("today",r),localStorage.setItem("quote",e),localStorage.setItem("author",t),{quote:e,author:t}}catch(n){console.error("Error fetching quote:",n.message)}}const jy=localStorage.getItem("today"),nx=uw();if(!jy||jy!==nx)tx().then(({quote:n,author:e})=>{Ky.textContent=n,Hy.textContent=e});else{const n=localStorage.getItem("quote");n&&(Ky.textContent=n);const e=localStorage.getItem("author");e&&(Hy.textContent=e)}const lw=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},rx=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],l=n[t++],h=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},hw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,l=a?n[i+1]:0,h=i+2<n.length,f=h?n[i+2]:0,p=s>>2,m=(s&3)<<4|l>>4;let I=(l&15)<<2|f>>6,A=f&63;h||(A=64,a||(I=64)),r.push(t[p],t[m],t[I],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(lw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):rx(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const f=i<n.length?t[n.charAt(i)]:64;++i;const m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||f==null||m==null)throw new ix;const I=s<<2|l>>4;if(r.push(I),f!==64){const A=l<<4&240|f>>2;if(r.push(A),m!==64){const L=f<<6&192|m;r.push(L)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class ix extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const sx=function(n){const e=lw(n);return hw.encodeByteArray(e,!0)},ju=function(n){return sx(n).replace(/\./g,"")},dw=function(n){try{return hw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Qu(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!ox(t)||(n[t]=Qu(n[t],e[t]));return n}function ox(n){return n!=="__proto__"}function ax(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const cx=()=>ax().__FIREBASE_DEFAULTS__,ux=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},lx=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&dw(n[1]);return e&&JSON.parse(e)},fp=()=>{try{return cx()||ux()||lx()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},fw=()=>{var n;return(n=fp())===null||n===void 0?void 0:n.config},hx=n=>{var e;return(e=fp())===null||e===void 0?void 0:e[`_${n}`]};class dx{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function fx(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n),l="";return[ju(JSON.stringify(t)),ju(JSON.stringify(a)),l].join(".")}function Ue(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function px(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ue())}function pp(){var n;const e=(n=fp())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function gx(){return typeof self=="object"&&self.self===self}function pw(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function gp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gw(){const n=Ue();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function mx(){return!pp()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ea(){try{return typeof indexedDB=="object"}catch{return!1}}function _x(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}const yx="FirebaseError";class kt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=yx,Object.setPrototypeOf(this,kt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ki.prototype.create)}}class Ki{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?vx(s,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new kt(i,l,r)}}function vx(n,e){return n.replace(Ix,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const Ix=/\{\$([^}]+)}/g;function Qy(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function wx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function _f(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(Yy(s)&&Yy(a)){if(!_f(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Yy(n){return n!==null&&typeof n=="object"}function oo(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function xs(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function ia(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function mw(n,e){const t=new Ex(n,e);return t.subscribe.bind(t)}class Ex{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Tx(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=zd),i.error===void 0&&(i.error=zd),i.complete===void 0&&(i.complete=zd);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Tx(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function zd(){}function H(n){return n&&n._delegate?n._delegate:n}class Wn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const _i="[DEFAULT]";class Ax{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new dx;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Sx(e))try{this.getOrInitializeService({instanceIdentifier:_i})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=_i){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_i){return this.instances.has(e)}getOptions(e=_i){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&a.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Rx(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=_i){return this.component?this.component.multipleInstances?e:_i:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Rx(n){return n===_i?void 0:n}function Sx(n){return n.instantiationMode==="EAGER"}class bx{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Ax(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const mp=[];var ue;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ue||(ue={}));const _w={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},Px=ue.INFO,Cx={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},Dx=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=Cx[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Rl{constructor(e){this.name=e,this._logLevel=Px,this._logHandler=Dx,this._userLogHandler=null,mp.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_w[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...e),this._logHandler(this,ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...e),this._logHandler(this,ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ue.INFO,...e),this._logHandler(this,ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ue.WARN,...e),this._logHandler(this,ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...e),this._logHandler(this,ue.ERROR,...e)}}function kx(n){mp.forEach(e=>{e.setLogLevel(n)})}function xx(n,e){for(const t of mp){let r=null;e&&e.level&&(r=_w[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...a)=>{const l=a.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");s>=(r??i.logLevel)&&n({level:ue[s].toLowerCase(),message:l,args:a,type:i.name})}}}const Nx=(n,e)=>e.some(t=>n instanceof t);let Jy,Xy;function Vx(){return Jy||(Jy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ox(){return Xy||(Xy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yw=new WeakMap,yf=new WeakMap,vw=new WeakMap,Kd=new WeakMap,_p=new WeakMap;function Lx(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Mr(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&yw.set(t,n)}).catch(()=>{}),_p.set(e,n),e}function Mx(n){if(yf.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});yf.set(n,e)}let vf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return yf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||vw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Mr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Fx(n){vf=n(vf)}function Ux(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Hd(this),e,...t);return vw.set(r,e.sort?e.sort():[e]),Mr(r)}:Ox().includes(n)?function(...e){return n.apply(Hd(this),e),Mr(yw.get(this))}:function(...e){return Mr(n.apply(Hd(this),e))}}function Bx(n){return typeof n=="function"?Ux(n):(n instanceof IDBTransaction&&Mx(n),Nx(n,Vx())?new Proxy(n,vf):n)}function Mr(n){if(n instanceof IDBRequest)return Lx(n);if(Kd.has(n))return Kd.get(n);const e=Bx(n);return e!==n&&(Kd.set(n,e),_p.set(e,n)),e}const Hd=n=>_p.get(n);function qx(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),l=Mr(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Mr(a.result),h.oldVersion,h.newVersion,Mr(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),l.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const $x=["get","getKey","getAll","getAllKeys","count"],Wx=["put","add","delete","clear"],jd=new Map;function Zy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(jd.get(e))return jd.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=Wx.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||$x.includes(t)))return;const s=async function(a,...l){const h=this.transaction(a,i?"readwrite":"readonly");let f=h.store;return r&&(f=f.index(l.shift())),(await Promise.all([f[t](...l),i&&h.done]))[0]};return jd.set(e,s),s}Fx(n=>({...n,get:(e,t,r)=>Zy(e,t)||n.get(e,t,r),has:(e,t)=>!!Zy(e,t)||n.has(e,t)}));class Gx{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(zx(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function zx(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const If="@firebase/app",ev="0.9.25";const Ni=new Rl("@firebase/app"),Kx="@firebase/app-compat",Hx="@firebase/analytics-compat",jx="@firebase/analytics",Qx="@firebase/app-check-compat",Yx="@firebase/app-check",Jx="@firebase/auth",Xx="@firebase/auth-compat",Zx="@firebase/database",eN="@firebase/database-compat",tN="@firebase/functions",nN="@firebase/functions-compat",rN="@firebase/installations",iN="@firebase/installations-compat",sN="@firebase/messaging",oN="@firebase/messaging-compat",aN="@firebase/performance",cN="@firebase/performance-compat",uN="@firebase/remote-config",lN="@firebase/remote-config-compat",hN="@firebase/storage",dN="@firebase/storage-compat",fN="@firebase/firestore",pN="@firebase/firestore-compat",gN="firebase",mN="10.7.1";const Fr="[DEFAULT]",_N={[If]:"fire-core",[Kx]:"fire-core-compat",[jx]:"fire-analytics",[Hx]:"fire-analytics-compat",[Yx]:"fire-app-check",[Qx]:"fire-app-check-compat",[Jx]:"fire-auth",[Xx]:"fire-auth-compat",[Zx]:"fire-rtdb",[eN]:"fire-rtdb-compat",[tN]:"fire-fn",[nN]:"fire-fn-compat",[rN]:"fire-iid",[iN]:"fire-iid-compat",[sN]:"fire-fcm",[oN]:"fire-fcm-compat",[aN]:"fire-perf",[cN]:"fire-perf-compat",[uN]:"fire-rc",[lN]:"fire-rc-compat",[hN]:"fire-gcs",[dN]:"fire-gcs-compat",[fN]:"fire-fst",[pN]:"fire-fst-compat","fire-js":"fire-js",[gN]:"fire-js-all"};const Ur=new Map,Ta=new Map;function Yu(n,e){try{n.container.addComponent(e)}catch(t){Ni.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Iw(n,e){n.container.addOrOverwriteComponent(e)}function Br(n){const e=n.name;if(Ta.has(e))return Ni.debug(`There were multiple attempts to register component ${e}.`),!1;Ta.set(e,n);for(const t of Ur.values())Yu(t,n);return!0}function ww(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function yN(n,e,t=Fr){ww(n,e).clearInstance(t)}function vN(){Ta.clear()}const IN={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ar=new Ki("app","Firebase",IN);let wN=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Wn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ar.create("app-deleted",{appName:this._name})}};const Xr=mN;function yp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Fr,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw ar.create("bad-app-name",{appName:String(i)});if(t||(t=fw()),!t)throw ar.create("no-options");const s=Ur.get(i);if(s){if(_f(t,s.options)&&_f(r,s.config))return s;throw ar.create("duplicate-app",{appName:i})}const a=new bx(i);for(const h of Ta.values())a.addComponent(h);const l=new wN(t,r,a);return Ur.set(i,l),l}function EN(n=Fr){const e=Ur.get(n);if(!e&&n===Fr&&fw())return yp();if(!e)throw ar.create("no-app",{appName:n});return e}function TN(){return Array.from(Ur.values())}async function Ew(n){const e=n.name;Ur.has(e)&&(Ur.delete(e),await Promise.all(n.container.getProviders().map(t=>t.delete())),n.isDeleted=!0)}function Un(n,e,t){var r;let i=(r=_N[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ni.warn(l.join(" "));return}Br(new Wn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function Tw(n,e){if(n!==null&&typeof n!="function")throw ar.create("invalid-log-argument");xx(n,e)}function Aw(n){kx(n)}const AN="firebase-heartbeat-database",RN=1,Aa="firebase-heartbeat-store";let Qd=null;function Rw(){return Qd||(Qd=qx(AN,RN,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Aa)}}}).catch(n=>{throw ar.create("idb-open",{originalErrorMessage:n.message})})),Qd}async function SN(n){try{return await(await Rw()).transaction(Aa).objectStore(Aa).get(Sw(n))}catch(e){if(e instanceof kt)Ni.warn(e.message);else{const t=ar.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ni.warn(t.message)}}}async function tv(n,e){try{const r=(await Rw()).transaction(Aa,"readwrite");await r.objectStore(Aa).put(e,Sw(n)),await r.done}catch(t){if(t instanceof kt)Ni.warn(t.message);else{const r=ar.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ni.warn(r.message)}}}function Sw(n){return`${n.name}!${n.options.appId}`}const bN=1024,PN=30*24*60*60*1e3;class CN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new kN(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=nv();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=PN}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=nv(),{heartbeatsToSend:r,unsentEntries:i}=DN(this._heartbeatsCache.heartbeats),s=ju(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function nv(){return new Date().toISOString().substring(0,10)}function DN(n,e=bN){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),rv(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),rv(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class kN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ea()?_x().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await SN(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return tv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return tv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function rv(n){return ju(JSON.stringify({version:2,heartbeats:n})).length}function xN(n){Br(new Wn("platform-logger",e=>new Gx(e),"PRIVATE")),Br(new Wn("heartbeat",e=>new CN(e),"PRIVATE")),Un(If,ev,n),Un(If,ev,"esm2017"),Un("fire-js","")}xN("");const NN=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:Xr,_DEFAULT_ENTRY_NAME:Fr,_addComponent:Yu,_addOrOverwriteComponent:Iw,_apps:Ur,_clearComponents:vN,_components:Ta,_getProvider:ww,_registerComponent:Br,_removeServiceInstance:yN,deleteApp:Ew,getApp:EN,getApps:TN,initializeApp:yp,onLog:Tw,registerVersion:Un,setLogLevel:Aw,FirebaseError:kt},Symbol.toStringTag,{value:"Module"}));class VN{constructor(e,t){this._delegate=e,this.firebase=t,Yu(e,new Wn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Ew(this._delegate)))}_getService(e,t=Fr){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=Fr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Yu(this._delegate,e)}_addOrOverwriteComponent(e){Iw(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const ON={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},iv=new Ki("app-compat","Firebase",ON);function LN(n){const e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Un,setLogLevel:Aw,onLog:Tw,apps:null,SDK_VERSION:Xr,INTERNAL:{registerComponent:l,removeApp:r,useAsService:h,modularAPIs:NN}};t.default=t,Object.defineProperty(t,"apps",{get:a});function r(f){delete e[f]}function i(f){if(f=f||Fr,!Qy(e,f))throw iv.create("no-app",{appName:f});return e[f]}i.App=n;function s(f,p={}){const m=yp(f,p);if(Qy(e,m.name))return e[m.name];const I=new n(m,t);return e[m.name]=I,I}function a(){return Object.keys(e).map(f=>e[f])}function l(f){const p=f.name,m=p.replace("-compat","");if(Br(f)&&f.type==="PUBLIC"){const I=(A=i())=>{if(typeof A[m]!="function")throw iv.create("invalid-app-argument",{appName:p});return A[m]()};f.serviceProps!==void 0&&Qu(I,f.serviceProps),t[m]=I,n.prototype[m]=function(...A){return this._getService.bind(this,p).apply(this,f.multipleInstances?A:[])}}return f.type==="PUBLIC"?t[m]:null}function h(f,p){return p==="serverAuth"?null:p}return t}function bw(){const n=LN(VN);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:bw,extendNamespace:e,createSubscribe:mw,ErrorFactory:Ki,deepExtend:Qu});function e(t){Qu(n,t)}return n}const MN=bw();const sv=new Rl("@firebase/app-compat"),FN="@firebase/app-compat",UN="0.2.25";function BN(n){Un(FN,UN,n)}if(gx()&&self.firebase!==void 0){sv.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&sv.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const qr=MN;BN();var qN="firebase",$N="10.7.1";qr.registerVersion(qN,$N,"app-compat");function vp(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}const zo={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},ys={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function WN(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is incorrect, malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-password"]:"A non-empty password must be provided",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.",["missing-recaptcha-token"]:"The reCAPTCHA token is missing when sending request to the backend.",["invalid-recaptcha-token"]:"The reCAPTCHA token is invalid when sending request to the backend.",["invalid-recaptcha-action"]:"The reCAPTCHA action is invalid when sending request to the backend.",["recaptcha-not-enabled"]:"reCAPTCHA Enterprise integration is not enabled for this project.",["missing-client-type"]:"The reCAPTCHA client type is missing when sending request to the backend.",["missing-recaptcha-version"]:"The reCAPTCHA version is missing when sending request to the backend.",["invalid-req-type"]:"Invalid request parameters.",["invalid-recaptcha-version"]:"The reCAPTCHA version is invalid when sending request to the backend.",["unsupported-password-policy-schema-version"]:"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.",["password-does-not-meet-requirements"]:"The password does not meet the requirements."}}function Pw(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const GN=WN,zN=Pw,Cw=new Ki("auth","Firebase",Pw());const Ju=new Rl("@firebase/auth");function KN(n,...e){Ju.logLevel<=ue.WARN&&Ju.warn(`Auth (${Xr}): ${n}`,...e)}function Lu(n,...e){Ju.logLevel<=ue.ERROR&&Ju.error(`Auth (${Xr}): ${n}`,...e)}function yt(n,...e){throw Ip(n,...e)}function mt(n,...e){return Ip(n,...e)}function Dw(n,e,t){const r=Object.assign(Object.assign({},zN()),{[e]:t});return new Ki("auth","Firebase",r).create(e,{appName:n.name})}function ao(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&yt(n,"argument-error"),Dw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ip(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Cw.create(n,...e)}function O(n,e,...t){if(!n)throw Ip(e,...t)}function Vn(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Lu(e),new Error(e)}function In(n,e){n||Vn(e)}function Ra(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function wp(){return ov()==="http:"||ov()==="https:"}function ov(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function HN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(wp()||pw()||"connection"in navigator)?navigator.onLine:!0}function jN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class nc{constructor(e,t){this.shortDelay=e,this.longDelay=t,In(t>e,"Short delay should be less than long delay!"),this.isMobile=px()||gp()}get(){return HN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ep(n,e){In(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class kw{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const QN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const YN=new nc(3e4,6e4);function Ke(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function He(n,e,t,r,i={}){return xw(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const l=oo(Object.assign({key:n.config.apiKey},a)).slice(1),h=await n._getAdditionalHeaders();return h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode),kw.fetch()(Nw(n,n.config.apiHost,t,l),Object.assign({method:e,headers:h,referrerPolicy:"no-referrer"},s))})}async function xw(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},QN),e);try{const i=new XN(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw sa(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const l=s.ok?a.errorMessage:a.error.message,[h,f]=l.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw sa(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw sa(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw sa(n,"user-disabled",a);const p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw Dw(n,p,f);yt(n,p)}}catch(i){if(i instanceof kt)throw i;yt(n,"network-request-failed",{message:String(i)})}}async function fr(n,e,t,r,i={}){const s=await He(n,e,t,r,i);return"mfaPendingCredential"in s&&yt(n,"multi-factor-auth-required",{_serverResponse:s}),s}function Nw(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?Ep(n.config,i):`${n.config.apiScheme}://${i}`}function JN(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class XN{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(mt(this.auth,"network-request-failed")),YN.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function sa(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=mt(n,e,r);return i.customData._tokenResponse=t,i}function av(n){return n!==void 0&&n.getResponse!==void 0}function cv(n){return n!==void 0&&n.enterprise!==void 0}class ZN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return JN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function eV(n){return(await He(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function tV(n,e){return He(n,"GET","/v2/recaptchaConfig",Ke(n,e))}async function nV(n,e){return He(n,"POST","/v1/accounts:delete",e)}async function rV(n,e){return He(n,"POST","/v1/accounts:update",e)}async function iV(n,e){return He(n,"POST","/v1/accounts:lookup",e)}function da(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function sV(n,e=!1){const t=H(n),r=await t.getIdToken(e),i=Sl(r);O(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:da(Yd(i.auth_time)),issuedAtTime:da(Yd(i.iat)),expirationTime:da(Yd(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Yd(n){return Number(n)*1e3}function Sl(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Lu("JWT malformed, contained fewer than 3 sections"),null;try{const i=dw(t);return i?JSON.parse(i):(Lu("Failed to decode base64 JWT payload"),null)}catch(i){return Lu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function oV(n){const e=Sl(n);return O(e,"internal-error"),O(typeof e.exp<"u","internal-error"),O(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function lr(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof kt&&aV(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function aV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class cV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Vw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=da(this.lastLoginAt),this.creationTime=da(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Sa(n){var e;const t=n.auth,r=await n.getIdToken(),i=await lr(n,iV(t,{idToken:r}));O(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?hV(s.providerUserInfo):[],l=lV(n.providerData,a),h=n.isAnonymous,f=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=h?f:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Vw(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)}async function uV(n){const e=H(n);await Sa(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function lV(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function hV(n){return n.map(e=>{var{providerId:t}=e,r=vp(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function dV(n,e){const t=await xw(n,{},async()=>{const r=oo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=Nw(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",kw.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function fV(n,e){return He(n,"POST","/v2/accounts:revokeToken",Ke(n,e))}class ba{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){O(e.idToken,"internal-error"),O(typeof e.idToken<"u","internal-error"),O(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):oV(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return O(!this.accessToken||this.refreshToken,e,"user-token-expired"),!t&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await dV(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new ba;return r&&(O(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(O(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(O(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ba,this.toJSON())}_performRefresh(){return Vn("not implemented")}}function Pr(n,e){O(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ci{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=vp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new cV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Vw(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await lr(this,this.stsTokenManager.getToken(this.auth,e));return O(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return sV(this,e)}reload(){return uV(this)}_assign(e){this!==e&&(O(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ci(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){O(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Sa(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await lr(this,nV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,l,h,f,p;const m=(r=t.displayName)!==null&&r!==void 0?r:void 0,I=(i=t.email)!==null&&i!==void 0?i:void 0,A=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,L=(a=t.photoURL)!==null&&a!==void 0?a:void 0,M=(l=t.tenantId)!==null&&l!==void 0?l:void 0,V=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,Y=(f=t.createdAt)!==null&&f!==void 0?f:void 0,ae=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:j,emailVerified:ye,isAnonymous:de,providerData:me,stsTokenManager:we}=t;O(j&&we,e,"internal-error");const Vt=ba.fromJSON(this.name,we);O(typeof j=="string",e,"internal-error"),Pr(m,e.name),Pr(I,e.name),O(typeof ye=="boolean",e,"internal-error"),O(typeof de=="boolean",e,"internal-error"),Pr(A,e.name),Pr(L,e.name),Pr(M,e.name),Pr(V,e.name),Pr(Y,e.name),Pr(ae,e.name);const Hn=new Ci({uid:j,auth:e,email:I,emailVerified:ye,displayName:m,isAnonymous:de,photoURL:L,phoneNumber:A,tenantId:M,stsTokenManager:Vt,createdAt:Y,lastLoginAt:ae});return me&&Array.isArray(me)&&(Hn.providerData=me.map(ts=>Object.assign({},ts))),V&&(Hn._redirectEventId=V),Hn}static async _fromIdTokenResponse(e,t,r=!1){const i=new ba;i.updateFromServerResponse(t);const s=new Ci({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Sa(s),s}}const uv=new Map;function Jt(n){In(n instanceof Function,"Expected a class definition");let e=uv.get(n);return e?(In(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,uv.set(n,e),e)}class Ow{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ow.type="NONE";const zs=Ow;function Di(n,e,t){return`firebase:${n}:${e}:${t}`}class Vs{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Di(this.userKey,i.apiKey,s),this.fullPersistenceKey=Di("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ci._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Vs(Jt(zs),e,r);const i=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let s=i[0]||Jt(zs);const a=Di(r,e.config.apiKey,e.name);let l=null;for(const f of t)try{const p=await f._get(a);if(p){const m=Ci._fromJSON(e,p);f!==s&&(l=m),s=f;break}}catch{}const h=i.filter(f=>f._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new Vs(s,e,r):(s=h[0],l&&await s._set(a,l.toJSON()),await Promise.all(t.map(async f=>{if(f!==s)try{await f._remove(a)}catch{}})),new Vs(s,e,r))}}function lv(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Fw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Lw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Uw(e))return"Blackberry";if(Bw(e))return"Webos";if(Tp(e))return"Safari";if((e.includes("chrome/")||Mw(e))&&!e.includes("edge/"))return"Chrome";if(rc(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Lw(n=Ue()){return/firefox\//i.test(n)}function Tp(n=Ue()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Mw(n=Ue()){return/crios\//i.test(n)}function Fw(n=Ue()){return/iemobile/i.test(n)}function rc(n=Ue()){return/android/i.test(n)}function Uw(n=Ue()){return/blackberry/i.test(n)}function Bw(n=Ue()){return/webos/i.test(n)}function co(n=Ue()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function pV(n=Ue()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function gV(n=Ue()){var e;return co(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function mV(){return gw()&&document.documentMode===10}function qw(n=Ue()){return co(n)||rc(n)||Bw(n)||Uw(n)||/windows phone/i.test(n)||Fw(n)}function _V(){try{return!!(window&&window!==window.top)}catch{return!1}}function $w(n,e=[]){let t;switch(n){case"Browser":t=lv(Ue());break;case"Worker":t=`${lv(Ue())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xr}/${r}`}class yV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,l)=>{try{const h=e(s);a(h)}catch(h){l(h)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}async function vV(n,e={}){return He(n,"GET","/v2/passwordPolicy",Ke(n,e))}const IV=6;class wV{constructor(e){var t,r,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:IV,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,l;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(l=h.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),h}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class EV{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hv(this),this.idTokenSubscription=new hv(this),this.beforeStateQueue=new yV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Cw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Jt(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Vs.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===l)&&(h!=null&&h.user)&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return O(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Sa(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=jN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?H(e):null;return t&&O(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&O(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Jt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vV(this),t=new wV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ki("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await fV(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Jt(e)||this._popupRedirectResolver;O(t,this,"argument-error"),this.redirectPersistenceManager=await Vs.create(this,[Jt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(O(l,this,"internal-error"),l.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{const h=e.addObserver(t);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return O(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$w(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&KN(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function We(n){return H(n)}class hv{constructor(e){this.auth=e,this.observer=null,this.addObserver=mw(t=>this.observer=t)}get next(){return O(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function TV(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}function Ap(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=mt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",TV().appendChild(r)})}function Ww(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const AV="https://www.google.com/recaptcha/enterprise.js?render=",RV="recaptcha-enterprise",SV="NO_RECAPTCHA";class bV{constructor(e){this.type=RV,this.auth=We(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,l)=>{tV(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const f=new ZN(h);return s.tenantId==null?s._agentRecaptchaConfig=f:s._tenantRecaptchaConfigs[s.tenantId]=f,a(f.siteKey)}}).catch(h=>{l(h)})})}function i(s,a,l){const h=window.grecaptcha;cv(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(f=>{a(f)}).catch(()=>{a(SV)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(l=>{if(!t&&cv(window.grecaptcha))i(l,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}Ap(AV+l).then(()=>{i(l,s,a)}).catch(h=>{a(h)})}}).catch(l=>{a(l)})})}}async function dv(n,e,t,r=!1){const i=new bV(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Pa(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await dv(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await dv(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)})}function PV(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Jt);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function CV(n,e,t){const r=We(n);O(r._canInitEmulator,r,"emulator-config-failed"),O(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=Gw(e),{host:a,port:l}=DV(e),h=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||kV()}function Gw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function DV(n){const e=Gw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:fv(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:fv(a)}}}function fv(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function kV(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class uo{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Vn("not implemented")}_getIdTokenResponse(e){return Vn("not implemented")}_linkToIdToken(e,t){return Vn("not implemented")}_getReauthenticationResolver(e){return Vn("not implemented")}}async function zw(n,e){return He(n,"POST","/v1/accounts:resetPassword",Ke(n,e))}async function xV(n,e){return He(n,"POST","/v1/accounts:update",e)}async function NV(n,e){return He(n,"POST","/v1/accounts:signUp",e)}async function VV(n,e){return He(n,"POST","/v1/accounts:update",Ke(n,e))}async function OV(n,e){return fr(n,"POST","/v1/accounts:signInWithPassword",Ke(n,e))}async function bl(n,e){return He(n,"POST","/v1/accounts:sendOobCode",Ke(n,e))}async function LV(n,e){return bl(n,e)}async function MV(n,e){return bl(n,e)}async function FV(n,e){return bl(n,e)}async function UV(n,e){return bl(n,e)}async function BV(n,e){return fr(n,"POST","/v1/accounts:signInWithEmailLink",Ke(n,e))}async function qV(n,e){return fr(n,"POST","/v1/accounts:signInWithEmailLink",Ke(n,e))}class Ca extends uo{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ca(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Ca(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Pa(e,t,"signInWithPassword",OV);case"emailLink":return BV(e,{email:this._email,oobCode:this._password});default:yt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Pa(e,r,"signUpPassword",NV);case"emailLink":return qV(e,{idToken:t,email:this._email,oobCode:this._password});default:yt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function cr(n,e){return fr(n,"POST","/v1/accounts:signInWithIdp",Ke(n,e))}const $V="http://localhost";class Gn extends uo{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Gn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):yt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=vp(t,["providerId","signInMethod"]);if(!r||!i)return null;const a=new Gn(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return cr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,cr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,cr(e,t)}buildRequest(){const e={requestUri:$V,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=oo(t)}return e}}async function WV(n,e){return He(n,"POST","/v1/accounts:sendVerificationCode",Ke(n,e))}async function GV(n,e){return fr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ke(n,e))}async function zV(n,e){const t=await fr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ke(n,e));if(t.temporaryProof)throw sa(n,"account-exists-with-different-credential",t);return t}const KV={USER_NOT_FOUND:"user-not-found"};async function HV(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return fr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ke(n,t),KV)}class ki extends uo{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ki({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ki({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return GV(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return zV(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return HV(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new ki({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}}function jV(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function QV(n){const e=xs(ia(n)).link,t=e?xs(ia(e)).deep_link_id:null,r=xs(ia(n)).deep_link_id;return(r?xs(ia(r)).link:null)||r||t||e||n}class Pl{constructor(e){var t,r,i,s,a,l;const h=xs(ia(e)),f=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,m=jV((i=h.mode)!==null&&i!==void 0?i:null);O(f&&p&&m,"argument-error"),this.apiKey=f,this.operation=m,this.code=p,this.continueUrl=(s=h.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(l=h.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=QV(e);try{return new Pl(t)}catch{return null}}}class Zr{constructor(){this.providerId=Zr.PROVIDER_ID}static credential(e,t){return Ca._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Pl.parseLink(t);return O(r,"argument-error"),Ca._fromEmailAndCode(e,r.code,r.tenantId)}}Zr.PROVIDER_ID="password";Zr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Zr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class pr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class lo extends pr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Os extends lo{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return O("providerId"in t&&"signInMethod"in t,"argument-error"),Gn._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return O(e.idToken||e.accessToken,"argument-error"),Gn._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Os.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Os.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:a,providerId:l}=e;if(!r&&!i&&!t&&!s||!l)return null;try{return new Os(l)._credential({idToken:t,accessToken:r,nonce:a,pendingToken:s})}catch{return null}}}class Cn extends lo{constructor(){super("facebook.com")}static credential(e){return Gn._fromParams({providerId:Cn.PROVIDER_ID,signInMethod:Cn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Cn.credentialFromTaggedObject(e)}static credentialFromError(e){return Cn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Cn.credential(e.oauthAccessToken)}catch{return null}}}Cn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Cn.PROVIDER_ID="facebook.com";class Dn extends lo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Gn._fromParams({providerId:Dn.PROVIDER_ID,signInMethod:Dn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Dn.credentialFromTaggedObject(e)}static credentialFromError(e){return Dn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Dn.credential(t,r)}catch{return null}}}Dn.GOOGLE_SIGN_IN_METHOD="google.com";Dn.PROVIDER_ID="google.com";class kn extends lo{constructor(){super("github.com")}static credential(e){return Gn._fromParams({providerId:kn.PROVIDER_ID,signInMethod:kn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return kn.credentialFromTaggedObject(e)}static credentialFromError(e){return kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return kn.credential(e.oauthAccessToken)}catch{return null}}}kn.GITHUB_SIGN_IN_METHOD="github.com";kn.PROVIDER_ID="github.com";const YV="http://localhost";class Ks extends uo{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return cr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,cr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,cr(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new Ks(r,s)}static _create(e,t){return new Ks(e,t)}buildRequest(){return{requestUri:YV,returnSecureToken:!0,pendingToken:this.pendingToken}}}const JV="saml.";class Xu extends pr{constructor(e){O(e.startsWith(JV),"argument-error"),super(e)}static credentialFromResult(e){return Xu.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Xu.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Ks.fromJSON(e);return O(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Ks._create(r,t)}catch{return null}}}class xn extends lo{constructor(){super("twitter.com")}static credential(e,t){return Gn._fromParams({providerId:xn.PROVIDER_ID,signInMethod:xn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return xn.credentialFromTaggedObject(e)}static credentialFromError(e){return xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return xn.credential(t,r)}catch{return null}}}xn.TWITTER_SIGN_IN_METHOD="twitter.com";xn.PROVIDER_ID="twitter.com";async function Kw(n,e){return fr(n,"POST","/v1/accounts:signUp",Ke(n,e))}class hn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Ci._fromIdTokenResponse(e,r,i),a=pv(r);return new hn({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=pv(r);return new hn({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function pv(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function XV(n){var e;const t=We(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new hn({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await Kw(t,{returnSecureToken:!0}),i=await hn._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(i.user),i}class Zu extends kt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Zu.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Zu(e,t,r,i)}}function Hw(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Zu._fromErrorAndOperation(n,s,e,r):s})}function jw(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}async function ZV(n,e){const t=H(n);await Cl(!0,t,e);const{providerUserInfo:r}=await rV(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=jw(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Rp(n,e,t=!1){const r=await lr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return hn._forOperation(n,"link",r)}async function Cl(n,e,t){await Sa(e);const r=jw(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";O(r.has(t)===n,e.auth,i)}async function Qw(n,e,t=!1){const{auth:r}=n,i="reauthenticate";try{const s=await lr(n,Hw(r,i,e,n),t);O(s.idToken,r,"internal-error");const a=Sl(s.idToken);O(a,r,"internal-error");const{sub:l}=a;return O(n.uid===l,r,"user-mismatch"),hn._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&yt(r,"user-mismatch"),s}}async function Yw(n,e,t=!1){const r="signIn",i=await Hw(n,r,e),s=await hn._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function Dl(n,e){return Yw(We(n),e)}async function Jw(n,e){const t=H(n);return await Cl(!1,t,e.providerId),Rp(t,e)}async function Xw(n,e){return Qw(H(n),e)}async function eO(n,e){return fr(n,"POST","/v1/accounts:signInWithCustomToken",Ke(n,e))}async function tO(n,e){const t=We(n),r=await eO(t,{token:e,returnSecureToken:!0}),i=await hn._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}class ic{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Sp._fromServerResponse(e,t):"totpInfo"in t?bp._fromServerResponse(e,t):yt(e,"internal-error")}}class Sp extends ic{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Sp(t)}}class bp extends ic{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new bp(t)}}function kl(n,e,t){var r;O(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),O(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(O(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(O(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function Pp(n){const e=We(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function nO(n,e,t){const r=We(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&kl(r,i,t),await Pa(r,i,"getOobCode",MV)}async function rO(n,e,t){await zw(H(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Pp(n),r})}async function iO(n,e){await VV(H(n),{oobCode:e})}async function Zw(n,e){const t=H(n),r=await zw(t,{oobCode:e}),i=r.requestType;switch(O(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":O(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":O(r.mfaInfo,t,"internal-error");default:O(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=ic._fromServerResponse(We(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function sO(n,e){const{data:t}=await Zw(H(n),e);return t.email}async function oO(n,e,t){const r=We(n),a=await Pa(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Kw).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&Pp(n),h}),l=await hn._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function aO(n,e,t){return Dl(H(n),Zr.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Pp(n),r})}async function cO(n,e,t){const r=We(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(a,l){O(l.handleCodeInApp,r,"argument-error"),l&&kl(r,a,l)}s(i,t),await Pa(r,i,"getOobCode",FV)}function uO(n,e){const t=Pl.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function lO(n,e,t){const r=H(n),i=Zr.credentialWithLink(e,t||Ra());return O(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Dl(r,i)}async function hO(n,e){return He(n,"POST","/v1/accounts:createAuthUri",Ke(n,e))}async function dO(n,e){const t=wp()?Ra():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await hO(H(n),r);return i||[]}async function fO(n,e){const t=H(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&kl(t.auth,i,e);const{email:s}=await LV(t.auth,i);s!==n.email&&await n.reload()}async function pO(n,e,t){const r=H(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&kl(r.auth,s,t);const{email:a}=await UV(r.auth,s);a!==n.email&&await n.reload()}async function gO(n,e){return He(n,"POST","/v1/accounts:update",e)}async function mO(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=H(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},a=await lr(r,gO(r.auth,s));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const l=r.providerData.find(({providerId:h})=>h==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function _O(n,e){return eE(H(n),e,null)}function yO(n,e){return eE(H(n),null,e)}async function eE(n,e,t){const{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);const a=await lr(n,xV(r,s));await n._updateTokensIfNecessary(a,!0)}function vO(n){var e,t;if(!n)return null;const{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const a=(t=(e=Sl(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(a){const l=a!=="anonymous"&&a!=="custom"?a:null;return new Ls(s,l)}}if(!r)return null;switch(r){case"facebook.com":return new IO(s,i);case"github.com":return new wO(s,i);case"google.com":return new EO(s,i);case"twitter.com":return new TO(s,i,n.screenName||null);case"custom":case"anonymous":return new Ls(s,null);default:return new Ls(s,r,i)}}class Ls{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class tE extends Ls{constructor(e,t,r,i){super(e,t,r),this.username=i}}class IO extends Ls{constructor(e,t){super(e,"facebook.com",t)}}class wO extends tE{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class EO extends Ls{constructor(e,t){super(e,"google.com",t)}}class TO extends tE{constructor(e,t,r){super(e,"twitter.com",t,r)}}function AO(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:vO(t)}class Ai{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new Ai("enroll",e,t)}static _fromMfaPendingCredential(e){return new Ai("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return Ai._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Ai._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Cp{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=We(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(l=>ic._fromServerResponse(r,l));O(i.mfaPendingCredential,r,"internal-error");const a=Ai._fromMfaPendingCredential(i.mfaPendingCredential);return new Cp(a,s,async l=>{const h=await l._process(r,a);delete i.mfaInfo,delete i.mfaPendingCredential;const f=Object.assign(Object.assign({},i),{idToken:h.idToken,refreshToken:h.refreshToken});switch(t.operationType){case"signIn":const p=await hn._fromIdTokenResponse(r,t.operationType,f);return await r._updateCurrentUser(p.user),p;case"reauthenticate":return O(t.user,r,"internal-error"),hn._forOperation(t.user,t.operationType,f);default:yt(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function RO(n,e){var t;const r=H(n),i=e;return O(e.customData.operationType,r,"argument-error"),O((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),Cp._fromError(r,i)}function SO(n,e){return He(n,"POST","/v2/accounts/mfaEnrollment:start",Ke(n,e))}function bO(n,e){return He(n,"POST","/v2/accounts/mfaEnrollment:finalize",Ke(n,e))}function PO(n,e){return He(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Ke(n,e))}class Dp{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>ic._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new Dp(e)}async getSession(){return Ai._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),s=await lr(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await lr(this.user,PO(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Jd=new WeakMap;function CO(n){const e=H(n);return Jd.has(e)||Jd.set(e,Dp._fromUser(e)),Jd.get(e)}const el="__sak";class nE{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(el,"1"),this.storage.removeItem(el),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}function DO(){const n=Ue();return Tp(n)||co(n)}const kO=1e3,xO=10;class rE extends nE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=DO()&&_V(),this.fallbackToPolling=qw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,l,h)=>{this.notifyListeners(a,h)});return}const r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(r);if(e.newValue!==a)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);mV()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,xO):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},kO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}rE.type="LOCAL";const kp=rE;class iE extends nE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}iE.type="SESSION";const Vi=iE;function NO(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class xl{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new xl(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(a).map(async f=>f(t.origin,s)),h=await NO(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}xl.receivers=[];function sc(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class VO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((l,h)=>{const f=sc("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(m){const I=m;if(I.data.eventId===f)switch(I.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(I.data.response);break;default:clearTimeout(p),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Ze(){return window}function OO(n){Ze().location.href=n}function xp(){return typeof Ze().WorkerGlobalScope<"u"&&typeof Ze().importScripts=="function"}async function LO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function MO(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function FO(){return xp()?self:null}const sE="firebaseLocalStorageDb",UO=1,tl="firebaseLocalStorage",oE="fbase_key";class oc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Nl(n,e){return n.transaction([tl],e?"readwrite":"readonly").objectStore(tl)}function BO(){const n=indexedDB.deleteDatabase(sE);return new oc(n).toPromise()}function wf(){const n=indexedDB.open(sE,UO);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(tl,{keyPath:oE})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(tl)?e(r):(r.close(),await BO(),e(await wf()))})})}async function gv(n,e,t){const r=Nl(n,!0).put({[oE]:e,value:t});return new oc(r).toPromise()}async function qO(n,e){const t=Nl(n,!1).get(e),r=await new oc(t).toPromise();return r===void 0?null:r.value}function mv(n,e){const t=Nl(n,!0).delete(e);return new oc(t).toPromise()}const $O=800,WO=3;class aE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await wf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>WO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return xp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=xl._getInstance(FO()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await LO(),!this.activeServiceWorker)return;this.sender=new VO(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||MO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wf();return await gv(e,el,"1"),await mv(e,el),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>gv(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>qO(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>mv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Nl(i,!1).getAll();return new oc(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$O)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}aE.type="LOCAL";const Da=aE;function GO(n,e){return He(n,"POST","/v2/accounts/mfaSignIn:start",Ke(n,e))}function zO(n,e){return He(n,"POST","/v2/accounts/mfaSignIn:finalize",Ke(n,e))}const KO=500,HO=6e4,Eu=1e12;class jO{constructor(e){this.auth=e,this.counter=Eu,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new QO(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||Eu;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||Eu;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||Eu;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class QO{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;O(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=YO(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},HO)},KO))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function YO(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const Xd=Ww("rcb"),JO=new nc(3e4,6e4),XO="https://www.google.com/recaptcha/api.js?";class ZO{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Ze().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return O(eL(t),e,"argument-error"),this.shouldResolveImmediately(t)&&av(Ze().grecaptcha)?Promise.resolve(Ze().grecaptcha):new Promise((r,i)=>{const s=Ze().setTimeout(()=>{i(mt(e,"network-request-failed"))},JO.get());Ze()[Xd]=()=>{Ze().clearTimeout(s),delete Ze()[Xd];const l=Ze().grecaptcha;if(!l||!av(l)){i(mt(e,"internal-error"));return}const h=l.render;l.render=(f,p)=>{const m=h(f,p);return this.counter++,m},this.hostLanguage=t,r(l)};const a=`${XO}?${oo({onload:Xd,render:"explicit",hl:t})}`;Ap(a).catch(()=>{clearTimeout(s),i(mt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=Ze().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function eL(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class tL{async load(e){return new jO(e)}clearedOneInstance(){}}const cE="recaptcha",nL={theme:"light",type:"image"};let rL=class{constructor(e,t,r=Object.assign({},nL)){this.parameters=r,this.type=cE,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=We(e),this.isInvisible=this.parameters.size==="invisible",O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;O(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new tL:new ZO,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const s=a=>{a&&(this.tokenChangeListeners.delete(s),i(a))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){O(!this.parameters.sitekey,this.auth,"argument-error"),O(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=Ze()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){O(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){O(wp()&&!xp(),this.auth,"internal-error"),await iL(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await eV(this.auth);O(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return O(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function iL(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}class Np{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ki._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function sL(n,e,t){const r=We(n),i=await Vl(r,e,H(t));return new Np(i,s=>Dl(r,s))}async function oL(n,e,t){const r=H(n);await Cl(!1,r,"phone");const i=await Vl(r.auth,e,H(t));return new Np(i,s=>Jw(r,s))}async function aL(n,e,t){const r=H(n),i=await Vl(r.auth,e,H(t));return new Np(i,s=>Xw(r,s))}async function Vl(n,e,t){var r;const i=await t.verify();try{O(typeof i=="string",n,"argument-error"),O(t.type===cE,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const a=s.session;if("phoneNumber"in s)return O(a.type==="enroll",n,"internal-error"),(await SO(n,{idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{O(a.type==="signin",n,"internal-error");const l=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return O(l,n,"missing-multi-factor-info"),(await GO(n,{mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:a}=await WV(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return a}}finally{t._reset()}}async function cL(n,e){await Rp(H(n),e)}let Bn=class{constructor(e){this.providerId=Bn.PROVIDER_ID,this.auth=We(e)}verifyPhoneNumber(e,t){return Vl(this.auth,e,H(t))}static credential(e,t){return ki._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Bn.credentialFromTaggedObject(t)}static credentialFromError(e){return Bn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?ki._fromTokenResponse(t,r):null}};Bn.PROVIDER_ID="phone";Bn.PHONE_SIGN_IN_METHOD="phone";function Hi(n,e){return e?Jt(e):(O(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Vp extends uo{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return cr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return cr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return cr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function uL(n){return Yw(n.auth,new Vp(n),n.bypassAuthState)}function lL(n){const{auth:e,user:t}=n;return O(t,e,"internal-error"),Qw(t,new Vp(n),n.bypassAuthState)}async function hL(n){const{auth:e,user:t}=n;return O(t,e,"internal-error"),Rp(t,new Vp(n),n.bypassAuthState)}class uE{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:l}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(h))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uL;case"linkViaPopup":case"linkViaRedirect":return hL;case"reauthViaPopup":case"reauthViaRedirect":return lL;default:yt(this.auth,"internal-error")}}resolve(e){In(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){In(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const dL=new nc(2e3,1e4);async function fL(n,e,t){const r=We(n);ao(n,e,pr);const i=Hi(r,t);return new ir(r,"signInViaPopup",e,i).executeNotNull()}async function pL(n,e,t){const r=H(n);ao(r.auth,e,pr);const i=Hi(r.auth,t);return new ir(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function gL(n,e,t){const r=H(n);ao(r.auth,e,pr);const i=Hi(r.auth,t);return new ir(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class ir extends uE{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,ir.currentPopupAction&&ir.currentPopupAction.cancel(),ir.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return O(e,this.auth,"internal-error"),e}async onExecution(){In(this.filter.length===1,"Popup operations only handle one event");const e=sc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(mt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(mt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ir.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,dL.get())};e()}}ir.currentPopupAction=null;const mL="pendingRedirect",fa=new Map;class _L extends uE{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=fa.get(this.auth._key());if(!e){try{const r=await yL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}fa.set(this.auth._key(),e)}return this.bypassAuthState||fa.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function yL(n,e){const t=hE(e),r=lE(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function Op(n,e){return lE(n)._set(hE(e),"true")}function vL(){fa.clear()}function Lp(n,e){fa.set(n._key(),e)}function lE(n){return Jt(n._redirectPersistence)}function hE(n){return Di(mL,n.config.apiKey,n.name)}function IL(n,e,t){return wL(n,e,t)}async function wL(n,e,t){const r=We(n);ao(n,e,pr),await r._initializationPromise;const i=Hi(r,t);return await Op(i,r),i._openRedirect(r,e,"signInViaRedirect")}function EL(n,e,t){return TL(n,e,t)}async function TL(n,e,t){const r=H(n);ao(r.auth,e,pr),await r.auth._initializationPromise;const i=Hi(r.auth,t);await Op(i,r.auth);const s=await dE(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function AL(n,e,t){return RL(n,e,t)}async function RL(n,e,t){const r=H(n);ao(r.auth,e,pr),await r.auth._initializationPromise;const i=Hi(r.auth,t);await Cl(!1,r,e.providerId),await Op(i,r.auth);const s=await dE(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function SL(n,e){return await We(n)._initializationPromise,Ol(n,e,!1)}async function Ol(n,e,t=!1){const r=We(n),i=Hi(r,e),a=await new _L(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}async function dE(n){const e=sc(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}const bL=10*60*1e3;class fE{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!PL(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!pE(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(mt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=bL&&this.cachedEventUids.clear(),this.cachedEventUids.has(_v(e))}saveEventToCache(e){this.cachedEventUids.add(_v(e)),this.lastProcessedEventTime=Date.now()}}function _v(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function pE({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function PL(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pE(n);default:return!1}}async function gE(n,e={}){return He(n,"GET","/v1/projects",e)}const CL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DL=/^https?/;async function kL(n){if(n.config.emulator)return;const{authorizedDomains:e}=await gE(n);for(const t of e)try{if(xL(t))return}catch{}yt(n,"unauthorized-domain")}function xL(n){const e=Ra(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!DL.test(t))return!1;if(CL.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const NL=new nc(3e4,6e4);function yv(){const n=Ze().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function VL(n){return new Promise((e,t)=>{var r,i,s;function a(){yv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{yv(),t(mt(n,"network-request-failed"))},timeout:NL.get()})}if(!((i=(r=Ze().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Ze().gapi)===null||s===void 0)&&s.load)a();else{const l=Ww("iframefcb");return Ze()[l]=()=>{gapi.load?a():t(mt(n,"network-request-failed"))},Ap(`https://apis.google.com/js/api.js?onload=${l}`).catch(h=>t(h))}}).catch(e=>{throw Mu=null,e})}let Mu=null;function OL(n){return Mu=Mu||VL(n),Mu}const LL=new nc(5e3,15e3),ML="__/auth/iframe",FL="emulator/auth/iframe",UL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},BL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function qL(n){const e=n.config;O(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Ep(e,FL):`https://${n.config.authDomain}/${ML}`,r={apiKey:e.apiKey,appName:n.name,v:Xr},i=BL.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${oo(r).slice(1)}`}async function $L(n){const e=await OL(n),t=Ze().gapi;return O(t,n,"internal-error"),e.open({where:document.body,url:qL(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:UL,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=mt(n,"network-request-failed"),l=Ze().setTimeout(()=>{s(a)},LL.get());function h(){Ze().clearTimeout(l),i(r)}r.ping(h).then(h,()=>{s(a)})}))}const WL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},GL=500,zL=600,KL="_blank",HL="http://localhost";class vv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function jL(n,e,t,r=GL,i=zL){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const h=Object.assign(Object.assign({},WL),{width:r.toString(),height:i.toString(),top:s,left:a}),f=Ue().toLowerCase();t&&(l=Mw(f)?KL:t),Lw(f)&&(e=e||HL,h.scrollbars="yes");const p=Object.entries(h).reduce((I,[A,L])=>`${I}${A}=${L},`,"");if(gV(f)&&l!=="_self")return QL(e||"",l),new vv(null);const m=window.open(e||"",l,p);O(m,n,"popup-blocked");try{m.focus()}catch{}return new vv(m)}function QL(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const YL="__/auth/handler",JL="emulator/auth/handler",XL=encodeURIComponent("fac");async function Ef(n,e,t,r,i,s){O(n.config.authDomain,n,"auth-domain-config-required"),O(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Xr,eventId:i};if(e instanceof pr){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",wx(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries(s||{}))a[p]=m}if(e instanceof lo){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);const l=a;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const h=await n._getAppCheckToken(),f=h?`#${XL}=${encodeURIComponent(h)}`:"";return`${ZL(n)}?${oo(l).slice(1)}${f}`}function ZL({config:n}){return n.emulator?Ep(n,JL):`https://${n.authDomain}/${YL}`}const Zd="webStorageSupport";class eM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Vi,this._completeRedirectFn=Ol,this._overrideRedirectResult=Lp}async _openPopup(e,t,r,i){var s;In((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Ef(e,t,r,Ra(),i);return jL(e,a,sc())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await Ef(e,t,r,Ra(),i);return OO(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(In(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await $L(e),r=new fE(e);return t.register("authEvent",i=>(O(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Zd,{type:Zd},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Zd];a!==void 0&&t(!!a),yt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=kL(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return qw()||Tp()||co()}}const tM=eM;class nM{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Vn("unexpected MultiFactorSessionType")}}}class Mp extends nM{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Mp(e)}_finalizeEnroll(e,t,r){return bO(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return zO(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class mE{constructor(){}static assertion(e){return Mp._fromCredential(e)}}mE.FACTOR_ID="phone";var Iv="@firebase/auth",wv="1.5.1";class rM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){O(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function iM(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function sM(n){Br(new Wn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;O(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$w(n)},f=new EV(r,i,s,h);return PV(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Br(new Wn("auth-internal",e=>{const t=We(e.getProvider("auth").getImmediate());return(r=>new rM(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Un(Iv,wv,iM(n)),Un(Iv,wv,"esm2017")}const oM=5*60;hx("authIdTokenMaxAge");sM("Browser");function Oi(){return window}const aM=2e3;async function cM(n,e,t){var r;const{BuildInfo:i}=Oi();In(e.sessionId,"AuthEvent did not contain a session ID");const s=await fM(e.sessionId),a={};return co()?a.ibi=i.packageName:rc()?a.apn=i.packageName:yt(n,"operation-not-supported-in-this-environment"),i.displayName&&(a.appDisplayName=i.displayName),a.sessionId=s,Ef(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,a)}async function uM(n){const{BuildInfo:e}=Oi(),t={};co()?t.iosBundleId=e.packageName:rc()?t.androidPackageName=e.packageName:yt(n,"operation-not-supported-in-this-environment"),await gE(n,t)}function lM(n){const{cordova:e}=Oi();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,pV()?"_blank":"_system","location=yes"),t(i)})})}async function hM(n,e,t){const{cordova:r}=Oi();let i=()=>{};try{await new Promise((s,a)=>{let l=null;function h(){var m;s();const I=(m=r.plugins.browsertab)===null||m===void 0?void 0:m.close;typeof I=="function"&&I(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function f(){l||(l=window.setTimeout(()=>{a(mt(n,"redirect-cancelled-by-user"))},aM))}function p(){(document==null?void 0:document.visibilityState)==="visible"&&f()}e.addPassiveListener(h),document.addEventListener("resume",f,!1),rc()&&document.addEventListener("visibilitychange",p,!1),i=()=>{e.removePassiveListener(h),document.removeEventListener("resume",f,!1),document.removeEventListener("visibilitychange",p,!1),l&&window.clearTimeout(l)}})}finally{i()}}function dM(n){var e,t,r,i,s,a,l,h,f,p;const m=Oi();O(typeof((e=m==null?void 0:m.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),O(typeof((t=m==null?void 0:m.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),O(typeof((s=(i=(r=m==null?void 0:m.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((h=(l=(a=m==null?void 0:m.cordova)===null||a===void 0?void 0:a.plugins)===null||l===void 0?void 0:l.browsertab)===null||h===void 0?void 0:h.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((p=(f=m==null?void 0:m.cordova)===null||f===void 0?void 0:f.InAppBrowser)===null||p===void 0?void 0:p.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function fM(n){const e=pM(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function pM(n){if(In(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}const gM=20;class mM extends fE{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function _M(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:IM(),postBody:null,tenantId:n.tenantId,error:mt(n,"no-auth-event")}}function yM(n,e){return Tf()._set(Af(n),e)}async function Ev(n){const e=await Tf()._get(Af(n));return e&&await Tf()._remove(Af(n)),e}function vM(n,e){var t,r;const i=EM(e);if(i.includes("/__/auth/callback")){const s=Fu(i),a=s.firebaseError?wM(decodeURIComponent(s.firebaseError)):null,l=(r=(t=a==null?void 0:a.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],h=l?mt(l):null;return h?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:h,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function IM(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<gM;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function Tf(){return Jt(kp)}function Af(n){return Di("authEvent",n.config.apiKey,n.name)}function wM(n){try{return JSON.parse(n)}catch{return null}}function EM(n){const e=Fu(n),t=e.link?decodeURIComponent(e.link):void 0,r=Fu(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Fu(i).link||i||r||t||n}function Fu(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return xs(t.join("?"))}const TM=500;class AM{constructor(){this._redirectPersistence=Vi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Ol,this._overrideRedirectResult=Lp}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new mM(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){yt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){dM(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),vL(),await this._originValidation(e);const a=_M(e,r,i);await yM(e,a);const l=await cM(e,a,t),h=await lM(l);return hM(e,s,h)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=uM(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Oi(),a=setTimeout(async()=>{await Ev(e),t.onEvent(Tv())},TM),l=async p=>{clearTimeout(a);const m=await Ev(e);let I=null;m&&(p!=null&&p.url)&&(I=vM(m,p.url)),t.onEvent(I||Tv())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,l);const h=i,f=`${s.packageName.toLowerCase()}://`;Oi().handleOpenURL=async p=>{if(p.toLowerCase().startsWith(f)&&l({url:p}),typeof h=="function")try{h(p)}catch(m){console.error(m)}}}}const RM=AM;function Tv(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:mt("no-auth-event")}}function SM(n,e){We(n)._logFramework(e)}var bM="@firebase/auth-compat",PM="0.5.1";const CM=1e3;function pa(){var n;return((n=self==null?void 0:self.location)===null||n===void 0?void 0:n.protocol)||null}function DM(){return pa()==="http:"||pa()==="https:"}function _E(n=Ue()){return!!((pa()==="file:"||pa()==="ionic:"||pa()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function kM(){return gp()||pp()}function xM(){return gw()&&(document==null?void 0:document.documentMode)===11}function NM(n=Ue()){return/Edge\/\d+/.test(n)}function VM(n=Ue()){return xM()||NM(n)}function yE(){try{const n=self.localStorage,e=sc();if(n)return n.setItem(e,"1"),n.removeItem(e),VM()?Ea():!0}catch{return Fp()&&Ea()}return!1}function Fp(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function ef(){return(DM()||pw()||_E())&&!kM()&&yE()&&!Fp()}function vE(){return _E()&&typeof document<"u"}async function OM(){return vE()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},CM);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function LM(){return typeof window<"u"?window:null}const Yt={LOCAL:"local",NONE:"none",SESSION:"session"},Ko=O,IE="persistence";function MM(n,e){if(Ko(Object.values(Yt).includes(e),n,"invalid-persistence-type"),gp()){Ko(e!==Yt.SESSION,n,"unsupported-persistence-type");return}if(pp()){Ko(e===Yt.NONE,n,"unsupported-persistence-type");return}if(Fp()){Ko(e===Yt.NONE||e===Yt.LOCAL&&Ea(),n,"unsupported-persistence-type");return}Ko(e===Yt.NONE||yE(),n,"unsupported-persistence-type")}async function Rf(n){await n._initializationPromise;const e=wE(),t=Di(IE,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())}function FM(n,e){const t=wE();if(!t)return[];const r=Di(IE,n,e);switch(t.getItem(r)){case Yt.NONE:return[zs];case Yt.LOCAL:return[Da,Vi];case Yt.SESSION:return[Vi];default:return[]}}function wE(){var n;try{return((n=LM())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}const UM=O;class Vr{constructor(){this.browserResolver=Jt(tM),this.cordovaResolver=Jt(RM),this.underlyingResolver=null,this._redirectPersistence=Vi,this._completeRedirectFn=Ol,this._overrideRedirectResult=Lp}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return vE()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return UM(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await OM();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function EE(n){return n.unwrap()}function BM(n){return n.wrapped()}function qM(n){return TE(n)}function $M(n,e){var t;const r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new WM(n,RO(n,e))}else if(r){const i=TE(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function TE(n){const{_tokenResponse:e}=n instanceof kt?n.customData:n;if(!e)return null;if(!(n instanceof kt)&&"temporaryProof"in e&&"phoneNumber"in e)return Bn.credentialFromResult(n);const t=e.providerId;if(!t||t===zo.PASSWORD)return null;let r;switch(t){case zo.GOOGLE:r=Dn;break;case zo.FACEBOOK:r=Cn;break;case zo.GITHUB:r=kn;break;case zo.TWITTER:r=xn;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:h}=e;return!s&&!a&&!i&&!l?null:l?t.startsWith("saml.")?Ks._create(t,l):Gn._fromParams({providerId:t,signInMethod:t,pendingToken:l,idToken:i,accessToken:s}):new Os(t).credential({idToken:i,accessToken:s,rawNonce:h})}return n instanceof kt?r.credentialFromError(n):r.credentialFromResult(n)}function Ut(n,e){return e.catch(t=>{throw t instanceof kt&&$M(n,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:qM(t),additionalUserInfo:AO(t),user:Or.getOrCreate(i)}})}async function Sf(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>Ut(n,t.confirm(r))}}class WM{constructor(e,t){this.resolver=t,this.auth=BM(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Ut(EE(this.auth),this.resolver.resolveSignIn(e))}}let Or=class{constructor(e){this._delegate=e,this.multiFactor=CO(e)}static getOrCreate(e){return Or.USER_MAP.has(e)||Or.USER_MAP.set(e,new Or(e)),Or.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Ut(this.auth,Jw(this._delegate,e))}async linkWithPhoneNumber(e,t){return Sf(this.auth,oL(this._delegate,e,t))}async linkWithPopup(e){return Ut(this.auth,gL(this._delegate,e,Vr))}async linkWithRedirect(e){return await Rf(We(this.auth)),AL(this._delegate,e,Vr)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Ut(this.auth,Xw(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Sf(this.auth,aL(this._delegate,e,t))}reauthenticateWithPopup(e){return Ut(this.auth,pL(this._delegate,e,Vr))}async reauthenticateWithRedirect(e){return await Rf(We(this.auth)),EL(this._delegate,e,Vr)}sendEmailVerification(e){return fO(this._delegate,e)}async unlink(e){return await ZV(this._delegate,e),this}updateEmail(e){return _O(this._delegate,e)}updatePassword(e){return yO(this._delegate,e)}updatePhoneNumber(e){return cL(this._delegate,e)}updateProfile(e){return mO(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return pO(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Or.USER_MAP=new WeakMap;const Ho=O;class bf{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Ho(r,"invalid-api-key",{appName:e.name}),Ho(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?Vr:void 0;this._delegate=t.initialize({options:{persistence:GM(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(GN),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Or.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){CV(this._delegate,e,t)}applyActionCode(e){return iO(this._delegate,e)}checkActionCode(e){return Zw(this._delegate,e)}confirmPasswordReset(e,t){return rO(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Ut(this._delegate,oO(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return dO(this._delegate,e)}isSignInWithEmailLink(e){return uO(this._delegate,e)}async getRedirectResult(){Ho(ef(),this._delegate,"operation-not-supported-in-this-environment");const e=await SL(this._delegate,Vr);return e?Ut(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){SM(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:s,complete:a}=Av(e,t,r);return this._delegate.onAuthStateChanged(i,s,a)}onIdTokenChanged(e,t,r){const{next:i,error:s,complete:a}=Av(e,t,r);return this._delegate.onIdTokenChanged(i,s,a)}sendSignInLinkToEmail(e,t){return cO(this._delegate,e,t)}sendPasswordResetEmail(e,t){return nO(this._delegate,e,t||void 0)}async setPersistence(e){MM(this._delegate,e);let t;switch(e){case Yt.SESSION:t=Vi;break;case Yt.LOCAL:t=await Jt(Da)._isAvailable()?Da:kp;break;case Yt.NONE:t=zs;break;default:return yt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Ut(this._delegate,XV(this._delegate))}signInWithCredential(e){return Ut(this._delegate,Dl(this._delegate,e))}signInWithCustomToken(e){return Ut(this._delegate,tO(this._delegate,e))}signInWithEmailAndPassword(e,t){return Ut(this._delegate,aO(this._delegate,e,t))}signInWithEmailLink(e,t){return Ut(this._delegate,lO(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Sf(this._delegate,sL(this._delegate,e,t))}async signInWithPopup(e){return Ho(ef(),this._delegate,"operation-not-supported-in-this-environment"),Ut(this._delegate,fL(this._delegate,e,Vr))}async signInWithRedirect(e){return Ho(ef(),this._delegate,"operation-not-supported-in-this-environment"),await Rf(this._delegate),IL(this._delegate,e,Vr)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return sO(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}bf.Persistence=Yt;function Av(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const i=r;return{next:a=>i(a&&Or.getOrCreate(a)),error:e,complete:t}}function GM(n,e){const t=FM(n,e);if(typeof self<"u"&&!t.includes(Da)&&t.push(Da),typeof window<"u")for(const r of[kp,Vi])t.includes(r)||t.push(r);return t.includes(zs)||t.push(zs),t}class Up{constructor(){this.providerId="phone",this._delegate=new Bn(EE(qr.auth()))}static credential(e,t){return Bn.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}Up.PHONE_SIGN_IN_METHOD=Bn.PHONE_SIGN_IN_METHOD;Up.PROVIDER_ID=Bn.PROVIDER_ID;const zM=O;class KM{constructor(e,t,r=qr.app()){var i;zM((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new rL(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const HM="auth-compat";function jM(n){n.INTERNAL.registerComponent(new Wn(HM,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new bf(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ys.EMAIL_SIGNIN,PASSWORD_RESET:ys.PASSWORD_RESET,RECOVER_EMAIL:ys.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:ys.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:ys.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:ys.VERIFY_EMAIL}},EmailAuthProvider:Zr,FacebookAuthProvider:Cn,GithubAuthProvider:kn,GoogleAuthProvider:Dn,OAuthProvider:Os,SAMLAuthProvider:Xu,PhoneAuthProvider:Up,PhoneMultiFactorGenerator:mE,RecaptchaVerifier:KM,TwitterAuthProvider:xn,Auth:bf,AuthCredential:uo,Error:kt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(bM,PM)}jM(qr);var QM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},q,Bp=Bp||{},Z=QM||self;function Ll(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function ac(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function YM(n){return Object.prototype.hasOwnProperty.call(n,tf)&&n[tf]||(n[tf]=++JM)}var tf="closure_uid_"+(1e9*Math.random()>>>0),JM=0;function XM(n,e,t){return n.call.apply(n.bind,arguments)}function ZM(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function Et(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Et=XM:Et=ZM,Et.apply(null,arguments)}function Tu(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ct(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var a=Array(arguments.length-2),l=2;l<arguments.length;l++)a[l-2]=arguments[l];return e.prototype[i].apply(r,a)}}function ei(){this.s=this.s,this.o=this.o}var eF=0;ei.prototype.s=!1;ei.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),eF!=0)&&YM(this)};ei.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const AE=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function qp(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Rv(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Ll(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let a=0;a<s;a++)n[i+a]=r[a]}else n.push(r)}}function Tt(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Tt.prototype.h=function(){this.defaultPrevented=!0};var tF=function(){if(!Z.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const t=()=>{};Z.addEventListener("test",t,e),Z.removeEventListener("test",t,e)}catch{}return n}();function ka(n){return/^[\s\xa0]*$/.test(n)}function Ml(){var n=Z.navigator;return n&&(n=n.userAgent)?n:""}function Nn(n){return Ml().indexOf(n)!=-1}function $p(n){return $p[" "](n),n}$p[" "]=function(){};function nF(n,e){var t=jF;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}var rF=Nn("Opera"),Hs=Nn("Trident")||Nn("MSIE"),RE=Nn("Edge"),Pf=RE||Hs,SE=Nn("Gecko")&&!(Ml().toLowerCase().indexOf("webkit")!=-1&&!Nn("Edge"))&&!(Nn("Trident")||Nn("MSIE"))&&!Nn("Edge"),iF=Ml().toLowerCase().indexOf("webkit")!=-1&&!Nn("Edge");function bE(){var n=Z.document;return n?n.documentMode:void 0}var Cf;e:{var nf="",rf=function(){var n=Ml();if(SE)return/rv:([^\);]+)(\)|;)/.exec(n);if(RE)return/Edge\/([\d\.]+)/.exec(n);if(Hs)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(iF)return/WebKit\/(\S+)/.exec(n);if(rF)return/(?:Version)[ \/]?(\S+)/.exec(n)}();if(rf&&(nf=rf?rf[1]:""),Hs){var sf=bE();if(sf!=null&&sf>parseFloat(nf)){Cf=String(sf);break e}}Cf=nf}var Df;if(Z.document&&Hs){var Sv=bE();Df=Sv||parseInt(Cf,10)||void 0}else Df=void 0;var sF=Df;function xa(n,e){if(Tt.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(SE){e:{try{$p(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:oF[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&xa.$.h.call(this)}}ct(xa,Tt);var oF={2:"touch",3:"pen",4:"mouse"};xa.prototype.h=function(){xa.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var cc="closure_listenable_"+(1e6*Math.random()|0),aF=0;function cF(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++aF,this.fa=this.ia=!1}function Fl(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function Wp(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function uF(n,e){for(const t in n)e.call(void 0,n[t],t,n)}function PE(n){const e={};for(const t in n)e[t]=n[t];return e}const bv="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function CE(n,e){let t,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(t in r)n[t]=r[t];for(let s=0;s<bv.length;s++)t=bv[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Ul(n){this.src=n,this.g={},this.h=0}Ul.prototype.add=function(n,e,t,r,i){var s=n.toString();n=this.g[s],n||(n=this.g[s]=[],this.h++);var a=xf(n,e,r,i);return-1<a?(e=n[a],t||(e.ia=!1)):(e=new cF(e,this.src,s,!!r,i),e.ia=t,n.push(e)),e};function kf(n,e){var t=e.type;if(t in n.g){var r=n.g[t],i=AE(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Fl(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function xf(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}var Gp="closure_lm_"+(1e6*Math.random()|0),of={};function DE(n,e,t,r,i){if(r&&r.once)return xE(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)DE(n,e[s],t,r,i);return null}return t=Hp(t),n&&n[cc]?n.O(e,t,ac(r)?!!r.capture:!!r,i):kE(n,e,t,!1,r,i)}function kE(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var a=ac(i)?!!i.capture:!!i,l=Kp(n);if(l||(n[Gp]=l=new Ul(n)),t=l.add(e,t,r,a,s),t.proxy)return t;if(r=lF(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)tF||(i=a),i===void 0&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(VE(e.toString()),r);else if(n.addListener&&n.removeListener)n.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return t}function lF(){function n(t){return e.call(n.src,n.listener,t)}const e=hF;return n}function xE(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)xE(n,e[s],t,r,i);return null}return t=Hp(t),n&&n[cc]?n.P(e,t,ac(r)?!!r.capture:!!r,i):kE(n,e,t,!0,r,i)}function NE(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)NE(n,e[s],t,r,i);else r=ac(r)?!!r.capture:!!r,t=Hp(t),n&&n[cc]?(n=n.i,e=String(e).toString(),e in n.g&&(s=n.g[e],t=xf(s,t,r,i),-1<t&&(Fl(s[t]),Array.prototype.splice.call(s,t,1),s.length==0&&(delete n.g[e],n.h--)))):n&&(n=Kp(n))&&(e=n.g[e.toString()],n=-1,e&&(n=xf(e,t,r,i)),(t=-1<n?e[n]:null)&&zp(t))}function zp(n){if(typeof n!="number"&&n&&!n.fa){var e=n.src;if(e&&e[cc])kf(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(VE(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Kp(e))?(kf(t,n),t.h==0&&(t.src=null,e[Gp]=null)):Fl(n)}}}function VE(n){return n in of?of[n]:of[n]="on"+n}function hF(n,e){if(n.fa)n=!0;else{e=new xa(e,this);var t=n.listener,r=n.la||n.src;n.ia&&zp(n),n=t.call(r,e)}return n}function Kp(n){return n=n[Gp],n instanceof Ul?n:null}var af="__closure_events_fn_"+(1e9*Math.random()>>>0);function Hp(n){return typeof n=="function"?n:(n[af]||(n[af]=function(e){return n.handleEvent(e)}),n[af])}function at(){ei.call(this),this.i=new Ul(this),this.S=this,this.J=null}ct(at,ei);at.prototype[cc]=!0;at.prototype.removeEventListener=function(n,e,t,r){NE(this,n,e,t,r)};function _t(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,typeof e=="string")e=new Tt(e,n);else if(e instanceof Tt)e.target=e.target||n;else{var i=e;e=new Tt(r,n),CE(e,i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var a=e.g=t[s];i=Au(a,r,!0,e)&&i}if(a=e.g=n,i=Au(a,r,!0,e)&&i,i=Au(a,r,!1,e)&&i,t)for(s=0;s<t.length;s++)a=e.g=t[s],i=Au(a,r,!1,e)&&i}at.prototype.N=function(){if(at.$.N.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Fl(t[r]);delete n.g[e],n.h--}}this.J=null};at.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)};at.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};function Au(n,e,t,r){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==t){var l=a.listener,h=a.la||a.src;a.ia&&kf(n.i,a),i=l.call(h,r)!==!1&&i}}return i&&!r.defaultPrevented}var jp=Z.JSON.stringify;class dF{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function fF(){var n=Qp;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}class pF{constructor(){this.h=this.g=null}add(e,t){const r=OE.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}}var OE=new dF(()=>new gF,n=>n.reset());class gF{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function mF(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function _F(n){Z.setTimeout(()=>{throw n},0)}let Na,Va=!1,Qp=new pF,LE=()=>{const n=Z.Promise.resolve(void 0);Na=()=>{n.then(yF)}};var yF=()=>{for(var n;n=fF();){try{n.h.call(n.g)}catch(t){_F(t)}var e=OE;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Va=!1};function Bl(n,e){at.call(this),this.h=n||1,this.g=e||Z,this.j=Et(this.qb,this),this.l=Date.now()}ct(Bl,at);q=Bl.prototype;q.ga=!1;q.T=null;q.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),_t(this,"tick"),this.ga&&(Yp(this),this.start()))}};q.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Yp(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}q.N=function(){Bl.$.N.call(this),Yp(this),delete this.g};function Jp(n,e,t){if(typeof n=="function")t&&(n=Et(n,t));else if(n&&typeof n.handleEvent=="function")n=Et(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Z.setTimeout(n,e||0)}function ME(n){n.g=Jp(()=>{n.g=null,n.i&&(n.i=!1,ME(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}class vF extends ei{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:ME(this)}N(){super.N(),this.g&&(Z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Oa(n){ei.call(this),this.h=n,this.g={}}ct(Oa,ei);var Pv=[];function FE(n,e,t,r){Array.isArray(t)||(t&&(Pv[0]=t.toString()),t=Pv);for(var i=0;i<t.length;i++){var s=DE(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function UE(n){Wp(n.g,function(e,t){this.g.hasOwnProperty(t)&&zp(e)},n),n.g={}}Oa.prototype.N=function(){Oa.$.N.call(this),UE(this)};Oa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ql(){this.g=!0}ql.prototype.Ea=function(){this.g=!1};function IF(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var a="",l=s.split("&"),h=0;h<l.length;h++){var f=l[h].split("=");if(1<f.length){var p=f[0];f=f[1];var m=p.split("_");a=2<=m.length&&m[1]=="type"?a+(p+"="+f+"&"):a+(p+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+t+`
`+a})}function wF(n,e,t,r,i,s,a){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+t+`
`+s+" "+a})}function Ns(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+TF(n,t)+(r?" "+r:"")})}function EF(n,e){n.info(function(){return"TIMEOUT: "+e})}ql.prototype.info=function(){};function TF(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return jp(t)}catch{return e}}var ji={},Cv=null;function $l(){return Cv=Cv||new at}ji.Ta="serverreachability";function BE(n){Tt.call(this,ji.Ta,n)}ct(BE,Tt);function La(n){const e=$l();_t(e,new BE(e))}ji.STAT_EVENT="statevent";function qE(n,e){Tt.call(this,ji.STAT_EVENT,n),this.stat=e}ct(qE,Tt);function Dt(n){const e=$l();_t(e,new qE(e,n))}ji.Ua="timingevent";function $E(n,e){Tt.call(this,ji.Ua,n),this.size=e}ct($E,Tt);function uc(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return Z.setTimeout(function(){n()},e)}var Wl={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},WE={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Xp(){}Xp.prototype.h=null;function Dv(n){return n.h||(n.h=n.i())}function GE(){}var lc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Zp(){Tt.call(this,"d")}ct(Zp,Tt);function eg(){Tt.call(this,"c")}ct(eg,Tt);var Nf;function Gl(){}ct(Gl,Xp);Gl.prototype.g=function(){return new XMLHttpRequest};Gl.prototype.i=function(){return{}};Nf=new Gl;function hc(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new Oa(this),this.P=AF,n=Pf?125:void 0,this.V=new Bl(n),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new zE}function zE(){this.i=null,this.g="",this.h=!1}var AF=45e3,KE={},Vf={};q=hc.prototype;q.setTimeout=function(n){this.P=n};function Of(n,e,t){n.L=1,n.A=Kl(hr(e)),n.u=t,n.S=!0,HE(n,null)}function HE(n,e){n.G=Date.now(),dc(n),n.B=hr(n.A);var t=n.B,r=n.W;Array.isArray(r)||(r=[String(r)]),tT(t.i,"t",r),n.o=0,t=n.l.J,n.h=new zE,n.g=ET(n.l,t?e:null,!n.u),0<n.O&&(n.M=new vF(Et(n.Pa,n,n.g),n.O)),FE(n.U,n.g,"readystatechange",n.nb),e=n.I?PE(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),La(),IF(n.j,n.v,n.B,n.m,n.W,n.u)}q.nb=function(n){n=n.target;const e=this.M;e&&On(n)==3?e.l():this.Pa(n)};q.Pa=function(n){try{if(n==this.g)e:{const p=On(this.g);var e=this.g.Ia();const m=this.g.da();if(!(3>p)&&(p!=3||Pf||this.g&&(this.h.h||this.g.ja()||Vv(this.g)))){this.J||p!=4||e==7||(e==8||0>=m?La(3):La(2)),zl(this);var t=this.g.da();this.ca=t;t:if(jE(this)){var r=Vv(this.g);n="";var i=r.length,s=On(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ri(this),ga(this);var a="";break t}this.h.i=new Z.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=n,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=t==200,wF(this.j,this.v,this.B,this.m,this.W,p,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var l,h=this.g;if((l=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ka(l)){var f=l;break t}}f=null}if(t=f)Ns(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Lf(this,t);else{this.i=!1,this.s=3,Dt(12),Ri(this),ga(this);break e}}this.S?(QE(this,p,a),Pf&&this.i&&p==3&&(FE(this.U,this.V,"tick",this.mb),this.V.start())):(Ns(this.j,this.m,a,null),Lf(this,a)),p==4&&Ri(this),this.i&&!this.J&&(p==4?yT(this.l,this):(this.i=!1,dc(this)))}else zF(this.g),t==400&&0<a.indexOf("Unknown SID")?(this.s=3,Dt(12)):(this.s=0,Dt(13)),Ri(this),ga(this)}}}catch{}finally{}};function jE(n){return n.g?n.v=="GET"&&n.L!=2&&n.l.Ha:!1}function QE(n,e,t){let r=!0,i;for(;!n.J&&n.o<t.length;)if(i=RF(n,t),i==Vf){e==4&&(n.s=4,Dt(14),r=!1),Ns(n.j,n.m,null,"[Incomplete Response]");break}else if(i==KE){n.s=4,Dt(15),Ns(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}else Ns(n.j,n.m,i,null),Lf(n,i);jE(n)&&n.o!=0&&(n.h.g=n.h.g.slice(n.o),n.o=0),e!=4||t.length!=0||n.h.h||(n.s=1,Dt(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,e=n.l,e.g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),og(e),e.M=!0,Dt(11))):(Ns(n.j,n.m,t,"[Invalid Chunked Response]"),Ri(n),ga(n))}q.mb=function(){if(this.g){var n=On(this.g),e=this.g.ja();this.o<e.length&&(zl(this),QE(this,n,e),this.i&&n!=4&&dc(this))}};function RF(n,e){var t=n.o,r=e.indexOf(`
`,t);return r==-1?Vf:(t=Number(e.substring(t,r)),isNaN(t)?KE:(r+=1,r+t>e.length?Vf:(e=e.slice(r,r+t),n.o=r+t,e)))}q.cancel=function(){this.J=!0,Ri(this)};function dc(n){n.Y=Date.now()+n.P,YE(n,n.P)}function YE(n,e){if(n.C!=null)throw Error("WatchDog timer not null");n.C=uc(Et(n.lb,n),e)}function zl(n){n.C&&(Z.clearTimeout(n.C),n.C=null)}q.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(EF(this.j,this.B),this.L!=2&&(La(),Dt(17)),Ri(this),this.s=2,ga(this)):YE(this,this.Y-n)};function ga(n){n.l.H==0||n.J||yT(n.l,n)}function Ri(n){zl(n);var e=n.M;e&&typeof e.sa=="function"&&e.sa(),n.M=null,Yp(n.V),UE(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function Lf(n,e){try{var t=n.l;if(t.H!=0&&(t.g==n||Mf(t.i,n))){if(!n.K&&Mf(t.i,n)&&t.H==3){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<n.G)il(t),Yl(t);else break e;sg(t),Dt(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&t.A==0&&!t.v&&(t.v=uc(Et(t.ib,t),6e3));if(1>=iT(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Si(t,11)}else if((n.K||t.g==n)&&il(t),!ka(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let f=i[e];if(t.V=f[0],f=f[1],t.H==2)if(f[0]=="c"){t.K=f[1],t.pa=f[2];const p=f[3];p!=null&&(t.ra=p,t.l.info("VER="+t.ra));const m=f[4];m!=null&&(t.Ga=m,t.l.info("SVER="+t.Ga));const I=f[5];I!=null&&typeof I=="number"&&0<I&&(r=1.5*I,t.L=r,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const A=n.g;if(A){const L=A.g?A.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(L){var s=r.i;s.g||L.indexOf("spdy")==-1&&L.indexOf("quic")==-1&&L.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(tg(s,s.h),s.h=null))}if(r.F){const M=A.g?A.g.getResponseHeader("X-HTTP-Session-Id"):null;M&&(r.Da=M,ke(r.I,r.F,M))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms")),r=t;var a=n;if(r.wa=wT(r,r.J?r.pa:null,r.Y),a.K){sT(r.i,a);var l=a,h=r.L;h&&l.setTimeout(h),l.C&&(zl(l),dc(l)),r.g=a}else mT(r);0<t.j.length&&Jl(t)}else f[0]!="stop"&&f[0]!="close"||Si(t,7);else t.H==3&&(f[0]=="stop"||f[0]=="close"?f[0]=="stop"?Si(t,7):ig(t):f[0]!="noop"&&t.h&&t.h.Aa(f),t.A=0)}}La(4)}catch{}}function SF(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(Ll(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}e=[],t=0;for(r in n)e[t++]=n[r];return e}function bF(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Ll(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}function JE(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(Ll(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=bF(n),r=SF(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}var XE=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PF(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function xi(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof xi){this.h=n.h,nl(this,n.j),this.s=n.s,this.g=n.g,rl(this,n.m),this.l=n.l;var e=n.i,t=new Ma;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),kv(this,t),this.o=n.o}else n&&(e=String(n).match(XE))?(this.h=!1,nl(this,e[1]||"",!0),this.s=oa(e[2]||""),this.g=oa(e[3]||"",!0),rl(this,e[4]),this.l=oa(e[5]||"",!0),kv(this,e[6]||"",!0),this.o=oa(e[7]||"")):(this.h=!1,this.i=new Ma(null,this.h))}xi.prototype.toString=function(){var n=[],e=this.j;e&&n.push(aa(e,xv,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(aa(e,xv,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(aa(t,t.charAt(0)=="/"?kF:DF,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",aa(t,NF)),n.join("")};function hr(n){return new xi(n)}function nl(n,e,t){n.j=t?oa(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function rl(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function kv(n,e,t){e instanceof Ma?(n.i=e,VF(n.i,n.h)):(t||(e=aa(e,xF)),n.i=new Ma(e,n.h))}function ke(n,e,t){n.i.set(e,t)}function Kl(n){return ke(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function oa(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function aa(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,CF),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function CF(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var xv=/[#\/\?@]/g,DF=/[#\?:]/g,kF=/[#\?]/g,xF=/[#\?@]/g,NF=/#/g;function Ma(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function ti(n){n.g||(n.g=new Map,n.h=0,n.i&&PF(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}q=Ma.prototype;q.add=function(n,e){ti(this),this.i=null,n=ho(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function ZE(n,e){ti(n),e=ho(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function eT(n,e){return ti(n),e=ho(n,e),n.g.has(e)}q.forEach=function(n,e){ti(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)};q.ta=function(){ti(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t};q.Z=function(n){ti(this);let e=[];if(typeof n=="string")eT(this,n)&&(e=e.concat(this.g.get(ho(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};q.set=function(n,e){return ti(this),this.i=null,n=ho(this,n),eT(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};q.get=function(n,e){return n?(n=this.Z(n),0<n.length?String(n[0]):e):e};function tT(n,e,t){ZE(n,e),0<t.length&&(n.i=null,n.g.set(ho(n,e),qp(t)),n.h+=t.length)}q.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;a[r]!==""&&(i+="="+encodeURIComponent(String(a[r]))),n.push(i)}}return this.i=n.join("&")};function ho(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function VF(n,e){e&&!n.j&&(ti(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(ZE(this,r),tT(this,i,t))},n)),n.j=e}var OF=class{constructor(n,e){this.g=n,this.map=e}};function nT(n){this.l=n||LF,Z.PerformanceNavigationTiming?(n=Z.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(Z.g&&Z.g.Ka&&Z.g.Ka()&&Z.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var LF=10;function rT(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function iT(n){return n.h?1:n.g?n.g.size:0}function Mf(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function tg(n,e){n.g?n.g.add(e):n.h=e}function sT(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}nT.prototype.cancel=function(){if(this.i=oT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function oT(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return qp(n.i)}var MF=class{stringify(n){return Z.JSON.stringify(n,void 0)}parse(n){return Z.JSON.parse(n,void 0)}};function FF(){this.g=new MF}function UF(n,e,t){const r=t||"";try{JE(n,function(i,s){let a=i;ac(i)&&(a=jp(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function BF(n,e){const t=new ql;if(Z.Image){const r=new Image;r.onload=Tu(Ru,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Tu(Ru,t,r,"TestLoadImage: error",!1,e),r.onabort=Tu(Ru,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Tu(Ru,t,r,"TestLoadImage: timeout",!1,e),Z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}function Ru(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Hl(n){this.l=n.ec||null,this.j=n.ob||!1}ct(Hl,Xp);Hl.prototype.g=function(){return new jl(this.l,this.j)};Hl.prototype.i=function(n){return function(){return n}}({});function jl(n,e){at.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=ng,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ct(jl,at);var ng=0;q=jl.prototype;q.open=function(n,e){if(this.readyState!=ng)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Fa(this)};q.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||Z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};q.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,fc(this)),this.readyState=ng};q.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Fa(this)),this.g&&(this.readyState=3,Fa(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Z.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;aT(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function aT(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}q.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?fc(this):Fa(this),this.readyState==3&&aT(this)}};q.Za=function(n){this.g&&(this.response=this.responseText=n,fc(this))};q.Ya=function(n){this.g&&(this.response=n,fc(this))};q.ka=function(){this.g&&fc(this)};function fc(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Fa(n)}q.setRequestHeader=function(n,e){this.v.append(n,e)};q.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};q.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function Fa(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(jl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var qF=Z.JSON.parse;function Ge(n){at.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=cT,this.L=this.M=!1}ct(Ge,at);var cT="",$F=/^https?$/i,WF=["POST","PUT"];q=Ge.prototype;q.Oa=function(n){this.M=n};q.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Nf.g(),this.C=this.u?Dv(this.u):Dv(Nf),this.g.onreadystatechange=Et(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){Nv(this,s);return}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())t.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(t.keys()).find(s=>s.toLowerCase()=="content-type"),i=Z.FormData&&n instanceof Z.FormData,!(0<=AE(WF,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of t)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{hT(this),0<this.B&&((this.L=GF(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Et(this.ua,this)):this.A=Jp(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){Nv(this,s)}};function GF(n){return Hs&&typeof n.timeout=="number"&&n.ontimeout!==void 0}q.ua=function(){typeof Bp<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,_t(this,"timeout"),this.abort(8))};function Nv(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,uT(n),Ql(n)}function uT(n){n.F||(n.F=!0,_t(n,"complete"),_t(n,"error"))}q.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,_t(this,"complete"),_t(this,"abort"),Ql(this))};q.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ql(this,!0)),Ge.$.N.call(this)};q.La=function(){this.s||(this.G||this.v||this.l?lT(this):this.kb())};q.kb=function(){lT(this)};function lT(n){if(n.h&&typeof Bp<"u"&&(!n.C[1]||On(n)!=4||n.da()!=2)){if(n.v&&On(n)==4)Jp(n.La,0,n);else if(_t(n,"readystatechange"),On(n)==4){n.h=!1;try{const a=n.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=a===0){var i=String(n.I).match(XE)[1]||null;!i&&Z.self&&Z.self.location&&(i=Z.self.location.protocol.slice(0,-1)),r=!$F.test(i?i.toLowerCase():"")}t=r}if(t)_t(n,"complete"),_t(n,"success");else{n.m=6;try{var s=2<On(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",uT(n)}}finally{Ql(n)}}}}function Ql(n,e){if(n.g){hT(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||_t(n,"ready");try{t.onreadystatechange=r}catch{}}}function hT(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(Z.clearTimeout(n.A),n.A=null)}q.isActive=function(){return!!this.g};function On(n){return n.g?n.g.readyState:0}q.da=function(){try{return 2<On(this)?this.g.status:-1}catch{return-1}};q.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};q.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),qF(e)}};function Vv(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case cT:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function zF(n){const e={};n=(n.g&&2<=On(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<n.length;r++){if(ka(n[r]))continue;var t=mF(n[r]);const i=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}uF(e,function(r){return r.join(", ")})}q.Ia=function(){return this.m};q.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function dT(n){let e="";return Wp(n,function(t,r){e+=r,e+=":",e+=t,e+=`\r
`}),e}function rg(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=dT(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):ke(n,e,t))}function jo(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function fT(n){this.Ga=0,this.j=[],this.l=new ql,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=jo("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=jo("baseRetryDelayMs",5e3,n),this.hb=jo("retryDelaySeedMs",1e4,n),this.eb=jo("forwardChannelMaxRetries",2,n),this.xa=jo("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new nT(n&&n.concurrentRequestLimit),this.Ja=new FF,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}q=fT.prototype;q.ra=8;q.H=1;function ig(n){if(pT(n),n.H==3){var e=n.W++,t=hr(n.I);if(ke(t,"SID",n.K),ke(t,"RID",e),ke(t,"TYPE","terminate"),pc(n,t),e=new hc(n,n.l,e),e.L=2,e.A=Kl(hr(t)),t=!1,Z.navigator&&Z.navigator.sendBeacon)try{t=Z.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&Z.Image&&(new Image().src=e.A,t=!0),t||(e.g=ET(e.l,null),e.g.ha(e.A)),e.G=Date.now(),dc(e)}IT(n)}function Yl(n){n.g&&(og(n),n.g.cancel(),n.g=null)}function pT(n){Yl(n),n.u&&(Z.clearTimeout(n.u),n.u=null),il(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&Z.clearTimeout(n.m),n.m=null)}function Jl(n){if(!rT(n.i)&&!n.m){n.m=!0;var e=n.Na;Na||LE(),Va||(Na(),Va=!0),Qp.add(e,n),n.C=0}}function KF(n,e){return iT(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=e.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=uc(Et(n.Na,n,e),vT(n,n.C)),n.C++,!0)}q.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new hc(this,this.l,n);let s=this.s;if(this.U&&(s?(s=PE(s),CE(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var r=this.j[t];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=gT(this,i,e),t=hr(this.I),ke(t,"RID",n),ke(t,"CVER",22),this.F&&ke(t,"X-HTTP-Session-Id",this.F),pc(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(dT(s)))+"&"+e:this.o&&rg(t,this.o,s)),tg(this.i,i),this.bb&&ke(t,"TYPE","init"),this.P?(ke(t,"$req",e),ke(t,"SID","null"),i.aa=!0,Of(i,t,null)):Of(i,t,e),this.H=2}}else this.H==3&&(n?Ov(this,n):this.j.length==0||rT(this.i)||Ov(this))};function Ov(n,e){var t;e?t=e.m:t=n.W++;const r=hr(n.I);ke(r,"SID",n.K),ke(r,"RID",t),ke(r,"AID",n.V),pc(n,r),n.o&&n.s&&rg(r,n.o,n.s),t=new hc(n,n.l,t,n.C+1),n.o===null&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=gT(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),tg(n.i,t),Of(t,r,e)}function pc(n,e){n.na&&Wp(n.na,function(t,r){ke(e,r,t)}),n.h&&JE({},function(t,r){ke(e,r,t)})}function gT(n,e,t){t=Math.min(n.j.length,t);var r=n.h?Et(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const a=["count="+t];s==-1?0<t?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let l=!0;for(let h=0;h<t;h++){let f=i[h].g;const p=i[h].map;if(f-=s,0>f)s=Math.max(0,i[h].g-100),l=!1;else try{UF(p,a,"req"+f+"_")}catch{r&&r(p)}}if(l){r=a.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function mT(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Na||LE(),Va||(Na(),Va=!0),Qp.add(e,n),n.A=0}}function sg(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=uc(Et(n.Ma,n),vT(n,n.A)),n.A++,!0)}q.Ma=function(){if(this.u=null,_T(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=uc(Et(this.jb,this),n)}};q.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Dt(10),Yl(this),_T(this))};function og(n){n.B!=null&&(Z.clearTimeout(n.B),n.B=null)}function _T(n){n.g=new hc(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var e=hr(n.wa);ke(e,"RID","rpc"),ke(e,"SID",n.K),ke(e,"AID",n.V),ke(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&ke(e,"TO",n.qa),ke(e,"TYPE","xmlhttp"),pc(n,e),n.o&&n.s&&rg(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=Kl(hr(e)),t.u=null,t.S=!0,HE(t,n)}q.ib=function(){this.v!=null&&(this.v=null,Yl(this),sg(this),Dt(19))};function il(n){n.v!=null&&(Z.clearTimeout(n.v),n.v=null)}function yT(n,e){var t=null;if(n.g==e){il(n),og(n),n.g=null;var r=2}else if(Mf(n.i,e))t=e.F,sT(n.i,e),r=1;else return;if(n.H!=0){if(e.i)if(r==1){t=e.u?e.u.length:0,e=Date.now()-e.G;var i=n.C;r=$l(),_t(r,new $E(r,t)),Jl(n)}else mT(n);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&KF(n,e)||r==2&&sg(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Si(n,5);break;case 4:Si(n,10);break;case 3:Si(n,6);break;default:Si(n,2)}}}function vT(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Si(n,e){if(n.l.info("Error code "+e),e==2){var t=null;n.h&&(t=null);var r=Et(n.pb,n);t||(t=new xi("//www.google.com/images/cleardot.gif"),Z.location&&Z.location.protocol=="http"||nl(t,"https"),Kl(t)),BF(t.toString(),r)}else Dt(2);n.H=0,n.h&&n.h.za(e),IT(n),pT(n)}q.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Dt(2)):(this.l.info("Failed to ping google.com"),Dt(1))};function IT(n){if(n.H=0,n.ma=[],n.h){const e=oT(n.i);(e.length!=0||n.j.length!=0)&&(Rv(n.ma,e),Rv(n.ma,n.j),n.i.i.length=0,qp(n.j),n.j.length=0),n.h.ya()}}function wT(n,e,t){var r=t instanceof xi?hr(t):new xi(t);if(r.g!="")e&&(r.g=e+"."+r.g),rl(r,r.m);else{var i=Z.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new xi(null);r&&nl(s,r),e&&(s.g=e),i&&rl(s,i),t&&(s.l=t),r=s}return t=n.F,e=n.Da,t&&e&&ke(r,t,e),ke(r,"VER",n.ra),pc(n,r),r}function ET(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n.Ha&&!n.va?new Ge(new Hl({ob:t})):new Ge(n.va),e.Oa(n.J),e}q.isActive=function(){return!!this.h&&this.h.isActive(this)};function TT(){}q=TT.prototype;q.Ba=function(){};q.Aa=function(){};q.za=function(){};q.ya=function(){};q.isActive=function(){return!0};q.Va=function(){};function sl(){if(Hs&&!(10<=Number(sF)))throw Error("Environmental error: no available transport.")}sl.prototype.g=function(n,e){return new Xt(n,e)};function Xt(n,e){at.call(this),this.g=new fT(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!ka(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ka(e)&&(this.g.F=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new fo(this)}ct(Xt,at);Xt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Dt(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=wT(n,null,n.Y),Jl(n)};Xt.prototype.close=function(){ig(this.g)};Xt.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=jp(n),n=t);e.j.push(new OF(e.fb++,n)),e.H==3&&Jl(e)};Xt.prototype.N=function(){this.g.h=null,delete this.j,ig(this.g),delete this.g,Xt.$.N.call(this)};function AT(n){Zp.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}ct(AT,Zp);function RT(){eg.call(this),this.status=1}ct(RT,eg);function fo(n){this.g=n}ct(fo,TT);fo.prototype.Ba=function(){_t(this.g,"a")};fo.prototype.Aa=function(n){_t(this.g,new AT(n))};fo.prototype.za=function(n){_t(this.g,new RT)};fo.prototype.ya=function(){_t(this.g,"b")};function HF(){this.blockSize=-1}function wn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ct(wn,HF);wn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function cf(n,e,t){t||(t=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=n.g[0],t=n.g[1],i=n.g[2];var s=n.g[3],a=e+(s^t&(i^s))+r[0]+3614090360&4294967295;e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[1]+3905402710&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[3]+3250441966&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[4]+4118548399&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[5]+1200080426&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[7]+4249261313&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[8]+1770035416&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[9]+2336552879&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[11]+2304563134&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[12]+1804603682&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[13]+4254626195&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[15]+1236535329&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(i^s&(t^i))+r[1]+4129170786&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[6]+3225465664&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[0]+3921069994&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[5]+3593408605&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[10]+38016083&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[4]+3889429448&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[9]+568446438&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[14]+3275163606&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[8]+1163531501&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[13]+2850285829&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[2]+4243563512&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[12]+2368359562&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(t^i^s)+r[5]+4294588738&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[8]+2272392833&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[14]+4259657740&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[1]+2763975236&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[4]+1272893353&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[10]+3200236656&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[13]+681279174&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[0]+3936430074&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[6]+76029189&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[9]+3654602809&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[12]+3873151461&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[2]+3299628645&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(i^(t|~s))+r[0]+4096336452&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[7]+1126891415&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[5]+4237533241&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[12]+1700485571&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[3]+2399980690&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[1]+2240044497&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[8]+1873313359&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[15]+4264355552&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[13]+1309151649&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[4]+4149444226&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[11]+3174756917&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}wn.prototype.j=function(n,e){e===void 0&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=t;)cf(this,n,s),s+=this.blockSize;if(typeof n=="string"){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){cf(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){cf(this,r),i=0;break}}this.h=i,this.i+=e};wn.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=t&255,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};function Ae(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=n[i]|0;r&&s==e||(t[i]=s,r=!1)}this.g=t}var jF={};function ag(n){return-128<=n&&128>n?nF(n,function(e){return new Ae([e|0],0>e?-1:0)}):new Ae([n|0],0>n?-1:0)}function Ln(n){if(isNaN(n)||!isFinite(n))return Ms;if(0>n)return pt(Ln(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=Ff;return new Ae(e,0)}function ST(n,e){if(n.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(n.charAt(0)=="-")return pt(ST(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Ln(Math.pow(e,8)),r=Ms,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),a=parseInt(n.substring(i,i+s),e);8>s?(s=Ln(Math.pow(e,s)),r=r.R(s).add(Ln(a))):(r=r.R(t),r=r.add(Ln(a)))}return r}var Ff=4294967296,Ms=ag(0),Uf=ag(1),Lv=ag(16777216);q=Ae.prototype;q.ea=function(){if(un(this))return-pt(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:Ff+r)*e,e*=Ff}return n};q.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(sr(this))return"0";if(un(this))return"-"+pt(this).toString(n);for(var e=Ln(Math.pow(n,6)),t=this,r="";;){var i=al(t,e).g;t=ol(t,i.R(e));var s=((0<t.g.length?t.g[0]:t.h)>>>0).toString(n);if(t=i,sr(t))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};q.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function sr(n){if(n.h!=0)return!1;for(var e=0;e<n.g.length;e++)if(n.g[e]!=0)return!1;return!0}function un(n){return n.h==-1}q.X=function(n){return n=ol(this,n),un(n)?-1:sr(n)?0:1};function pt(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new Ae(t,~n.h).add(Uf)}q.abs=function(){return un(this)?pt(this):this};q.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(n.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=a>>>16,s&=65535,a&=65535,t[i]=a<<16|s}return new Ae(t,t[t.length-1]&-2147483648?-1:0)};function ol(n,e){return n.add(pt(e))}q.R=function(n){if(sr(this)||sr(n))return Ms;if(un(this))return un(n)?pt(this).R(pt(n)):pt(pt(this).R(n));if(un(n))return pt(this.R(pt(n)));if(0>this.X(Lv)&&0>n.X(Lv))return Ln(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,a=this.D(r)&65535,l=n.D(i)>>>16,h=n.D(i)&65535;t[2*r+2*i]+=a*h,Su(t,2*r+2*i),t[2*r+2*i+1]+=s*h,Su(t,2*r+2*i+1),t[2*r+2*i+1]+=a*l,Su(t,2*r+2*i+1),t[2*r+2*i+2]+=s*l,Su(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new Ae(t,0)};function Su(n,e){for(;(n[e]&65535)!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function Qo(n,e){this.g=n,this.h=e}function al(n,e){if(sr(e))throw Error("division by zero");if(sr(n))return new Qo(Ms,Ms);if(un(n))return e=al(pt(n),e),new Qo(pt(e.g),pt(e.h));if(un(e))return e=al(n,pt(e)),new Qo(pt(e.g),e.h);if(30<n.g.length){if(un(n)||un(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Uf,r=e;0>=r.X(n);)t=Mv(t),r=Mv(r);var i=vs(t,1),s=vs(r,1);for(r=vs(r,2),t=vs(t,2);!sr(r);){var a=s.add(r);0>=a.X(n)&&(i=i.add(t),s=a),r=vs(r,1),t=vs(t,1)}return e=ol(n,i.R(e)),new Qo(i,e)}for(i=Ms;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=Math.ceil(Math.log(t)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Ln(t),a=s.R(e);un(a)||0<a.X(n);)t-=r,s=Ln(t),a=s.R(e);sr(s)&&(s=Uf),i=i.add(s),n=ol(n,a)}return new Qo(i,n)}q.gb=function(n){return al(this,n).h};q.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new Ae(t,this.h&n.h)};q.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new Ae(t,this.h|n.h)};q.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new Ae(t,this.h^n.h)};function Mv(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new Ae(t,n.h)}function vs(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new Ae(i,n.h)}sl.prototype.createWebChannel=sl.prototype.g;Xt.prototype.send=Xt.prototype.u;Xt.prototype.open=Xt.prototype.m;Xt.prototype.close=Xt.prototype.close;Wl.NO_ERROR=0;Wl.TIMEOUT=8;Wl.HTTP_ERROR=6;WE.COMPLETE="complete";GE.EventType=lc;lc.OPEN="a";lc.CLOSE="b";lc.ERROR="c";lc.MESSAGE="d";at.prototype.listen=at.prototype.O;Ge.prototype.listenOnce=Ge.prototype.P;Ge.prototype.getLastError=Ge.prototype.Sa;Ge.prototype.getLastErrorCode=Ge.prototype.Ia;Ge.prototype.getStatus=Ge.prototype.da;Ge.prototype.getResponseJson=Ge.prototype.Wa;Ge.prototype.getResponseText=Ge.prototype.ja;Ge.prototype.send=Ge.prototype.ha;Ge.prototype.setWithCredentials=Ge.prototype.Oa;wn.prototype.digest=wn.prototype.l;wn.prototype.reset=wn.prototype.reset;wn.prototype.update=wn.prototype.j;Ae.prototype.add=Ae.prototype.add;Ae.prototype.multiply=Ae.prototype.R;Ae.prototype.modulo=Ae.prototype.gb;Ae.prototype.compare=Ae.prototype.X;Ae.prototype.toNumber=Ae.prototype.ea;Ae.prototype.toString=Ae.prototype.toString;Ae.prototype.getBits=Ae.prototype.D;Ae.fromNumber=Ln;Ae.fromString=ST;var QF=function(){return new sl},YF=function(){return $l()},uf=Wl,JF=WE,XF=ji,Fv={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},bu=GE,ZF=Ge,e2=wn,Fs=Ae;const Uv="@firebase/firestore";class st{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}st.UNAUTHENTICATED=new st(null),st.GOOGLE_CREDENTIALS=new st("google-credentials-uid"),st.FIRST_PARTY=new st("first-party-uid"),st.MOCK_USER=new st("mock-user");let po="10.7.0";const $r=new Rl("@firebase/firestore");function Rs(){return $r.logLevel}function t2(n){$r.setLogLevel(n)}function N(n,...e){if($r.logLevel<=ue.DEBUG){const t=e.map(cg);$r.debug(`Firestore (${po}): ${n}`,...t)}}function Ye(n,...e){if($r.logLevel<=ue.ERROR){const t=e.map(cg);$r.error(`Firestore (${po}): ${n}`,...t)}}function En(n,...e){if($r.logLevel<=ue.WARN){const t=e.map(cg);$r.warn(`Firestore (${po}): ${n}`,...t)}}function cg(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function $(n="Unexpected state"){const e=`FIRESTORE (${po}) INTERNAL ASSERTION FAILED: `+n;throw Ye(e),new Error(e)}function z(n,e){n||$()}function n2(n,e){n||$()}function B(n,e){return n}const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends kt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ot{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class bT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class r2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(st.UNAUTHENTICATED))}shutdown(){}}class i2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class s2{constructor(e){this.t=e,this.currentUser=st.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let s=new ot;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ot,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=s;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},l=h=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?l(h):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ot)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(z(typeof r.accessToken=="string"),new bT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return z(e===null||typeof e=="string"),new st(e)}}class o2{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=st.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class a2{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new o2(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(st.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class c2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class u2{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{s.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,N("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(z(typeof t.token=="string"),this.R=t.token,new c2(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function l2(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class PT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=l2(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function ne(n,e){return n<e?-1:n>e?1:0}function js(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function CT(n){return n+"\0"}class Le{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new k(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Le.fromMillis(Date.now())}static fromDate(e){return Le.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Le(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class K{constructor(e){this.timestamp=e}static fromTimestamp(e){return new K(e)}static min(){return new K(new Le(0,0))}static max(){return new K(new Le(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Ua{constructor(e,t,r){t===void 0?t=0:t>e.length&&$(),r===void 0?r=e.length-t:r>e.length-t&&$(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ua.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ua?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ge extends Ua{construct(e,t,r){return new ge(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new k(b.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new ge(t)}static emptyPath(){return new ge([])}}const h2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ve extends Ua{construct(e,t,r){return new Ve(e,t,r)}static isValidIdentifier(e){return h2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ve.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ve(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new k(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new k(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new k(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(s(),i++)}if(s(),a)throw new k(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ve(t)}static emptyPath(){return new Ve([])}}class F{constructor(e){this.path=e}static fromPath(e){return new F(ge.fromString(e))}static fromName(e){return new F(ge.fromString(e).popFirst(5))}static empty(){return new F(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ge.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new ge(e.slice()))}}class cl{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Bf(n){return n.fields.find(e=>e.kind===2)}function yi(n){return n.fields.filter(e=>e.kind!==2)}cl.UNKNOWN_ID=-1;class Uu{constructor(e,t){this.fieldPath=e,this.kind=t}}class Ba{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ba(0,Zt.min())}}function DT(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new Le(t+1,0):new Le(t,r));return new Zt(i,F.empty(),e)}function kT(n){return new Zt(n.readTime,n.key,-1)}class Zt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Zt(K.min(),F.empty(),-1)}static max(){return new Zt(K.max(),F.empty(),-1)}}function ug(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:ne(n.largestBatchId,e.largestBatchId))}const xT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function ni(n){if(n.code!==b.FAILED_PRECONDITION||n.message!==xT)throw n;N("LocalStore","Unexpectedly lost primary lease")}class R{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new R((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof R?t:R.resolve(t)}catch(t){return R.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):R.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):R.reject(t)}static resolve(e){return new R((t,r)=>{t(e)})}static reject(e){return new R((t,r)=>{r(e)})}static waitFor(e){return new R((t,r)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&t()},h=>r(h))}),a=!0,s===i&&t()})}static or(e){let t=R.resolve(!1);for(const r of e)t=t.next(i=>i?R.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new R((r,i)=>{const s=e.length,a=new Array(s);let l=0;for(let h=0;h<s;h++){const f=h;t(e[f]).next(p=>{a[f]=p,++l,l===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new R((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}class Xl{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new ot,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ma(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=lg(r.target.error);this.V.reject(new ma(e,i))}}static open(e,t,r,i){try{return new Xl(t,e.transaction(i,r))}catch(s){throw new ma(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(N("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new f2(t)}}class vn{constructor(e,t,r){this.name=e,this.version=t,this.p=r,vn.S(Ue())===12.2&&Ye("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return N("SimpleDb","Removing database:",e),vi(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Ea())return!1;if(vn.C())return!0;const e=Ue(),t=vn.S(e),r=0<t&&t<10,i=vn.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async O(e){return this.db||(N("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new ma(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new k(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new k(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new ma(e,a))},i.onupgradeneeded=s=>{N("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.p.N(a,i.transaction,s.oldVersion,this.version).next(()=>{N("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.O(e);const l=Xl.open(this.db,e,s?"readonly":"readwrite",r),h=i(l).next(f=>(l.g(),f)).catch(f=>(l.abort(f),R.reject(f))).toPromise();return h.catch(()=>{}),await l.m,h}catch(l){const h=l,f=h.name!=="FirebaseError"&&a<3;if(N("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),this.close(),!f)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}class d2{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return vi(this.k.delete())}}class ma extends k{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ri(n){return n.name==="IndexedDbTransactionError"}class f2{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(N("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(N("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),vi(r)}add(e){return N("SimpleDb","ADD",this.store.name,e,e),vi(this.store.add(e))}get(e){return vi(this.store.get(e)).next(t=>(t===void 0&&(t=null),N("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return N("SimpleDb","DELETE",this.store.name,e),vi(this.store.delete(e))}count(){return N("SimpleDb","COUNT",this.store.name),vi(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.G(i,(a,l)=>{s.push(l)}).next(()=>s)}{const i=this.store.getAll(r.range);return new R((s,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{s(l.target.result)}})}}j(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new R((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}H(e,t){N("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.J=!1;const i=this.cursor(r);return this.G(i,(s,a,l)=>l.delete())}Y(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Z(e){const t=this.cursor({});return new R((r,i)=>{t.onerror=s=>{const a=lg(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(l=>{l?a.continue():r()}):r()}})}G(e,t){const r=[];return new R((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const l=a.target.result;if(!l)return void i();const h=new d2(l),f=t(l.primaryKey,l.value,h);if(f instanceof R){const p=f.catch(m=>(h.done(),R.reject(m)));r.push(p)}h.isDone?i():h.$===null?l.continue():l.continue(h.$)}}).next(()=>R.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function vi(n){return new R((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=lg(r.target.error);t(i)}})}let Bv=!1;function lg(n){const e=vn.S(Ue());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Bv||(Bv=!0,setTimeout(()=>{throw r},0)),r}}return n}class p2{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){N("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{N("IndexBackiller",`Documents written: ${await this.X.te()}`)}catch(t){ri(t)?N("IndexBackiller","Ignoring IndexedDB error during index backfill: ",t):await ni(t)}await this.ee(6e4)})}}class g2{constructor(e,t){this.localStore=e,this.persistence=t}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ne(t,e))}ne(e,t){const r=new Set;let i=t,s=!0;return R.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return N("IndexBackiller",`Processing collection: ${a}`),this.re(e,a,i).next(l=>{i-=l,r.add(a)});s=!1})).next(()=>t-i)}re(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ie(i,s)).next(l=>(N("IndexBackiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>a.size)}))}ie(e,t){let r=e;return t.changes.forEach((i,s)=>{const a=kT(s);ug(a,r)>0&&(r=a)}),new Zt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class qt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.se(r),this.oe=r=>t.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}qt._e=-1;function gc(n){return n==null}function qa(n){return n===0&&1/n==-1/0}function VT(n){return typeof n=="number"&&Number.isInteger(n)&&!qa(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function xt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=qv(e)),e=m2(n.get(t),e);return qv(e)}function m2(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function qv(n){return n+""}function Mn(n){const e=n.length;if(z(e>=2),e===2)return z(n.charAt(0)===""&&n.charAt(1)===""),ge.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf("",s);switch((a<0||a>t)&&$(),n.charAt(a+1)){case"":const l=n.substring(s,a);let h;i.length===0?h=l:(i+=l,h=i,i=""),r.push(h);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:$()}s=a+2}return new ge(r)}const $v=["userId","batchId"];function Bu(n,e){return[n,xt(e)]}function OT(n,e,t){return[n,xt(e),t]}const _2={},y2=["prefixPath","collectionGroup","readTime","documentId"],v2=["prefixPath","collectionGroup","documentId"],I2=["collectionGroup","readTime","prefixPath","documentId"],w2=["canonicalId","targetId"],E2=["targetId","path"],T2=["path","targetId"],A2=["collectionId","parent"],R2=["indexId","uid"],S2=["uid","sequenceNumber"],b2=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],P2=["indexId","uid","orderedDocumentKey"],C2=["userId","collectionPath","documentId"],D2=["userId","collectionPath","largestBatchId"],k2=["userId","collectionGroup","largestBatchId"],LT=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],x2=[...LT,"documentOverlays"],MT=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],FT=MT,N2=[...FT,"indexConfiguration","indexState","indexEntries"];class qf extends NT{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function ut(n,e){const t=B(n);return vn.M(t.ae,e)}function Wv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Qi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function UT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Pe{constructor(e,t){this.comparator=e,this.root=t||ft.EMPTY}insert(e,t){return new Pe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ft.BLACK,null,null))}remove(e){return new Pe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ft.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pu(this.root,e,this.comparator,!0)}}class Pu{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ft{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??ft.RED,this.left=i??ft.EMPTY,this.right=s??ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new ft(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ft.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $();const e=this.left.check();if(e!==this.right.check())throw $();return e+(this.isRed()?0:1)}}ft.EMPTY=null,ft.RED=!0,ft.BLACK=!1;ft.EMPTY=new class{constructor(){this.size=0}get key(){throw $()}get value(){throw $()}get color(){throw $()}get left(){throw $()}get right(){throw $()}copy(e,t,r,i,s){return this}insert(e,t,r){return new ft(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Re{constructor(e){this.comparator=e,this.data=new Pe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Gv(this.data.getIterator())}getIteratorFrom(e){return new Gv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Re(this.comparator);return t.data=e,t}}class Gv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Is(n){return n.hasNext()?n.getNext():void 0}class $t{constructor(e){this.fields=e,e.sort(Ve.comparator)}static empty(){return new $t([])}unionWith(e){let t=new Re(Ve.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new $t(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return js(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class BT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function V2(){return typeof atob<"u"}class nt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new BT("Invalid base64 string: "+s):s}}(e);return new nt(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new nt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}nt.EMPTY_BYTE_STRING=new nt("");const O2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wr(n){if(z(!!n),typeof n=="string"){let e=0;const t=O2.exec(n);if(z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:qe(n.seconds),nanos:qe(n.nanos)}}function qe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Gr(n){return typeof n=="string"?nt.fromBase64String(n):nt.fromUint8Array(n)}function Zl(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function hg(n){const e=n.mapValue.fields.__previous_value__;return Zl(e)?hg(e):e}function $a(n){const e=Wr(n.mapValue.fields.__local_write_time__.timestampValue);return new Le(e.seconds,e.nanos)}class L2{constructor(e,t,r,i,s,a,l,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=f}}class zr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new zr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof zr&&e.projectId===this.projectId&&e.database===this.database}}const Lr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},qu={nullValue:"NULL_VALUE"};function Li(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Zl(n)?4:qT(n)?9007199254740991:10:$()}function zn(n,e){if(n===e)return!0;const t=Li(n);if(t!==Li(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return $a(n).isEqual($a(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Wr(i.timestampValue),l=Wr(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Gr(i.bytesValue).isEqual(Gr(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return qe(i.geoPointValue.latitude)===qe(s.geoPointValue.latitude)&&qe(i.geoPointValue.longitude)===qe(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return qe(i.integerValue)===qe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=qe(i.doubleValue),l=qe(s.doubleValue);return a===l?qa(a)===qa(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return js(n.arrayValue.values||[],e.arrayValue.values||[],zn);case 10:return function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(Wv(a)!==Wv(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(l[h]===void 0||!zn(a[h],l[h])))return!1;return!0}(n,e);default:return $()}}function Wa(n,e){return(n.values||[]).find(t=>zn(t,e))!==void 0}function Kr(n,e){if(n===e)return 0;const t=Li(n),r=Li(e);if(t!==r)return ne(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ne(n.booleanValue,e.booleanValue);case 2:return function(s,a){const l=qe(s.integerValue||s.doubleValue),h=qe(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return zv(n.timestampValue,e.timestampValue);case 4:return zv($a(n),$a(e));case 5:return ne(n.stringValue,e.stringValue);case 6:return function(s,a){const l=Gr(s),h=Gr(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),h=a.split("/");for(let f=0;f<l.length&&f<h.length;f++){const p=ne(l[f],h[f]);if(p!==0)return p}return ne(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){const l=ne(qe(s.latitude),qe(a.latitude));return l!==0?l:ne(qe(s.longitude),qe(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,a){const l=s.values||[],h=a.values||[];for(let f=0;f<l.length&&f<h.length;++f){const p=Kr(l[f],h[f]);if(p)return p}return ne(l.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===Lr.mapValue&&a===Lr.mapValue)return 0;if(s===Lr.mapValue)return 1;if(a===Lr.mapValue)return-1;const l=s.fields||{},h=Object.keys(l),f=a.fields||{},p=Object.keys(f);h.sort(),p.sort();for(let m=0;m<h.length&&m<p.length;++m){const I=ne(h[m],p[m]);if(I!==0)return I;const A=Kr(l[h[m]],f[p[m]]);if(A!==0)return A}return ne(h.length,p.length)}(n.mapValue,e.mapValue);default:throw $()}}function zv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ne(n,e);const t=Wr(n),r=Wr(e),i=ne(t.seconds,r.seconds);return i!==0?i:ne(t.nanos,r.nanos)}function Qs(n){return $f(n)}function $f(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Wr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Gr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return F.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=$f(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${$f(t.fields[a])}`;return i+"}"}(n.mapValue):$()}function Mi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Wf(n){return!!n&&"integerValue"in n}function Ga(n){return!!n&&"arrayValue"in n}function Kv(n){return!!n&&"nullValue"in n}function Hv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function $u(n){return!!n&&"mapValue"in n}function _a(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Qi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=_a(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=_a(n.arrayValue.values[t]);return e}return Object.assign({},n)}function qT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function M2(n){return"nullValue"in n?qu:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Mi(zr.empty(),F.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:$()}function F2(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Mi(zr.empty(),F.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Lr:$()}function jv(n,e){const t=Kr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Qv(n,e){const t=Kr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class gt{constructor(e){this.value=e}static empty(){return new gt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!$u(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=_a(t)}setAll(e){let t=Ve.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!t.isImmediateParentOf(l)){const h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=l.popLast()}a?r[l.lastSegment()]=_a(a):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());$u(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return zn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];$u(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Qi(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new gt(_a(this.value))}}function $T(n){const e=[];return Qi(n.fields,(t,r)=>{const i=new Ve([t]);if($u(r)){const s=$T(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new $t(e)}class xe{constructor(e,t,r,i,s,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new xe(e,0,K.min(),K.min(),K.min(),gt.empty(),0)}static newFoundDocument(e,t,r,i){return new xe(e,1,t,K.min(),r,i,0)}static newNoDocument(e,t){return new xe(e,2,t,K.min(),K.min(),gt.empty(),0)}static newUnknownDocument(e,t){return new xe(e,3,t,K.min(),K.min(),gt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Hr{constructor(e,t){this.position=e,this.inclusive=t}}function Yv(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=Kr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Jv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!zn(n.position[t],e.position[t]))return!1;return!0}class za{constructor(e,t="asc"){this.field=e,this.dir=t}}function U2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class WT{}class he extends WT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new B2(e,t,r):t==="array-contains"?new W2(e,r):t==="in"?new QT(e,r):t==="not-in"?new G2(e,r):t==="array-contains-any"?new z2(e,r):new he(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new q2(e,r):new $2(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Kr(t,this.value)):t!==null&&Li(this.value)===Li(t)&&this.matchesComparison(Kr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Te extends WT{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Te(e,t)}matches(e){return Ys(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Ys(n){return n.op==="and"}function Gf(n){return n.op==="or"}function dg(n){return GT(n)&&Ys(n)}function GT(n){for(const e of n.filters)if(e instanceof Te)return!1;return!0}function zf(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+Qs(n.value);if(dg(n))return n.filters.map(e=>zf(e)).join(",");{const e=n.filters.map(t=>zf(t)).join(",");return`${n.op}(${e})`}}function zT(n,e){return n instanceof he?function(r,i){return i instanceof he&&r.op===i.op&&r.field.isEqual(i.field)&&zn(r.value,i.value)}(n,e):n instanceof Te?function(r,i){return i instanceof Te&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,l)=>s&&zT(a,i.filters[l]),!0):!1}(n,e):void $()}function KT(n,e){const t=n.filters.concat(e);return Te.create(t,n.op)}function HT(n){return n instanceof he?function(t){return`${t.field.canonicalString()} ${t.op} ${Qs(t.value)}`}(n):n instanceof Te?function(t){return t.op.toString()+" {"+t.getFilters().map(HT).join(" ,")+"}"}(n):"Filter"}class B2 extends he{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){const t=F.comparator(e.key,this.key);return this.matchesComparison(t)}}class q2 extends he{constructor(e,t){super(e,"in",t),this.keys=jT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class $2 extends he{constructor(e,t){super(e,"not-in",t),this.keys=jT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function jT(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>F.fromName(r.referenceValue))}class W2 extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ga(t)&&Wa(t.arrayValue,this.value)}}class QT extends he{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Wa(this.value.arrayValue,t)}}class G2 extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Wa(this.value.arrayValue,t)}}class z2 extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ga(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Wa(this.value.arrayValue,r))}}class K2{constructor(e,t=null,r=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.ce=null}}function Kf(n,e=null,t=[],r=[],i=null,s=null,a=null){return new K2(n,e,t,r,i,s,a)}function Fi(n){const e=B(n);if(e.ce===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>zf(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),gc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Qs(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Qs(r)).join(",")),e.ce=t}return e.ce}function mc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!U2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!zT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Jv(n.startAt,e.startAt)&&Jv(n.endAt,e.endAt)}function ul(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function ll(n,e){return n.filters.filter(t=>t instanceof he&&t.field.isEqual(e))}function Xv(n,e,t){let r=qu,i=!0;for(const s of ll(n,e)){let a=qu,l=!0;switch(s.op){case"<":case"<=":a=M2(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,l=!1;break;case"!=":case"not-in":a=qu}jv({value:r,inclusive:i},{value:a,inclusive:l})<0&&(r=a,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];jv({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function Zv(n,e,t){let r=Lr,i=!0;for(const s of ll(n,e)){let a=Lr,l=!0;switch(s.op){case">=":case">":a=F2(s.value),l=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,l=!1;break;case"!=":case"not-in":a=Lr}Qv({value:r,inclusive:i},{value:a,inclusive:l})>0&&(r=a,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Qv({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class gr{constructor(e,t=null,r=[],i=[],s=null,a="F",l=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=h,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function YT(n,e,t,r,i,s,a,l){return new gr(n,e,t,r,i,s,a,l)}function go(n){return new gr(n)}function eI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function fg(n){return n.collectionGroup!==null}function Us(n){const e=B(n);if(e.le===null){e.le=[];const t=new Set;for(const s of e.explicitOrderBy)e.le.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Re(Ve.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.le.push(new za(s,r))}),t.has(Ve.keyField().canonicalString())||e.le.push(new za(Ve.keyField(),r))}return e.le}function Nt(n){const e=B(n);return e.he||(e.he=H2(e,Us(n))),e.he}function H2(n,e){if(n.limitType==="F")return Kf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new za(i.field,s)});const t=n.endAt?new Hr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Hr(n.startAt.position,n.startAt.inclusive):null;return Kf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Hf(n,e){const t=n.filters.concat([e]);return new gr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function hl(n,e,t){return new gr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function _c(n,e){return mc(Nt(n),Nt(e))&&n.limitType===e.limitType}function JT(n){return`${Fi(Nt(n))}|lt:${n.limitType}`}function Ss(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>HT(i)).join(", ")}]`),gc(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Qs(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Qs(i)).join(",")),`Target(${r})`}(Nt(n))}; limitType=${n.limitType})`}function yc(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):F.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Us(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,l,h){const f=Yv(a,l,h);return a.inclusive?f<=0:f<0}(r.startAt,Us(r),i)||r.endAt&&!function(a,l,h){const f=Yv(a,l,h);return a.inclusive?f>=0:f>0}(r.endAt,Us(r),i))}(n,e)}function XT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ZT(n){return(e,t)=>{let r=!1;for(const i of Us(n)){const s=j2(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function j2(n,e,t){const r=n.field.isKeyField()?F.comparator(e.key,t.key):function(s,a,l){const h=a.data.field(s),f=l.data.field(s);return h!==null&&f!==null?Kr(h,f):$()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return $()}}class ii{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Qi(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return UT(this.inner)}size(){return this.innerSize}}const Q2=new Pe(F.comparator);function Wt(){return Q2}const eA=new Pe(F.comparator);function ca(...n){let e=eA;for(const t of n)e=e.insert(t.key,t);return e}function tA(n){let e=eA;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Fn(){return ya()}function nA(){return ya()}function ya(){return new ii(n=>n.toString(),(n,e)=>n.isEqual(e))}const Y2=new Pe(F.comparator),J2=new Re(F.comparator);function re(...n){let e=J2;for(const t of n)e=e.add(t);return e}const X2=new Re(ne);function pg(){return X2}function rA(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qa(e)?"-0":e}}function iA(n){return{integerValue:""+n}}function sA(n,e){return VT(e)?iA(e):rA(n,e)}class eh{constructor(){this._=void 0}}function Z2(n,e,t){return n instanceof Js?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Zl(s)&&(s=hg(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof Ui?aA(n,e):n instanceof Bi?cA(n,e):function(i,s){const a=oA(i,s),l=tI(a)+tI(i.Ie);return Wf(a)&&Wf(i.Ie)?iA(l):rA(i.serializer,l)}(n,e)}function eU(n,e,t){return n instanceof Ui?aA(n,e):n instanceof Bi?cA(n,e):t}function oA(n,e){return n instanceof Xs?function(r){return Wf(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Js extends eh{}class Ui extends eh{constructor(e){super(),this.elements=e}}function aA(n,e){const t=uA(e);for(const r of n.elements)t.some(i=>zn(i,r))||t.push(r);return{arrayValue:{values:t}}}class Bi extends eh{constructor(e){super(),this.elements=e}}function cA(n,e){let t=uA(e);for(const r of n.elements)t=t.filter(i=>!zn(i,r));return{arrayValue:{values:t}}}class Xs extends eh{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function tI(n){return qe(n.integerValue||n.doubleValue)}function uA(n){return Ga(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class vc{constructor(e,t){this.field=e,this.transform=t}}function tU(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Ui&&i instanceof Ui||r instanceof Bi&&i instanceof Bi?js(r.elements,i.elements,zn):r instanceof Xs&&i instanceof Xs?zn(r.Ie,i.Ie):r instanceof Js&&i instanceof Js}(n.transform,e.transform)}class nU{constructor(e,t){this.version=e,this.transformResults=t}}class Oe{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Oe}static exists(e){return new Oe(void 0,e)}static updateTime(e){return new Oe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class th{}function lA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new _o(n.key,Oe.none()):new mo(n.key,n.data,Oe.none());{const t=n.data,r=gt.empty();let i=new Re(Ve.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new mr(n.key,r,new $t(i.toArray()),Oe.none())}}function rU(n,e,t){n instanceof mo?function(i,s,a){const l=i.value.clone(),h=rI(i.fieldTransforms,s,a.transformResults);l.setAll(h),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof mr?function(i,s,a){if(!Wu(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=rI(i.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(hA(i)),h.setAll(l),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function va(n,e,t,r){return n instanceof mo?function(s,a,l,h){if(!Wu(s.precondition,a))return l;const f=s.value.clone(),p=iI(s.fieldTransforms,h,a);return f.setAll(p),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof mr?function(s,a,l,h){if(!Wu(s.precondition,a))return l;const f=iI(s.fieldTransforms,h,a),p=a.data;return p.setAll(hA(s)),p.setAll(f),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,a,l){return Wu(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(n,e,t)}function iU(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=oA(r.transform,i||null);s!=null&&(t===null&&(t=gt.empty()),t.set(r.field,s))}return t||null}function nI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&js(r,i,(s,a)=>tU(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class mo extends th{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class mr extends th{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function hA(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function rI(n,e,t){const r=new Map;z(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,l=e.data.field(s.field);r.set(s.field,eU(a,l,t[i]))}return r}function iI(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,Z2(s,a,e))}return r}class _o extends th{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gg extends th{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class mg{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&rU(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=va(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=va(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=nA();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=t.has(i.key)?null:l;const h=lA(a,l);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),re())}isEqual(e){return this.batchId===e.batchId&&js(this.mutations,e.mutations,(t,r)=>nI(t,r))&&js(this.baseMutations,e.baseMutations,(t,r)=>nI(t,r))}}class _g{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){z(e.mutations.length===r.length);let i=function(){return Y2}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new _g(e,t,r,i)}}class yg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class sU{constructor(e,t){this.count=e,this.unchangedNames=t}}var Xe,pe;function dA(n){switch(n){default:return $();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function fA(n){if(n===void 0)return Ye("GRPC error has no .code"),b.UNKNOWN;switch(n){case Xe.OK:return b.OK;case Xe.CANCELLED:return b.CANCELLED;case Xe.UNKNOWN:return b.UNKNOWN;case Xe.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Xe.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Xe.INTERNAL:return b.INTERNAL;case Xe.UNAVAILABLE:return b.UNAVAILABLE;case Xe.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Xe.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Xe.NOT_FOUND:return b.NOT_FOUND;case Xe.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Xe.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Xe.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Xe.ABORTED:return b.ABORTED;case Xe.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Xe.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Xe.DATA_LOSS:return b.DATA_LOSS;default:return $()}}(pe=Xe||(Xe={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";function pA(){return new TextEncoder}const oU=new Fs([4294967295,4294967295],0);function sI(n){const e=pA().encode(n),t=new e2;return t.update(e),new Uint8Array(t.digest())}function oI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Fs([t,r],0),new Fs([i,s],0)]}class vg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ua(`Invalid padding: ${t}`);if(r<0)throw new ua(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ua(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ua(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=Fs.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(Fs.fromNumber(r)));return i.compare(oU)===1&&(i=new Fs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const t=sI(e),[r,i]=oI(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);if(!this.Ae(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new vg(s,i,t);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Te===0)return;const t=sI(e),[r,i]=oI(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);this.Re(a)}}Re(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ua extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ic{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,wc.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ic(K.min(),i,new Pe(ne),Wt(),re())}}class wc{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new wc(r,t,re(),re(),re())}}class Gu{constructor(e,t,r,i){this.Ve=e,this.removedTargetIds=t,this.key=r,this.me=i}}class gA{constructor(e,t){this.targetId=e,this.fe=t}}class mA{constructor(e,t,r=nt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class aI{constructor(){this.ge=0,this.pe=uI(),this.ye=nt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=re(),t=re(),r=re();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:$()}}),new wc(this.ye,this.we,e,t,r)}Fe(){this.Se=!1,this.pe=uI()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,z(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class aU{constructor(e){this.Le=e,this.ke=new Map,this.qe=Wt(),this.Qe=cI(),this.Ke=new Pe(ne)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(t);break;case 3:this.je(t)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.Ce(e.resumeToken));break;default:$()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){const t=e.targetId,r=e.fe.count,i=this.Ye(t);if(i){const s=i.target;if(ul(s))if(r===0){const a=new F(s.path);this.We(t,a,xe.newNoDocument(a,K.min()))}else z(r===1);else{const a=this.Ze(t);if(a!==r){const l=this.Xe(e),h=l?this.et(l,e,a):1;if(h!==0){this.He(t);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,f)}}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,l;try{a=Gr(r).toUint8Array()}catch(h){if(h instanceof BT)return En("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{l=new vg(a,i,s)}catch(h){return En(h instanceof ua?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return l.Te===0?null:l}et(e,t,r){return t.fe.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const a=this.Le.nt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.We(t,s,null),i++)}),i}it(e){const t=new Map;this.ke.forEach((s,a)=>{const l=this.Ye(a);if(l){if(s.current&&ul(l.target)){const h=new F(l.target.path);this.qe.get(h)!==null||this.st(a,h)||this.We(a,h,xe.newNoDocument(h,e))}s.De&&(t.set(a,s.ve()),s.Fe())}});let r=re();this.Qe.forEach((s,a)=>{let l=!0;a.forEachWhile(h=>{const f=this.Ye(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(e));const i=new Ic(e,t,this.Ke,this.qe,r);return this.qe=Wt(),this.Qe=cI(),this.Ke=new Pe(ne),i}Ue(e,t){if(!this.je(e))return;const r=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,r),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,t)?i.Me(t,1):i.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),r&&(this.qe=this.qe.insert(t,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new aI,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new Re(ne),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=this.Ye(e)!==null;return t||N("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new aI),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function cI(){return new Pe(F.comparator)}function uI(){return new Pe(F.comparator)}const cU=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),uU=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),lU=(()=>({and:"AND",or:"OR"}))();class hU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function jf(n,e){return n.useProto3Json||gc(e)?e:{value:e}}function Zs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _A(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function dU(n,e){return Zs(n,e.toTimestamp())}function Je(n){return z(!!n),K.fromTimestamp(function(t){const r=Wr(t);return new Le(r.seconds,r.nanos)}(n))}function Ig(n,e){return function(r){return new ge(["projects",r.projectId,"databases",r.database])}(n).child("documents").child(e).canonicalString()}function yA(n){const e=ge.fromString(n);return z(bA(e)),e}function Ka(n,e){return Ig(n.databaseId,e.path)}function qn(n,e){const t=yA(e);if(t.get(1)!==n.databaseId.projectId)throw new k(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new k(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(IA(t))}function Qf(n,e){return Ig(n.databaseId,e)}function vA(n){const e=yA(n);return e.length===4?ge.emptyPath():IA(e)}function Ha(n){return new ge(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function IA(n){return z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function lI(n,e,t){return{name:Ka(n,e),fields:t.value.mapValue.fields}}function wA(n,e,t){const r=qn(n,e.name),i=Je(e.updateTime),s=e.createTime?Je(e.createTime):K.min(),a=new gt({mapValue:{fields:e.fields}}),l=xe.newFoundDocument(r,i,s,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function fU(n,e){return"found"in e?function(r,i){z(!!i.found),i.found.name,i.found.updateTime;const s=qn(r,i.found.name),a=Je(i.found.updateTime),l=i.found.createTime?Je(i.found.createTime):K.min(),h=new gt({mapValue:{fields:i.found.fields}});return xe.newFoundDocument(s,a,l,h)}(n,e):"missing"in e?function(r,i){z(!!i.missing),z(!!i.readTime);const s=qn(r,i.missing),a=Je(i.readTime);return xe.newNoDocument(s,a)}(n,e):$()}function pU(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:$()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(f,p){return f.useProto3Json?(z(p===void 0||typeof p=="string"),nt.fromBase64String(p||"")):(z(p===void 0||p instanceof Uint8Array),nt.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(f){const p=f.code===void 0?b.UNKNOWN:fA(f.code);return new k(p,f.message||"")}(a);t=new mA(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=qn(n,r.document.name),s=Je(r.document.updateTime),a=r.document.createTime?Je(r.document.createTime):K.min(),l=new gt({mapValue:{fields:r.document.fields}}),h=xe.newFoundDocument(i,s,a,l),f=r.targetIds||[],p=r.removedTargetIds||[];t=new Gu(f,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=qn(n,r.document),s=r.readTime?Je(r.readTime):K.min(),a=xe.newNoDocument(i,s),l=r.removedTargetIds||[];t=new Gu([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=qn(n,r.document),s=r.removedTargetIds||[];t=new Gu([],s,i,null)}else{if(!("filter"in e))return $();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new sU(i,s),l=r.targetId;t=new gA(l,a)}}return t}function ja(n,e){let t;if(e instanceof mo)t={update:lI(n,e.key,e.value)};else if(e instanceof _o)t={delete:Ka(n,e.key)};else if(e instanceof mr)t={update:lI(n,e.key,e.data),updateMask:IU(e.fieldMask)};else{if(!(e instanceof gg))return $();t={verify:Ka(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const l=a.transform;if(l instanceof Js)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ui)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Bi)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Xs)return{fieldPath:a.field.canonicalString(),increment:l.Ie};throw $()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:dU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:$()}(n,e.precondition)),t}function Yf(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Oe.updateTime(Je(s.updateTime)):s.exists!==void 0?Oe.exists(s.exists):Oe.none()}(e.currentDocument):Oe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;if("setToServerValue"in l)z(l.setToServerValue==="REQUEST_TIME"),h=new Js;else if("appendMissingElements"in l){const p=l.appendMissingElements.values||[];h=new Ui(p)}else if("removeAllFromArray"in l){const p=l.removeAllFromArray.values||[];h=new Bi(p)}else"increment"in l?h=new Xs(a,l.increment):$();const f=Ve.fromServerFormat(l.fieldPath);return new vc(f,h)}(n,i)):[];if(e.update){e.update.name;const i=qn(n,e.update.name),s=new gt({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(h){const f=h.fieldPaths||[];return new $t(f.map(p=>Ve.fromServerFormat(p)))}(e.updateMask);return new mr(i,s,a,t,r)}return new mo(i,s,t,r)}if(e.delete){const i=qn(n,e.delete);return new _o(i,t)}if(e.verify){const i=qn(n,e.verify);return new gg(i,t)}return $()}function gU(n,e){return n&&n.length>0?(z(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?Je(i.updateTime):Je(s);return a.isEqual(K.min())&&(a=Je(s)),new nU(a,i.transformResults||[])}(t,e))):[]}function EA(n,e){return{documents:[Qf(n,e.path)]}}function TA(n,e){const t={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(t.parent=Qf(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Qf(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(h){if(h.length!==0)return SA(Te.create(h,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(h){if(h.length!==0)return h.map(f=>function(m){return{field:bs(m.field),direction:_U(m.dir)}}(f))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=jf(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),t}function AA(n){let e=vA(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){z(r===1);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){const I=RA(m);return I instanceof Te&&dg(I)?I.getFilters():[I]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(I=>function(L){return new za(Ps(L.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(L.direction))}(I))}(t.orderBy));let l=null;t.limit&&(l=function(m){let I;return I=typeof m=="object"?m.value:m,gc(I)?null:I}(t.limit));let h=null;t.startAt&&(h=function(m){const I=!!m.before,A=m.values||[];return new Hr(A,I)}(t.startAt));let f=null;return t.endAt&&(f=function(m){const I=!m.before,A=m.values||[];return new Hr(A,I)}(t.endAt)),YT(e,i,a,s,l,"F",h,f)}function mU(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function RA(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ps(t.unaryFilter.field);return he.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ps(t.unaryFilter.field);return he.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ps(t.unaryFilter.field);return he.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ps(t.unaryFilter.field);return he.create(a,"!=",{nullValue:"NULL_VALUE"});default:return $()}}(n):n.fieldFilter!==void 0?function(t){return he.create(Ps(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Te.create(t.compositeFilter.filters.map(r=>RA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $()}}(t.compositeFilter.op))}(n):$()}function _U(n){return cU[n]}function yU(n){return uU[n]}function vU(n){return lU[n]}function bs(n){return{fieldPath:n.canonicalString()}}function Ps(n){return Ve.fromServerFormat(n.fieldPath)}function SA(n){return n instanceof he?function(t){if(t.op==="=="){if(Hv(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NAN"}};if(Kv(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Hv(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NOT_NAN"}};if(Kv(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bs(t.field),op:yU(t.op),value:t.value}}}(n):n instanceof Te?function(t){const r=t.getFilters().map(i=>SA(i));return r.length===1?r[0]:{compositeFilter:{op:vU(t.op),filters:r}}}(n):$()}function IU(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function bA(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class or{constructor(e,t,r,i,s=K.min(),a=K.min(),l=nt.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(e){return new or(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class PA{constructor(e){this.ut=e}}function wU(n,e){let t;if(e.document)t=wA(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=F.fromSegments(e.noDocument.path),i=$i(e.noDocument.readTime);t=xe.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return $();{const r=F.fromSegments(e.unknownDocument.path),i=$i(e.unknownDocument.version);t=xe.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Le(i[0],i[1]);return K.fromTimestamp(s)}(e.readTime)),t}function hI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:dl(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,a){return{name:Ka(s,a.key),fields:a.data.value.mapValue.fields,updateTime:Zs(s,a.version.toTimestamp()),createTime:Zs(s,a.createTime.toTimestamp())}}(n.ut,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:qi(e.version)};else{if(!e.isUnknownDocument())return $();r.unknownDocument={path:t.path.toArray(),version:qi(e.version)}}return r}function dl(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function qi(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function $i(n){const e=new Le(n.seconds,n.nanoseconds);return K.fromTimestamp(e)}function Ii(n,e){const t=(e.baseMutations||[]).map(s=>Yf(n.ut,s));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];a.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Yf(n.ut,s)),i=Le.fromMillis(e.localWriteTimeMs);return new mg(e.batchId,i,t,r)}function la(n){const e=$i(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?$i(n.lastLimboFreeSnapshotVersion):K.min();let r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return z(s.documents.length===1),Nt(go(vA(s.documents[0])))}(n.query):function(s){return Nt(AA(s))}(n.query),new or(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,nt.fromBase64String(n.resumeToken))}function CA(n,e){const t=qi(e.snapshotVersion),r=qi(e.lastLimboFreeSnapshotVersion);let i;i=ul(e.target)?EA(n.ut,e.target):TA(n.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Fi(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function wg(n){const e=AA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?hl(e,e.limit,"L"):e}function lf(n,e){return new yg(e.largestBatchId,Yf(n.ut,e.overlayMutation))}function dI(n,e){const t=e.path.lastSegment();return[n,xt(e.path.popLast()),t]}function fI(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:qi(r.readTime),documentKey:xt(r.documentKey.path),largestBatchId:r.largestBatchId}}class EU{getBundleMetadata(e,t){return pI(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:$i(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return pI(e).put(function(i){return{bundleId:i.id,createTime:qi(Je(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return gI(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:wg(s.bundledQuery),readTime:$i(s.readTime)}}(r)})}saveNamedQuery(e,t){return gI(e).put(function(i){return{name:i.name,readTime:qi(Je(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function pI(n){return ut(n,"bundles")}function gI(n){return ut(n,"namedQueries")}class nh{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){const r=t.uid||"";return new nh(e,r)}getOverlay(e,t){return Yo(e).get(dI(this.userId,t)).next(r=>r?lf(this.serializer,r):null)}getOverlays(e,t){const r=Fn();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,a)=>{const l=new yg(t,a);i.push(this.lt(e,l))}),R.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(a=>i.add(xt(a.getCollectionPath())));const s=[];return i.forEach(a=>{const l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(Yo(e).H("collectionPathOverlayIndex",l))}),R.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Fn(),s=xt(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Yo(e).W("collectionPathOverlayIndex",a).next(l=>{for(const h of l){const f=lf(this.serializer,h);i.set(f.getKey(),f)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Fn();let a;const l=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Yo(e).Y({index:"collectionGroupOverlayIndex",range:l},(h,f,p)=>{const m=lf(this.serializer,f);s.size()<i||m.largestBatchId===a?(s.set(m.getKey(),m),a=m.largestBatchId):p.done()}).next(()=>s)}lt(e,t){return Yo(e).put(function(i,s,a){const[l,h,f]=dI(s,a.mutation.key);return{userId:s,collectionPath:h,documentId:f,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:ja(i.ut,a.mutation)}}(this.serializer,this.userId,t))}}function Yo(n){return ut(n,"documentOverlays")}class wi{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(qe(e.integerValue));else if("doubleValue"in e){const r=qe(e.doubleValue);isNaN(r)?this.Tt(t,13):(this.Tt(t,15),qa(r)?t.Et(0):t.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(t,20),typeof r=="string"?t.dt(r):(t.dt(`${r.seconds||""}`),t.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(Gr(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(t,45),t.Et(r.latitude||0),t.Et(r.longitude||0)}else"mapValue"in e?qT(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):$()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const r=e.fields||{};this.Tt(t,55);for(const i of Object.keys(r))this.At(i,t),this.Pt(r[i],t)}yt(e,t){const r=e.values||[];this.Tt(t,50);for(const i of r)this.Pt(i,t)}ft(e,t){this.Tt(t,37),F.fromName(e).path.forEach(r=>{this.Tt(t,60),this.wt(r,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}wi.St=new wi;function TU(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function mI(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const a=TU(255&r[s]);if(i+=a,a!==8)break}return i}(n);return Math.ceil(e/8)}class AU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Dt(r.value),r=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=t.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const t=this.Bt(e),r=mI(t);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}kt(e){const t=this.Bt(e),r=mI(t);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Dt(e){const t=255&e;t===0?(this.Qt(0),this.Qt(255)):t===255?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;t===0?(this.$t(0),this.$t(255)):t===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class RU{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class SU{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class Jo{constructor(){this.Wt=new AU,this.Gt=new RU(this.Wt),this.zt=new SU(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class Ei{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ei(this.indexId,this.documentKey,this.arrayValue,r)}}function Cr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=_I(n.arrayValue,e.arrayValue),t!==0?t:(t=_I(n.directionalValue,e.directionalValue),t!==0?t:F.comparator(n.documentKey,e.documentKey)))}function _I(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}class yI{constructor(e){this.Jt=new Re((t,r)=>Ve.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const r=t;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(z(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=Bf(e);if(t!==void 0&&!this.tn(t))return!1;const r=yi(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const l=this.Jt.getIterator().getNext();if(!i.has(l.field.canonicalString())){const h=r[s];if(!this.nn(l,h)||!this.rn(this.Yt[a++],h))return!1}++s}for(;s<r.length;++s){const l=r[s];if(a>=this.Yt.length||!this.rn(this.Yt[a++],l))return!1}return!0}sn(){if(this.Xt)return null;let e=new Re(Ve.comparator);const t=[];for(const r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Uu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Uu(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Uu(r.field,r.dir==="asc"?0:1)));return new cl(cl.UNKNOWN_ID,this.collectionId,t,Ba.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function DA(n){var e,t;if(z(n instanceof he||n instanceof Te),n instanceof he){if(n instanceof QT){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>he.create(n.field,"==",s)))||[];return Te.create(i,"or")}return n}const r=n.filters.map(i=>DA(i));return Te.create(r,n.op)}function bU(n){if(n.getFilters().length===0)return[];const e=Zf(DA(n));return z(kA(e)),Jf(e)||Xf(e)?[e]:e.getFilters()}function Jf(n){return n instanceof he}function Xf(n){return n instanceof Te&&dg(n)}function kA(n){return Jf(n)||Xf(n)||function(t){if(t instanceof Te&&Gf(t)){for(const r of t.getFilters())if(!Jf(r)&&!Xf(r))return!1;return!0}return!1}(n)}function Zf(n){if(z(n instanceof he||n instanceof Te),n instanceof he)return n;if(n.filters.length===1)return Zf(n.filters[0]);const e=n.filters.map(r=>Zf(r));let t=Te.create(e,n.op);return t=fl(t),kA(t)?t:(z(t instanceof Te),z(Ys(t)),z(t.filters.length>1),t.filters.reduce((r,i)=>Eg(r,i)))}function Eg(n,e){let t;return z(n instanceof he||n instanceof Te),z(e instanceof he||e instanceof Te),t=n instanceof he?e instanceof he?function(i,s){return Te.create([i,s],"and")}(n,e):vI(n,e):e instanceof he?vI(e,n):function(i,s){if(z(i.filters.length>0&&s.filters.length>0),Ys(i)&&Ys(s))return KT(i,s.getFilters());const a=Gf(i)?i:s,l=Gf(i)?s:i,h=a.filters.map(f=>Eg(f,l));return Te.create(h,"or")}(n,e),fl(t)}function vI(n,e){if(Ys(e))return KT(e,n.getFilters());{const t=e.filters.map(r=>Eg(n,r));return Te.create(t,"or")}}function fl(n){if(z(n instanceof he||n instanceof Te),n instanceof he)return n;const e=n.getFilters();if(e.length===1)return fl(e[0]);if(GT(n))return n;const t=e.map(i=>fl(i)),r=[];return t.forEach(i=>{i instanceof he?r.push(i):i instanceof Te&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Te.create(r,n.op)}class PU{constructor(){this.on=new Tg}addToCollectionParentIndex(e,t){return this.on.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(Zt.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(Zt.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}}class Tg{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Re(ge.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Re(ge.comparator)).toArray()}}const Cu=new Uint8Array(0);class CU{constructor(e,t){this.user=e,this.databaseId=t,this._n=new Tg,this.an=new ii(r=>Fi(r),(r,i)=>mc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:r,parent:xt(i)};return II(e).put(s)}return R.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[CT(t),""],!1,!0);return II(e).W(i).next(s=>{for(const a of s){if(a.collectionId!==t)break;r.push(Mn(a.parent))}return r})}addFieldIndex(e,t){const r=Xo(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=Es(e);return s.next(l=>{a.put(fI(l,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=Xo(e),i=Es(e),s=ws(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Xo(e),r=ws(e),i=Es(e);return t.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,t){return R.forEach(this.un(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new yI(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=ws(e);let i=!0;const s=new Map;return R.forEach(this.un(t),a=>this.cn(e,a).next(l=>{i&&(i=!!l),s.set(a,l)})).next(()=>{if(i){let a=re();const l=[];return R.forEach(s,(h,f)=>{N("IndexedDbIndexManager",`Using index ${function(j){return`id=${j.indexId}|cg=${j.collectionGroup}|f=${j.fields.map(ye=>`${ye.fieldPath}:${ye.kind}`).join(",")}`}(h)} to execute ${Fi(t)}`);const p=function(j,ye){const de=Bf(ye);if(de===void 0)return null;for(const me of ll(j,de.fieldPath))switch(me.op){case"array-contains-any":return me.value.arrayValue.values||[];case"array-contains":return[me.value]}return null}(f,h),m=function(j,ye){const de=new Map;for(const me of yi(ye))for(const we of ll(j,me.fieldPath))switch(we.op){case"==":case"in":de.set(me.fieldPath.canonicalString(),we.value);break;case"not-in":case"!=":return de.set(me.fieldPath.canonicalString(),we.value),Array.from(de.values())}return null}(f,h),I=function(j,ye){const de=[];let me=!0;for(const we of yi(ye)){const Vt=we.kind===0?Xv(j,we.fieldPath,j.startAt):Zv(j,we.fieldPath,j.startAt);de.push(Vt.value),me&&(me=Vt.inclusive)}return new Hr(de,me)}(f,h),A=function(j,ye){const de=[];let me=!0;for(const we of yi(ye)){const Vt=we.kind===0?Zv(j,we.fieldPath,j.endAt):Xv(j,we.fieldPath,j.endAt);de.push(Vt.value),me&&(me=Vt.inclusive)}return new Hr(de,me)}(f,h),L=this.ln(h,f,I),M=this.ln(h,f,A),V=this.hn(h,f,m),Y=this.Pn(h.indexId,p,L,I.inclusive,M,A.inclusive,V);return R.forEach(Y,ae=>r.j(ae,t.limit).next(j=>{j.forEach(ye=>{const de=F.fromSegments(ye.documentKey);a.has(de)||(a=a.add(de),l.push(de))})}))}).next(()=>l)}return R.resolve(null)})}un(e){let t=this.an.get(e);return t||(e.filters.length===0?t=[e]:t=bU(Te.create(e.filters,"and")).map(r=>Kf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,r,i,s,a,l){const h=(t!=null?t.length:1)*Math.max(r.length,s.length),f=h/(t!=null?t.length:1),p=[];for(let m=0;m<h;++m){const I=t?this.In(t[m/f]):Cu,A=this.Tn(e,I,r[m%f],i),L=this.En(e,I,s[m%f],a),M=l.map(V=>this.Tn(e,I,V,!0));p.push(...this.createRange(A,L,M))}return p}Tn(e,t,r,i){const s=new Ei(e,F.empty(),t,r);return i?s:s.Ht()}En(e,t,r,i){const s=new Ei(e,F.empty(),t,r);return i?s.Ht():s}cn(e,t){const r=new yI(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const l of s)r.en(l)&&(!a||l.fields.length>a.fields.length)&&(a=l);return a})}getIndexType(e,t){let r=2;const i=this.un(t);return R.forEach(i,s=>this.cn(e,s).next(a=>{a?r!==0&&a.fields.length<function(h){let f=new Re(Ve.comparator),p=!1;for(const m of h.filters)for(const I of m.getFlattenedFilters())I.field.isKeyField()||(I.op==="array-contains"||I.op==="array-contains-any"?p=!0:f=f.add(I.field));for(const m of h.orderBy)m.field.isKeyField()||(f=f.add(m.field));return f.size+(p?1:0)}(s)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(t)&&i.length>1&&r===2?1:r)}dn(e,t){const r=new Jo;for(const i of yi(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.jt(i.kind);wi.St.ht(s,a)}return r.Ut()}In(e){const t=new Jo;return wi.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const r=new Jo;return wi.St.ht(Mi(this.databaseId,t),r.jt(function(s){const a=yi(s);return a.length===0?0:a[a.length-1].kind}(e))),r.Ut()}hn(e,t,r){if(r===null)return[];let i=[];i.push(new Jo);let s=0;for(const a of yi(e)){const l=r[s++];for(const h of i)if(this.Rn(t,a.fieldPath)&&Ga(l))i=this.Vn(i,a,l);else{const f=h.jt(a.kind);wi.St.ht(l,f)}}return this.mn(i)}ln(e,t,r){return this.hn(e,t,r.position)}mn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ut();return t}Vn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const l of i){const h=new Jo;h.seed(l.Ut()),wi.St.ht(a,h.jt(t.kind)),s.push(h)}return s}Rn(e,t){return!!e.filters.find(r=>r instanceof he&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Xo(e),i=Es(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(s=>{const a=[];return R.forEach(s,l=>i.get([l.indexId,this.uid]).next(h=>{a.push(function(p,m){const I=m?new Ba(m.sequenceNumber,new Zt($i(m.readTime),new F(Mn(m.documentKey)),m.largestBatchId)):Ba.empty(),A=p.fields.map(([L,M])=>new Uu(Ve.fromServerFormat(L),M));return new cl(p.indexId,p.collectionGroup,A,I)}(l,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ne(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Xo(e),s=Es(e);return this.fn(e).next(a=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(l=>R.forEach(l,h=>s.put(fI(h.indexId,this.user,a,r)))))}updateIndexEntries(e,t){const r=new Map;return R.forEach(t,(i,s)=>{const a=r.get(i.collectionGroup);return(a?R.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(r.set(i.collectionGroup,l),R.forEach(l,h=>this.gn(e,i,h).next(f=>{const p=this.pn(s,h);return f.isEqual(p)?R.resolve():this.yn(e,s,h,f,p)}))))})}wn(e,t,r,i){return ws(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,r,i){return ws(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,t.key),t.key.path.toArray()])}gn(e,t,r){const i=ws(e);let s=new Re(Cr);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,t)])},(a,l)=>{s=s.add(new Ei(r.indexId,t,l.arrayValue,l.directionalValue))}).next(()=>s)}pn(e,t){let r=new Re(Cr);const i=this.dn(t,e);if(i==null)return r;const s=Bf(t);if(s!=null){const a=e.data.field(s.fieldPath);if(Ga(a))for(const l of a.arrayValue.values||[])r=r.add(new Ei(t.indexId,e.key,this.In(l),i))}else r=r.add(new Ei(t.indexId,e.key,Cu,i));return r}yn(e,t,r,i,s){N("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(h,f,p,m,I){const A=h.getIterator(),L=f.getIterator();let M=Is(A),V=Is(L);for(;M||V;){let Y=!1,ae=!1;if(M&&V){const j=p(M,V);j<0?ae=!0:j>0&&(Y=!0)}else M!=null?ae=!0:Y=!0;Y?(m(V),V=Is(L)):ae?(I(M),M=Is(A)):(M=Is(A),V=Is(L))}}(i,s,Cr,l=>{a.push(this.wn(e,t,r,l))},l=>{a.push(this.Sn(e,t,r,l))}),R.waitFor(a)}fn(e){let t=1;return Es(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((a,l)=>Cr(a,l)).filter((a,l,h)=>!l||Cr(a,h[l-1])!==0);const i=[];i.push(e);for(const a of r){const l=Cr(a,e),h=Cr(a,t);if(l===0)i[0]=e.Ht();else if(l>0&&h<0)i.push(a),i.push(a.Ht());else if(h>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.bn(i[a],i[a+1]))return[];const l=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Cu,[]],h=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Cu,[]];s.push(IDBKeyRange.bound(l,h))}return s}bn(e,t){return Cr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(wI)}getMinOffset(e,t){return R.mapArray(this.un(t),r=>this.cn(e,r).next(i=>i||$())).next(wI)}}function II(n){return ut(n,"collectionParents")}function ws(n){return ut(n,"indexEntries")}function Xo(n){return ut(n,"indexConfiguration")}function Es(n){return ut(n,"indexState")}function wI(n){z(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;ug(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Zt(e.readTime,e.documentKey,t)}const EI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Bt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Bt(e,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function xA(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let l=0;const h=r.Y({range:a},(p,m,I)=>(l++,I.delete()));s.push(h.next(()=>{z(l===1)}));const f=[];for(const p of t.mutations){const m=OT(e,p.key.path,t.batchId);s.push(i.delete(m)),f.push(p.key)}return R.waitFor(s).next(()=>f)}function pl(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw $();e=n.noDocument}return JSON.stringify(e).length}Bt.DEFAULT_COLLECTION_PERCENTILE=10,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bt.DEFAULT=new Bt(41943040,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bt.DISABLED=new Bt(-1,0,0);class rh{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,t,r,i){z(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new rh(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Dr(e).Y({index:"userMutationsIndex",range:r},(i,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Cs(e),a=Dr(e);return a.add({}).next(l=>{z(typeof l=="number");const h=new mg(l,t,r,i),f=function(A,L,M){const V=M.baseMutations.map(ae=>ja(A.ut,ae)),Y=M.mutations.map(ae=>ja(A.ut,ae));return{userId:L,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:V,mutations:Y}}(this.serializer,this.userId,h),p=[];let m=new Re((I,A)=>ne(I.canonicalString(),A.canonicalString()));for(const I of i){const A=OT(this.userId,I.key.path,l);m=m.add(I.key.path.popLast()),p.push(a.put(f)),p.push(s.put(A,_2))}return m.forEach(I=>{p.push(this.indexManager.addToCollectionParentIndex(e,I))}),e.addOnCommittedListener(()=>{this.Dn[l]=h.keys()}),R.waitFor(p).next(()=>h)})}lookupMutationBatch(e,t){return Dr(e).get(t).next(r=>r?(z(r.userId===this.userId),Ii(this.serializer,r)):null)}Cn(e,t){return this.Dn[t]?R.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Dn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Dr(e).Y({index:"userMutationsIndex",range:i},(a,l,h)=>{l.userId===this.userId&&(z(l.batchId>=r),s=Ii(this.serializer,l)),h.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Dr(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(i,s,a)=>{r=s.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Dr(e).W("userMutationsIndex",t).next(r=>r.map(i=>Ii(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Bu(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Cs(e).Y({range:i},(a,l,h)=>{const[f,p,m]=a,I=Mn(p);if(f===this.userId&&t.path.isEqual(I))return Dr(e).get(m).next(A=>{if(!A)throw $();z(A.userId===this.userId),s.push(Ii(this.serializer,A))});h.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(ne);const i=[];return t.forEach(s=>{const a=Bu(this.userId,s.path),l=IDBKeyRange.lowerBound(a),h=Cs(e).Y({range:l},(f,p,m)=>{const[I,A,L]=f,M=Mn(A);I===this.userId&&s.path.isEqual(M)?r=r.add(L):m.done()});i.push(h)}),R.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Bu(this.userId,r),a=IDBKeyRange.lowerBound(s);let l=new Re(ne);return Cs(e).Y({range:a},(h,f,p)=>{const[m,I,A]=h,L=Mn(I);m===this.userId&&r.isPrefixOf(L)?L.length===i&&(l=l.add(A)):p.done()}).next(()=>this.vn(e,l))}vn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(Dr(e).get(s).next(a=>{if(a===null)throw $();z(a.userId===this.userId),r.push(Ii(this.serializer,a))}))}),R.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return xA(e.ae,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),R.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return R.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return Cs(e).Y({range:r},(s,a,l)=>{if(s[0]===this.userId){const h=Mn(s[1]);i.push(h)}else l.done()}).next(()=>{z(i.length===0)})})}containsKey(e,t){return NA(e,this.userId,t)}Mn(e){return VA(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function NA(n,e,t){const r=Bu(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Cs(n).Y({range:s,J:!0},(l,h,f)=>{const[p,m,I]=l;p===e&&m===i&&(a=!0),f.done()}).next(()=>a)}function Dr(n){return ut(n,"mutations")}function Cs(n){return ut(n,"documentMutations")}function VA(n){return ut(n,"mutationQueues")}class Wi{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Wi(0)}static Nn(){return new Wi(-1)}}class DU{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const r=new Wi(t.highestTargetId);return t.highestTargetId=r.next(),this.Ln(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>K.fromTimestamp(new Le(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Ln(e,i)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(t,r),this.Ln(e,r))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ts(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(z(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Ts(e).Y((a,l)=>{const h=la(l);h.sequenceNumber<=t&&r.get(h.targetId)===null&&(i++,s.push(this.removeTargetData(e,h)))}).next(()=>R.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Ts(e).Y((r,i)=>{const s=la(i);t(s)})}Bn(e){return TI(e).get("targetGlobalKey").next(t=>(z(t!==null),t))}Ln(e,t){return TI(e).put("targetGlobalKey",t)}kn(e,t){return Ts(e).put(CA(this.serializer,t))}qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Fi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Ts(e).Y({range:i,index:"queryTargetsIndex"},(a,l,h)=>{const f=la(l);mc(t,f.target)&&(s=f,h.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=xr(e);return t.forEach(a=>{const l=xt(a.path);i.push(s.put({targetId:r,path:l})),i.push(this.referenceDelegate.addReference(e,r,a))}),R.waitFor(i)}removeMatchingKeys(e,t,r){const i=xr(e);return R.forEach(t,s=>{const a=xt(s.path);return R.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=xr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=xr(e);let s=re();return i.Y({range:r,J:!0},(a,l,h)=>{const f=Mn(a[1]),p=new F(f);s=s.add(p)}).next(()=>s)}containsKey(e,t){const r=xt(t.path),i=IDBKeyRange.bound([r],[CT(r)],!1,!0);let s=0;return xr(e).Y({index:"documentTargetsIndex",J:!0,range:i},([a,l],h,f)=>{a!==0&&(s++,f.done())}).next(()=>s>0)}_t(e,t){return Ts(e).get(t).next(r=>r?la(r):null)}}function Ts(n){return ut(n,"targets")}function TI(n){return ut(n,"targetGlobal")}function xr(n){return ut(n,"targetDocuments")}function AI([n,e],[t,r]){const i=ne(n,t);return i===0?ne(e,r):i}class kU{constructor(e){this.Qn=e,this.buffer=new Re(AI),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();AI(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xU{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){N("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ri(t)?N("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await ni(t)}await this.Gn(3e5)})}}class NU{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(qt._e);const r=new kU(t);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(N("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(EI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(N("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),EI):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let r,i,s,a,l,h,f;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(N("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,a=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,t))).next(m=>(s=m,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(f=Date.now(),Rs()<=ue.DEBUG&&N("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${s} targets in `+(h-l)+`ms
	Removed ${m} documents in `+(f-h)+`ms
Total Duration: ${f-p}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function VU(n,e){return new NU(n,e)}class OU{constructor(e,t){this.db=e,this.garbageCollector=VU(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Yn(e){let t=0;return this.Hn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(r,i)=>t(i))}addReference(e,t,r){return Du(e,r)}removeReference(e,t,r){return Du(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Du(e,t)}Xn(e,t){return function(i,s){let a=!1;return VA(i).Z(l=>NA(i,l,s).next(h=>(h&&(a=!0),R.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(a,l)=>{if(l<=t){const h=this.Xn(e,a).next(f=>{if(!f)return s++,r.getEntry(e,a).next(()=>(r.removeEntry(a,K.min()),xr(e).delete(function(m){return[0,xt(m.path)]}(a))))});i.push(h)}}).next(()=>R.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Du(e,t)}Zn(e,t){const r=xr(e);let i,s=qt._e;return r.Y({index:"documentTargetsIndex"},([a,l],{path:h,sequenceNumber:f})=>{a===0?(s!==qt._e&&t(new F(Mn(i)),s),s=f,i=h):s=qt._e}).next(()=>{s!==qt._e&&t(new F(Mn(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Du(n,e){return xr(n).put(function(r,i){return{targetId:0,path:xt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}class OA{constructor(){this.changes=new ii(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class LU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return mi(e).put(r)}removeEntry(e,t,r){return mi(e).delete(function(s,a){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],dl(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.er(e,r)))}getEntry(e,t){let r=xe.newInvalidDocument(t);return mi(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Zo(t))},(i,s)=>{r=this.tr(t,s)}).next(()=>r)}nr(e,t){let r={size:0,document:xe.newInvalidDocument(t)};return mi(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Zo(t))},(i,s)=>{r={document:this.tr(t,s),size:pl(s)}}).next(()=>r)}getEntries(e,t){let r=Wt();return this.rr(e,t,(i,s)=>{const a=this.tr(i,s);r=r.insert(i,a)}).next(()=>r)}ir(e,t){let r=Wt(),i=new Pe(F.comparator);return this.rr(e,t,(s,a)=>{const l=this.tr(s,a);r=r.insert(s,l),i=i.insert(s,pl(a))}).next(()=>({documents:r,sr:i}))}rr(e,t,r){if(t.isEmpty())return R.resolve();let i=new Re(bI);t.forEach(h=>i=i.add(h));const s=IDBKeyRange.bound(Zo(i.first()),Zo(i.last())),a=i.getIterator();let l=a.getNext();return mi(e).Y({index:"documentKeyIndex",range:s},(h,f,p)=>{const m=F.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;l&&bI(l,m)<0;)r(l,null),l=a.getNext();l&&l.isEqual(m)&&(r(l,f),l=a.hasNext()?a.getNext():null),l?p.U(Zo(l)):p.done()}).next(()=>{for(;l;)r(l,null),l=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,l=[a.popLast().toArray(),a.lastSegment(),dl(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return mi(e).W(IDBKeyRange.bound(l,h,!0)).next(f=>{s==null||s.incrementDocumentReadCount(f.length);let p=Wt();for(const m of f){const I=this.tr(F.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);I.isFoundDocument()&&(yc(t,I)||i.has(I.key))&&(p=p.insert(I.key,I))}return p})}getAllFromCollectionGroup(e,t,r,i){let s=Wt();const a=SI(t,r),l=SI(t,Zt.max());return mi(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,l,!0)},(h,f,p)=>{const m=this.tr(F.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(m.key,m),s.size===i&&p.done()}).next(()=>s)}newChangeBuffer(e){return new MU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return RI(e).get("remoteDocumentGlobalKey").next(t=>(z(!!t),t))}er(e,t){return RI(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const r=wU(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(K.min())))return r}return xe.newInvalidDocument(e)}}function LA(n){return new LU(n)}class MU extends OA{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new ii(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Re((s,a)=>ne(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const l=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,l.readTime)),a.isValidDocument()){const h=hI(this._r.serializer,a);i=i.add(s.path.popLast());const f=pl(h);r+=f-l.size,t.push(this._r.addEntry(e,s,h))}else if(r-=l.size,this.trackRemovals){const h=hI(this._r.serializer,a.convertToNoDocument(K.min()));t.push(this._r.addEntry(e,s,h))}}),i.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,r)),R.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(r=>(this.ar.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:r,sr:i})=>(i.forEach((s,a)=>{this.ar.set(s,{size:a,readTime:r.get(s).readTime})}),r))}}function RI(n){return ut(n,"remoteDocumentGlobal")}function mi(n){return ut(n,"remoteDocumentsV14")}function Zo(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function SI(n,e){const t=e.documentKey.path.toArray();return[n,dl(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function bI(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ne(t[s],r[s]),i)return i;return i=ne(t.length,r.length),i||(i=ne(t[t.length-2],r[r.length-2]),i||ne(t[t.length-1],r[r.length-1]))}class FU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class MA{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&va(r.mutation,i,$t.empty(),Le.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,t,r=re()){const i=Fn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=ca();return s.forEach((l,h)=>{a=a.insert(l,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=Fn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,re()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{t.set(a,l)})})}computeViews(e,t,r,i){let s=Wt();const a=ya(),l=function(){return ya()}();return t.forEach((h,f)=>{const p=r.get(f.key);i.has(f.key)&&(p===void 0||p.mutation instanceof mr)?s=s.insert(f.key,f):p!==void 0?(a.set(f.key,p.mutation.getFieldMask()),va(p.mutation,f,p.mutation.getFieldMask(),Le.now())):a.set(f.key,$t.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((f,p)=>a.set(f,p)),t.forEach((f,p)=>{var m;return l.set(f,new FU(p,(m=a.get(f))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,t){const r=ya();let i=new Pe((a,l)=>a-l),s=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const l of a)l.keys().forEach(h=>{const f=t.get(h);if(f===null)return;let p=r.get(h)||$t.empty();p=l.applyToLocalView(f,p),r.set(h,p);const m=(i.get(l.batchId)||re()).add(h);i=i.insert(l.batchId,m)})}).next(()=>{const a=[],l=i.getReverseIterator();for(;l.hasNext();){const h=l.getNext(),f=h.key,p=h.value,m=nA();p.forEach(I=>{if(!s.has(I)){const A=lA(t.get(I),r.get(I));A!==null&&m.set(I,A),s=s.add(I)}}),a.push(this.documentOverlayCache.saveOverlays(e,f,m))}return R.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):fg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):R.resolve(Fn());let l=-1,h=s;return a.next(f=>R.forEach(f,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(p)?R.resolve():this.remoteDocumentCache.getEntry(e,p).next(I=>{h=h.insert(p,I)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,h,f,re())).next(p=>({batchId:l,changes:tA(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=ca();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=ca();return this.indexManager.getCollectionParents(e,s).next(l=>R.forEach(l,h=>{const f=function(m,I){return new gr(I,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next(p=>{p.forEach((m,I)=>{a=a.insert(m,I)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((h,f)=>{const p=f.getKey();a.get(p)===null&&(a=a.insert(p,xe.newInvalidDocument(p)))});let l=ca();return a.forEach((h,f)=>{const p=s.get(h);p!==void 0&&va(p.mutation,f,$t.empty(),Le.now()),yc(t,f)&&(l=l.insert(h,f))}),l})}}class UU{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return R.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Je(i.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,function(i){return{name:i.name,query:wg(i.bundledQuery),readTime:Je(i.readTime)}}(t)),R.resolve()}}class BU{constructor(){this.overlays=new Pe(F.comparator),this.lr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Fn();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.lt(e,t,s)}),R.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){const i=Fn(),s=t.length+1,a=new F(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const h=l.getNext().value,f=h.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Pe((f,p)=>f-p);const a=this.overlays.getIterator();for(;a.hasNext();){const f=a.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let p=s.get(f.largestBatchId);p===null&&(p=Fn(),s=s.insert(f.largestBatchId,p)),p.set(f.getKey(),f)}}const l=Fn(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((f,p)=>l.set(f,p)),!(l.size()>=i)););return R.resolve(l)}lt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new yg(t,r));let s=this.lr.get(t);s===void 0&&(s=re(),this.lr.set(t,s)),this.lr.set(t,s.add(r.key))}}class Ag{constructor(){this.hr=new Re(it.Pr),this.Ir=new Re(it.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const r=new it(e,t);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.dr(new it(e,t))}Ar(e,t){e.forEach(r=>this.removeReference(r,t))}Rr(e){const t=new F(new ge([])),r=new it(t,e),i=new it(t,e+1),s=[];return this.Ir.forEachInRange([r,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new F(new ge([])),r=new it(t,e),i=new it(t,e+1);let s=re();return this.Ir.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new it(e,0),r=this.hr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class it{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return F.comparator(e.key,t.key)||ne(e.gr,t.gr)}static Tr(e,t){return ne(e.gr,t.gr)||F.comparator(e.key,t.key)}}class qU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new Re(it.Pr)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new mg(s,t,r,i);this.mutationQueue.push(a);for(const l of i)this.yr=this.yr.add(new it(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Sr(r),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new it(t,0),i=new it(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],a=>{const l=this.wr(a.gr);s.push(l)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(ne);return t.forEach(i=>{const s=new it(i,0),a=new it(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],l=>{r=r.add(l.gr)})}),R.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;F.isDocumentKey(s)||(s=s.child(""));const a=new it(new F(s),0);let l=new Re(ne);return this.yr.forEachWhile(h=>{const f=h.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(l=l.add(h.gr)),!0)},a),R.resolve(this.br(l))}br(e){const t=[];return e.forEach(r=>{const i=this.wr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){z(this.Dr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return R.forEach(t.mutations,i=>{const s=new it(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,t){const r=new it(t,0),i=this.yr.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class $U{constructor(e){this.Cr=e,this.docs=function(){return new Pe(F.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Cr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():xe.newInvalidDocument(t))}getEntries(e,t){let r=Wt();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():xe.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Wt();const a=t.path,l=new F(a.child("")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){const{key:f,value:{document:p}}=h.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||ug(kT(p),r)<=0||(i.has(p.key)||yc(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,t,r,i){$()}vr(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new WU(this)}getSize(e){return R.resolve(this.size)}}class WU extends OA{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class GU{constructor(e){this.persistence=e,this.Fr=new ii(t=>Fi(t),mc),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Mr=0,this.Or=new Ag,this.targetCount=0,this.Nr=Wi.On()}forEachTarget(e,t){return this.Fr.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Mr&&(this.Mr=t),R.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new Wi(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.kn(t),R.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Fr.forEach((a,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){const r=this.Fr.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.Or.Er(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.Or.Ar(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),R.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Or.mr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.Or.containsKey(t))}}class FA{constructor(e,t){this.Br={},this.overlays={},this.Lr=new qt(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new GU(this),this.indexManager=new PU,this.remoteDocumentCache=function(i){return new $U(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new PA(t),this.Kr=new UU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new BU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new qU(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,r){N("MemoryPersistence","Starting transaction:",e);const i=new zU(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,t){return R.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class zU extends NT{constructor(e){super(),this.currentSequenceNumber=e}}class ih{constructor(e){this.persistence=e,this.Gr=new Ag,this.zr=null}static jr(e){return new ih(e)}get Hr(){if(this.zr)return this.zr;throw $()}addReference(e,t,r){return this.Gr.addReference(r,t),this.Hr.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Gr.removeReference(r,t),this.Hr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Hr,r=>{const i=F.fromPath(r);return this.Jr(e,i).next(s=>{s||t.removeEntry(i,K.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(r=>{r?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return R.or([()=>R.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class KU{constructor(e){this.serializer=e}N(e,t,r,i){const s=new Xl("createOrUpgrade",t);r<1&&i>=1&&(function(h){h.createObjectStore("owner")}(e),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$v,{unique:!0}),h.createObjectStore("documentMutations")}(e),PI(e),function(h){h.createObjectStore("remoteDocuments")}(e));let a=R.resolve();return r<3&&i>=3&&(r!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),PI(e)),a=a.next(()=>function(h){const f=h.store("targetGlobal"),p={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:K.min().toTimestamp(),targetCount:0};return f.put("targetGlobalKey",p)}(s))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(h,f){return f.store("mutations").W().next(p=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$v,{unique:!0});const m=f.store("mutations"),I=p.map(A=>m.put(A));return R.waitFor(I)})}(e,s))),a=a.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.Zr(s))),r<6&&i>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(a=a.next(()=>this.ei(s))),r<8&&i>=8&&(a=a.next(()=>this.ti(e,s))),r<9&&i>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.ni(s))),r<11&&i>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(h){const f=h.createObjectStore("documentOverlays",{keyPath:C2});f.createIndex("collectionPathOverlayIndex",D2,{unique:!1}),f.createIndex("collectionGroupOverlayIndex",k2,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(h){const f=h.createObjectStore("remoteDocumentsV14",{keyPath:y2});f.createIndex("documentKeyIndex",v2),f.createIndex("collectionGroupIndex",I2)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ii(e,s))),r<15&&i>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:R2}).createIndex("sequenceNumberIndex",S2,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:b2}).createIndex("documentKeyIndex",P2,{unique:!1})}(e))),a}Xr(e){let t=0;return e.store("remoteDocuments").Y((r,i)=>{t+=pl(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>R.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next(l=>R.forEach(l,h=>{z(h.userId===s.userId);const f=Ii(this.serializer,h);return xA(e,s.userId,f).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((a,l)=>{const h=new ge(a),f=function(m){return[0,xt(m)]}(h);s.push(t.get(f).next(p=>p?R.resolve():(m=>t.put({targetId:0,path:xt(m),sequenceNumber:i.highestListenSequenceNumber}))(h)))}).next(()=>R.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:A2});const r=t.store("collectionParents"),i=new Tg,s=a=>{if(i.add(a)){const l=a.lastSegment(),h=a.popLast();return r.put({collectionId:l,parent:xt(h)})}};return t.store("remoteDocuments").Y({J:!0},(a,l)=>{const h=new ge(a);return s(h.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([a,l,h],f)=>{const p=Mn(l);return s(p.popLast())}))}ni(e){const t=e.store("targets");return t.Y((r,i)=>{const s=la(i),a=CA(this.serializer,s);return t.put(a)})}ri(e,t){const r=t.store("remoteDocuments"),i=[];return r.Y((s,a)=>{const l=t.store("remoteDocumentsV14"),h=function(m){return m.document?new F(ge.fromString(m.document.name).popFirst(5)):m.noDocument?F.fromSegments(m.noDocument.path):m.unknownDocument?F.fromSegments(m.unknownDocument.path):$()}(a).path.toArray(),f={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(l.put(f))}).next(()=>R.waitFor(i))}ii(e,t){const r=t.store("mutations"),i=LA(this.serializer),s=new FA(ih.jr,this.serializer.ut);return r.W().next(a=>{const l=new Map;return a.forEach(h=>{var f;let p=(f=l.get(h.userId))!==null&&f!==void 0?f:re();Ii(this.serializer,h).keys().forEach(m=>p=p.add(m)),l.set(h.userId,p)}),R.forEach(l,(h,f)=>{const p=new st(f),m=nh.ct(this.serializer,p),I=s.getIndexManager(p),A=rh.ct(p,this.serializer,I,s.referenceDelegate);return new MA(i,A,m,I).recalculateAndSaveOverlaysForDocumentKeys(new qf(t,qt._e),h).next()})})}}function PI(n){n.createObjectStore("targetDocuments",{keyPath:E2}).createIndex("documentTargetsIndex",T2,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",w2,{unique:!0}),n.createObjectStore("targetGlobal")}const hf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Rg{constructor(e,t,r,i,s,a,l,h,f,p,m=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.si=s,this.window=a,this.document=l,this.oi=f,this._i=p,this.ai=m,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=I=>Promise.resolve(),!Rg.D())throw new k(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new OU(this,i),this.Ii=t+"main",this.serializer=new PA(h),this.Ti=new vn(this.Ii,this.ai,new KU(this.serializer)),this.qr=new DU(this.referenceDelegate,this.serializer),this.remoteDocumentCache=LA(this.serializer),this.Kr=new EU,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,p===!1&&Ye("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(b.FAILED_PRECONDITION,hf);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new qt(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.di()}))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ku(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if(ri(e))return N("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return N("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return ea(e).get("owner").next(t=>R.resolve(this.wi(t)))}Si(e){return ku(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=ut(t,"clientMetadata");return r.W().next(i=>{const s=this.Ci(i,18e5),a=i.filter(l=>s.indexOf(l)===-1);return R.forEach(a,l=>r.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ei)for(const t of e)this.Ei.removeItem(this.vi(t.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?R.resolve(!0):ea(e).get("owner").next(t=>{if(t!==null&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new k(b.FAILED_PRECONDITION,hf);return!1}}return!(!this.networkEnabled||!this.inForeground)||ku(e).W().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||a&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&N("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new qf(e,qt._e);return this.pi(t).next(()=>this.Si(t))}),this.Ti.close(),this.Ni()}Ci(e,t){return e.filter(r=>this.Di(r.updateTimeMs,t)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>ku(e).W().next(t=>this.Ci(t,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return rh.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new CU(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return nh.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,r){N("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(h){return h===15?N2:h===14?FT:h===13?MT:h===12?x2:h===11?LT:void $()}(this.ai);let a;return this.Ti.runTransaction(e,i,s,l=>(a=new qf(l,this.Lr?this.Lr.next():qt._e),t==="readwrite-primary"?this.fi(a).next(h=>!!h||this.gi(a)).next(h=>{if(!h)throw Ye(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new k(b.FAILED_PRECONDITION,xT);return r(a)}).next(h=>this.yi(a).next(()=>h)):this.Li(a).next(()=>r(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Li(e){return ea(e).get("owner").next(t=>{if(t!==null&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new k(b.FAILED_PRECONDITION,hf)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ea(e).put("owner",t)}static D(){return vn.D()}pi(e){const t=ea(e);return t.get("owner").next(r=>this.wi(r)?(N("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):R.resolve())}Di(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Ye(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;mx()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const r=((t=this.Ei)===null||t===void 0?void 0:t.getItem(this.vi(e)))!==null;return N("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ye("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){Ye("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ea(n){return ut(n,"owner")}function ku(n){return ut(n,"clientMetadata")}function Sg(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class bg{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ki=r,this.qi=i}static Qi(e,t){let r=re(),i=re();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new bg(e,t.fromCache,r,i)}}class HU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class UA{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.zi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new HU;return this.Hi(e,t,a).next(l=>{if(s.result=l,this.$i)return this.Ji(e,t,a,l.size)})}).next(()=>s.result)}Ji(e,t,r,i){return r.documentReadCount<this.Ui?(Rs()<=ue.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",Ss(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),R.resolve()):(Rs()<=ue.DEBUG&&N("QueryEngine","Query:",Ss(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(Rs()<=ue.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",Ss(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Nt(t))):R.resolve())}zi(e,t){if(eI(t))return R.resolve(null);let r=Nt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=hl(t,null,"F"),r=Nt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=re(...s);return this.Gi.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(h=>{const f=this.Yi(t,l);return this.Zi(t,f,a,h.readTime)?this.zi(e,hl(t,null,"F")):this.Xi(e,f,t,h)}))})))}ji(e,t,r,i){return eI(t)||i.isEqual(K.min())?R.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const a=this.Yi(t,s);return this.Zi(t,a,r,i)?R.resolve(null):(Rs()<=ue.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ss(t)),this.Xi(e,a,t,DT(i,-1)).next(l=>l))})}Yi(e,t){let r=new Re(ZT(e));return t.forEach((i,s)=>{yc(e,s)&&(r=r.add(s))}),r}Zi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,t,r){return Rs()<=ue.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",Ss(t)),this.Gi.getDocumentsMatchingQuery(e,t,Zt.min(),r)}Xi(e,t,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}class jU{constructor(e,t,r,i){this.persistence=e,this.es=t,this.serializer=i,this.ts=new Pe(ne),this.ns=new ii(s=>Fi(s),mc),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MA(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function BA(n,e,t,r){return new jU(n,e,t,r)}async function qA(n,e){const t=B(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.os(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],l=[];let h=re();for(const f of i){a.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}for(const f of s){l.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(f=>({_s:f,removedBatchIds:a,addedBatchIds:l}))})})}function QU(n,e){const t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(l,h,f,p){const m=f.batch,I=m.keys();let A=R.resolve();return I.forEach(L=>{A=A.next(()=>p.getEntry(h,L)).next(M=>{const V=f.docVersions.get(L);z(V!==null),M.version.compareTo(V)<0&&(m.applyToRemoteDocument(M,f),M.isValidDocument()&&(M.setReadTime(f.commitVersion),p.addEntry(M)))})}),A.next(()=>l.mutationQueue.removeMutationBatch(h,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=re();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(h=h.add(l.batch.mutations[f].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function $A(n){const e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function YU(n,e){const t=B(n),r=e.snapshotVersion;let i=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.ss.newChangeBuffer({trackRemovals:!0});i=t.ts;const l=[];e.targetChanges.forEach((p,m)=>{const I=i.get(m);if(!I)return;l.push(t.qr.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.qr.addMatchingKeys(s,p.addedDocuments,m)));let A=I.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?A=A.withResumeToken(nt.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):p.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(p.resumeToken,r)),i=i.insert(m,A),function(M,V,Y){return M.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0}(I,A,p)&&l.push(t.qr.updateTargetData(s,A))});let h=Wt(),f=re();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(WA(s,a,e.documentUpdates).next(p=>{h=p.us,f=p.cs})),!r.isEqual(K.min())){const p=t.qr.getLastRemoteSnapshotVersion(s).next(m=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(p)}return R.waitFor(l).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,h,f)).next(()=>h)}).then(s=>(t.ts=i,s))}function WA(n,e,t){let r=re(),i=re();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Wt();return t.forEach((l,h)=>{const f=s.get(l);h.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(l)),h.isNoDocument()&&h.version.isEqual(K.min())?(e.removeEntry(l,h.readTime),a=a.insert(l,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(h),a=a.insert(l,h)):N("LocalStore","Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",h.version)}),{us:a,cs:i}})}function JU(n,e){const t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function eo(n,e){const t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.qr.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):t.qr.allocateTargetId(r).next(a=>(i=new or(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ts=t.ts.insert(r.targetId,r),t.ns.set(e,r.targetId)),r})}async function to(n,e,t){const r=B(n),i=r.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!ri(a))throw a;N("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}function gl(n,e,t){const r=B(n);let i=K.min(),s=re();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,f,p){const m=B(h),I=m.ns.get(p);return I!==void 0?R.resolve(m.ts.get(I)):m.qr.getTargetData(f,p)}(r,a,Nt(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(a,l.targetId).next(h=>{s=h})}).next(()=>r.es.getDocumentsMatchingQuery(a,e,t?i:K.min(),t?s:re())).next(l=>(KA(r,XT(e),l),{documents:l,ls:s})))}function GA(n,e){const t=B(n),r=B(t.qr),i=t.ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(a=>a?a.target:null))}function zA(n,e){const t=B(n),r=t.rs.get(e)||K.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ss.getAllFromCollectionGroup(i,e,DT(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(KA(t,e,i),i))}function KA(n,e,t){let r=n.rs.get(e)||K.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.rs.set(e,r)}async function XU(n,e,t,r){const i=B(n);let s=re(),a=Wt();for(const f of t){const p=e.hs(f.metadata.name);f.document&&(s=s.add(p));const m=e.Ps(f);m.setReadTime(e.Is(f.metadata.readTime)),a=a.insert(p,m)}const l=i.ss.newChangeBuffer({trackRemovals:!0}),h=await eo(i,function(p){return Nt(go(ge.fromString(`__bundle__/docs/${p}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",f=>WA(f,l,a).next(p=>(l.apply(f),p)).next(p=>i.qr.removeMatchingKeysForTargetId(f,h.targetId).next(()=>i.qr.addMatchingKeys(f,s,h.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(f,p.us,p.cs)).next(()=>p.us)))}async function ZU(n,e,t=re()){const r=await eo(n,Nt(wg(e.bundledQuery))),i=B(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const a=Je(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return i.Kr.saveNamedQuery(s,e);const l=r.withResumeToken(nt.EMPTY_BYTE_STRING,a);return i.ts=i.ts.insert(l.targetId,l),i.qr.updateTargetData(s,l).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,t,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}function CI(n,e){return`firestore_clients_${n}_${e}`}function DI(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function df(n,e){return`firestore_targets_${n}_${e}`}class ml{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ts(e,t,r){const i=JSON.parse(r);let s,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new k(i.error.code,i.error.message))),a?new ml(e,t,i.state,s):(Ye("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ia{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ts(e,t){const r=JSON.parse(t);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new k(r.error.code,r.error.message))),s?new Ia(e,r.state,i):(Ye("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class _l{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=pg();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=VT(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return i?new _l(e,s):(Ye("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Pg{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Pg(t.clientId,t.onlineState):(Ye("SharedClientState",`Failed to parse online state: ${e}`),null)}}class ep{constructor(){this.activeTargetIds=pg()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ff{constructor(e,t,r,i,s){this.window=e,this.si=t,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Pe(ne),this.started=!1,this.ps=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=CI(this.persistenceKey,this.Rs),this.ws=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new ep),this.Ss=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.Cs=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.vs=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const r of e){if(r===this.Rs)continue;const i=this.getItem(CI(this.persistenceKey,r));if(i){const s=_l.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();const t=this.storage.getItem(this.Cs);if(t){const r=this.Ms(t);r&&this.xs(r)}for(const r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,r){this.Ns(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(df(this.persistenceKey,e));if(r){const i=Ia.Ts(e,r);i&&(t=i.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(df(this.persistenceKey,e))}updateQueryState(e,t,r){this.ks(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return N("SharedClientState","READ",e,t),t}setItem(e,t){N("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){N("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const t=e;if(t.storageArea===this.storage){if(N("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ys)return void Ye("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Ss.test(t.key)){if(t.newValue==null){const r=this.Ks(t.key);return this.$s(r,null)}{const r=this.Us(t.key,t.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(t.key)){if(t.newValue!==null){const r=this.Ws(t.key,t.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){const r=this.zs(t.key,t.newValue);if(r)return this.js(r)}}else if(t.key===this.Cs){if(t.newValue!==null){const r=this.Ms(t.newValue);if(r)return this.xs(r)}}else if(t.key===this.ws){const r=function(s){let a=qt._e;if(s!=null)try{const l=JSON.parse(s);z(typeof l=="number"),a=l}catch(l){Ye("SharedClientState","Failed to read sequence number from WebStorage",l)}return a}(t.newValue);r!==qt._e&&this.sequenceNumberHandler(r)}else if(t.key===this.vs){const r=this.Hs(t.newValue);await Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(t)})}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,r){const i=new ml(this.currentUser,e,t,r),s=DI(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const t=DI(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){const t={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(t))}ks(e,t,r){const i=df(this.persistenceKey,e),s=new Ia(e,t,r);this.setItem(i,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const r=this.Ks(e);return _l.Ts(r,t)}Ws(e,t){const r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return ml.Ts(new st(s),i,t)}zs(e,t){const r=this.Ds.exec(e),i=Number(r[1]);return Ia.Ts(i,t)}Ms(e){return Pg.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);N("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const r=t?this.gs.insert(e,t):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),a=[],l=[];return s.forEach(h=>{i.has(h)||a.push(h)}),i.forEach(h=>{s.has(h)||l.push(h)}),this.syncEngine.Xs(a,l).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=pg();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class HA{constructor(){this.eo=new ep,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,r){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new ep,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class eB{ro(e){}shutdown(){}}class kI{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){N("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){N("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let xu=null;function pf(){return xu===null?xu=function(){return 268435456+Math.round(2147483648*Math.random())}():xu++,"0x"+xu.toString(16)}const tB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class nB{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const wt="WebChannelConnection";class rB extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+t.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(t,r,i,s,a){const l=pf(),h=this.So(t,r);N("RestConnection",`Sending RPC '${t}' ${l}:`,h,i);const f={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(f,s,a),this.Do(t,h,f,i).then(p=>(N("RestConnection",`Received RPC '${t}' ${l}: `,p),p),p=>{throw En("RestConnection",`RPC '${t}' ${l} failed with error: `,p,"url: ",h,"request:",i),p})}Co(t,r,i,s,a,l){return this.wo(t,r,i,s,a)}bo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+po}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}So(t,r){const i=tB[t];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,r,i){const s=pf();return new Promise((a,l)=>{const h=new ZF;h.setWithCredentials(!0),h.listenOnce(JF.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case uf.NO_ERROR:const p=h.getResponseJson();N(wt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case uf.TIMEOUT:N(wt,`RPC '${e}' ${s} timed out`),l(new k(b.DEADLINE_EXCEEDED,"Request time out"));break;case uf.HTTP_ERROR:const m=h.getStatus();if(N(wt,`RPC '${e}' ${s} failed with status:`,m,"response text:",h.getResponseText()),m>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);const A=I==null?void 0:I.error;if(A&&A.status&&A.message){const L=function(V){const Y=V.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(Y)>=0?Y:b.UNKNOWN}(A.status);l(new k(L,A.message))}else l(new k(b.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new k(b.UNAVAILABLE,"Connection failed."));break;default:$()}}finally{N(wt,`RPC '${e}' ${s} completed.`)}});const f=JSON.stringify(i);N(wt,`RPC '${e}' ${s} sending request:`,i),h.send(t,"POST",f,r,15)})}vo(e,t,r){const i=pf(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=QF(),l=YF(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.bo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const p=s.join("");N(wt,`Creating RPC '${e}' stream ${i}: ${p}`,h);const m=a.createWebChannel(p,h);let I=!1,A=!1;const L=new nB({co:V=>{A?N(wt,`Not sending because RPC '${e}' stream ${i} is closed:`,V):(I||(N(wt,`Opening RPC '${e}' stream ${i} transport.`),m.open(),I=!0),N(wt,`RPC '${e}' stream ${i} sending:`,V),m.send(V))},lo:()=>m.close()}),M=(V,Y,ae)=>{V.listen(Y,j=>{try{ae(j)}catch(ye){setTimeout(()=>{throw ye},0)}})};return M(m,bu.EventType.OPEN,()=>{A||N(wt,`RPC '${e}' stream ${i} transport opened.`)}),M(m,bu.EventType.CLOSE,()=>{A||(A=!0,N(wt,`RPC '${e}' stream ${i} transport closed`),L.Ro())}),M(m,bu.EventType.ERROR,V=>{A||(A=!0,En(wt,`RPC '${e}' stream ${i} transport errored:`,V),L.Ro(new k(b.UNAVAILABLE,"The operation could not be completed")))}),M(m,bu.EventType.MESSAGE,V=>{var Y;if(!A){const ae=V.data[0];z(!!ae);const j=ae,ye=j.error||((Y=j[0])===null||Y===void 0?void 0:Y.error);if(ye){N(wt,`RPC '${e}' stream ${i} received error:`,ye);const de=ye.status;let me=function(Hn){const ts=Xe[Hn];if(ts!==void 0)return fA(ts)}(de),we=ye.message;me===void 0&&(me=b.INTERNAL,we="Unknown error status: "+de+" with message "+ye.message),A=!0,L.Ro(new k(me,we)),m.close()}else N(wt,`RPC '${e}' stream ${i} received:`,ae),L.Vo(ae)}}),M(l,XF.STAT_EVENT,V=>{V.stat===Fv.PROXY?N(wt,`RPC '${e}' stream ${i} detected buffering proxy`):V.stat===Fv.NOPROXY&&N(wt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{L.Ao()},0),L}}function jA(){return typeof window<"u"?window:null}function zu(){return typeof document<"u"?document:null}function Ec(n){return new hU(n,!0)}class Cg{constructor(e,t,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=t,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,t-r);i>0&&N("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class QA{constructor(e,t,r,i,s,a,l,h){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new Cg(e,t)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,t){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(Ye(t.toString()),Ye("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):t&&t.code===b.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(t)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===t&&this.s_(r,i)},r=>{e(()=>{const i=new k(b.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,t){const r=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return N("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(N("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class iB extends QA{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=pU(this.serializer,e),r=function(s){if(!("targetChange"in s))return K.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?K.min():a.readTime?Je(a.readTime):K.min()}(e);return this.listener.a_(t,r)}u_(e){const t={};t.database=Ha(this.serializer),t.addTarget=function(s,a){let l;const h=a.target;if(l=ul(h)?{documents:EA(s,h)}:{query:TA(s,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=_A(s,a.resumeToken);const f=jf(s,a.expectedCount);f!==null&&(l.expectedCount=f)}else if(a.snapshotVersion.compareTo(K.min())>0){l.readTime=Zs(s,a.snapshotVersion.toTimestamp());const f=jf(s,a.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,e);const r=mU(this.serializer,e);r&&(t.labels=r),this.e_(t)}c_(e){const t={};t.database=Ha(this.serializer),t.removeTarget=e,this.e_(t)}}class sB extends QA{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=gU(e.writeResults,e.commitTime),r=Je(e.commitTime);return this.listener.I_(r,t)}return z(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=Ha(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>ja(this.serializer,r))};this.e_(t)}}class oB extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new k(b.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,t,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new k(b.UNKNOWN,i.toString())})}Co(e,t,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,t,r,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(b.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class aB{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(Ye(t),this.f_=!1):N("OnlineStateTracker",t)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}class cB{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget(async()=>{si(this)&&(N("RemoteStore","Restarting streams for network reachability change."),await async function(h){const f=B(h);f.C_.add(4),await yo(f),f.M_.set("Unknown"),f.C_.delete(4),await Tc(f)}(this))})}),this.M_=new aB(r,i)}}async function Tc(n){if(si(n))for(const e of n.v_)await e(!0)}async function yo(n){for(const e of n.v_)await e(!1)}function sh(n,e){const t=B(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),xg(t)?kg(t):Io(t).Ho()&&Dg(t,e))}function Qa(n,e){const t=B(n),r=Io(t);t.D_.delete(e),r.Ho()&&YA(t,e),t.D_.size===0&&(r.Ho()?r.Zo():si(t)&&t.M_.set("Unknown"))}function Dg(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Io(n).u_(e)}function YA(n,e){n.x_.Oe(e),Io(n).c_(e)}function kg(n){n.x_=new aU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),Io(n).start(),n.M_.g_()}function xg(n){return si(n)&&!Io(n).jo()&&n.D_.size>0}function si(n){return B(n).C_.size===0}function JA(n){n.x_=void 0}async function uB(n){n.D_.forEach((e,t)=>{Dg(n,e)})}async function lB(n,e){JA(n),xg(n)?(n.M_.w_(e),kg(n)):n.M_.set("Unknown")}async function hB(n,e,t){if(n.M_.set("Online"),e instanceof mA&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const l of s.targetIds)i.D_.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.D_.delete(l),i.x_.removeTarget(l))}(n,e)}catch(r){N("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await yl(n,r)}else if(e instanceof Gu?n.x_.$e(e):e instanceof gA?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(K.min()))try{const r=await $A(n.localStore);t.compareTo(r)>=0&&await function(s,a){const l=s.x_.it(a);return l.targetChanges.forEach((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const p=s.D_.get(f);p&&s.D_.set(f,p.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach((h,f)=>{const p=s.D_.get(h);if(!p)return;s.D_.set(h,p.withResumeToken(nt.EMPTY_BYTE_STRING,p.snapshotVersion)),YA(s,h);const m=new or(p.target,h,f,p.sequenceNumber);Dg(s,m)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(r){N("RemoteStore","Failed to raise snapshot:",r),await yl(n,r)}}async function yl(n,e,t){if(!ri(e))throw e;n.C_.add(1),await yo(n),n.M_.set("Offline"),t||(t=()=>$A(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{N("RemoteStore","Retrying IndexedDB access"),await t(),n.C_.delete(1),await Tc(n)})}function XA(n,e){return e().catch(t=>yl(n,t,e))}async function vo(n){const e=B(n),t=jr(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;dB(e);)try{const i=await JU(e.localStore,r);if(i===null){e.b_.length===0&&t.Zo();break}r=i.batchId,fB(e,i)}catch(i){await yl(e,i)}ZA(e)&&e0(e)}function dB(n){return si(n)&&n.b_.length<10}function fB(n,e){n.b_.push(e);const t=jr(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function ZA(n){return si(n)&&!jr(n).jo()&&n.b_.length>0}function e0(n){jr(n).start()}async function pB(n){jr(n).E_()}async function gB(n){const e=jr(n);for(const t of n.b_)e.P_(t.mutations)}async function mB(n,e,t){const r=n.b_.shift(),i=_g.from(r,e,t);await XA(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await vo(n)}async function _B(n,e){e&&jr(n).h_&&await async function(r,i){if(function(a){return dA(a)&&a!==b.ABORTED}(i.code)){const s=r.b_.shift();jr(r).Yo(),await XA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await vo(r)}}(n,e),ZA(n)&&e0(n)}async function xI(n,e){const t=B(n);t.asyncQueue.verifyOperationInProgress(),N("RemoteStore","RemoteStore received new credentials");const r=si(t);t.C_.add(3),await yo(t),r&&t.M_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),await Tc(t)}async function tp(n,e){const t=B(n);e?(t.C_.delete(2),await Tc(t)):e||(t.C_.add(2),await yo(t),t.M_.set("Unknown"))}function Io(n){return n.O_||(n.O_=function(t,r,i){const s=B(t);return s.A_(),new iB(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:uB.bind(null,n),Io:lB.bind(null,n),a_:hB.bind(null,n)}),n.v_.push(async e=>{e?(n.O_.Yo(),xg(n)?kg(n):n.M_.set("Unknown")):(await n.O_.stop(),JA(n))})),n.O_}function jr(n){return n.N_||(n.N_=function(t,r,i){const s=B(t);return s.A_(),new sB(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:pB.bind(null,n),Io:_B.bind(null,n),T_:gB.bind(null,n),I_:mB.bind(null,n)}),n.v_.push(async e=>{e?(n.N_.Yo(),await vo(n)):(await n.N_.stop(),n.b_.length>0&&(N("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))})),n.N_}class Ng{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ot,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,l=new Ng(e,t,a,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function wo(n,e){if(Ye("AsyncQueue",`${e}: ${n}`),ri(n))return new k(b.UNAVAILABLE,`${e}: ${n}`);throw n}class Bs{constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=ca(),this.sortedSet=new Pe(this.comparator)}static emptySet(e){return new Bs(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Bs)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Bs;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class NI{constructor(){this.B_=new Pe(F.comparator)}track(e){const t=e.doc.key,r=this.B_.get(t);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(t,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(t):e.type===1&&r.type===2?this.B_=this.B_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):$():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,r)=>{e.push(r)}),e}}class no{constructor(e,t,r,i,s,a,l,h,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new no(e,t,Bs.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_c(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class yB{constructor(){this.k_=void 0,this.listeners=[]}}class vB{constructor(){this.queries=new ii(e=>JT(e),_c),this.onlineState="Unknown",this.q_=new Set}}async function Vg(n,e){const t=B(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new yB),i)try{s.k_=await t.onListen(r)}catch(a){const l=wo(a,`Initialization of query '${Ss(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,s),s.listeners.push(e),e.Q_(t.onlineState),s.k_&&e.K_(s.k_)&&Lg(t)}async function Og(n,e){const t=B(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return t.queries.delete(r),t.onUnlisten(r)}function IB(n,e){const t=B(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const l of a.listeners)l.K_(i)&&(r=!0);a.k_=i}}r&&Lg(t)}function wB(n,e,t){const r=B(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function Lg(n){n.q_.forEach(e=>{e.next()})}class Mg{constructor(e,t,r){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new no(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){if(!e.fromCache)return!0;const r=t!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const t=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}H_(e){e=no.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class EB{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class VI{constructor(e){this.serializer=e}hs(e){return qn(this.serializer,e)}Ps(e){return e.metadata.exists?wA(this.serializer,e.document,!1):xe.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return Je(e)}}class TB{constructor(e,t,r){this.X_=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=t0(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const r=ge.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,r=new VI(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const a of i.metadata.queries){const l=(t.get(a)||re()).add(s);t.set(a,l)}}return t}async complete(){const e=await XU(this.localStore,new VI(this.serializer),this.documents,this.X_.id),t=this.ta(this.documents);for(const r of this.queries)await ZU(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,na:this.collectionGroups,ra:e}}}function t0(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class n0{constructor(e){this.key=e}}class r0{constructor(e){this.key=e}}class i0{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=re(),this.mutatedKeys=re(),this._a=ZT(e),this.aa=new Bs(this._a)}get ua(){return this.ia}ca(e,t){const r=t?t.la:new NI,i=t?t.aa:this.aa;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,l=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{const I=i.get(p),A=yc(this.query,m)?m:null,L=!!I&&this.mutatedKeys.has(I.key),M=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let V=!1;I&&A?I.data.isEqual(A.data)?L!==M&&(r.track({type:3,doc:A}),V=!0):this.ha(I,A)||(r.track({type:2,doc:A}),V=!0,(h&&this._a(A,h)>0||f&&this._a(A,f)<0)&&(l=!0)):!I&&A?(r.track({type:0,doc:A}),V=!0):I&&!A&&(r.track({type:1,doc:I}),V=!0,(h||f)&&(l=!0)),V&&(A?(a=a.add(A),s=M?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{aa:a,la:r,Zi:l,mutatedKeys:s}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const a=e.la.L_();a.sort((p,m)=>function(A,L){const M=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $()}};return M(A)-M(L)}(p.type,m.type)||this._a(p.doc,m.doc)),this.Pa(r),i=i!=null&&i;const l=t&&!i?this.Ia():[],h=this.oa.size===0&&this.current&&!i?1:0,f=h!==this.sa;return this.sa=h,a.length!==0||f?{snapshot:new no(this.query,e.aa,s,a,e.mutatedKeys,h===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:l}:{Ta:l}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new NI,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=re(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const t=[];return e.forEach(r=>{this.oa.has(r)||t.push(new r0(r))}),this.oa.forEach(r=>{e.has(r)||t.push(new n0(r))}),t}da(e){this.ia=e.ls,this.oa=re();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return no.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class AB{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class RB{constructor(e){this.key=e,this.Ra=!1}}class SB{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new ii(l=>JT(l),_c),this.fa=new Map,this.ga=new Set,this.pa=new Pe(F.comparator),this.ya=new Map,this.wa=new Ag,this.Sa={},this.ba=new Map,this.Da=Wi.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function bB(n,e){const t=$g(n);let r,i;const s=t.ma.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const a=await eo(t.localStore,Nt(e)),l=t.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=await Fg(t,e,r,l==="current",a.resumeToken),t.isPrimaryClient&&sh(t.remoteStore,a)}return i}async function Fg(n,e,t,r,i){n.va=(m,I,A)=>async function(M,V,Y,ae){let j=V.view.ca(Y);j.Zi&&(j=await gl(M.localStore,V.query,!1).then(({documents:we})=>V.view.ca(we,j)));const ye=ae&&ae.targetChanges.get(V.targetId),de=ae&&ae.targetMismatches.get(V.targetId)!=null,me=V.view.applyChanges(j,M.isPrimaryClient,ye,de);return np(M,V.targetId,me.Ta),me.snapshot}(n,m,I,A);const s=await gl(n.localStore,e,!0),a=new i0(e,s.ls),l=a.ca(s.documents),h=wc.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),f=a.applyChanges(l,n.isPrimaryClient,h);np(n,t,f.Ta);const p=new AB(e,t,a);return n.ma.set(e,p),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),f.snapshot}async function PB(n,e){const t=B(n),r=t.ma.get(e),i=t.fa.get(r.targetId);if(i.length>1)return t.fa.set(r.targetId,i.filter(s=>!_c(s,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||await to(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Qa(t.remoteStore,r.targetId),ro(t,r.targetId)}).catch(ni)):(ro(t,r.targetId),await to(t.localStore,r.targetId,!0))}async function CB(n,e,t){const r=Wg(n);try{const i=await function(a,l){const h=B(a),f=Le.now(),p=l.reduce((A,L)=>A.add(L.key),re());let m,I;return h.persistence.runTransaction("Locally write mutations","readwrite",A=>{let L=Wt(),M=re();return h.ss.getEntries(A,p).next(V=>{L=V,L.forEach((Y,ae)=>{ae.isValidDocument()||(M=M.add(Y))})}).next(()=>h.localDocuments.getOverlayedDocuments(A,L)).next(V=>{m=V;const Y=[];for(const ae of l){const j=iU(ae,m.get(ae.key).overlayedDocument);j!=null&&Y.push(new mr(ae.key,j,$T(j.value.mapValue),Oe.exists(!0)))}return h.mutationQueue.addMutationBatch(A,f,Y,l)}).next(V=>{I=V;const Y=V.applyToLocalDocumentSet(m,M);return h.documentOverlayCache.saveOverlays(A,V.batchId,Y)})}).then(()=>({batchId:I.batchId,changes:tA(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let f=a.Sa[a.currentUser.toKey()];f||(f=new Pe(ne)),f=f.insert(l,h),a.Sa[a.currentUser.toKey()]=f}(r,i.batchId,t),await _r(r,i.changes),await vo(r.remoteStore)}catch(i){const s=wo(i,"Failed to persist write");t.reject(s)}}async function s0(n,e){const t=B(n);try{const r=await YU(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.ya.get(s);a&&(z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?z(a.Ra):i.removedDocuments.size>0&&(z(a.Ra),a.Ra=!1))}),await _r(t,r,e)}catch(r){await ni(r)}}function OI(n,e,t){const r=B(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.ma.forEach((s,a)=>{const l=a.view.Q_(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){const h=B(a);h.onlineState=l;let f=!1;h.queries.forEach((p,m)=>{for(const I of m.listeners)I.Q_(l)&&(f=!0)}),f&&Lg(h)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function DB(n,e,t){const r=B(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ya.get(e),s=i&&i.key;if(s){let a=new Pe(F.comparator);a=a.insert(s,xe.newNoDocument(s,K.min()));const l=re().add(s),h=new Ic(K.min(),new Map,new Pe(ne),a,l);await s0(r,h),r.pa=r.pa.remove(s),r.ya.delete(e),qg(r)}else await to(r.localStore,e,!1).then(()=>ro(r,e,t)).catch(ni)}async function kB(n,e){const t=B(n),r=e.batch.batchId;try{const i=await QU(t.localStore,e);Bg(t,r,null),Ug(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await _r(t,i)}catch(i){await ni(i)}}async function xB(n,e,t){const r=B(n);try{const i=await function(a,l){const h=B(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let p;return h.mutationQueue.lookupMutationBatch(f,l).next(m=>(z(m!==null),p=m.keys(),h.mutationQueue.removeMutationBatch(f,m))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,p,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,p)).next(()=>h.localDocuments.getDocuments(f,p))})}(r.localStore,e);Bg(r,e,t),Ug(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await _r(r,i)}catch(i){await ni(i)}}async function NB(n,e){const t=B(n);si(t.remoteStore)||N("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(a){const l=B(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(r===-1)return void e.resolve();const i=t.ba.get(r)||[];i.push(e),t.ba.set(r,i)}catch(r){const i=wo(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Ug(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function Bg(n,e,t){const r=B(n);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function ro(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.fa.get(e))n.ma.delete(r),t&&n.Va.Fa(r,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(r=>{n.wa.containsKey(r)||o0(n,r)})}function o0(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);t!==null&&(Qa(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),qg(n))}function np(n,e,t){for(const r of t)r instanceof n0?(n.wa.addReference(r.key,e),VB(n,r)):r instanceof r0?(N("SyncEngine","Document no longer in limbo: "+r.key),n.wa.removeReference(r.key,e),n.wa.containsKey(r.key)||o0(n,r.key)):$()}function VB(n,e){const t=e.key,r=t.path.canonicalString();n.pa.get(t)||n.ga.has(r)||(N("SyncEngine","New document in limbo: "+t),n.ga.add(r),qg(n))}function qg(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new F(ge.fromString(e)),r=n.Da.next();n.ya.set(r,new RB(t)),n.pa=n.pa.insert(t,r),sh(n.remoteStore,new or(Nt(go(t.path)),r,"TargetPurposeLimboResolution",qt._e))}}async function _r(n,e,t){const r=B(n),i=[],s=[],a=[];r.ma.isEmpty()||(r.ma.forEach((l,h)=>{a.push(r.va(h,e,t).then(f=>{if((f||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(h.targetId,f!=null&&f.fromCache?"not-current":"current"),f){i.push(f);const p=bg.Qi(h.targetId,f);s.push(p)}}))}),await Promise.all(a),r.Va.a_(i),await async function(h,f){const p=B(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>R.forEach(f,I=>R.forEach(I.ki,A=>p.persistence.referenceDelegate.addReference(m,I.targetId,A)).next(()=>R.forEach(I.qi,A=>p.persistence.referenceDelegate.removeReference(m,I.targetId,A)))))}catch(m){if(!ri(m))throw m;N("LocalStore","Failed to update sequence numbers: "+m)}for(const m of f){const I=m.targetId;if(!m.fromCache){const A=p.ts.get(I),L=A.snapshotVersion,M=A.withLastLimboFreeSnapshotVersion(L);p.ts=p.ts.insert(I,M)}}}(r.localStore,s))}async function OB(n,e){const t=B(n);if(!t.currentUser.isEqual(e)){N("SyncEngine","User change. New user:",e.toKey());const r=await qA(t.localStore,e);t.currentUser=e,function(s,a){s.ba.forEach(l=>{l.forEach(h=>{h.reject(new k(b.CANCELLED,a))})}),s.ba.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await _r(t,r._s)}}function LB(n,e){const t=B(n),r=t.ya.get(e);if(r&&r.Ra)return re().add(r.key);{let i=re();const s=t.fa.get(e);if(!s)return i;for(const a of s){const l=t.ma.get(a);i=i.unionWith(l.view.ua)}return i}}async function MB(n,e){const t=B(n),r=await gl(t.localStore,e.query,!0),i=e.view.da(r);return t.isPrimaryClient&&np(t,e.targetId,i.Ta),i}async function FB(n,e){const t=B(n);return zA(t.localStore,e).then(r=>_r(t,r))}async function UB(n,e,t,r){const i=B(n),s=await function(l,h){const f=B(l),p=B(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",m=>p.Cn(m,h).next(I=>I?f.localDocuments.getDocuments(m,I):R.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await vo(i.remoteStore):t==="acknowledged"||t==="rejected"?(Bg(i,e,r||null),Ug(i,e),function(l,h){B(B(l).mutationQueue).Fn(h)}(i.localStore,e)):$(),await _r(i,s)):N("SyncEngine","Cannot apply mutation batch with id: "+e)}async function BB(n,e){const t=B(n);if($g(t),Wg(t),e===!0&&t.Ca!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await LI(t,r.toArray());t.Ca=!0,await tp(t.remoteStore,!0);for(const s of i)sh(t.remoteStore,s)}else if(e===!1&&t.Ca!==!1){const r=[];let i=Promise.resolve();t.fa.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(ro(t,a),to(t.localStore,a,!0))),Qa(t.remoteStore,a)}),await i,await LI(t,r),function(a){const l=B(a);l.ya.forEach((h,f)=>{Qa(l.remoteStore,f)}),l.wa.Vr(),l.ya=new Map,l.pa=new Pe(F.comparator)}(t),t.Ca=!1,await tp(t.remoteStore,!1)}}async function LI(n,e,t){const r=B(n),i=[],s=[];for(const a of e){let l;const h=r.fa.get(a);if(h&&h.length!==0){l=await eo(r.localStore,Nt(h[0]));for(const f of h){const p=r.ma.get(f),m=await MB(r,p);m.snapshot&&s.push(m.snapshot)}}else{const f=await GA(r.localStore,a);l=await eo(r.localStore,f),await Fg(r,a0(f),a,!1,l.resumeToken)}i.push(l)}return r.Va.a_(s),i}function a0(n){return YT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function qB(n){return function(t){return B(B(t).persistence).Bi()}(B(n).localStore)}async function $B(n,e,t,r){const i=B(n);if(i.Ca)return void N("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=await zA(i.localStore,XT(s[0])),l=Ic.createSynthesizedRemoteEventForCurrentChange(e,t==="current",nt.EMPTY_BYTE_STRING);await _r(i,a,l);break}case"rejected":await to(i.localStore,e,!0),ro(i,e,r);break;default:$()}}async function WB(n,e,t){const r=$g(n);if(r.Ca){for(const i of e){if(r.fa.has(i)){N("SyncEngine","Adding an already active target "+i);continue}const s=await GA(r.localStore,i),a=await eo(r.localStore,s);await Fg(r,a0(s),a.targetId,!1,a.resumeToken),sh(r.remoteStore,a)}for(const i of t)r.fa.has(i)&&await to(r.localStore,i,!1).then(()=>{Qa(r.remoteStore,i),ro(r,i)}).catch(ni)}}function $g(n){const e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=s0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=LB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=DB.bind(null,e),e.Va.a_=IB.bind(null,e.eventManager),e.Va.Fa=wB.bind(null,e.eventManager),e}function Wg(n){const e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=xB.bind(null,e),e}function GB(n,e,t){const r=B(n);(async function(s,a,l){try{const h=await a.getMetadata();if(await function(A,L){const M=B(A),V=Je(L.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",Y=>M.Kr.getBundleMetadata(Y,L.id)).then(Y=>!!Y&&Y.createTime.compareTo(V)>=0)}(s.localStore,h))return await a.close(),l._completeWith(function(A){return{taskState:"Success",documentsLoaded:A.totalDocuments,bytesLoaded:A.totalBytes,totalDocuments:A.totalDocuments,totalBytes:A.totalBytes}}(h)),Promise.resolve(new Set);l._updateProgress(t0(h));const f=new TB(h,s.localStore,a.serializer);let p=await a.Ma();for(;p;){const I=await f.ea(p);I&&l._updateProgress(I),p=await a.Ma()}const m=await f.complete();return await _r(s,m.ra,void 0),await function(A,L){const M=B(A);return M.persistence.runTransaction("Save bundle","readwrite",V=>M.Kr.saveBundleMetadata(V,L))}(s.localStore,h),l._completeWith(m.progress),Promise.resolve(m.na)}catch(h){return En("SyncEngine",`Loading bundle failed with ${h}`),l._failWith(h),Promise.resolve(new Set)}})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class rp{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Ec(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return BA(this.persistence,new UA,e.initialUser,this.serializer)}createPersistence(e){return new FA(ih.jr,this.serializer)}createSharedClientState(e){return new HA}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class c0 extends rp{constructor(e,t,r){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xa.initialize(this,e),await Wg(this.xa.syncEngine),await vo(this.xa.remoteStore),await this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return BA(this.persistence,new UA,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new xU(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new g2(t,this.persistence);return new p2(e.asyncQueue,r)}createPersistence(e){const t=Sg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Bt.withCacheSize(this.cacheSizeBytes):Bt.DEFAULT;return new Rg(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,jA(),zu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new HA}}class zB extends c0{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xa.syncEngine;this.sharedClientState instanceof ff&&(this.sharedClientState.syncEngine={Ys:UB.bind(null,t),Zs:$B.bind(null,t),Xs:WB.bind(null,t),Bi:qB.bind(null,t),Js:FB.bind(null,t)},await this.sharedClientState.start()),await this.persistence.mi(async r=>{await BB(this.xa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const t=jA();if(!ff.D(t))throw new k(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Sg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ff(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Gg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>OI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=OB.bind(null,this.syncEngine),await tp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new vB}()}createDatastore(e){const t=Ec(e.databaseInfo.databaseId),r=function(s){return new rB(s)}(e.databaseInfo);return function(s,a,l,h){return new oB(s,a,l,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,a,l){return new cB(r,i,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,t=>OI(this.syncEngine,t,0),function(){return kI.D()?new kI:new eB}())}createSyncEngine(e,t){return function(i,s,a,l,h,f,p){const m=new SB(i,s,a,l,h,f);return p&&(m.Ca=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(t){const r=B(t);N("RemoteStore","RemoteStore shutting down."),r.C_.add(5),await yo(r),r.F_.shutdown(),r.M_.set("Unknown")}(this.remoteStore)}}function MI(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class oh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):Ye("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class KB{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new ot,this.buffer=new Uint8Array,this.La=function(){return new TextDecoder("utf-8")}(),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}async getMetadata(){return this.metadata.promise}async Ma(){return await this.getMetadata(),this.ka()}async ka(){const e=await this.qa();if(e===null)return null;const t=this.La.decode(e),r=Number(t);isNaN(r)&&this.Qa(`length string (${t}) is not valid number`);const i=await this.Ka(r);return new EB(JSON.parse(i),e.length+r)}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async qa(){for(;this.$a()<0&&!await this.Ua(););if(this.buffer.length===0)return null;const e=this.$a();e<0&&this.Qa("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Ka(e){for(;this.buffer.length<e;)await this.Ua()&&this.Qa("Reached the end of bundle when more is expected.");const t=this.La.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ua(){const e=await this.Ba.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class HB{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new k(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(i,s){const a=B(i),l=Ha(a.serializer)+"/documents",h={documents:s.map(I=>Ka(a.serializer,I))},f=await a.Co("BatchGetDocuments",l,h,s.length),p=new Map;f.forEach(I=>{const A=fU(a.serializer,I);p.set(A.key.toString(),A)});const m=[];return s.forEach(I=>{const A=p.get(I.toString());z(!!A),m.push(A)}),m}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new _o(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=F.fromPath(r);this.mutations.push(new gg(i,this.precondition(i)))}),await async function(r,i){const s=B(r),a=Ha(s.serializer)+"/documents",l={writes:i.map(h=>ja(s.serializer,h))};await s.wo("Commit",a,l)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw $();t=K.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new k(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(K.min())?Oe.exists(!1):Oe.updateTime(t):Oe.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(K.min()))throw new k(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Oe.updateTime(t)}return Oe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class jB{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new Cg(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko(async()=>{const e=new HB(this.datastore),t=this.za(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ja(i)}))}).catch(r=>{this.ja(r)})})}za(e){try{const t=this.updateFunction(e);return!gc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!dA(t)}return!1}}class QB{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=st.UNAUTHENTICATED,this.clientId=PT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{N("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(N("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ot;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=wo(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ku(n,e){n.asyncQueue.verifyOperationInProgress(),N("FirestoreClient","Initializing OfflineComponentProvider");const t=await n.getConfiguration();await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await qA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function ip(n,e){n.asyncQueue.verifyOperationInProgress();const t=await zg(n);N("FirestoreClient","Initializing OnlineComponentProvider");const r=await n.getConfiguration();await e.initialize(t,r),n.setCredentialChangeListener(i=>xI(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>xI(e.remoteStore,s)),n._onlineComponents=e}function u0(n){return n.name==="FirebaseError"?n.code===b.FAILED_PRECONDITION||n.code===b.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function zg(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){N("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ku(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!u0(t))throw t;En("Error using user provided cache. Falling back to memory cache: "+t),await Ku(n,new rp)}}else N("FirestoreClient","Using default OfflineComponentProvider"),await Ku(n,new rp);return n._offlineComponents}async function ah(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(N("FirestoreClient","Using user provided OnlineComponentProvider"),await ip(n,n._uninitializedComponentsProvider._online)):(N("FirestoreClient","Using default OnlineComponentProvider"),await ip(n,new Gg))),n._onlineComponents}function l0(n){return zg(n).then(e=>e.persistence)}function Kg(n){return zg(n).then(e=>e.localStore)}function h0(n){return ah(n).then(e=>e.remoteStore)}function Hg(n){return ah(n).then(e=>e.syncEngine)}function YB(n){return ah(n).then(e=>e.datastore)}async function io(n){const e=await ah(n),t=e.eventManager;return t.onListen=bB.bind(null,e.syncEngine),t.onUnlisten=PB.bind(null,e.syncEngine),t}function JB(n){return n.asyncQueue.enqueue(async()=>{const e=await l0(n),t=await h0(n);return e.setNetworkEnabled(!0),function(i){const s=B(i);return s.C_.delete(0),Tc(s)}(t)})}function XB(n){return n.asyncQueue.enqueue(async()=>{const e=await l0(n),t=await h0(n);return e.setNetworkEnabled(!1),async function(i){const s=B(i);s.C_.add(0),await yo(s),s.M_.set("Offline")}(t)})}function ZB(n,e){const t=new ot;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await function(f,p){const m=B(f);return m.persistence.runTransaction("read document","readonly",I=>m.localDocuments.getDocument(I,p))}(i,s);l.isFoundDocument()?a.resolve(l):l.isNoDocument()?a.resolve(null):a.reject(new k(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const h=wo(l,`Failed to get document '${s} from cache`);a.reject(h)}}(await Kg(n),e,t)),t.promise}function d0(n,e,t={}){const r=new ot;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const p=new oh({next:I=>{a.enqueueAndForget(()=>Og(s,m));const A=I.docs.has(l);!A&&I.fromCache?f.reject(new k(b.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&I.fromCache&&h&&h.source==="server"?f.reject(new k(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(I)},error:I=>f.reject(I)}),m=new Mg(go(l.path),p,{includeMetadataChanges:!0,J_:!0});return Vg(s,m)}(await io(n),n.asyncQueue,e,t,r)),r.promise}function eq(n,e){const t=new ot;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await gl(i,s,!0),h=new i0(s,l.ls),f=h.ca(l.documents),p=h.applyChanges(f,!1);a.resolve(p.snapshot)}catch(l){const h=wo(l,`Failed to execute query '${s} against cache`);a.reject(h)}}(await Kg(n),e,t)),t.promise}function f0(n,e,t={}){const r=new ot;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const p=new oh({next:I=>{a.enqueueAndForget(()=>Og(s,m)),I.fromCache&&h.source==="server"?f.reject(new k(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(I)},error:I=>f.reject(I)}),m=new Mg(l,p,{includeMetadataChanges:!0,J_:!0});return Vg(s,m)}(await io(n),n.asyncQueue,e,t,r)),r.promise}function tq(n,e){const t=new oh(e);return n.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).q_.add(s),s.next()}(await io(n),t)),()=>{t.Na(),n.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).q_.delete(s)}(await io(n),t))}}function nq(n,e,t,r){const i=function(a,l){let h;return h=typeof a=="string"?pA().encode(a):a,function(p,m){return new KB(p,m)}(function(p,m){if(p instanceof Uint8Array)return MI(p,m);if(p instanceof ArrayBuffer)return MI(new Uint8Array(p),m);if(p instanceof ReadableStream)return p.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),l)}(t,Ec(e));n.asyncQueue.enqueueAndForget(async()=>{GB(await Hg(n),i,r)})}function rq(n,e){return n.asyncQueue.enqueue(async()=>function(r,i){const s=B(r);return s.persistence.runTransaction("Get named query","readonly",a=>s.Kr.getNamedQuery(a,i))}(await Kg(n),e))}function p0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const FI=new Map;function jg(n,e,t){if(!t)throw new k(b.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function g0(n,e,t,r){if(e===!0&&r===!0)throw new k(b.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function UI(n){if(!F.isDocumentKey(n))throw new k(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function BI(n){if(F.isDocumentKey(n))throw new k(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ch(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$()}function _e(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new k(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ch(n);throw new k(b.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function m0(n,e){if(e<=0)throw new k(b.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class qI{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new k(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}g0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=p0((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new k(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new k(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new k(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ac{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qI({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new k(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new k(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qI(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new r2;switch(r.type){case"firstParty":return new a2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new k(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=FI.get(t);r&&(N("ComponentProvider","Removing Datastore"),FI.delete(t),r.terminate())}(this),Promise.resolve()}}function iq(n,e,t,r={}){var i;const s=(n=_e(n,Ac))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&En("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let l,h;if(typeof r.mockUserToken=="string")l=r.mockUserToken,h=st.MOCK_USER;else{l=fx(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new k(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new st(f)}n._authCredentials=new i2(new bT(l,h))}}let At=class{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new At(this.firestore,e,this._query)}},Me=class{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ur(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Me(this.firestore,e,this._key)}},ur=class extends At{constructor(e,t,r){super(e,t,go(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new F(e))}withConverter(e){return new ur(this.firestore,e,this._path)}};function _0(n,e,...t){if(n=H(n),jg("collection","path",e),n instanceof Ac){const r=ge.fromString(e,...t);return BI(r),new ur(n,null,r)}{if(!(n instanceof Me||n instanceof ur))throw new k(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ge.fromString(e,...t));return BI(r),new ur(n.firestore,null,r)}}function sq(n,e){if(n=_e(n,Ac),jg("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(b.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new At(n,null,function(r){return new gr(ge.emptyPath(),r)}(e))}function Ya(n,e,...t){if(n=H(n),arguments.length===1&&(e=PT.newId()),jg("doc","path",e),n instanceof Ac){const r=ge.fromString(e,...t);return UI(r),new Me(n,null,new F(r))}{if(!(n instanceof Me||n instanceof ur))throw new k(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ge.fromString(e,...t));return UI(r),new Me(n.firestore,n instanceof ur?n.converter:null,new F(r))}}function y0(n,e){return n=H(n),e=H(e),(n instanceof Me||n instanceof ur)&&(e instanceof Me||e instanceof ur)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function v0(n,e){return n=H(n),e=H(e),n instanceof At&&e instanceof At&&n.firestore===e.firestore&&_c(n._query,e._query)&&n.converter===e.converter}class oq{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new Cg(this,"async_queue_retry"),this.iu=()=>{const t=zu();t&&N("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=zu();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=zu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new ot;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!ri(e))throw e;N("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;const i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw Ye("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=t,t}enqueueAfterDelay(e,t,r){this.su(),this.ru.indexOf(e)>-1&&(t=0);const i=Ng.createAndSchedule(this,e,t,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&$()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function sp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class aq{constructor(){this._progressObserver={},this._taskCompletionResolver=new ot,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const cq=-1;let ze=class extends Ac{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new oq}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||I0(this),this._firestoreClient.terminate()}};function lt(n){return n._firestoreClient||I0(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function I0(n){var e,t,r;const i=n._freezeSettings(),s=function(l,h,f,p){return new L2(l,h,f,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,p0(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new QB(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function uq(n,e){E0(n=_e(n,ze));const t=lt(n);if(t._uninitializedComponentsProvider)throw new k(b.FAILED_PRECONDITION,"SDK cache is already specified.");En("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new Gg;return w0(t,i,new c0(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function lq(n){E0(n=_e(n,ze));const e=lt(n);if(e._uninitializedComponentsProvider)throw new k(b.FAILED_PRECONDITION,"SDK cache is already specified.");En("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new Gg;return w0(e,r,new zB(r,t.cacheSizeBytes))}function w0(n,e,t){const r=new ot;return n.asyncQueue.enqueue(async()=>{try{await Ku(n,t),await ip(n,e),r.resolve()}catch(i){const s=i;if(!u0(s))throw s;En("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function hq(n){if(n._initialized&&!n._terminated)throw new k(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ot;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!vn.D())return Promise.resolve();const i=r+"main";await vn.delete(i)}(Sg(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function dq(n){return function(t){const r=new ot;return t.asyncQueue.enqueueAndForget(async()=>NB(await Hg(t),r)),r.promise}(lt(n=_e(n,ze)))}function fq(n){return JB(lt(n=_e(n,ze)))}function pq(n){return XB(lt(n=_e(n,ze)))}function gq(n,e){const t=lt(n=_e(n,ze)),r=new aq;return nq(t,n._databaseId,e,r),r}function mq(n,e){return rq(lt(n=_e(n,ze)),e).then(t=>t?new At(n,null,t.query):null)}function E0(n){if(n._initialized||n._terminated)throw new k(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Kn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Kn(nt.fromBase64String(e))}catch(t){throw new k(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Kn(nt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}let Qr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new k(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let Yi=class{constructor(e){this._methodName=e}};class uh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new k(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}}const _q=/^__.*__$/;class yq{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new mr(e,this.data,this.fieldMask,t,this.fieldTransforms):new mo(e,this.data,t,this.fieldTransforms)}}class T0{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new mr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function A0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $()}}class lh{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new lh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return vl(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(A0(this.Iu)&&_q.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class vq{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ec(e)}pu(e,t,r,i=!1){return new lh({Iu:e,methodName:t,gu:r,path:Ve.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ji(n){const e=n._freezeSettings(),t=Ec(n._databaseId);return new vq(n._databaseId,!!e.ignoreUndefinedProperties,t)}function hh(n,e,t,r,i,s={}){const a=n.pu(s.merge||s.mergeFields?2:0,e,t,i);Xg("Data must be an object, but it was:",a,r);const l=b0(r,a);let h,f;if(s.merge)h=new $t(a.fieldMask),f=a.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const I=op(e,m,t);if(!a.contains(I))throw new k(b.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);C0(p,I)||p.push(I)}h=new $t(p),f=a.fieldTransforms.filter(m=>h.covers(m.field))}else h=null,f=a.fieldTransforms;return new yq(new gt(l),h,f)}class Rc extends Yi{_toFieldTransform(e){if(e.Iu!==2)throw e.Iu===1?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rc}}function R0(n,e,t){return new lh({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Qg extends Yi{_toFieldTransform(e){return new vc(e.path,new Js)}isEqual(e){return e instanceof Qg}}class Iq extends Yi{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=R0(this,e,!0),r=this.yu.map(s=>Xi(s,t)),i=new Ui(r);return new vc(e.path,i)}isEqual(e){return this===e}}class wq extends Yi{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=R0(this,e,!0),r=this.yu.map(s=>Xi(s,t)),i=new Bi(r);return new vc(e.path,i)}isEqual(e){return this===e}}class Eq extends Yi{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new Xs(e.serializer,sA(e.serializer,this.wu));return new vc(e.path,t)}isEqual(e){return this===e}}function Yg(n,e,t,r){const i=n.pu(1,e,t);Xg("Data must be an object, but it was:",i,r);const s=[],a=gt.empty();Qi(r,(h,f)=>{const p=Zg(e,h,t);f=H(f);const m=i.Ru(p);if(f instanceof Rc)s.push(p);else{const I=Xi(f,m);I!=null&&(s.push(p),a.set(p,I))}});const l=new $t(s);return new T0(a,l,i.fieldTransforms)}function Jg(n,e,t,r,i,s){const a=n.pu(1,e,t),l=[op(e,r,t)],h=[i];if(s.length%2!=0)throw new k(b.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<s.length;I+=2)l.push(op(e,s[I])),h.push(s[I+1]);const f=[],p=gt.empty();for(let I=l.length-1;I>=0;--I)if(!C0(f,l[I])){const A=l[I];let L=h[I];L=H(L);const M=a.Ru(A);if(L instanceof Rc)f.push(A);else{const V=Xi(L,M);V!=null&&(f.push(A),p.set(A,V))}}const m=new $t(f);return new T0(p,m,a.fieldTransforms)}function S0(n,e,t,r=!1){return Xi(t,n.pu(r?4:3,e))}function Xi(n,e){if(P0(n=H(n)))return Xg("Unsupported field value:",e,n),b0(n,e);if(n instanceof Yi)return function(r,i){if(!A0(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const l of r){let h=Xi(l,i.Vu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=H(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return sA(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Le.fromDate(r);return{timestampValue:Zs(i.serializer,s)}}if(r instanceof Le){const s=new Le(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Zs(i.serializer,s)}}if(r instanceof uh)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Kn)return{bytesValue:_A(i.serializer,r._byteString)};if(r instanceof Me){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ig(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${ch(r)}`)}(n,e)}function b0(n,e){const t={};return UT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qi(n,(r,i)=>{const s=Xi(i,e.Eu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function P0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Le||n instanceof uh||n instanceof Kn||n instanceof Me||n instanceof Yi)}function Xg(n,e,t){if(!P0(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=ch(t);throw r==="an object"?e.mu(n+" a custom object"):e.mu(n+" "+r)}}function op(n,e,t){if((e=H(e))instanceof Qr)return e._internalPath;if(typeof e=="string")return Zg(n,e);throw vl("Field path arguments must be of type string or ",n,!1,void 0,t)}const Tq=new RegExp("[~\\*/\\[\\]]");function Zg(n,e,t){if(e.search(Tq)>=0)throw vl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Qr(...e.split("."))._internalPath}catch{throw vl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function vl(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new k(b.INVALID_ARGUMENT,l+n+h)}function C0(n,e){return n.some(t=>t.isEqual(e))}class Ja{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Aq(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(dh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Aq extends Ja{data(){return super.data()}}function dh(n,e){return typeof e=="string"?Zg(n,e):e instanceof Qr?e._internalPath:e._delegate._internalPath}function D0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new k(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class em{}class Sc extends em{}function kr(n,e,...t){let r=[];e instanceof em&&r.push(e),r=r.concat(t),function(s){const a=s.filter(h=>h instanceof tm).length,l=s.filter(h=>h instanceof fh).length;if(a>1||a>0&&l>0)throw new k(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class fh extends Sc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new fh(e,t,r)}_apply(e){const t=this._parse(e);return x0(e._query,t),new At(e.firestore,e.converter,Hf(e._query,t))}_parse(e){const t=Ji(e.firestore);return function(s,a,l,h,f,p,m){let I;if(f.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new k(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){WI(m,p);const A=[];for(const L of m)A.push($I(h,s,L));I={arrayValue:{values:A}}}else I=$I(h,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||WI(m,p),I=S0(l,a,m,p==="in"||p==="not-in");return he.create(f,p,I)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Rq(n,e,t){const r=e,i=dh("where",n);return fh._create(i,r,t)}class tm extends em{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new tm(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Te.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i;const l=s.getFlattenedFilters();for(const h of l)x0(a,h),a=Hf(a,h)}(e._query,t),new At(e.firestore,e.converter,Hf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class nm extends Sc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new nm(e,t)}_apply(e){const t=function(i,s,a){if(i.startAt!==null)throw new k(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new k(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new za(s,a)}(e._query,this._field,this._direction);return new At(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new gr(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function Sq(n,e="asc"){const t=e,r=dh("orderBy",n);return nm._create(r,t)}class ph extends Sc{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new ph(e,t,r)}_apply(e){return new At(e.firestore,e.converter,hl(e._query,this._limit,this._limitType))}}function bq(n){return m0("limit",n),ph._create("limit",n,"F")}function Pq(n){return m0("limitToLast",n),ph._create("limitToLast",n,"L")}class gh extends Sc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new gh(e,t,r)}_apply(e){const t=k0(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new gr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}}function Cq(...n){return gh._create("startAt",n,!0)}function Dq(...n){return gh._create("startAfter",n,!1)}class mh extends Sc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new mh(e,t,r)}_apply(e){const t=k0(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new gr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}}function kq(...n){return mh._create("endBefore",n,!1)}function xq(...n){return mh._create("endAt",n,!0)}function k0(n,e,t,r){if(t[0]=H(t[0]),t[0]instanceof Ja)return function(s,a,l,h,f){if(!h)throw new k(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const p=[];for(const m of Us(s))if(m.field.isKeyField())p.push(Mi(a,h.key));else{const I=h.data.field(m.field);if(Zl(I))throw new k(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+m.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(I===null){const A=m.field.canonicalString();throw new k(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${A}' (used as the orderBy) does not exist.`)}p.push(I)}return new Hr(p,f)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Ji(n.firestore);return function(a,l,h,f,p,m){const I=a.explicitOrderBy;if(p.length>I.length)throw new k(b.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const A=[];for(let L=0;L<p.length;L++){const M=p[L];if(I[L].field.isKeyField()){if(typeof M!="string")throw new k(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof M}`);if(!fg(a)&&M.indexOf("/")!==-1)throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${M}' contains a slash.`);const V=a.path.child(ge.fromString(M));if(!F.isDocumentKey(V))throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${V}' is not because it contains an odd number of segments.`);const Y=new F(V);A.push(Mi(l,Y))}else{const V=S0(h,f,M);A.push(V)}}return new Hr(A,m)}(n._query,n.firestore._databaseId,i,e,t,r)}}function $I(n,e,t){if(typeof(t=H(t))=="string"){if(t==="")throw new k(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fg(e)&&t.indexOf("/")!==-1)throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ge.fromString(t));if(!F.isDocumentKey(r))throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Mi(n,new F(r))}if(t instanceof Me)return Mi(n,t._key);throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ch(t)}.`)}function WI(n,e){if(!Array.isArray(n)||n.length===0)throw new k(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function x0(n,e){const t=function(i,s){for(const a of i)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new k(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new k(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class rm{convertValue(e,t="none"){switch(Li(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Gr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw $()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Qi(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new uh(qe(e.latitude),qe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=hg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp($a(e));default:return null}}convertTimestamp(e){const t=Wr(e);return new Le(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ge.fromString(e);z(bA(r));const i=new zr(r.get(1),r.get(3)),s=new F(r.popFirst(5));return i.isEqual(t)||Ye(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function _h(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Nq extends rm{constructor(e){super(),this.firestore=e}convertBytes(e){return new Kn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}}class bi{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let dr=class extends Ja{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wa(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(dh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},wa=class extends dr{data(e={}){return super.data(e)}},Yr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new bi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new wa(this._firestore,this._userDataWriter,r.key,r,new bi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new k(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{const h=new wa(i._firestore,i._userDataWriter,l.doc.key,l.doc,new bi(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const h=new wa(i._firestore,i._userDataWriter,l.doc.key,l.doc,new bi(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,p=-1;return l.type!==0&&(f=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:Vq(l.type),doc:h,oldIndex:f,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Vq(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $()}}function N0(n,e){return n instanceof dr&&e instanceof dr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Yr&&e instanceof Yr&&n._firestore===e._firestore&&v0(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function V0(n){n=_e(n,Me);const e=_e(n.firestore,ze);return d0(lt(e),n._key).then(t=>im(e,n,t))}class Zi extends rm{constructor(e){super(),this.firestore=e}convertBytes(e){return new Kn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}}function Oq(n){n=_e(n,Me);const e=_e(n.firestore,ze),t=lt(e),r=new Zi(e);return ZB(t,n._key).then(i=>new dr(e,r,n._key,i,new bi(i!==null&&i.hasLocalMutations,!0),n.converter))}function Lq(n){n=_e(n,Me);const e=_e(n.firestore,ze);return d0(lt(e),n._key,{source:"server"}).then(t=>im(e,n,t))}function Mq(n){n=_e(n,At);const e=_e(n.firestore,ze),t=lt(e),r=new Zi(e);return D0(n._query),f0(t,n._query).then(i=>new Yr(e,r,n,i))}function Fq(n){n=_e(n,At);const e=_e(n.firestore,ze),t=lt(e),r=new Zi(e);return eq(t,n._query).then(i=>new Yr(e,r,n,i))}function Uq(n){n=_e(n,At);const e=_e(n.firestore,ze),t=lt(e),r=new Zi(e);return f0(t,n._query,{source:"server"}).then(i=>new Yr(e,r,n,i))}function GI(n,e,t){n=_e(n,Me);const r=_e(n.firestore,ze),i=_h(n.converter,e,t);return bc(r,[hh(Ji(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Oe.none())])}function zI(n,e,t,...r){n=_e(n,Me);const i=_e(n.firestore,ze),s=Ji(i);let a;return a=typeof(e=H(e))=="string"||e instanceof Qr?Jg(s,"updateDoc",n._key,e,t,r):Yg(s,"updateDoc",n._key,e),bc(i,[a.toMutation(n._key,Oe.exists(!0))])}function Bq(n){return bc(_e(n.firestore,ze),[new _o(n._key,Oe.none())])}function qq(n,e){const t=_e(n.firestore,ze),r=Ya(n),i=_h(n.converter,e);return bc(t,[hh(Ji(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Oe.exists(!1))]).then(()=>r)}function O0(n,...e){var t,r,i;n=H(n);let s={includeMetadataChanges:!1},a=0;typeof e[a]!="object"||sp(e[a])||(s=e[a],a++);const l={includeMetadataChanges:s.includeMetadataChanges};if(sp(e[a])){const m=e[a];e[a]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[a+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[a+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let h,f,p;if(n instanceof Me)f=_e(n.firestore,ze),p=go(n._key.path),h={next:m=>{e[a]&&e[a](im(f,n,m))},error:e[a+1],complete:e[a+2]};else{const m=_e(n,At);f=_e(m.firestore,ze),p=m._query;const I=new Zi(f);h={next:A=>{e[a]&&e[a](new Yr(f,I,m,A))},error:e[a+1],complete:e[a+2]},D0(n._query)}return function(I,A,L,M){const V=new oh(M),Y=new Mg(A,V,L);return I.asyncQueue.enqueueAndForget(async()=>Vg(await io(I),Y)),()=>{V.Na(),I.asyncQueue.enqueueAndForget(async()=>Og(await io(I),Y))}}(lt(f),p,l,h)}function $q(n,e){return tq(lt(n=_e(n,ze)),sp(e)?e:{next:e})}function bc(n,e){return function(r,i){const s=new ot;return r.asyncQueue.enqueueAndForget(async()=>CB(await Hg(r),i,s)),s.promise}(lt(n),e)}function im(n,e,t){const r=t.docs.get(e._key),i=new Zi(n);return new dr(n,i,e._key,r,new bi(t.hasPendingWrites,t.fromCache),e.converter)}const Wq={maxAttempts:5};let Gq=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ji(e)}set(e,t,r){this._verifyNotCommitted();const i=Nr(e,this._firestore),s=_h(i.converter,t,r),a=hh(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(a.toMutation(i._key,Oe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=Nr(e,this._firestore);let a;return a=typeof(t=H(t))=="string"||t instanceof Qr?Jg(this._dataReader,"WriteBatch.update",s._key,t,r,i):Yg(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Oe.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Nr(e,this._firestore);return this._mutations=this._mutations.concat(new _o(t._key,Oe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Nr(n,e){if((n=H(n)).firestore!==e)throw new k(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}let zq=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Ji(t)}get(t){const r=Nr(t,this._firestore),i=new Nq(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return $();const a=s[0];if(a.isFoundDocument())return new Ja(this._firestore,i,a.key,a,r.converter);if(a.isNoDocument())return new Ja(this._firestore,i,r._key,null,r.converter);throw $()})}set(t,r,i){const s=Nr(t,this._firestore),a=_h(s.converter,r,i),l=hh(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(t,r,i,...s){const a=Nr(t,this._firestore);let l;return l=typeof(r=H(r))=="string"||r instanceof Qr?Jg(this._dataReader,"Transaction.update",a._key,r,i,s):Yg(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,l),this}delete(t){const r=Nr(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Nr(e,this._firestore),r=new Zi(this._firestore);return super.get(e).then(i=>new dr(this._firestore,r,t._key,i._document,new bi(!1,!1),t.converter))}};function Kq(n,e,t){n=_e(n,ze);const r=Object.assign(Object.assign({},Wq),t);return function(s){if(s.maxAttempts<1)throw new k(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,a,l){const h=new ot;return s.asyncQueue.enqueueAndForget(async()=>{const f=await YB(s);new jB(s.asyncQueue,f,l,a,h).run()}),h.promise}(lt(n),i=>e(new zq(n,i)),r)}function Hq(){return new Rc("deleteField")}function jq(){return new Qg("serverTimestamp")}function Qq(...n){return new Iq("arrayUnion",n)}function Yq(...n){return new wq("arrayRemove",n)}function Jq(n){return new Eq("increment",n)}(function(e,t=!0){(function(i){po=i})(Xr),Br(new Wn("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),l=new ze(new s2(r.getProvider("auth-internal")),new u2(r.getProvider("app-check-internal")),function(f,p){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new k(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zr(f.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Un(Uv,"4.4.0",e),Un(Uv,"4.4.0","esm2017")})();const Xq="@firebase/firestore-compat",Zq="0.3.23";function sm(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function KI(){if(typeof Uint8Array>"u")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function HI(){if(!V2())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Xa{constructor(e){this._delegate=e}static fromBase64String(e){return HI(),new Xa(Kn.fromBase64String(e))}static fromUint8Array(e){return KI(),new Xa(Kn.fromUint8Array(e))}toBase64(){return HI(),this._delegate.toBase64()}toUint8Array(){return KI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function ap(n){return e4(n,["next","error","complete"])}function e4(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class t4{enableIndexedDbPersistence(e,t){return uq(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return lq(e._delegate)}clearIndexedDbPersistence(e){return hq(e._delegate)}}class L0{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof zr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&En("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){iq(this._delegate,e,t,r)}enableNetwork(){return fq(this._delegate)}disableNetwork(){return pq(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,g0("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return dq(this._delegate)}onSnapshotsInSync(e){return $q(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new so(this,_0(this._delegate,e))}catch(t){throw Ct(t,"collection()","Firestore.collection()")}}doc(e){try{return new ln(this,Ya(this._delegate,e))}catch(t){throw Ct(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Pt(this,sq(this._delegate,e))}catch(t){throw Ct(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Kq(this._delegate,t=>e(new M0(this,t)))}batch(){return lt(this._delegate),new F0(new Gq(this._delegate,e=>bc(this._delegate,e)))}loadBundle(e){return gq(this._delegate,e)}namedQuery(e){return mq(this._delegate,e).then(t=>t?new Pt(this,t):null)}}class yh extends rm{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xa(new Kn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return ln.forKey(t,this.firestore,null)}}function n4(n){t2(n)}class M0{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new yh(e)}get(e){const t=Pi(e);return this._delegate.get(t).then(r=>new Za(this._firestore,new dr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Pi(e);return r?(sm("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Pi(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Pi(e);return this._delegate.delete(t),this}}class F0{constructor(e){this._delegate=e}set(e,t,r){const i=Pi(e);return r?(sm("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Pi(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Pi(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Gi{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new wa(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ec(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Gi.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new Gi(e,new yh(e),t),i.set(t,s)),s}}Gi.INSTANCES=new WeakMap;class ln{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new yh(e)}static forPath(e,t,r){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new ln(t,new Me(t._delegate,r,new F(e)))}static forKey(e,t,r){return new ln(t,new Me(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new so(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new so(this.firestore,_0(this._delegate,e))}catch(t){throw Ct(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=H(e),e instanceof Me?y0(this._delegate,e):!1}set(e,t){t=sm("DocumentReference.set",t);try{return t?GI(this._delegate,e,t):GI(this._delegate,e)}catch(r){throw Ct(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?zI(this._delegate,e):zI(this._delegate,e,t,...r)}catch(i){throw Ct(i,"updateDoc()","DocumentReference.update()")}}delete(){return Bq(this._delegate)}onSnapshot(...e){const t=U0(e),r=B0(e,i=>new Za(this.firestore,new dr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return O0(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=Oq(this._delegate):(e==null?void 0:e.source)==="server"?t=Lq(this._delegate):t=V0(this._delegate),t.then(r=>new Za(this.firestore,new dr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new ln(this.firestore,e?this._delegate.withConverter(Gi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ct(n,e,t){return n.message=n.message.replace(e,t),n}function U0(n){for(const e of n)if(typeof e=="object"&&!ap(e))return e;return{}}function B0(n,e){var t,r;let i;return ap(n[0])?i=n[0]:ap(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class Za{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new ln(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return N0(this._delegate,e._delegate)}}class ec extends Za{data(e){const t=this._delegate.data(e);return this._delegate._converter||n2(t!==void 0),t}}class Pt{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new yh(e)}where(e,t,r){try{return new Pt(this.firestore,kr(this._delegate,Rq(e,t,r)))}catch(i){throw Ct(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Pt(this.firestore,kr(this._delegate,Sq(e,t)))}catch(r){throw Ct(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Pt(this.firestore,kr(this._delegate,bq(e)))}catch(t){throw Ct(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Pt(this.firestore,kr(this._delegate,Pq(e)))}catch(t){throw Ct(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Pt(this.firestore,kr(this._delegate,Cq(...e)))}catch(t){throw Ct(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Pt(this.firestore,kr(this._delegate,Dq(...e)))}catch(t){throw Ct(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Pt(this.firestore,kr(this._delegate,kq(...e)))}catch(t){throw Ct(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Pt(this.firestore,kr(this._delegate,xq(...e)))}catch(t){throw Ct(t,"endAt()","Query.endAt()")}}isEqual(e){return v0(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=Fq(this._delegate):(e==null?void 0:e.source)==="server"?t=Uq(this._delegate):t=Mq(this._delegate),t.then(r=>new cp(this.firestore,new Yr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=U0(e),r=B0(e,i=>new cp(this.firestore,new Yr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return O0(this._delegate,t,r)}withConverter(e){return new Pt(this.firestore,e?this._delegate.withConverter(Gi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class r4{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new ec(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class cp{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Pt(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ec(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new r4(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new ec(this._firestore,r))})}isEqual(e){return N0(this._delegate,e._delegate)}}class so extends Pt{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new ln(this.firestore,e):null}doc(e){try{return e===void 0?new ln(this.firestore,Ya(this._delegate)):new ln(this.firestore,Ya(this._delegate,e))}catch(t){throw Ct(t,"doc()","CollectionReference.doc()")}}add(e){return qq(this._delegate,e).then(t=>new ln(this.firestore,t))}isEqual(e){return y0(this._delegate,e._delegate)}withConverter(e){return new so(this.firestore,e?this._delegate.withConverter(Gi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Pi(n){return _e(n,Me)}class om{constructor(...e){this._delegate=new Qr(...e)}static documentId(){return new om(Ve.keyField().canonicalString())}isEqual(e){return e=H(e),e instanceof Qr?this._delegate._internalPath.isEqual(e._internalPath):!1}}class Ti{constructor(e){this._delegate=e}static serverTimestamp(){const e=jq();return e._methodName="FieldValue.serverTimestamp",new Ti(e)}static delete(){const e=Hq();return e._methodName="FieldValue.delete",new Ti(e)}static arrayUnion(...e){const t=Qq(...e);return t._methodName="FieldValue.arrayUnion",new Ti(t)}static arrayRemove(...e){const t=Yq(...e);return t._methodName="FieldValue.arrayRemove",new Ti(t)}static increment(e){const t=Jq(e);return t._methodName="FieldValue.increment",new Ti(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const i4={Firestore:L0,GeoPoint:uh,Timestamp:Le,Blob:Xa,Transaction:M0,WriteBatch:F0,DocumentReference:ln,DocumentSnapshot:Za,Query:Pt,QueryDocumentSnapshot:ec,QuerySnapshot:cp,CollectionReference:so,FieldPath:om,FieldValue:Ti,setLogLevel:n4,CACHE_SIZE_UNLIMITED:cq};function s4(n,e){n.INTERNAL.registerComponent(new Wn("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},i4)))}function o4(n){s4(n,(e,t)=>new L0(e,t,new t4)),n.registerVersion(Xq,Zq)}o4(qr);const a4={apiKey:"AIzaSyCfFGZC07caKFCARPJmMU-qsuAW8jLIu3E",authDomain:"project-fitness-07.firebaseapp.com",projectId:"project-fitness-07",storageBucket:"project-fitness-07.appspot.com",messagingSenderId:"607206642972",appId:"1:607206642972:web:ea1d5c525a976b668cd6d9"},zi=qr.initializeApp(a4);async function c4({email:n,password:e,name:t}){await zi.auth().createUserWithEmailAndPassword(n,e),await(await zi.auth().currentUser).updateProfile({displayName:t})}async function u4({email:n,password:e}){try{await zi.auth().signInWithEmailAndPassword(n,e)}catch(t){console.log(t.message)}}async function l4(){await zi.auth().signOut()}const ta={fs:qr.firestore(),getCurrentUserID:async function(){return new Promise((n,e)=>{zi.auth().onAuthStateChanged(t=>{t?n(t.uid):e("User not authenticated")})})},addData:async function(n,e){const t=await this.getCurrentUserID();this.fs.collection("users").doc(t).set({[n]:e},{merge:!0}).then(()=>!0).catch(r=>(console.error("Error writing document: ",r),!1))},removeData:async function(n){const e=await this.getCurrentUserID();this.fs.collection("users").doc(e).update({[n]:qr.firestore.FieldValue.delete()},{merge:!0}).then(()=>!0).catch(t=>(console.error("Error writing document: ",t),!1))},getData:async function(){const n=await this.getCurrentUserID(),e=Ya(this.fs,"users",n),t=await V0(e);if(t.exists())return t.data();console.error("No such document")}};function Ds(n,e){let t="";for(let r=0;r<n;r+=1)e.classList.contains("workout-cards__wrapper")||e.classList.contains("favorite-cards__wrapper")?t+=`
      <li class='workouts__skeleton-loader'>
        <div class='svg-container'>
          <svg
            role="img"
            width="100%"
            height="135"
            aria-labelledby="loading-aria"
            viewBox="0 0 405 141"
            preserveAspectRatio="none"
          >
            <title id="loading-aria">Loading...</title>
            <rect
              x="0"
              y="0"
              width="100%"
              height="100%"
              clip-path="url(#clip-path)"
              style='fill: url("#fill");'
            ></rect>
            <defs>
              <clipPath id="clip-path">
                  <rect x="9" y="5" rx="10" ry="10" width="81" height="19" />
                  <rect x="107" y="5" rx="3" ry="3" width="19" height="18" />
                  <circle cx="28" cy="67" r="19" />
                  <rect x="311" y="7" rx="4" ry="4" width="58" height="20" />
                  <rect x="381" y="18" rx="0" ry="0" width="40" height="0" />
                  <rect x="74" y="54" rx="0" ry="0" width="192" height="25" />
                  <rect x="6" y="108" rx="0" ry="0" width="123" height="28" />
                  <rect x="164" y="109" rx="0" ry="0" width="122" height="26" />
                  <rect x="314" y="109" rx="0" ry="0" width="77" height="27" />
                  <rect x="379" y="8" rx="7" ry="7" width="19" height="19" />
              </clipPath>
              <linearGradient id="fill">
                <stop
                  offset="0.599964"
                  stop-color="#ecebeb"
                  stop-opacity="1"
                >
                  <animate
                    attributeName="offset"
                    values="-2; -2; 1"
                    keyTimes="0; 0.25; 1"
                    dur="2s"
                    repeatCount="indefinite"
                  ></animate>
                </stop>
                <stop
                  offset="1.59996"
                  stop-color="#ffffff"
                  stop-opacity="1"
                >
                  <animate
                    attributeName="offset"
                    values="-1; -1; 2"
                    keyTimes="0; 0.25; 1"
                    dur="2s"
                    repeatCount="indefinite"
                  ></animate>
                </stop>
                <stop
                  offset="2.59996"
                  stop-color="#ecebeb"
                  stop-opacity="1"
                >
                  <animate
                    attributeName="offset"
                    values="0; 0; 3"
                    keyTimes="0; 0.25; 1"
                    dur="2s"
                    repeatCount="indefinite"
                  ></animate>
                </stop>
              </linearGradient>
            </defs>
          </svg>
        </div>
      </li>
      `:t+=`
      <li class='exercises__skeleton-loader'>
        <div class='card'>
          <div class='cover-image-skeleton'></div>
        </div>
      </li>
      `;return t}function ks(n,e){n.innerHTML=e}const qs=document.querySelector(".js-cards"),$s="/project-fitness-07/";function h4(n){const e=n.map(({filter:t,name:r,imgURL:i})=>`
        <li class="exercise-cards__gallery-link js-card" data-card-name="${r}">
            <div class="exercise-cards__gallery-card">

                <img class="exercise-cards__gallery-image"  src="${i}" alt="${t+"-"+r}" loading="lazy" />
                <div class="exercise-cards__gallery-info">
                    <h3 class="exercise-cards__head3-name">${r}</h3>
                    <p class="exercise-cards__parag-filter">${t}</p>
                </div>
            </div>
        </li>
        `).join("");qs.insertAdjacentHTML("beforeend",e)}function d4(n){const e=n.map(({_id:t,bodyPart:r,name:i,target:s,burnedCalories:a,time:l,rating:h})=>`
        <li class="workout-cards__gallery-link js-workout-card" data-id="${t}">
            <div class="workout-cards__gallery-card" >
                <div class="workout-cards__first-line-wrapper">
                    <p class="workout-cards__parag-workout">Workout</p>
                    <p class="workout-cards__parag-rating">${Math.round(h*10)/10}</p>
                    <svg class="workout-cards__icon-star">
                        <use href="${$s}images/icons-sprite.svg#icon-star"></use>
                    </svg>
                    <p class="workout-cards__parag-start">Start</p>
                    <svg class="workout-cards__icon-arrow-up">
                        <use href="${$s}images/icons-sprite.svg#icon-arrow-up"></use>
                    </svg>
                </div>
                <div class="workout-cards__second-line-wrapper">
                    <div class="workout-cards__wrapper-icon-running-stick">
                        <svg class="workout-cards__icon-running-stick">
                            <use href="${$s}images/icons-sprite.svg#icon-running-stick"></use>
                        </svg>
                    </div>
                    <h3 class="workout-cards__head3-name">${i}</h3>
                </div>
                <div class="workout-cards__third-line-wrapper">
                  <ul class="workout-cards__list-info">
                    <li class="workout-cards__list-point">
                      <p class="workout-cards__parag-burned-calories">Burned calories:</p>
                      <p class="workout-cards__parag-burned-calories-result">${a} / ${l} min<p>
                    </li>
                    <li class="workout-cards__list-point">
                      <p class="workout-cards__parag-body-part">Body part:</p>
                      <p class="workout-cards__parag-body-part-result">${r}<p>
                    </li>
                    <li class="workout-cards__list-point">
                      <p class="workout-cards__parag-target">Target:</p>
                      <p class="workout-cards__parag-target-result">${s}<p>
                    </li>
                  </ul>
                </div>
            </div>
          </li>
        `).join("");qs.insertAdjacentHTML("beforeend",e)}function f4(n){const e=n.length;ks(qs,Ds(e,qs));const t=n.map(({_id:r,bodyPart:i,name:s,target:a,burnedCalories:l,time:h})=>`
        <li class="favorite-cards__gallery-link" data-id="${r}">
            <div class="favorite-cards__gallery-card">
                <div class="favorite-cards__first-line-wrapper">
                    <p class="favorite-cards__parag-workout">Workout</p>
                    <svg class="favorite-cards__icon-trash">
                        <use href="${$s}images/icons-sprite.svg#icon-trash"></use>
                    </svg>
                    <p class="favorite-cards__parag-start">Start</p>
                    <svg class="favorite-cards__icon-arrow-up">
                        <use href="${$s}images/icons-sprite.svg#icon-arrow-up"></use>
                    </svg>
                </div>
                <div class="favorite-cards__second-line-wrapper">
                    <div class="workout-cards__wrapper-icon-running-stick">
                      <svg class="favorite-cards__icon-running-stick">
                          <use href="${$s}images/icons-sprite.svg#icon-running-stick"></use>
                      </svg>
                    </div>
                    <h3 class="favorite-cards__head3-name">${s}</h3>
                </div>
                <div class="favorite-cards__third-line-wrapper">
                  <ul class="favorite-cards__list-info">
                    <li class="favorite-cards__list-point">
                      <p class="favorite-cards__parag-burned-calories">Burned calories:</p>
                      <p class="favorite-cards__parag-burned-calories-result">${l} / ${h} min<p>
                    </li>
                    <li class="favorite-cards__list-point">
                      <p class="favorite-cards__parag-body-part">Body part:</p>
                      <p class="favorite-cards__parag-body-part-result">${i}<p>
                    </li>
                    <li class="favorite-cards__list-point">
                      <p class="favorite-cards__parag-target">Target:</p>
                      <p class="favorite-cards__parag-target-result">${a}<p>
                    </li>
                  </ul>
                </div>
            </div>
          </li>
        `).join("");qs.innerHTML=t}function Nu(){qs.innerHTML=""}const Ws={add:function(n,e){return new Promise((t,r)=>{try{ta.addData(n,e),t(!0)}catch{r(!1)}})},get:function(){return new Promise(async(n,e)=>{try{const t=await ta.getData();n(Object.values(t))}catch{e([])}})},idIsFavorite:async function(n){try{return(await this.get()).some(t=>t._id===n)}catch{return!1}},getObjectById:async function(n){try{const t=(await this.get()).find(r=>r._id===n)||null;return t?{...t,isFavorite:!0}:null}catch{return null}},addAndGet:async function(n,e){return new Promise(async(t,r)=>{try{await ta.addData(n,e),setTimeout(async()=>{const i=await ta.getData();t(Object.values(i))},200)}catch{r([])}})},remove:async function(n){return new Promise((e,t)=>{try{ta.removeData(n),e(!0)}catch{t(!1)}})}},bn=document.querySelector(".js-cards");function q0(n,e){if(e>=768)return n!=3?(ks(bn,Ds(10,bn)),10):(ks(bn,Ds(12,bn)),12);if(e<768){if(n===1)return ks(bn,Ds(8,bn)),8;if(n===2||n===1)return ks(bn,Ds(8,bn)),8}return ks(bn,Ds(9,bn)),9}function $0(n){const e={filter:"Body%20parts",bodypart:"",keyword:"",muscles:"",equipment:""};for(const t in n)if(n.hasOwnProperty(t)&&n[t]!==e[t])return!0;return!1}function p4(n,e,t,r,i){return $0(r)?(t.bodyPart=r.bodypart,t.searchQuery=r.keyword,t.muscles=r.muscles,t.equipment=r.equipment,i=Il(n,e,t).fetchFilteredExercises()):i=Il(n,e,t).fetchExercise(),i}function g4(n,e,t,r,i,s){return $0(r)&&(t.filter=r.filter),i=Il(n,e,t,s).fetchMuscles(),i}function Il(n,e,t,r){const i=q0(e,r);return t.pageCounter=n,t.limit=i,t}function jI(n){return n.then(e=>e).catch(e=>{throw console.error("Error in getData:",e),e})}function W0(n,e){const t=document.querySelector(".filters__list .active");if(t){const r=t.id.includes("-")?(t.id.charAt(0).toUpperCase()+t.id.slice(1)).replace("-","%20"):t.id.charAt(0).toUpperCase()+t.id.slice(1);if(r!=n.filter||n.filter===""){n.filter=r;for(const i in n)i!=="filter"&&(n[i]="");e.currentPage=1,e.endPoint=3}}}async function m4({currentPage:n,endPoint:e},t){let r;const i=q0(e,t),s=localStorage.getItem("favoriteData"),a=localStorage.getItem("isDataOld"),l=a?JSON.parse(a):[];if(console.log(l),l||l.length===1)try{const h=await Ws.get();console.log("current data: ",h),r=QI(h,i),localStorage.setItem("favoriteData",JSON.stringify(h)),s&&localStorage.setItem("isDataOld",JSON.stringify(!1));const f=YI(n,r);return console.log("current page: ",s,a),{totalPages:r.totalPages,currentData:f}}catch(h){console.log("Favorite data error: ",h)}else{const h=s?JSON.parse(s):[],f=QI(h,i),p=YI(n,f);return console.log("current data from array: ",p),{totalPages:f.totalPages,currentData:p}}}function QI(n,e){const t=n.length;if(t<=e)return{totalPages:1,slicedData:n};if(t>e){const r=Math.ceil(t/e);let i=[];for(let s=0;s<r;s++){const a=s*e,l=(s+1)*e;i.push(n.slice(a,l))}return{totalPages:r,slicedData:i}}}function YI(n,{totalPages:e,slicedData:t}){return e===1?t:t[n-1]}const vh=document.querySelector(".exercise-cards__wrapper"),Ih=document.querySelector(".exercise-cards__parag-empty"),_4="It appears that you haven't added any exercises to your favorites yet. To get started, you can add exercises that you like to your favorites for easier access in the future.",y4="Sorry, but we don`t have anything for you with such filter. Please try another search";function v4(){vh.classList.add("workout-cards__wrapper")}function JI(){vh.classList.remove("workout-cards__wrapper")}function I4(){vh.classList.add("favorite-cards__wrapper")}function XI(){vh.classList.remove("favorite-cards__wrapper")}function w4(){Ih.classList.add("visually-hidden")}function E4(){Ih.classList.remove("visually-hidden")}function T4(){Ih.innerHTML=_4}function A4(){Ih.innerHTML=y4}const up=document.querySelector(".js-pages");function gf(n,e){const t=[];if(e>1){for(let i=n-3;i<=n+3;i++)if(i>0&&i<=e){const s=i===n?"exercise-cards__wrapper-page exercise-cards__current-page":"exercise-cards__wrapper-page js-pages";t.push(`
                    <div class="${s}">
                        <a class="exercise-cards__page js-page" data-page="${i}" href="">
                            ${i}
                        </a>
                    </div>
                `)}up.innerHTML="";for(const i of t)up.insertAdjacentHTML("beforeend",i)}}function Vu(){up.innerHTML=""}function R4(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-cards")?void 0:e.closest(".js-card").dataset.cardName}function S4(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-page")?e.closest(".js-page").dataset.page:void 0}function b4(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-cards")?void 0:e.closest(".js-workout-card").dataset.id}const P4=async function(n){const{_id:e}=n;try{if(await Ws.idIsFavorite(e)){const r=await Ws.remove(e);return console.log(`Object with _id ${e} removed from favorites.`),!1}else{const r=await Ws.add(e,n);return console.log(`Object with _id ${e} added to favorites.`),r}}catch(t){return console.error(t),!1}},C4=n=>typeof n!="string"?n:n.split(" ").filter(e=>e).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),ZI=n=>typeof n!="string"?n:n.charAt(0).toUpperCase()+n.slice(1),D4=n=>typeof n!="string"?n:n.replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase(),k4=n=>{const e=getComputedStyle(document.documentElement).getPropertyValue("--rating-color-inactive"),t=getComputedStyle(document.documentElement).getPropertyValue("--rating-color-active");return`
<!-- DEFINE SVGs -->
<svg height="0" width="0">
  <defs>
    <!-- DEFINE ONE STAR -->
    <symbol viewBox="0 0 32 32" id="iconstar">
      <path
        d="M13.826 3.262c.684-2.106 3.663-2.106 4.348 0l1.932 5.945a2.285 2.285 0 0 0 2.174 1.579h6.251c2.214 0 3.135 2.833 1.344 4.135l-5.057 3.674a2.286 2.286 0 0 0-.83 2.556l1.931 5.945c.684 2.106-1.726 3.857-3.517 2.555l-5.057-3.674a2.286 2.286 0 0 0-2.687 0l-5.057 3.674c-1.791 1.302-4.202-.45-3.517-2.555l1.932-5.945a2.287 2.287 0 0 0-.83-2.556l-5.057-3.674c-1.791-1.302-.871-4.135 1.344-4.135h6.251c.99 0 1.868-.638 2.174-1.579l1.932-5.945z" />
    </symbol>
    <!-- DEFINE PATTERN FOR EMPTY STARS -->
    <pattern id="stars-empty" patternUnits="userSpaceOnUse" width="24" height="24">
      <use x="0" y="0" xlink:href="#iconstar" fill="${e}" height="24" width="24"/>
    </pattern>
    <!-- DEFINE PATTERN FOR FULL STARS -->
    <pattern id="stars-full" patternUnits="userSpaceOnUse" width="24" height="24">
      <use x="0" y="0" xlink:href="#iconstar" fill="${t}" height="24" width="24"/>
    </pattern>
  </defs>
</svg>

<!-- INSERT STARS -->
<svg height="24" viewBox="0 0 120 24" width="120">
  <rect fill="url(#stars-empty)" x="0" y="0" height="24" width="120"/>
  <rect fill="url(#stars-full)" x="0" y="0" height="24" width="${n}%"/>
</svg>
`},x4="/project-fitness-07/",yn={exercise:{},ratingText:"Rating",iconStar:`${x4}images/icons-sprite.svg#icon-star`,ratingMax:5,closeKeyBoardBtn:"Escape",beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null},am=document.querySelector("form.modal-form"),wl=document.querySelector(".rating-modal-window"),N4=document.querySelector(".rating-modal-window .x-button");document.querySelector(".modal-email-validate");const V4=()=>{const n=[];for(let e=0;e<yn.ratingMax;e++){let t=yn.ratingMax-e;n.push(`
        <input type="radio" class="visually-hidden" id="star${t}" name="rating" value="${t}">
        <label class="rating-star" for="star${t}">
            <svg class="rating-star-icon">
                <use href=${yn.iconStar} />
            </svg>
        </label>
        `)}return`
    <div class="rating-wrapper">
        <p class="rating-text">${yn.ratingText}</p>
        <div class="rating-stars">
            ${n.join("")}
            <p class="rating-count">0.0</p>
        </div>
    </div>
    `},G0=n=>{n.key===yn.closeKeyBoardBtn&&wh()},z0=n=>{cm.forEach(e=>{delete e.dataset.dataChecked}),n.target.dataset.dataChecked="checked",um.innerHTML=n.target.value},O4=()=>{um.innerHTML="0.0"};am.insertAdjacentHTML("afterbegin",V4());const cm=document.querySelectorAll(".rating-stars input"),um=document.querySelector(".rating-count"),wh=()=>{yn.afterClose&&yn.afterClose(yn.exercise),cm.forEach(n=>{n.removeEventListener("change",z0)}),wl.classList.remove("open"),document.body.style.overflow="visible",document.removeEventListener("keydown",G0),yn.afterClose&&yn.afterClose(),um.innerHTML="0.0",am.reset()},L4=()=>{wl.classList.add("open"),document.body.style.overflow="hidden",document.addEventListener("keydown",G0),cm.forEach(n=>{n.addEventListener("change",z0)})};N4.addEventListener("click",wh);am.addEventListener("reset",O4);wl.addEventListener("click",n=>{n.target===wl&&wh()});const lp={modalConfig:yn,openRatingModal:L4,closeRatingModal:wh},K0=document.querySelector(".backdrop");function H0(n){K0.classList.add("open"),n.classList.add("open")}function j0(n){K0.classList.remove("open"),n.classList.remove("open")}const Gs={name:document.querySelector(".js__auth-modal__name__message"),email:document.querySelector(".js__auth-modal__email__message"),password:document.querySelector(".js__auth-modal__password__message")},M4=document.querySelector(".backdrop"),lm=document.querySelector(".header__auth_btn"),hm=document.querySelector(".authModal__content"),Q0=document.querySelector(".authModal__content .x-button"),$e=document.querySelector(".authForm"),ew=document.querySelector(".action__text"),ha=document.querySelector(".action__button"),tw=document.querySelector(".authForm__fieldset.username"),nw=document.querySelector(".authForm__title"),rw=document.querySelectorAll(".header__nav-authorized"),iw=document.querySelectorAll(".header__nav__item.auth"),El=document.querySelectorAll(".header__logout_btn");let Hu=!0;const Pc=()=>{j0(hm),Q0.removeEventListener("click",Pc),lm.addEventListener("click",Eh),document.body.style.overflow="visible"},Eh=()=>{H0(hm),Q0.addEventListener("click",Pc),lm.removeEventListener("click",Eh),document.body.style.overflow="hidden"},hp=()=>{$e.reset()},F4=async n=>{if(n.preventDefault(),!$e.elements.name.value||$e.elements.name.value.length<3){Gs.name.classList.remove("hidden");return}if(!$e.elements.email.value||!Zk($e.elements.email.value)){Gs.email.classList.remove("hidden");return}if(!$e.elements.password.value||$e.elements.password.value.length<6){Gs.password.classList.remove("hidden");return}const e=[...$e.elements].reduce((t,r)=>(r.name&&(t[r.name]=r.value),t),{});Hu&&await c4(e),await u4(e),hp(),$e.elements.regSubmitBtn.disabled=!0,Pc()},U4=()=>{Hu?(ha.textContent="Registration",tw.classList.add("hidden"),ha.setAttribute("data-action","log_in"),nw.textContent="Log in",ew.textContent="Don't have an account?",hp(),Hu=!1):(ha.textContent="Log in",ha.setAttribute("data-action","reg"),tw.classList.remove("hidden"),nw.textContent="Registration",ew.textContent="Already have an account?",hp(),Hu=!0),$e.elements.name.toggleAttribute("required")},B4=async()=>{await zi.auth().onAuthStateChanged(n=>{n?(iw.forEach(e=>{e.classList.add("hidden")}),El.forEach(e=>{e.classList.add("visible")}),rw.forEach(e=>{e.classList.add("visible")})):(iw.forEach(e=>{e.classList.remove("hidden")}),El.forEach(e=>{e.classList.remove("visible")}),rw.forEach(e=>{e.classList.remove("visible")}))})},q4=async()=>{await l4(),El.forEach(n=>{n.classList.add("hidden")}),window.location.pathname="/project-fitness-07/"};lm.addEventListener("click",Eh);$e.addEventListener("submit",F4);ha.addEventListener("click",U4);El.forEach(n=>{n.addEventListener("click",q4)});document.addEventListener("keydown",n=>{n.key==="Escape"&&Pc()});M4.addEventListener("click",n=>{n.target===hm&&Pc()});B4();$e.elements.name.addEventListener("focus",$4);function $4(){Gs.name.classList.add("hidden")}$e.elements.email.addEventListener("focus",W4);function W4(){Gs.email.classList.add("hidden")}$e.elements.password.addEventListener("focus",G4);function G4(){Gs.password.classList.add("hidden")}$e.elements.name.addEventListener("input",dm);$e.elements.email.addEventListener("input",dm);$e.elements.password.addEventListener("input",dm);function dm(){$e.elements.name.value&&$e.elements.email.value&&$e.elements.password.value?$e.elements.regSubmitBtn.disabled=!1:$e.elements.regSubmitBtn.disabled=!0}const sw=document.querySelector(".backdrop"),es=document.querySelector(".modalExercise"),Y0=es.querySelector(".x-button"),ow=es.querySelector(".modalExercise__img-wrapper"),na=es.querySelector(".exercise-content"),As=es.querySelector(".button-box"),z4="/project-fitness-07/",K4=5;let H4,Th={};const j4=n=>{const{gifUrl:e,name:t,rating:r,_id:i,isFavorite:s,description:a}=n,l=Y4(n);Th=n,es.setAttribute("data-id",i),ow.innerHTML="",ow.insertAdjacentHTML("afterbegin",Z4(e,t)),na.innerHTML="",na.insertAdjacentHTML("beforeend",J4(t)),na.insertAdjacentHTML("beforeend",X4(r)),na.insertAdjacentHTML("beforeend",e$(l)),na.insertAdjacentHTML("beforeend",t$(a)),X0(s),lp.modalConfig.afterClose=Q4,document.querySelector(".js-give-rating").addEventListener("click",J0)},J0=n=>{Eo(),lp.modalConfig.exercise=Th,lp.openRatingModal()},Q4=()=>{document.querySelector(".js-give-rating").removeEventListener("click",J0),Z0(Th)},Y4=n=>({bodyPart:n.bodyPart,equipment:n.equipment,rating:n.rating,burnedCalories:n.burnedCalories,time:n.time,popular:n.popularity}),X0=(n=!1)=>{As.innerHTML="",n?As.insertAdjacentHTML("beforeend",r$()):As.insertAdjacentHTML("beforeend",n$()),As.insertAdjacentHTML("beforeend",i$());const e=As.querySelector(".js-toggle-favorite");As.querySelector(".js-give-rating"),e.addEventListener("click",eR)},J4=n=>`
    <h3 class="title">${C4(n)}</h3>
  `,X4=n=>{const e=[],t=Math.round(n*10)/10;e.push(`<li class="rating__item value">${t}</li>`);const r=Math.round(n/K4*100);return e.push(`<li ${k4(r)}</li>`),`<ul class="rating">${e.join("")}</ul>`},Z4=(n,e)=>`
    <img src="${n}" alt="${e}"/>
  `,e$=({burnedCalories:n,time:e,...t})=>{const r=[];for(const[i,s]of Object.entries(t)){const a=D4(i),l=ZI(a),h=ZI(s);r.push(`
      <li class="exercise_details-item">
        <p class="detail-name">${l}</p>
        <p class="detail-value">${h}</p>
      </li>
    `)}return r.push(`
      <li class="exercise_details-item">
        <p class="detail-name">Burned Calories</p>
        <p class="detail-value">${n}/${e} min</p>
      </li>
  `),`<ul class="exercise_details">${r.join("")}</ul>`},t$=n=>`
    <p class="exercise_description">${n}</p>
  `,n$=()=>fm({text:"Add to favorites",iconId:"icon-heart",className:"js-toggle-favorite"}),r$=()=>fm({text:"Remove from favorites",iconId:"icon-trash",className:"js-toggle-favorite"}),i$=()=>fm({text:"Give a rating",className:"js-give-rating ghost"}),fm=({text:n,iconId:e,className:t=""})=>{let r;return e&&(r=`
      <svg class="btn-icon">
        <use href=${z4}images/icons-sprite.svg#${e} />
      </svg>
    `),`
    <button id="js-toggle-favorite" type="button" class="button ${t}">
      <span>${n}</span>
      ${e?r:""}
    </button>
  `},Eo=()=>{j0(es),Y0.removeEventListener("click",Eo),document.body.style.overflow="visible";const n="js-toggle-favorite";try{document.getElementById(n).removeEventListener("click",H4)}catch{console.error(`${n} not found!`)}},Z0=async n=>{const{_id:e}=n;n.isFavorite=await Ws.idIsFavorite(e),j4(n),H0(es),Y0.addEventListener("click",Eo),document.body.style.overflow="hidden"},eR=async n=>{if(!zi.auth().currentUser){Eo(),Eh();return}const{target:t}=n;try{const r=await P4(Th);t.removeEventListener("click",eR),X0(r)}catch(r){console.error(r)}};document.addEventListener("keydown",n=>{n.key==="Escape"&&Eo()});sw.addEventListener("click",n=>{n.target===sw&&Eo()});const Ou=document.querySelector(".exercise-cards__wrapper");function s$(n,e){e>=375&&e<768&&n!=3?Ou.style.height="1268px":e>1440&&n===1?Ou.style.height="487px":e>768&&n!=3?Ou.style.height="833px":Ou.style.height=""}var ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},tc={},o$={get exports(){return tc},set exports(n){tc=n}};(function(n,e){(function(){var t,r="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",l="Invalid `variable` option passed into `_.template`",h="__lodash_hash_undefined__",f=500,p="__lodash_placeholder__",m=1,I=2,A=4,L=1,M=2,V=1,Y=2,ae=4,j=8,ye=16,de=32,me=64,we=128,Vt=256,Hn=512,ts=30,sR="...",oR=800,aR=16,pm=1,cR=2,uR=3,oi=1/0,yr=9007199254740991,lR=17976931348623157e292,Cc=0/0,Tn=4294967295,hR=Tn-1,dR=Tn>>>1,fR=[["ary",we],["bind",V],["bindKey",Y],["curry",j],["curryRight",ye],["flip",Hn],["partial",de],["partialRight",me],["rearg",Vt]],ns="[object Arguments]",Dc="[object Array]",pR="[object AsyncFunction]",To="[object Boolean]",Ao="[object Date]",gR="[object DOMException]",kc="[object Error]",xc="[object Function]",gm="[object GeneratorFunction]",dn="[object Map]",Ro="[object Number]",mR="[object Null]",jn="[object Object]",mm="[object Promise]",_R="[object Proxy]",So="[object RegExp]",fn="[object Set]",bo="[object String]",Nc="[object Symbol]",yR="[object Undefined]",Po="[object WeakMap]",vR="[object WeakSet]",Co="[object ArrayBuffer]",rs="[object DataView]",Ah="[object Float32Array]",Rh="[object Float64Array]",Sh="[object Int8Array]",bh="[object Int16Array]",Ph="[object Int32Array]",Ch="[object Uint8Array]",Dh="[object Uint8ClampedArray]",kh="[object Uint16Array]",xh="[object Uint32Array]",IR=/\b__p \+= '';/g,wR=/\b(__p \+=) '' \+/g,ER=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_m=/&(?:amp|lt|gt|quot|#39);/g,ym=/[&<>"']/g,TR=RegExp(_m.source),AR=RegExp(ym.source),RR=/<%-([\s\S]+?)%>/g,SR=/<%([\s\S]+?)%>/g,vm=/<%=([\s\S]+?)%>/g,bR=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,PR=/^\w*$/,CR=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Nh=/[\\^$.*+?()[\]{}|]/g,DR=RegExp(Nh.source),Vh=/^\s+/,kR=/\s/,xR=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,NR=/\{\n\/\* \[wrapped with (.+)\] \*/,VR=/,? & /,OR=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,LR=/[()=,{}\[\]\/\s]/,MR=/\\(\\)?/g,FR=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Im=/\w*$/,UR=/^[-+]0x[0-9a-f]+$/i,BR=/^0b[01]+$/i,qR=/^\[object .+?Constructor\]$/,$R=/^0o[0-7]+$/i,WR=/^(?:0|[1-9]\d*)$/,GR=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vc=/($^)/,zR=/['\n\r\u2028\u2029\\]/g,Oc="\\ud800-\\udfff",KR="\\u0300-\\u036f",HR="\\ufe20-\\ufe2f",jR="\\u20d0-\\u20ff",wm=KR+HR+jR,Em="\\u2700-\\u27bf",Tm="a-z\\xdf-\\xf6\\xf8-\\xff",QR="\\xac\\xb1\\xd7\\xf7",YR="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",JR="\\u2000-\\u206f",XR=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Am="A-Z\\xc0-\\xd6\\xd8-\\xde",Rm="\\ufe0e\\ufe0f",Sm=QR+YR+JR+XR,Oh="['’]",ZR="["+Oc+"]",bm="["+Sm+"]",Lc="["+wm+"]",Pm="\\d+",eS="["+Em+"]",Cm="["+Tm+"]",Dm="[^"+Oc+Sm+Pm+Em+Tm+Am+"]",Lh="\\ud83c[\\udffb-\\udfff]",tS="(?:"+Lc+"|"+Lh+")",km="[^"+Oc+"]",Mh="(?:\\ud83c[\\udde6-\\uddff]){2}",Fh="[\\ud800-\\udbff][\\udc00-\\udfff]",is="["+Am+"]",xm="\\u200d",Nm="(?:"+Cm+"|"+Dm+")",nS="(?:"+is+"|"+Dm+")",Vm="(?:"+Oh+"(?:d|ll|m|re|s|t|ve))?",Om="(?:"+Oh+"(?:D|LL|M|RE|S|T|VE))?",Lm=tS+"?",Mm="["+Rm+"]?",rS="(?:"+xm+"(?:"+[km,Mh,Fh].join("|")+")"+Mm+Lm+")*",iS="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",sS="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Fm=Mm+Lm+rS,oS="(?:"+[eS,Mh,Fh].join("|")+")"+Fm,aS="(?:"+[km+Lc+"?",Lc,Mh,Fh,ZR].join("|")+")",cS=RegExp(Oh,"g"),uS=RegExp(Lc,"g"),Uh=RegExp(Lh+"(?="+Lh+")|"+aS+Fm,"g"),lS=RegExp([is+"?"+Cm+"+"+Vm+"(?="+[bm,is,"$"].join("|")+")",nS+"+"+Om+"(?="+[bm,is+Nm,"$"].join("|")+")",is+"?"+Nm+"+"+Vm,is+"+"+Om,sS,iS,Pm,oS].join("|"),"g"),hS=RegExp("["+xm+Oc+wm+Rm+"]"),dS=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,fS=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],pS=-1,Ce={};Ce[Ah]=Ce[Rh]=Ce[Sh]=Ce[bh]=Ce[Ph]=Ce[Ch]=Ce[Dh]=Ce[kh]=Ce[xh]=!0,Ce[ns]=Ce[Dc]=Ce[Co]=Ce[To]=Ce[rs]=Ce[Ao]=Ce[kc]=Ce[xc]=Ce[dn]=Ce[Ro]=Ce[jn]=Ce[So]=Ce[fn]=Ce[bo]=Ce[Po]=!1;var be={};be[ns]=be[Dc]=be[Co]=be[rs]=be[To]=be[Ao]=be[Ah]=be[Rh]=be[Sh]=be[bh]=be[Ph]=be[dn]=be[Ro]=be[jn]=be[So]=be[fn]=be[bo]=be[Nc]=be[Ch]=be[Dh]=be[kh]=be[xh]=!0,be[kc]=be[xc]=be[Po]=!1;var gS={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},mS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_S={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},yS={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},vS=parseFloat,IS=parseInt,Um=typeof ra=="object"&&ra&&ra.Object===Object&&ra,wS=typeof self=="object"&&self&&self.Object===Object&&self,ht=Um||wS||Function("return this")(),Bh=e&&!e.nodeType&&e,ai=Bh&&!0&&n&&!n.nodeType&&n,Bm=ai&&ai.exports===Bh,qh=Bm&&Um.process,en=function(){try{var E=ai&&ai.require&&ai.require("util").types;return E||qh&&qh.binding&&qh.binding("util")}catch{}}(),qm=en&&en.isArrayBuffer,$m=en&&en.isDate,Wm=en&&en.isMap,Gm=en&&en.isRegExp,zm=en&&en.isSet,Km=en&&en.isTypedArray;function Gt(E,P,S){switch(S.length){case 0:return E.call(P);case 1:return E.call(P,S[0]);case 2:return E.call(P,S[0],S[1]);case 3:return E.call(P,S[0],S[1],S[2])}return E.apply(P,S)}function ES(E,P,S,W){for(var ee=-1,ve=E==null?0:E.length;++ee<ve;){var et=E[ee];P(W,et,S(et),E)}return W}function tn(E,P){for(var S=-1,W=E==null?0:E.length;++S<W&&P(E[S],S,E)!==!1;);return E}function TS(E,P){for(var S=E==null?0:E.length;S--&&P(E[S],S,E)!==!1;);return E}function Hm(E,P){for(var S=-1,W=E==null?0:E.length;++S<W;)if(!P(E[S],S,E))return!1;return!0}function vr(E,P){for(var S=-1,W=E==null?0:E.length,ee=0,ve=[];++S<W;){var et=E[S];P(et,S,E)&&(ve[ee++]=et)}return ve}function Mc(E,P){var S=E==null?0:E.length;return!!S&&ss(E,P,0)>-1}function $h(E,P,S){for(var W=-1,ee=E==null?0:E.length;++W<ee;)if(S(P,E[W]))return!0;return!1}function Ne(E,P){for(var S=-1,W=E==null?0:E.length,ee=Array(W);++S<W;)ee[S]=P(E[S],S,E);return ee}function Ir(E,P){for(var S=-1,W=P.length,ee=E.length;++S<W;)E[ee+S]=P[S];return E}function Wh(E,P,S,W){var ee=-1,ve=E==null?0:E.length;for(W&&ve&&(S=E[++ee]);++ee<ve;)S=P(S,E[ee],ee,E);return S}function AS(E,P,S,W){var ee=E==null?0:E.length;for(W&&ee&&(S=E[--ee]);ee--;)S=P(S,E[ee],ee,E);return S}function Gh(E,P){for(var S=-1,W=E==null?0:E.length;++S<W;)if(P(E[S],S,E))return!0;return!1}var RS=zh("length");function SS(E){return E.split("")}function bS(E){return E.match(OR)||[]}function jm(E,P,S){var W;return S(E,function(ee,ve,et){if(P(ee,ve,et))return W=ve,!1}),W}function Fc(E,P,S,W){for(var ee=E.length,ve=S+(W?1:-1);W?ve--:++ve<ee;)if(P(E[ve],ve,E))return ve;return-1}function ss(E,P,S){return P===P?US(E,P,S):Fc(E,Qm,S)}function PS(E,P,S,W){for(var ee=S-1,ve=E.length;++ee<ve;)if(W(E[ee],P))return ee;return-1}function Qm(E){return E!==E}function Ym(E,P){var S=E==null?0:E.length;return S?Hh(E,P)/S:Cc}function zh(E){return function(P){return P==null?t:P[E]}}function Kh(E){return function(P){return E==null?t:E[P]}}function Jm(E,P,S,W,ee){return ee(E,function(ve,et,Se){S=W?(W=!1,ve):P(S,ve,et,Se)}),S}function CS(E,P){var S=E.length;for(E.sort(P);S--;)E[S]=E[S].value;return E}function Hh(E,P){for(var S,W=-1,ee=E.length;++W<ee;){var ve=P(E[W]);ve!==t&&(S=S===t?ve:S+ve)}return S}function jh(E,P){for(var S=-1,W=Array(E);++S<E;)W[S]=P(S);return W}function DS(E,P){return Ne(P,function(S){return[S,E[S]]})}function Xm(E){return E&&E.slice(0,n_(E)+1).replace(Vh,"")}function zt(E){return function(P){return E(P)}}function Qh(E,P){return Ne(P,function(S){return E[S]})}function Do(E,P){return E.has(P)}function Zm(E,P){for(var S=-1,W=E.length;++S<W&&ss(P,E[S],0)>-1;);return S}function e_(E,P){for(var S=E.length;S--&&ss(P,E[S],0)>-1;);return S}function kS(E,P){for(var S=E.length,W=0;S--;)E[S]===P&&++W;return W}var xS=Kh(gS),NS=Kh(mS);function VS(E){return"\\"+yS[E]}function OS(E,P){return E==null?t:E[P]}function os(E){return hS.test(E)}function LS(E){return dS.test(E)}function MS(E){for(var P,S=[];!(P=E.next()).done;)S.push(P.value);return S}function Yh(E){var P=-1,S=Array(E.size);return E.forEach(function(W,ee){S[++P]=[ee,W]}),S}function t_(E,P){return function(S){return E(P(S))}}function wr(E,P){for(var S=-1,W=E.length,ee=0,ve=[];++S<W;){var et=E[S];(et===P||et===p)&&(E[S]=p,ve[ee++]=S)}return ve}function Uc(E){var P=-1,S=Array(E.size);return E.forEach(function(W){S[++P]=W}),S}function FS(E){var P=-1,S=Array(E.size);return E.forEach(function(W){S[++P]=[W,W]}),S}function US(E,P,S){for(var W=S-1,ee=E.length;++W<ee;)if(E[W]===P)return W;return-1}function BS(E,P,S){for(var W=S+1;W--;)if(E[W]===P)return W;return W}function as(E){return os(E)?$S(E):RS(E)}function pn(E){return os(E)?WS(E):SS(E)}function n_(E){for(var P=E.length;P--&&kR.test(E.charAt(P)););return P}var qS=Kh(_S);function $S(E){for(var P=Uh.lastIndex=0;Uh.test(E);)++P;return P}function WS(E){return E.match(Uh)||[]}function GS(E){return E.match(lS)||[]}var zS=function E(P){P=P==null?ht:cs.defaults(ht.Object(),P,cs.pick(ht,fS));var S=P.Array,W=P.Date,ee=P.Error,ve=P.Function,et=P.Math,Se=P.Object,Jh=P.RegExp,KS=P.String,nn=P.TypeError,Bc=S.prototype,HS=ve.prototype,us=Se.prototype,qc=P["__core-js_shared__"],$c=HS.toString,Ee=us.hasOwnProperty,jS=0,r_=function(){var o=/[^.]+$/.exec(qc&&qc.keys&&qc.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Wc=us.toString,QS=$c.call(Se),YS=ht._,JS=Jh("^"+$c.call(Ee).replace(Nh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gc=Bm?P.Buffer:t,Er=P.Symbol,zc=P.Uint8Array,i_=Gc?Gc.allocUnsafe:t,Kc=t_(Se.getPrototypeOf,Se),s_=Se.create,o_=us.propertyIsEnumerable,Hc=Bc.splice,a_=Er?Er.isConcatSpreadable:t,ko=Er?Er.iterator:t,ci=Er?Er.toStringTag:t,jc=function(){try{var o=fi(Se,"defineProperty");return o({},"",{}),o}catch{}}(),XS=P.clearTimeout!==ht.clearTimeout&&P.clearTimeout,ZS=W&&W.now!==ht.Date.now&&W.now,eb=P.setTimeout!==ht.setTimeout&&P.setTimeout,Qc=et.ceil,Yc=et.floor,Xh=Se.getOwnPropertySymbols,tb=Gc?Gc.isBuffer:t,c_=P.isFinite,nb=Bc.join,rb=t_(Se.keys,Se),tt=et.max,vt=et.min,ib=W.now,sb=P.parseInt,u_=et.random,ob=Bc.reverse,Zh=fi(P,"DataView"),xo=fi(P,"Map"),ed=fi(P,"Promise"),ls=fi(P,"Set"),No=fi(P,"WeakMap"),Vo=fi(Se,"create"),Jc=No&&new No,hs={},ab=pi(Zh),cb=pi(xo),ub=pi(ed),lb=pi(ls),hb=pi(No),Xc=Er?Er.prototype:t,Oo=Xc?Xc.valueOf:t,l_=Xc?Xc.toString:t;function _(o){if(Be(o)&&!te(o)&&!(o instanceof le)){if(o instanceof rn)return o;if(Ee.call(o,"__wrapped__"))return hy(o)}return new rn(o)}var ds=function(){function o(){}return function(c){if(!Fe(c))return{};if(s_)return s_(c);o.prototype=c;var u=new o;return o.prototype=t,u}}();function Zc(){}function rn(o,c){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!c,this.__index__=0,this.__values__=t}_.templateSettings={escape:RR,evaluate:SR,interpolate:vm,variable:"",imports:{_}},_.prototype=Zc.prototype,_.prototype.constructor=_,rn.prototype=ds(Zc.prototype),rn.prototype.constructor=rn;function le(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Tn,this.__views__=[]}function db(){var o=new le(this.__wrapped__);return o.__actions__=Ot(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=Ot(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=Ot(this.__views__),o}function fb(){if(this.__filtered__){var o=new le(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function pb(){var o=this.__wrapped__.value(),c=this.__dir__,u=te(o),d=c<0,g=u?o.length:0,y=SP(0,g,this.__views__),v=y.start,w=y.end,T=w-v,C=d?w:v-1,D=this.__iteratees__,x=D.length,U=0,G=vt(T,this.__takeCount__);if(!u||!d&&g==T&&G==T)return V_(o,this.__actions__);var J=[];e:for(;T--&&U<G;){C+=c;for(var se=-1,X=o[C];++se<x;){var ce=D[se],fe=ce.iteratee,jt=ce.type,bt=fe(X);if(jt==cR)X=bt;else if(!bt){if(jt==pm)continue e;break e}}J[U++]=X}return J}le.prototype=ds(Zc.prototype),le.prototype.constructor=le;function ui(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var d=o[c];this.set(d[0],d[1])}}function gb(){this.__data__=Vo?Vo(null):{},this.size=0}function mb(o){var c=this.has(o)&&delete this.__data__[o];return this.size-=c?1:0,c}function _b(o){var c=this.__data__;if(Vo){var u=c[o];return u===h?t:u}return Ee.call(c,o)?c[o]:t}function yb(o){var c=this.__data__;return Vo?c[o]!==t:Ee.call(c,o)}function vb(o,c){var u=this.__data__;return this.size+=this.has(o)?0:1,u[o]=Vo&&c===t?h:c,this}ui.prototype.clear=gb,ui.prototype.delete=mb,ui.prototype.get=_b,ui.prototype.has=yb,ui.prototype.set=vb;function Qn(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var d=o[c];this.set(d[0],d[1])}}function Ib(){this.__data__=[],this.size=0}function wb(o){var c=this.__data__,u=eu(c,o);if(u<0)return!1;var d=c.length-1;return u==d?c.pop():Hc.call(c,u,1),--this.size,!0}function Eb(o){var c=this.__data__,u=eu(c,o);return u<0?t:c[u][1]}function Tb(o){return eu(this.__data__,o)>-1}function Ab(o,c){var u=this.__data__,d=eu(u,o);return d<0?(++this.size,u.push([o,c])):u[d][1]=c,this}Qn.prototype.clear=Ib,Qn.prototype.delete=wb,Qn.prototype.get=Eb,Qn.prototype.has=Tb,Qn.prototype.set=Ab;function Yn(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var d=o[c];this.set(d[0],d[1])}}function Rb(){this.size=0,this.__data__={hash:new ui,map:new(xo||Qn),string:new ui}}function Sb(o){var c=du(this,o).delete(o);return this.size-=c?1:0,c}function bb(o){return du(this,o).get(o)}function Pb(o){return du(this,o).has(o)}function Cb(o,c){var u=du(this,o),d=u.size;return u.set(o,c),this.size+=u.size==d?0:1,this}Yn.prototype.clear=Rb,Yn.prototype.delete=Sb,Yn.prototype.get=bb,Yn.prototype.has=Pb,Yn.prototype.set=Cb;function li(o){var c=-1,u=o==null?0:o.length;for(this.__data__=new Yn;++c<u;)this.add(o[c])}function Db(o){return this.__data__.set(o,h),this}function kb(o){return this.__data__.has(o)}li.prototype.add=li.prototype.push=Db,li.prototype.has=kb;function gn(o){var c=this.__data__=new Qn(o);this.size=c.size}function xb(){this.__data__=new Qn,this.size=0}function Nb(o){var c=this.__data__,u=c.delete(o);return this.size=c.size,u}function Vb(o){return this.__data__.get(o)}function Ob(o){return this.__data__.has(o)}function Lb(o,c){var u=this.__data__;if(u instanceof Qn){var d=u.__data__;if(!xo||d.length<i-1)return d.push([o,c]),this.size=++u.size,this;u=this.__data__=new Yn(d)}return u.set(o,c),this.size=u.size,this}gn.prototype.clear=xb,gn.prototype.delete=Nb,gn.prototype.get=Vb,gn.prototype.has=Ob,gn.prototype.set=Lb;function h_(o,c){var u=te(o),d=!u&&gi(o),g=!u&&!d&&br(o),y=!u&&!d&&!g&&ms(o),v=u||d||g||y,w=v?jh(o.length,KS):[],T=w.length;for(var C in o)(c||Ee.call(o,C))&&!(v&&(C=="length"||g&&(C=="offset"||C=="parent")||y&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||er(C,T)))&&w.push(C);return w}function d_(o){var c=o.length;return c?o[hd(0,c-1)]:t}function Mb(o,c){return fu(Ot(o),hi(c,0,o.length))}function Fb(o){return fu(Ot(o))}function td(o,c,u){(u!==t&&!mn(o[c],u)||u===t&&!(c in o))&&Jn(o,c,u)}function Lo(o,c,u){var d=o[c];(!(Ee.call(o,c)&&mn(d,u))||u===t&&!(c in o))&&Jn(o,c,u)}function eu(o,c){for(var u=o.length;u--;)if(mn(o[u][0],c))return u;return-1}function Ub(o,c,u,d){return Tr(o,function(g,y,v){c(d,g,u(g),v)}),d}function f_(o,c){return o&&Rn(c,rt(c),o)}function Bb(o,c){return o&&Rn(c,Mt(c),o)}function Jn(o,c,u){c=="__proto__"&&jc?jc(o,c,{configurable:!0,enumerable:!0,value:u,writable:!0}):o[c]=u}function nd(o,c){for(var u=-1,d=c.length,g=S(d),y=o==null;++u<d;)g[u]=y?t:Ld(o,c[u]);return g}function hi(o,c,u){return o===o&&(u!==t&&(o=o<=u?o:u),c!==t&&(o=o>=c?o:c)),o}function sn(o,c,u,d,g,y){var v,w=c&m,T=c&I,C=c&A;if(u&&(v=g?u(o,d,g,y):u(o)),v!==t)return v;if(!Fe(o))return o;var D=te(o);if(D){if(v=PP(o),!w)return Ot(o,v)}else{var x=It(o),U=x==xc||x==gm;if(br(o))return M_(o,w);if(x==jn||x==ns||U&&!g){if(v=T||U?{}:ny(o),!w)return T?_P(o,Bb(v,o)):mP(o,f_(v,o))}else{if(!be[x])return g?o:{};v=CP(o,x,w)}}y||(y=new gn);var G=y.get(o);if(G)return G;y.set(o,v),ky(o)?o.forEach(function(X){v.add(sn(X,c,u,X,o,y))}):Cy(o)&&o.forEach(function(X,ce){v.set(ce,sn(X,c,u,ce,o,y))});var J=C?T?Ed:wd:T?Mt:rt,se=D?t:J(o);return tn(se||o,function(X,ce){se&&(ce=X,X=o[ce]),Lo(v,ce,sn(X,c,u,ce,o,y))}),v}function qb(o){var c=rt(o);return function(u){return p_(u,o,c)}}function p_(o,c,u){var d=u.length;if(o==null)return!d;for(o=Se(o);d--;){var g=u[d],y=c[g],v=o[g];if(v===t&&!(g in o)||!y(v))return!1}return!0}function g_(o,c,u){if(typeof o!="function")throw new nn(a);return Wo(function(){o.apply(t,u)},c)}function Mo(o,c,u,d){var g=-1,y=Mc,v=!0,w=o.length,T=[],C=c.length;if(!w)return T;u&&(c=Ne(c,zt(u))),d?(y=$h,v=!1):c.length>=i&&(y=Do,v=!1,c=new li(c));e:for(;++g<w;){var D=o[g],x=u==null?D:u(D);if(D=d||D!==0?D:0,v&&x===x){for(var U=C;U--;)if(c[U]===x)continue e;T.push(D)}else y(c,x,d)||T.push(D)}return T}var Tr=$_(An),m_=$_(id,!0);function $b(o,c){var u=!0;return Tr(o,function(d,g,y){return u=!!c(d,g,y),u}),u}function tu(o,c,u){for(var d=-1,g=o.length;++d<g;){var y=o[d],v=c(y);if(v!=null&&(w===t?v===v&&!Ht(v):u(v,w)))var w=v,T=y}return T}function Wb(o,c,u,d){var g=o.length;for(u=ie(u),u<0&&(u=-u>g?0:g+u),d=d===t||d>g?g:ie(d),d<0&&(d+=g),d=u>d?0:Ny(d);u<d;)o[u++]=c;return o}function __(o,c){var u=[];return Tr(o,function(d,g,y){c(d,g,y)&&u.push(d)}),u}function dt(o,c,u,d,g){var y=-1,v=o.length;for(u||(u=kP),g||(g=[]);++y<v;){var w=o[y];c>0&&u(w)?c>1?dt(w,c-1,u,d,g):Ir(g,w):d||(g[g.length]=w)}return g}var rd=W_(),y_=W_(!0);function An(o,c){return o&&rd(o,c,rt)}function id(o,c){return o&&y_(o,c,rt)}function nu(o,c){return vr(c,function(u){return tr(o[u])})}function di(o,c){c=Rr(c,o);for(var u=0,d=c.length;o!=null&&u<d;)o=o[Sn(c[u++])];return u&&u==d?o:t}function v_(o,c,u){var d=c(o);return te(o)?d:Ir(d,u(o))}function Rt(o){return o==null?o===t?yR:mR:ci&&ci in Se(o)?RP(o):FP(o)}function sd(o,c){return o>c}function Gb(o,c){return o!=null&&Ee.call(o,c)}function zb(o,c){return o!=null&&c in Se(o)}function Kb(o,c,u){return o>=vt(c,u)&&o<tt(c,u)}function od(o,c,u){for(var d=u?$h:Mc,g=o[0].length,y=o.length,v=y,w=S(y),T=1/0,C=[];v--;){var D=o[v];v&&c&&(D=Ne(D,zt(c))),T=vt(D.length,T),w[v]=!u&&(c||g>=120&&D.length>=120)?new li(v&&D):t}D=o[0];var x=-1,U=w[0];e:for(;++x<g&&C.length<T;){var G=D[x],J=c?c(G):G;if(G=u||G!==0?G:0,!(U?Do(U,J):d(C,J,u))){for(v=y;--v;){var se=w[v];if(!(se?Do(se,J):d(o[v],J,u)))continue e}U&&U.push(J),C.push(G)}}return C}function Hb(o,c,u,d){return An(o,function(g,y,v){c(d,u(g),y,v)}),d}function Fo(o,c,u){c=Rr(c,o),o=oy(o,c);var d=o==null?o:o[Sn(an(c))];return d==null?t:Gt(d,o,u)}function I_(o){return Be(o)&&Rt(o)==ns}function jb(o){return Be(o)&&Rt(o)==Co}function Qb(o){return Be(o)&&Rt(o)==Ao}function Uo(o,c,u,d,g){return o===c?!0:o==null||c==null||!Be(o)&&!Be(c)?o!==o&&c!==c:Yb(o,c,u,d,Uo,g)}function Yb(o,c,u,d,g,y){var v=te(o),w=te(c),T=v?Dc:It(o),C=w?Dc:It(c);T=T==ns?jn:T,C=C==ns?jn:C;var D=T==jn,x=C==jn,U=T==C;if(U&&br(o)){if(!br(c))return!1;v=!0,D=!1}if(U&&!D)return y||(y=new gn),v||ms(o)?Z_(o,c,u,d,g,y):TP(o,c,T,u,d,g,y);if(!(u&L)){var G=D&&Ee.call(o,"__wrapped__"),J=x&&Ee.call(c,"__wrapped__");if(G||J){var se=G?o.value():o,X=J?c.value():c;return y||(y=new gn),g(se,X,u,d,y)}}return U?(y||(y=new gn),AP(o,c,u,d,g,y)):!1}function Jb(o){return Be(o)&&It(o)==dn}function ad(o,c,u,d){var g=u.length,y=g,v=!d;if(o==null)return!y;for(o=Se(o);g--;){var w=u[g];if(v&&w[2]?w[1]!==o[w[0]]:!(w[0]in o))return!1}for(;++g<y;){w=u[g];var T=w[0],C=o[T],D=w[1];if(v&&w[2]){if(C===t&&!(T in o))return!1}else{var x=new gn;if(d)var U=d(C,D,T,o,c,x);if(!(U===t?Uo(D,C,L|M,d,x):U))return!1}}return!0}function w_(o){if(!Fe(o)||NP(o))return!1;var c=tr(o)?JS:qR;return c.test(pi(o))}function Xb(o){return Be(o)&&Rt(o)==So}function Zb(o){return Be(o)&&It(o)==fn}function eP(o){return Be(o)&&vu(o.length)&&!!Ce[Rt(o)]}function E_(o){return typeof o=="function"?o:o==null?Ft:typeof o=="object"?te(o)?R_(o[0],o[1]):A_(o):Gy(o)}function cd(o){if(!$o(o))return rb(o);var c=[];for(var u in Se(o))Ee.call(o,u)&&u!="constructor"&&c.push(u);return c}function tP(o){if(!Fe(o))return MP(o);var c=$o(o),u=[];for(var d in o)d=="constructor"&&(c||!Ee.call(o,d))||u.push(d);return u}function ud(o,c){return o<c}function T_(o,c){var u=-1,d=Lt(o)?S(o.length):[];return Tr(o,function(g,y,v){d[++u]=c(g,y,v)}),d}function A_(o){var c=Ad(o);return c.length==1&&c[0][2]?iy(c[0][0],c[0][1]):function(u){return u===o||ad(u,o,c)}}function R_(o,c){return Sd(o)&&ry(c)?iy(Sn(o),c):function(u){var d=Ld(u,o);return d===t&&d===c?Md(u,o):Uo(c,d,L|M)}}function ru(o,c,u,d,g){o!==c&&rd(c,function(y,v){if(g||(g=new gn),Fe(y))nP(o,c,v,u,ru,d,g);else{var w=d?d(Pd(o,v),y,v+"",o,c,g):t;w===t&&(w=y),td(o,v,w)}},Mt)}function nP(o,c,u,d,g,y,v){var w=Pd(o,u),T=Pd(c,u),C=v.get(T);if(C){td(o,u,C);return}var D=y?y(w,T,u+"",o,c,v):t,x=D===t;if(x){var U=te(T),G=!U&&br(T),J=!U&&!G&&ms(T);D=T,U||G||J?te(w)?D=w:je(w)?D=Ot(w):G?(x=!1,D=M_(T,!0)):J?(x=!1,D=F_(T,!0)):D=[]:Go(T)||gi(T)?(D=w,gi(w)?D=Vy(w):(!Fe(w)||tr(w))&&(D=ny(T))):x=!1}x&&(v.set(T,D),g(D,T,d,y,v),v.delete(T)),td(o,u,D)}function S_(o,c){var u=o.length;if(u)return c+=c<0?u:0,er(c,u)?o[c]:t}function b_(o,c,u){c.length?c=Ne(c,function(y){return te(y)?function(v){return di(v,y.length===1?y[0]:y)}:y}):c=[Ft];var d=-1;c=Ne(c,zt(Q()));var g=T_(o,function(y,v,w){var T=Ne(c,function(C){return C(y)});return{criteria:T,index:++d,value:y}});return CS(g,function(y,v){return gP(y,v,u)})}function rP(o,c){return P_(o,c,function(u,d){return Md(o,d)})}function P_(o,c,u){for(var d=-1,g=c.length,y={};++d<g;){var v=c[d],w=di(o,v);u(w,v)&&Bo(y,Rr(v,o),w)}return y}function iP(o){return function(c){return di(c,o)}}function ld(o,c,u,d){var g=d?PS:ss,y=-1,v=c.length,w=o;for(o===c&&(c=Ot(c)),u&&(w=Ne(o,zt(u)));++y<v;)for(var T=0,C=c[y],D=u?u(C):C;(T=g(w,D,T,d))>-1;)w!==o&&Hc.call(w,T,1),Hc.call(o,T,1);return o}function C_(o,c){for(var u=o?c.length:0,d=u-1;u--;){var g=c[u];if(u==d||g!==y){var y=g;er(g)?Hc.call(o,g,1):pd(o,g)}}return o}function hd(o,c){return o+Yc(u_()*(c-o+1))}function sP(o,c,u,d){for(var g=-1,y=tt(Qc((c-o)/(u||1)),0),v=S(y);y--;)v[d?y:++g]=o,o+=u;return v}function dd(o,c){var u="";if(!o||c<1||c>yr)return u;do c%2&&(u+=o),c=Yc(c/2),c&&(o+=o);while(c);return u}function oe(o,c){return Cd(sy(o,c,Ft),o+"")}function oP(o){return d_(_s(o))}function aP(o,c){var u=_s(o);return fu(u,hi(c,0,u.length))}function Bo(o,c,u,d){if(!Fe(o))return o;c=Rr(c,o);for(var g=-1,y=c.length,v=y-1,w=o;w!=null&&++g<y;){var T=Sn(c[g]),C=u;if(T==="__proto__"||T==="constructor"||T==="prototype")return o;if(g!=v){var D=w[T];C=d?d(D,T,w):t,C===t&&(C=Fe(D)?D:er(c[g+1])?[]:{})}Lo(w,T,C),w=w[T]}return o}var D_=Jc?function(o,c){return Jc.set(o,c),o}:Ft,cP=jc?function(o,c){return jc(o,"toString",{configurable:!0,enumerable:!1,value:Ud(c),writable:!0})}:Ft;function uP(o){return fu(_s(o))}function on(o,c,u){var d=-1,g=o.length;c<0&&(c=-c>g?0:g+c),u=u>g?g:u,u<0&&(u+=g),g=c>u?0:u-c>>>0,c>>>=0;for(var y=S(g);++d<g;)y[d]=o[d+c];return y}function lP(o,c){var u;return Tr(o,function(d,g,y){return u=c(d,g,y),!u}),!!u}function iu(o,c,u){var d=0,g=o==null?d:o.length;if(typeof c=="number"&&c===c&&g<=dR){for(;d<g;){var y=d+g>>>1,v=o[y];v!==null&&!Ht(v)&&(u?v<=c:v<c)?d=y+1:g=y}return g}return fd(o,c,Ft,u)}function fd(o,c,u,d){var g=0,y=o==null?0:o.length;if(y===0)return 0;c=u(c);for(var v=c!==c,w=c===null,T=Ht(c),C=c===t;g<y;){var D=Yc((g+y)/2),x=u(o[D]),U=x!==t,G=x===null,J=x===x,se=Ht(x);if(v)var X=d||J;else C?X=J&&(d||U):w?X=J&&U&&(d||!G):T?X=J&&U&&!G&&(d||!se):G||se?X=!1:X=d?x<=c:x<c;X?g=D+1:y=D}return vt(y,hR)}function k_(o,c){for(var u=-1,d=o.length,g=0,y=[];++u<d;){var v=o[u],w=c?c(v):v;if(!u||!mn(w,T)){var T=w;y[g++]=v===0?0:v}}return y}function x_(o){return typeof o=="number"?o:Ht(o)?Cc:+o}function Kt(o){if(typeof o=="string")return o;if(te(o))return Ne(o,Kt)+"";if(Ht(o))return l_?l_.call(o):"";var c=o+"";return c=="0"&&1/o==-oi?"-0":c}function Ar(o,c,u){var d=-1,g=Mc,y=o.length,v=!0,w=[],T=w;if(u)v=!1,g=$h;else if(y>=i){var C=c?null:wP(o);if(C)return Uc(C);v=!1,g=Do,T=new li}else T=c?[]:w;e:for(;++d<y;){var D=o[d],x=c?c(D):D;if(D=u||D!==0?D:0,v&&x===x){for(var U=T.length;U--;)if(T[U]===x)continue e;c&&T.push(x),w.push(D)}else g(T,x,u)||(T!==w&&T.push(x),w.push(D))}return w}function pd(o,c){return c=Rr(c,o),o=oy(o,c),o==null||delete o[Sn(an(c))]}function N_(o,c,u,d){return Bo(o,c,u(di(o,c)),d)}function su(o,c,u,d){for(var g=o.length,y=d?g:-1;(d?y--:++y<g)&&c(o[y],y,o););return u?on(o,d?0:y,d?y+1:g):on(o,d?y+1:0,d?g:y)}function V_(o,c){var u=o;return u instanceof le&&(u=u.value()),Wh(c,function(d,g){return g.func.apply(g.thisArg,Ir([d],g.args))},u)}function gd(o,c,u){var d=o.length;if(d<2)return d?Ar(o[0]):[];for(var g=-1,y=S(d);++g<d;)for(var v=o[g],w=-1;++w<d;)w!=g&&(y[g]=Mo(y[g]||v,o[w],c,u));return Ar(dt(y,1),c,u)}function O_(o,c,u){for(var d=-1,g=o.length,y=c.length,v={};++d<g;){var w=d<y?c[d]:t;u(v,o[d],w)}return v}function md(o){return je(o)?o:[]}function _d(o){return typeof o=="function"?o:Ft}function Rr(o,c){return te(o)?o:Sd(o,c)?[o]:ly(Ie(o))}var hP=oe;function Sr(o,c,u){var d=o.length;return u=u===t?d:u,!c&&u>=d?o:on(o,c,u)}var L_=XS||function(o){return ht.clearTimeout(o)};function M_(o,c){if(c)return o.slice();var u=o.length,d=i_?i_(u):new o.constructor(u);return o.copy(d),d}function yd(o){var c=new o.constructor(o.byteLength);return new zc(c).set(new zc(o)),c}function dP(o,c){var u=c?yd(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.byteLength)}function fP(o){var c=new o.constructor(o.source,Im.exec(o));return c.lastIndex=o.lastIndex,c}function pP(o){return Oo?Se(Oo.call(o)):{}}function F_(o,c){var u=c?yd(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.length)}function U_(o,c){if(o!==c){var u=o!==t,d=o===null,g=o===o,y=Ht(o),v=c!==t,w=c===null,T=c===c,C=Ht(c);if(!w&&!C&&!y&&o>c||y&&v&&T&&!w&&!C||d&&v&&T||!u&&T||!g)return 1;if(!d&&!y&&!C&&o<c||C&&u&&g&&!d&&!y||w&&u&&g||!v&&g||!T)return-1}return 0}function gP(o,c,u){for(var d=-1,g=o.criteria,y=c.criteria,v=g.length,w=u.length;++d<v;){var T=U_(g[d],y[d]);if(T){if(d>=w)return T;var C=u[d];return T*(C=="desc"?-1:1)}}return o.index-c.index}function B_(o,c,u,d){for(var g=-1,y=o.length,v=u.length,w=-1,T=c.length,C=tt(y-v,0),D=S(T+C),x=!d;++w<T;)D[w]=c[w];for(;++g<v;)(x||g<y)&&(D[u[g]]=o[g]);for(;C--;)D[w++]=o[g++];return D}function q_(o,c,u,d){for(var g=-1,y=o.length,v=-1,w=u.length,T=-1,C=c.length,D=tt(y-w,0),x=S(D+C),U=!d;++g<D;)x[g]=o[g];for(var G=g;++T<C;)x[G+T]=c[T];for(;++v<w;)(U||g<y)&&(x[G+u[v]]=o[g++]);return x}function Ot(o,c){var u=-1,d=o.length;for(c||(c=S(d));++u<d;)c[u]=o[u];return c}function Rn(o,c,u,d){var g=!u;u||(u={});for(var y=-1,v=c.length;++y<v;){var w=c[y],T=d?d(u[w],o[w],w,u,o):t;T===t&&(T=o[w]),g?Jn(u,w,T):Lo(u,w,T)}return u}function mP(o,c){return Rn(o,Rd(o),c)}function _P(o,c){return Rn(o,ey(o),c)}function ou(o,c){return function(u,d){var g=te(u)?ES:Ub,y=c?c():{};return g(u,o,Q(d,2),y)}}function fs(o){return oe(function(c,u){var d=-1,g=u.length,y=g>1?u[g-1]:t,v=g>2?u[2]:t;for(y=o.length>3&&typeof y=="function"?(g--,y):t,v&&St(u[0],u[1],v)&&(y=g<3?t:y,g=1),c=Se(c);++d<g;){var w=u[d];w&&o(c,w,d,y)}return c})}function $_(o,c){return function(u,d){if(u==null)return u;if(!Lt(u))return o(u,d);for(var g=u.length,y=c?g:-1,v=Se(u);(c?y--:++y<g)&&d(v[y],y,v)!==!1;);return u}}function W_(o){return function(c,u,d){for(var g=-1,y=Se(c),v=d(c),w=v.length;w--;){var T=v[o?w:++g];if(u(y[T],T,y)===!1)break}return c}}function yP(o,c,u){var d=c&V,g=qo(o);function y(){var v=this&&this!==ht&&this instanceof y?g:o;return v.apply(d?u:this,arguments)}return y}function G_(o){return function(c){c=Ie(c);var u=os(c)?pn(c):t,d=u?u[0]:c.charAt(0),g=u?Sr(u,1).join(""):c.slice(1);return d[o]()+g}}function ps(o){return function(c){return Wh($y(qy(c).replace(cS,"")),o,"")}}function qo(o){return function(){var c=arguments;switch(c.length){case 0:return new o;case 1:return new o(c[0]);case 2:return new o(c[0],c[1]);case 3:return new o(c[0],c[1],c[2]);case 4:return new o(c[0],c[1],c[2],c[3]);case 5:return new o(c[0],c[1],c[2],c[3],c[4]);case 6:return new o(c[0],c[1],c[2],c[3],c[4],c[5]);case 7:return new o(c[0],c[1],c[2],c[3],c[4],c[5],c[6])}var u=ds(o.prototype),d=o.apply(u,c);return Fe(d)?d:u}}function vP(o,c,u){var d=qo(o);function g(){for(var y=arguments.length,v=S(y),w=y,T=gs(g);w--;)v[w]=arguments[w];var C=y<3&&v[0]!==T&&v[y-1]!==T?[]:wr(v,T);if(y-=C.length,y<u)return Q_(o,c,au,g.placeholder,t,v,C,t,t,u-y);var D=this&&this!==ht&&this instanceof g?d:o;return Gt(D,this,v)}return g}function z_(o){return function(c,u,d){var g=Se(c);if(!Lt(c)){var y=Q(u,3);c=rt(c),u=function(w){return y(g[w],w,g)}}var v=o(c,u,d);return v>-1?g[y?c[v]:v]:t}}function K_(o){return Zn(function(c){var u=c.length,d=u,g=rn.prototype.thru;for(o&&c.reverse();d--;){var y=c[d];if(typeof y!="function")throw new nn(a);if(g&&!v&&hu(y)=="wrapper")var v=new rn([],!0)}for(d=v?d:u;++d<u;){y=c[d];var w=hu(y),T=w=="wrapper"?Td(y):t;T&&bd(T[0])&&T[1]==(we|j|de|Vt)&&!T[4].length&&T[9]==1?v=v[hu(T[0])].apply(v,T[3]):v=y.length==1&&bd(y)?v[w]():v.thru(y)}return function(){var C=arguments,D=C[0];if(v&&C.length==1&&te(D))return v.plant(D).value();for(var x=0,U=u?c[x].apply(this,C):D;++x<u;)U=c[x].call(this,U);return U}})}function au(o,c,u,d,g,y,v,w,T,C){var D=c&we,x=c&V,U=c&Y,G=c&(j|ye),J=c&Hn,se=U?t:qo(o);function X(){for(var ce=arguments.length,fe=S(ce),jt=ce;jt--;)fe[jt]=arguments[jt];if(G)var bt=gs(X),Qt=kS(fe,bt);if(d&&(fe=B_(fe,d,g,G)),y&&(fe=q_(fe,y,v,G)),ce-=Qt,G&&ce<C){var Qe=wr(fe,bt);return Q_(o,c,au,X.placeholder,u,fe,Qe,w,T,C-ce)}var _n=x?u:this,rr=U?_n[o]:o;return ce=fe.length,w?fe=UP(fe,w):J&&ce>1&&fe.reverse(),D&&T<ce&&(fe.length=T),this&&this!==ht&&this instanceof X&&(rr=se||qo(rr)),rr.apply(_n,fe)}return X}function H_(o,c){return function(u,d){return Hb(u,o,c(d),{})}}function cu(o,c){return function(u,d){var g;if(u===t&&d===t)return c;if(u!==t&&(g=u),d!==t){if(g===t)return d;typeof u=="string"||typeof d=="string"?(u=Kt(u),d=Kt(d)):(u=x_(u),d=x_(d)),g=o(u,d)}return g}}function vd(o){return Zn(function(c){return c=Ne(c,zt(Q())),oe(function(u){var d=this;return o(c,function(g){return Gt(g,d,u)})})})}function uu(o,c){c=c===t?" ":Kt(c);var u=c.length;if(u<2)return u?dd(c,o):c;var d=dd(c,Qc(o/as(c)));return os(c)?Sr(pn(d),0,o).join(""):d.slice(0,o)}function IP(o,c,u,d){var g=c&V,y=qo(o);function v(){for(var w=-1,T=arguments.length,C=-1,D=d.length,x=S(D+T),U=this&&this!==ht&&this instanceof v?y:o;++C<D;)x[C]=d[C];for(;T--;)x[C++]=arguments[++w];return Gt(U,g?u:this,x)}return v}function j_(o){return function(c,u,d){return d&&typeof d!="number"&&St(c,u,d)&&(u=d=t),c=nr(c),u===t?(u=c,c=0):u=nr(u),d=d===t?c<u?1:-1:nr(d),sP(c,u,d,o)}}function lu(o){return function(c,u){return typeof c=="string"&&typeof u=="string"||(c=cn(c),u=cn(u)),o(c,u)}}function Q_(o,c,u,d,g,y,v,w,T,C){var D=c&j,x=D?v:t,U=D?t:v,G=D?y:t,J=D?t:y;c|=D?de:me,c&=~(D?me:de),c&ae||(c&=~(V|Y));var se=[o,c,g,G,x,J,U,w,T,C],X=u.apply(t,se);return bd(o)&&ay(X,se),X.placeholder=d,cy(X,o,c)}function Id(o){var c=et[o];return function(u,d){if(u=cn(u),d=d==null?0:vt(ie(d),292),d&&c_(u)){var g=(Ie(u)+"e").split("e"),y=c(g[0]+"e"+(+g[1]+d));return g=(Ie(y)+"e").split("e"),+(g[0]+"e"+(+g[1]-d))}return c(u)}}var wP=ls&&1/Uc(new ls([,-0]))[1]==oi?function(o){return new ls(o)}:$d;function Y_(o){return function(c){var u=It(c);return u==dn?Yh(c):u==fn?FS(c):DS(c,o(c))}}function Xn(o,c,u,d,g,y,v,w){var T=c&Y;if(!T&&typeof o!="function")throw new nn(a);var C=d?d.length:0;if(C||(c&=~(de|me),d=g=t),v=v===t?v:tt(ie(v),0),w=w===t?w:ie(w),C-=g?g.length:0,c&me){var D=d,x=g;d=g=t}var U=T?t:Td(o),G=[o,c,u,d,g,D,x,y,v,w];if(U&&LP(G,U),o=G[0],c=G[1],u=G[2],d=G[3],g=G[4],w=G[9]=G[9]===t?T?0:o.length:tt(G[9]-C,0),!w&&c&(j|ye)&&(c&=~(j|ye)),!c||c==V)var J=yP(o,c,u);else c==j||c==ye?J=vP(o,c,w):(c==de||c==(V|de))&&!g.length?J=IP(o,c,u,d):J=au.apply(t,G);var se=U?D_:ay;return cy(se(J,G),o,c)}function J_(o,c,u,d){return o===t||mn(o,us[u])&&!Ee.call(d,u)?c:o}function X_(o,c,u,d,g,y){return Fe(o)&&Fe(c)&&(y.set(c,o),ru(o,c,t,X_,y),y.delete(c)),o}function EP(o){return Go(o)?t:o}function Z_(o,c,u,d,g,y){var v=u&L,w=o.length,T=c.length;if(w!=T&&!(v&&T>w))return!1;var C=y.get(o),D=y.get(c);if(C&&D)return C==c&&D==o;var x=-1,U=!0,G=u&M?new li:t;for(y.set(o,c),y.set(c,o);++x<w;){var J=o[x],se=c[x];if(d)var X=v?d(se,J,x,c,o,y):d(J,se,x,o,c,y);if(X!==t){if(X)continue;U=!1;break}if(G){if(!Gh(c,function(ce,fe){if(!Do(G,fe)&&(J===ce||g(J,ce,u,d,y)))return G.push(fe)})){U=!1;break}}else if(!(J===se||g(J,se,u,d,y))){U=!1;break}}return y.delete(o),y.delete(c),U}function TP(o,c,u,d,g,y,v){switch(u){case rs:if(o.byteLength!=c.byteLength||o.byteOffset!=c.byteOffset)return!1;o=o.buffer,c=c.buffer;case Co:return!(o.byteLength!=c.byteLength||!y(new zc(o),new zc(c)));case To:case Ao:case Ro:return mn(+o,+c);case kc:return o.name==c.name&&o.message==c.message;case So:case bo:return o==c+"";case dn:var w=Yh;case fn:var T=d&L;if(w||(w=Uc),o.size!=c.size&&!T)return!1;var C=v.get(o);if(C)return C==c;d|=M,v.set(o,c);var D=Z_(w(o),w(c),d,g,y,v);return v.delete(o),D;case Nc:if(Oo)return Oo.call(o)==Oo.call(c)}return!1}function AP(o,c,u,d,g,y){var v=u&L,w=wd(o),T=w.length,C=wd(c),D=C.length;if(T!=D&&!v)return!1;for(var x=T;x--;){var U=w[x];if(!(v?U in c:Ee.call(c,U)))return!1}var G=y.get(o),J=y.get(c);if(G&&J)return G==c&&J==o;var se=!0;y.set(o,c),y.set(c,o);for(var X=v;++x<T;){U=w[x];var ce=o[U],fe=c[U];if(d)var jt=v?d(fe,ce,U,c,o,y):d(ce,fe,U,o,c,y);if(!(jt===t?ce===fe||g(ce,fe,u,d,y):jt)){se=!1;break}X||(X=U=="constructor")}if(se&&!X){var bt=o.constructor,Qt=c.constructor;bt!=Qt&&"constructor"in o&&"constructor"in c&&!(typeof bt=="function"&&bt instanceof bt&&typeof Qt=="function"&&Qt instanceof Qt)&&(se=!1)}return y.delete(o),y.delete(c),se}function Zn(o){return Cd(sy(o,t,py),o+"")}function wd(o){return v_(o,rt,Rd)}function Ed(o){return v_(o,Mt,ey)}var Td=Jc?function(o){return Jc.get(o)}:$d;function hu(o){for(var c=o.name+"",u=hs[c],d=Ee.call(hs,c)?u.length:0;d--;){var g=u[d],y=g.func;if(y==null||y==o)return g.name}return c}function gs(o){var c=Ee.call(_,"placeholder")?_:o;return c.placeholder}function Q(){var o=_.iteratee||Bd;return o=o===Bd?E_:o,arguments.length?o(arguments[0],arguments[1]):o}function du(o,c){var u=o.__data__;return xP(c)?u[typeof c=="string"?"string":"hash"]:u.map}function Ad(o){for(var c=rt(o),u=c.length;u--;){var d=c[u],g=o[d];c[u]=[d,g,ry(g)]}return c}function fi(o,c){var u=OS(o,c);return w_(u)?u:t}function RP(o){var c=Ee.call(o,ci),u=o[ci];try{o[ci]=t;var d=!0}catch{}var g=Wc.call(o);return d&&(c?o[ci]=u:delete o[ci]),g}var Rd=Xh?function(o){return o==null?[]:(o=Se(o),vr(Xh(o),function(c){return o_.call(o,c)}))}:Wd,ey=Xh?function(o){for(var c=[];o;)Ir(c,Rd(o)),o=Kc(o);return c}:Wd,It=Rt;(Zh&&It(new Zh(new ArrayBuffer(1)))!=rs||xo&&It(new xo)!=dn||ed&&It(ed.resolve())!=mm||ls&&It(new ls)!=fn||No&&It(new No)!=Po)&&(It=function(o){var c=Rt(o),u=c==jn?o.constructor:t,d=u?pi(u):"";if(d)switch(d){case ab:return rs;case cb:return dn;case ub:return mm;case lb:return fn;case hb:return Po}return c});function SP(o,c,u){for(var d=-1,g=u.length;++d<g;){var y=u[d],v=y.size;switch(y.type){case"drop":o+=v;break;case"dropRight":c-=v;break;case"take":c=vt(c,o+v);break;case"takeRight":o=tt(o,c-v);break}}return{start:o,end:c}}function bP(o){var c=o.match(NR);return c?c[1].split(VR):[]}function ty(o,c,u){c=Rr(c,o);for(var d=-1,g=c.length,y=!1;++d<g;){var v=Sn(c[d]);if(!(y=o!=null&&u(o,v)))break;o=o[v]}return y||++d!=g?y:(g=o==null?0:o.length,!!g&&vu(g)&&er(v,g)&&(te(o)||gi(o)))}function PP(o){var c=o.length,u=new o.constructor(c);return c&&typeof o[0]=="string"&&Ee.call(o,"index")&&(u.index=o.index,u.input=o.input),u}function ny(o){return typeof o.constructor=="function"&&!$o(o)?ds(Kc(o)):{}}function CP(o,c,u){var d=o.constructor;switch(c){case Co:return yd(o);case To:case Ao:return new d(+o);case rs:return dP(o,u);case Ah:case Rh:case Sh:case bh:case Ph:case Ch:case Dh:case kh:case xh:return F_(o,u);case dn:return new d;case Ro:case bo:return new d(o);case So:return fP(o);case fn:return new d;case Nc:return pP(o)}}function DP(o,c){var u=c.length;if(!u)return o;var d=u-1;return c[d]=(u>1?"& ":"")+c[d],c=c.join(u>2?", ":" "),o.replace(xR,`{
/* [wrapped with `+c+`] */
`)}function kP(o){return te(o)||gi(o)||!!(a_&&o&&o[a_])}function er(o,c){var u=typeof o;return c=c??yr,!!c&&(u=="number"||u!="symbol"&&WR.test(o))&&o>-1&&o%1==0&&o<c}function St(o,c,u){if(!Fe(u))return!1;var d=typeof c;return(d=="number"?Lt(u)&&er(c,u.length):d=="string"&&c in u)?mn(u[c],o):!1}function Sd(o,c){if(te(o))return!1;var u=typeof o;return u=="number"||u=="symbol"||u=="boolean"||o==null||Ht(o)?!0:PR.test(o)||!bR.test(o)||c!=null&&o in Se(c)}function xP(o){var c=typeof o;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?o!=="__proto__":o===null}function bd(o){var c=hu(o),u=_[c];if(typeof u!="function"||!(c in le.prototype))return!1;if(o===u)return!0;var d=Td(u);return!!d&&o===d[0]}function NP(o){return!!r_&&r_ in o}var VP=qc?tr:Gd;function $o(o){var c=o&&o.constructor,u=typeof c=="function"&&c.prototype||us;return o===u}function ry(o){return o===o&&!Fe(o)}function iy(o,c){return function(u){return u==null?!1:u[o]===c&&(c!==t||o in Se(u))}}function OP(o){var c=_u(o,function(d){return u.size===f&&u.clear(),d}),u=c.cache;return c}function LP(o,c){var u=o[1],d=c[1],g=u|d,y=g<(V|Y|we),v=d==we&&u==j||d==we&&u==Vt&&o[7].length<=c[8]||d==(we|Vt)&&c[7].length<=c[8]&&u==j;if(!(y||v))return o;d&V&&(o[2]=c[2],g|=u&V?0:ae);var w=c[3];if(w){var T=o[3];o[3]=T?B_(T,w,c[4]):w,o[4]=T?wr(o[3],p):c[4]}return w=c[5],w&&(T=o[5],o[5]=T?q_(T,w,c[6]):w,o[6]=T?wr(o[5],p):c[6]),w=c[7],w&&(o[7]=w),d&we&&(o[8]=o[8]==null?c[8]:vt(o[8],c[8])),o[9]==null&&(o[9]=c[9]),o[0]=c[0],o[1]=g,o}function MP(o){var c=[];if(o!=null)for(var u in Se(o))c.push(u);return c}function FP(o){return Wc.call(o)}function sy(o,c,u){return c=tt(c===t?o.length-1:c,0),function(){for(var d=arguments,g=-1,y=tt(d.length-c,0),v=S(y);++g<y;)v[g]=d[c+g];g=-1;for(var w=S(c+1);++g<c;)w[g]=d[g];return w[c]=u(v),Gt(o,this,w)}}function oy(o,c){return c.length<2?o:di(o,on(c,0,-1))}function UP(o,c){for(var u=o.length,d=vt(c.length,u),g=Ot(o);d--;){var y=c[d];o[d]=er(y,u)?g[y]:t}return o}function Pd(o,c){if(!(c==="constructor"&&typeof o[c]=="function")&&c!="__proto__")return o[c]}var ay=uy(D_),Wo=eb||function(o,c){return ht.setTimeout(o,c)},Cd=uy(cP);function cy(o,c,u){var d=c+"";return Cd(o,DP(d,BP(bP(d),u)))}function uy(o){var c=0,u=0;return function(){var d=ib(),g=aR-(d-u);if(u=d,g>0){if(++c>=oR)return arguments[0]}else c=0;return o.apply(t,arguments)}}function fu(o,c){var u=-1,d=o.length,g=d-1;for(c=c===t?d:c;++u<c;){var y=hd(u,g),v=o[y];o[y]=o[u],o[u]=v}return o.length=c,o}var ly=OP(function(o){var c=[];return o.charCodeAt(0)===46&&c.push(""),o.replace(CR,function(u,d,g,y){c.push(g?y.replace(MR,"$1"):d||u)}),c});function Sn(o){if(typeof o=="string"||Ht(o))return o;var c=o+"";return c=="0"&&1/o==-oi?"-0":c}function pi(o){if(o!=null){try{return $c.call(o)}catch{}try{return o+""}catch{}}return""}function BP(o,c){return tn(fR,function(u){var d="_."+u[0];c&u[1]&&!Mc(o,d)&&o.push(d)}),o.sort()}function hy(o){if(o instanceof le)return o.clone();var c=new rn(o.__wrapped__,o.__chain__);return c.__actions__=Ot(o.__actions__),c.__index__=o.__index__,c.__values__=o.__values__,c}function qP(o,c,u){(u?St(o,c,u):c===t)?c=1:c=tt(ie(c),0);var d=o==null?0:o.length;if(!d||c<1)return[];for(var g=0,y=0,v=S(Qc(d/c));g<d;)v[y++]=on(o,g,g+=c);return v}function $P(o){for(var c=-1,u=o==null?0:o.length,d=0,g=[];++c<u;){var y=o[c];y&&(g[d++]=y)}return g}function WP(){var o=arguments.length;if(!o)return[];for(var c=S(o-1),u=arguments[0],d=o;d--;)c[d-1]=arguments[d];return Ir(te(u)?Ot(u):[u],dt(c,1))}var GP=oe(function(o,c){return je(o)?Mo(o,dt(c,1,je,!0)):[]}),zP=oe(function(o,c){var u=an(c);return je(u)&&(u=t),je(o)?Mo(o,dt(c,1,je,!0),Q(u,2)):[]}),KP=oe(function(o,c){var u=an(c);return je(u)&&(u=t),je(o)?Mo(o,dt(c,1,je,!0),t,u):[]});function HP(o,c,u){var d=o==null?0:o.length;return d?(c=u||c===t?1:ie(c),on(o,c<0?0:c,d)):[]}function jP(o,c,u){var d=o==null?0:o.length;return d?(c=u||c===t?1:ie(c),c=d-c,on(o,0,c<0?0:c)):[]}function QP(o,c){return o&&o.length?su(o,Q(c,3),!0,!0):[]}function YP(o,c){return o&&o.length?su(o,Q(c,3),!0):[]}function JP(o,c,u,d){var g=o==null?0:o.length;return g?(u&&typeof u!="number"&&St(o,c,u)&&(u=0,d=g),Wb(o,c,u,d)):[]}function dy(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=u==null?0:ie(u);return g<0&&(g=tt(d+g,0)),Fc(o,Q(c,3),g)}function fy(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=d-1;return u!==t&&(g=ie(u),g=u<0?tt(d+g,0):vt(g,d-1)),Fc(o,Q(c,3),g,!0)}function py(o){var c=o==null?0:o.length;return c?dt(o,1):[]}function XP(o){var c=o==null?0:o.length;return c?dt(o,oi):[]}function ZP(o,c){var u=o==null?0:o.length;return u?(c=c===t?1:ie(c),dt(o,c)):[]}function eC(o){for(var c=-1,u=o==null?0:o.length,d={};++c<u;){var g=o[c];d[g[0]]=g[1]}return d}function gy(o){return o&&o.length?o[0]:t}function tC(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=u==null?0:ie(u);return g<0&&(g=tt(d+g,0)),ss(o,c,g)}function nC(o){var c=o==null?0:o.length;return c?on(o,0,-1):[]}var rC=oe(function(o){var c=Ne(o,md);return c.length&&c[0]===o[0]?od(c):[]}),iC=oe(function(o){var c=an(o),u=Ne(o,md);return c===an(u)?c=t:u.pop(),u.length&&u[0]===o[0]?od(u,Q(c,2)):[]}),sC=oe(function(o){var c=an(o),u=Ne(o,md);return c=typeof c=="function"?c:t,c&&u.pop(),u.length&&u[0]===o[0]?od(u,t,c):[]});function oC(o,c){return o==null?"":nb.call(o,c)}function an(o){var c=o==null?0:o.length;return c?o[c-1]:t}function aC(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=d;return u!==t&&(g=ie(u),g=g<0?tt(d+g,0):vt(g,d-1)),c===c?BS(o,c,g):Fc(o,Qm,g,!0)}function cC(o,c){return o&&o.length?S_(o,ie(c)):t}var uC=oe(my);function my(o,c){return o&&o.length&&c&&c.length?ld(o,c):o}function lC(o,c,u){return o&&o.length&&c&&c.length?ld(o,c,Q(u,2)):o}function hC(o,c,u){return o&&o.length&&c&&c.length?ld(o,c,t,u):o}var dC=Zn(function(o,c){var u=o==null?0:o.length,d=nd(o,c);return C_(o,Ne(c,function(g){return er(g,u)?+g:g}).sort(U_)),d});function fC(o,c){var u=[];if(!(o&&o.length))return u;var d=-1,g=[],y=o.length;for(c=Q(c,3);++d<y;){var v=o[d];c(v,d,o)&&(u.push(v),g.push(d))}return C_(o,g),u}function Dd(o){return o==null?o:ob.call(o)}function pC(o,c,u){var d=o==null?0:o.length;return d?(u&&typeof u!="number"&&St(o,c,u)?(c=0,u=d):(c=c==null?0:ie(c),u=u===t?d:ie(u)),on(o,c,u)):[]}function gC(o,c){return iu(o,c)}function mC(o,c,u){return fd(o,c,Q(u,2))}function _C(o,c){var u=o==null?0:o.length;if(u){var d=iu(o,c);if(d<u&&mn(o[d],c))return d}return-1}function yC(o,c){return iu(o,c,!0)}function vC(o,c,u){return fd(o,c,Q(u,2),!0)}function IC(o,c){var u=o==null?0:o.length;if(u){var d=iu(o,c,!0)-1;if(mn(o[d],c))return d}return-1}function wC(o){return o&&o.length?k_(o):[]}function EC(o,c){return o&&o.length?k_(o,Q(c,2)):[]}function TC(o){var c=o==null?0:o.length;return c?on(o,1,c):[]}function AC(o,c,u){return o&&o.length?(c=u||c===t?1:ie(c),on(o,0,c<0?0:c)):[]}function RC(o,c,u){var d=o==null?0:o.length;return d?(c=u||c===t?1:ie(c),c=d-c,on(o,c<0?0:c,d)):[]}function SC(o,c){return o&&o.length?su(o,Q(c,3),!1,!0):[]}function bC(o,c){return o&&o.length?su(o,Q(c,3)):[]}var PC=oe(function(o){return Ar(dt(o,1,je,!0))}),CC=oe(function(o){var c=an(o);return je(c)&&(c=t),Ar(dt(o,1,je,!0),Q(c,2))}),DC=oe(function(o){var c=an(o);return c=typeof c=="function"?c:t,Ar(dt(o,1,je,!0),t,c)});function kC(o){return o&&o.length?Ar(o):[]}function xC(o,c){return o&&o.length?Ar(o,Q(c,2)):[]}function NC(o,c){return c=typeof c=="function"?c:t,o&&o.length?Ar(o,t,c):[]}function kd(o){if(!(o&&o.length))return[];var c=0;return o=vr(o,function(u){if(je(u))return c=tt(u.length,c),!0}),jh(c,function(u){return Ne(o,zh(u))})}function _y(o,c){if(!(o&&o.length))return[];var u=kd(o);return c==null?u:Ne(u,function(d){return Gt(c,t,d)})}var VC=oe(function(o,c){return je(o)?Mo(o,c):[]}),OC=oe(function(o){return gd(vr(o,je))}),LC=oe(function(o){var c=an(o);return je(c)&&(c=t),gd(vr(o,je),Q(c,2))}),MC=oe(function(o){var c=an(o);return c=typeof c=="function"?c:t,gd(vr(o,je),t,c)}),FC=oe(kd);function UC(o,c){return O_(o||[],c||[],Lo)}function BC(o,c){return O_(o||[],c||[],Bo)}var qC=oe(function(o){var c=o.length,u=c>1?o[c-1]:t;return u=typeof u=="function"?(o.pop(),u):t,_y(o,u)});function yy(o){var c=_(o);return c.__chain__=!0,c}function $C(o,c){return c(o),o}function pu(o,c){return c(o)}var WC=Zn(function(o){var c=o.length,u=c?o[0]:0,d=this.__wrapped__,g=function(y){return nd(y,o)};return c>1||this.__actions__.length||!(d instanceof le)||!er(u)?this.thru(g):(d=d.slice(u,+u+(c?1:0)),d.__actions__.push({func:pu,args:[g],thisArg:t}),new rn(d,this.__chain__).thru(function(y){return c&&!y.length&&y.push(t),y}))});function GC(){return yy(this)}function zC(){return new rn(this.value(),this.__chain__)}function KC(){this.__values__===t&&(this.__values__=xy(this.value()));var o=this.__index__>=this.__values__.length,c=o?t:this.__values__[this.__index__++];return{done:o,value:c}}function HC(){return this}function jC(o){for(var c,u=this;u instanceof Zc;){var d=hy(u);d.__index__=0,d.__values__=t,c?g.__wrapped__=d:c=d;var g=d;u=u.__wrapped__}return g.__wrapped__=o,c}function QC(){var o=this.__wrapped__;if(o instanceof le){var c=o;return this.__actions__.length&&(c=new le(this)),c=c.reverse(),c.__actions__.push({func:pu,args:[Dd],thisArg:t}),new rn(c,this.__chain__)}return this.thru(Dd)}function YC(){return V_(this.__wrapped__,this.__actions__)}var JC=ou(function(o,c,u){Ee.call(o,u)?++o[u]:Jn(o,u,1)});function XC(o,c,u){var d=te(o)?Hm:$b;return u&&St(o,c,u)&&(c=t),d(o,Q(c,3))}function ZC(o,c){var u=te(o)?vr:__;return u(o,Q(c,3))}var e1=z_(dy),t1=z_(fy);function n1(o,c){return dt(gu(o,c),1)}function r1(o,c){return dt(gu(o,c),oi)}function i1(o,c,u){return u=u===t?1:ie(u),dt(gu(o,c),u)}function vy(o,c){var u=te(o)?tn:Tr;return u(o,Q(c,3))}function Iy(o,c){var u=te(o)?TS:m_;return u(o,Q(c,3))}var s1=ou(function(o,c,u){Ee.call(o,u)?o[u].push(c):Jn(o,u,[c])});function o1(o,c,u,d){o=Lt(o)?o:_s(o),u=u&&!d?ie(u):0;var g=o.length;return u<0&&(u=tt(g+u,0)),Iu(o)?u<=g&&o.indexOf(c,u)>-1:!!g&&ss(o,c,u)>-1}var a1=oe(function(o,c,u){var d=-1,g=typeof c=="function",y=Lt(o)?S(o.length):[];return Tr(o,function(v){y[++d]=g?Gt(c,v,u):Fo(v,c,u)}),y}),c1=ou(function(o,c,u){Jn(o,u,c)});function gu(o,c){var u=te(o)?Ne:T_;return u(o,Q(c,3))}function u1(o,c,u,d){return o==null?[]:(te(c)||(c=c==null?[]:[c]),u=d?t:u,te(u)||(u=u==null?[]:[u]),b_(o,c,u))}var l1=ou(function(o,c,u){o[u?0:1].push(c)},function(){return[[],[]]});function h1(o,c,u){var d=te(o)?Wh:Jm,g=arguments.length<3;return d(o,Q(c,4),u,g,Tr)}function d1(o,c,u){var d=te(o)?AS:Jm,g=arguments.length<3;return d(o,Q(c,4),u,g,m_)}function f1(o,c){var u=te(o)?vr:__;return u(o,yu(Q(c,3)))}function p1(o){var c=te(o)?d_:oP;return c(o)}function g1(o,c,u){(u?St(o,c,u):c===t)?c=1:c=ie(c);var d=te(o)?Mb:aP;return d(o,c)}function m1(o){var c=te(o)?Fb:uP;return c(o)}function _1(o){if(o==null)return 0;if(Lt(o))return Iu(o)?as(o):o.length;var c=It(o);return c==dn||c==fn?o.size:cd(o).length}function y1(o,c,u){var d=te(o)?Gh:lP;return u&&St(o,c,u)&&(c=t),d(o,Q(c,3))}var v1=oe(function(o,c){if(o==null)return[];var u=c.length;return u>1&&St(o,c[0],c[1])?c=[]:u>2&&St(c[0],c[1],c[2])&&(c=[c[0]]),b_(o,dt(c,1),[])}),mu=ZS||function(){return ht.Date.now()};function I1(o,c){if(typeof c!="function")throw new nn(a);return o=ie(o),function(){if(--o<1)return c.apply(this,arguments)}}function wy(o,c,u){return c=u?t:c,c=o&&c==null?o.length:c,Xn(o,we,t,t,t,t,c)}function Ey(o,c){var u;if(typeof c!="function")throw new nn(a);return o=ie(o),function(){return--o>0&&(u=c.apply(this,arguments)),o<=1&&(c=t),u}}var xd=oe(function(o,c,u){var d=V;if(u.length){var g=wr(u,gs(xd));d|=de}return Xn(o,d,c,u,g)}),Ty=oe(function(o,c,u){var d=V|Y;if(u.length){var g=wr(u,gs(Ty));d|=de}return Xn(c,d,o,u,g)});function Ay(o,c,u){c=u?t:c;var d=Xn(o,j,t,t,t,t,t,c);return d.placeholder=Ay.placeholder,d}function Ry(o,c,u){c=u?t:c;var d=Xn(o,ye,t,t,t,t,t,c);return d.placeholder=Ry.placeholder,d}function Sy(o,c,u){var d,g,y,v,w,T,C=0,D=!1,x=!1,U=!0;if(typeof o!="function")throw new nn(a);c=cn(c)||0,Fe(u)&&(D=!!u.leading,x="maxWait"in u,y=x?tt(cn(u.maxWait)||0,c):y,U="trailing"in u?!!u.trailing:U);function G(Qe){var _n=d,rr=g;return d=g=t,C=Qe,v=o.apply(rr,_n),v}function J(Qe){return C=Qe,w=Wo(ce,c),D?G(Qe):v}function se(Qe){var _n=Qe-T,rr=Qe-C,zy=c-_n;return x?vt(zy,y-rr):zy}function X(Qe){var _n=Qe-T,rr=Qe-C;return T===t||_n>=c||_n<0||x&&rr>=y}function ce(){var Qe=mu();if(X(Qe))return fe(Qe);w=Wo(ce,se(Qe))}function fe(Qe){return w=t,U&&d?G(Qe):(d=g=t,v)}function jt(){w!==t&&L_(w),C=0,d=T=g=w=t}function bt(){return w===t?v:fe(mu())}function Qt(){var Qe=mu(),_n=X(Qe);if(d=arguments,g=this,T=Qe,_n){if(w===t)return J(T);if(x)return L_(w),w=Wo(ce,c),G(T)}return w===t&&(w=Wo(ce,c)),v}return Qt.cancel=jt,Qt.flush=bt,Qt}var w1=oe(function(o,c){return g_(o,1,c)}),E1=oe(function(o,c,u){return g_(o,cn(c)||0,u)});function T1(o){return Xn(o,Hn)}function _u(o,c){if(typeof o!="function"||c!=null&&typeof c!="function")throw new nn(a);var u=function(){var d=arguments,g=c?c.apply(this,d):d[0],y=u.cache;if(y.has(g))return y.get(g);var v=o.apply(this,d);return u.cache=y.set(g,v)||y,v};return u.cache=new(_u.Cache||Yn),u}_u.Cache=Yn;function yu(o){if(typeof o!="function")throw new nn(a);return function(){var c=arguments;switch(c.length){case 0:return!o.call(this);case 1:return!o.call(this,c[0]);case 2:return!o.call(this,c[0],c[1]);case 3:return!o.call(this,c[0],c[1],c[2])}return!o.apply(this,c)}}function A1(o){return Ey(2,o)}var R1=hP(function(o,c){c=c.length==1&&te(c[0])?Ne(c[0],zt(Q())):Ne(dt(c,1),zt(Q()));var u=c.length;return oe(function(d){for(var g=-1,y=vt(d.length,u);++g<y;)d[g]=c[g].call(this,d[g]);return Gt(o,this,d)})}),Nd=oe(function(o,c){var u=wr(c,gs(Nd));return Xn(o,de,t,c,u)}),by=oe(function(o,c){var u=wr(c,gs(by));return Xn(o,me,t,c,u)}),S1=Zn(function(o,c){return Xn(o,Vt,t,t,t,c)});function b1(o,c){if(typeof o!="function")throw new nn(a);return c=c===t?c:ie(c),oe(o,c)}function P1(o,c){if(typeof o!="function")throw new nn(a);return c=c==null?0:tt(ie(c),0),oe(function(u){var d=u[c],g=Sr(u,0,c);return d&&Ir(g,d),Gt(o,this,g)})}function C1(o,c,u){var d=!0,g=!0;if(typeof o!="function")throw new nn(a);return Fe(u)&&(d="leading"in u?!!u.leading:d,g="trailing"in u?!!u.trailing:g),Sy(o,c,{leading:d,maxWait:c,trailing:g})}function D1(o){return wy(o,1)}function k1(o,c){return Nd(_d(c),o)}function x1(){if(!arguments.length)return[];var o=arguments[0];return te(o)?o:[o]}function N1(o){return sn(o,A)}function V1(o,c){return c=typeof c=="function"?c:t,sn(o,A,c)}function O1(o){return sn(o,m|A)}function L1(o,c){return c=typeof c=="function"?c:t,sn(o,m|A,c)}function M1(o,c){return c==null||p_(o,c,rt(c))}function mn(o,c){return o===c||o!==o&&c!==c}var F1=lu(sd),U1=lu(function(o,c){return o>=c}),gi=I_(function(){return arguments}())?I_:function(o){return Be(o)&&Ee.call(o,"callee")&&!o_.call(o,"callee")},te=S.isArray,B1=qm?zt(qm):jb;function Lt(o){return o!=null&&vu(o.length)&&!tr(o)}function je(o){return Be(o)&&Lt(o)}function q1(o){return o===!0||o===!1||Be(o)&&Rt(o)==To}var br=tb||Gd,$1=$m?zt($m):Qb;function W1(o){return Be(o)&&o.nodeType===1&&!Go(o)}function G1(o){if(o==null)return!0;if(Lt(o)&&(te(o)||typeof o=="string"||typeof o.splice=="function"||br(o)||ms(o)||gi(o)))return!o.length;var c=It(o);if(c==dn||c==fn)return!o.size;if($o(o))return!cd(o).length;for(var u in o)if(Ee.call(o,u))return!1;return!0}function z1(o,c){return Uo(o,c)}function K1(o,c,u){u=typeof u=="function"?u:t;var d=u?u(o,c):t;return d===t?Uo(o,c,t,u):!!d}function Vd(o){if(!Be(o))return!1;var c=Rt(o);return c==kc||c==gR||typeof o.message=="string"&&typeof o.name=="string"&&!Go(o)}function H1(o){return typeof o=="number"&&c_(o)}function tr(o){if(!Fe(o))return!1;var c=Rt(o);return c==xc||c==gm||c==pR||c==_R}function Py(o){return typeof o=="number"&&o==ie(o)}function vu(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=yr}function Fe(o){var c=typeof o;return o!=null&&(c=="object"||c=="function")}function Be(o){return o!=null&&typeof o=="object"}var Cy=Wm?zt(Wm):Jb;function j1(o,c){return o===c||ad(o,c,Ad(c))}function Q1(o,c,u){return u=typeof u=="function"?u:t,ad(o,c,Ad(c),u)}function Y1(o){return Dy(o)&&o!=+o}function J1(o){if(VP(o))throw new ee(s);return w_(o)}function X1(o){return o===null}function Z1(o){return o==null}function Dy(o){return typeof o=="number"||Be(o)&&Rt(o)==Ro}function Go(o){if(!Be(o)||Rt(o)!=jn)return!1;var c=Kc(o);if(c===null)return!0;var u=Ee.call(c,"constructor")&&c.constructor;return typeof u=="function"&&u instanceof u&&$c.call(u)==QS}var Od=Gm?zt(Gm):Xb;function eD(o){return Py(o)&&o>=-yr&&o<=yr}var ky=zm?zt(zm):Zb;function Iu(o){return typeof o=="string"||!te(o)&&Be(o)&&Rt(o)==bo}function Ht(o){return typeof o=="symbol"||Be(o)&&Rt(o)==Nc}var ms=Km?zt(Km):eP;function tD(o){return o===t}function nD(o){return Be(o)&&It(o)==Po}function rD(o){return Be(o)&&Rt(o)==vR}var iD=lu(ud),sD=lu(function(o,c){return o<=c});function xy(o){if(!o)return[];if(Lt(o))return Iu(o)?pn(o):Ot(o);if(ko&&o[ko])return MS(o[ko]());var c=It(o),u=c==dn?Yh:c==fn?Uc:_s;return u(o)}function nr(o){if(!o)return o===0?o:0;if(o=cn(o),o===oi||o===-oi){var c=o<0?-1:1;return c*lR}return o===o?o:0}function ie(o){var c=nr(o),u=c%1;return c===c?u?c-u:c:0}function Ny(o){return o?hi(ie(o),0,Tn):0}function cn(o){if(typeof o=="number")return o;if(Ht(o))return Cc;if(Fe(o)){var c=typeof o.valueOf=="function"?o.valueOf():o;o=Fe(c)?c+"":c}if(typeof o!="string")return o===0?o:+o;o=Xm(o);var u=BR.test(o);return u||$R.test(o)?IS(o.slice(2),u?2:8):UR.test(o)?Cc:+o}function Vy(o){return Rn(o,Mt(o))}function oD(o){return o?hi(ie(o),-yr,yr):o===0?o:0}function Ie(o){return o==null?"":Kt(o)}var aD=fs(function(o,c){if($o(c)||Lt(c)){Rn(c,rt(c),o);return}for(var u in c)Ee.call(c,u)&&Lo(o,u,c[u])}),Oy=fs(function(o,c){Rn(c,Mt(c),o)}),wu=fs(function(o,c,u,d){Rn(c,Mt(c),o,d)}),cD=fs(function(o,c,u,d){Rn(c,rt(c),o,d)}),uD=Zn(nd);function lD(o,c){var u=ds(o);return c==null?u:f_(u,c)}var hD=oe(function(o,c){o=Se(o);var u=-1,d=c.length,g=d>2?c[2]:t;for(g&&St(c[0],c[1],g)&&(d=1);++u<d;)for(var y=c[u],v=Mt(y),w=-1,T=v.length;++w<T;){var C=v[w],D=o[C];(D===t||mn(D,us[C])&&!Ee.call(o,C))&&(o[C]=y[C])}return o}),dD=oe(function(o){return o.push(t,X_),Gt(Ly,t,o)});function fD(o,c){return jm(o,Q(c,3),An)}function pD(o,c){return jm(o,Q(c,3),id)}function gD(o,c){return o==null?o:rd(o,Q(c,3),Mt)}function mD(o,c){return o==null?o:y_(o,Q(c,3),Mt)}function _D(o,c){return o&&An(o,Q(c,3))}function yD(o,c){return o&&id(o,Q(c,3))}function vD(o){return o==null?[]:nu(o,rt(o))}function ID(o){return o==null?[]:nu(o,Mt(o))}function Ld(o,c,u){var d=o==null?t:di(o,c);return d===t?u:d}function wD(o,c){return o!=null&&ty(o,c,Gb)}function Md(o,c){return o!=null&&ty(o,c,zb)}var ED=H_(function(o,c,u){c!=null&&typeof c.toString!="function"&&(c=Wc.call(c)),o[c]=u},Ud(Ft)),TD=H_(function(o,c,u){c!=null&&typeof c.toString!="function"&&(c=Wc.call(c)),Ee.call(o,c)?o[c].push(u):o[c]=[u]},Q),AD=oe(Fo);function rt(o){return Lt(o)?h_(o):cd(o)}function Mt(o){return Lt(o)?h_(o,!0):tP(o)}function RD(o,c){var u={};return c=Q(c,3),An(o,function(d,g,y){Jn(u,c(d,g,y),d)}),u}function SD(o,c){var u={};return c=Q(c,3),An(o,function(d,g,y){Jn(u,g,c(d,g,y))}),u}var bD=fs(function(o,c,u){ru(o,c,u)}),Ly=fs(function(o,c,u,d){ru(o,c,u,d)}),PD=Zn(function(o,c){var u={};if(o==null)return u;var d=!1;c=Ne(c,function(y){return y=Rr(y,o),d||(d=y.length>1),y}),Rn(o,Ed(o),u),d&&(u=sn(u,m|I|A,EP));for(var g=c.length;g--;)pd(u,c[g]);return u});function CD(o,c){return My(o,yu(Q(c)))}var DD=Zn(function(o,c){return o==null?{}:rP(o,c)});function My(o,c){if(o==null)return{};var u=Ne(Ed(o),function(d){return[d]});return c=Q(c),P_(o,u,function(d,g){return c(d,g[0])})}function kD(o,c,u){c=Rr(c,o);var d=-1,g=c.length;for(g||(g=1,o=t);++d<g;){var y=o==null?t:o[Sn(c[d])];y===t&&(d=g,y=u),o=tr(y)?y.call(o):y}return o}function xD(o,c,u){return o==null?o:Bo(o,c,u)}function ND(o,c,u,d){return d=typeof d=="function"?d:t,o==null?o:Bo(o,c,u,d)}var Fy=Y_(rt),Uy=Y_(Mt);function VD(o,c,u){var d=te(o),g=d||br(o)||ms(o);if(c=Q(c,4),u==null){var y=o&&o.constructor;g?u=d?new y:[]:Fe(o)?u=tr(y)?ds(Kc(o)):{}:u={}}return(g?tn:An)(o,function(v,w,T){return c(u,v,w,T)}),u}function OD(o,c){return o==null?!0:pd(o,c)}function LD(o,c,u){return o==null?o:N_(o,c,_d(u))}function MD(o,c,u,d){return d=typeof d=="function"?d:t,o==null?o:N_(o,c,_d(u),d)}function _s(o){return o==null?[]:Qh(o,rt(o))}function FD(o){return o==null?[]:Qh(o,Mt(o))}function UD(o,c,u){return u===t&&(u=c,c=t),u!==t&&(u=cn(u),u=u===u?u:0),c!==t&&(c=cn(c),c=c===c?c:0),hi(cn(o),c,u)}function BD(o,c,u){return c=nr(c),u===t?(u=c,c=0):u=nr(u),o=cn(o),Kb(o,c,u)}function qD(o,c,u){if(u&&typeof u!="boolean"&&St(o,c,u)&&(c=u=t),u===t&&(typeof c=="boolean"?(u=c,c=t):typeof o=="boolean"&&(u=o,o=t)),o===t&&c===t?(o=0,c=1):(o=nr(o),c===t?(c=o,o=0):c=nr(c)),o>c){var d=o;o=c,c=d}if(u||o%1||c%1){var g=u_();return vt(o+g*(c-o+vS("1e-"+((g+"").length-1))),c)}return hd(o,c)}var $D=ps(function(o,c,u){return c=c.toLowerCase(),o+(u?By(c):c)});function By(o){return Fd(Ie(o).toLowerCase())}function qy(o){return o=Ie(o),o&&o.replace(GR,xS).replace(uS,"")}function WD(o,c,u){o=Ie(o),c=Kt(c);var d=o.length;u=u===t?d:hi(ie(u),0,d);var g=u;return u-=c.length,u>=0&&o.slice(u,g)==c}function GD(o){return o=Ie(o),o&&AR.test(o)?o.replace(ym,NS):o}function zD(o){return o=Ie(o),o&&DR.test(o)?o.replace(Nh,"\\$&"):o}var KD=ps(function(o,c,u){return o+(u?"-":"")+c.toLowerCase()}),HD=ps(function(o,c,u){return o+(u?" ":"")+c.toLowerCase()}),jD=G_("toLowerCase");function QD(o,c,u){o=Ie(o),c=ie(c);var d=c?as(o):0;if(!c||d>=c)return o;var g=(c-d)/2;return uu(Yc(g),u)+o+uu(Qc(g),u)}function YD(o,c,u){o=Ie(o),c=ie(c);var d=c?as(o):0;return c&&d<c?o+uu(c-d,u):o}function JD(o,c,u){o=Ie(o),c=ie(c);var d=c?as(o):0;return c&&d<c?uu(c-d,u)+o:o}function XD(o,c,u){return u||c==null?c=0:c&&(c=+c),sb(Ie(o).replace(Vh,""),c||0)}function ZD(o,c,u){return(u?St(o,c,u):c===t)?c=1:c=ie(c),dd(Ie(o),c)}function ek(){var o=arguments,c=Ie(o[0]);return o.length<3?c:c.replace(o[1],o[2])}var tk=ps(function(o,c,u){return o+(u?"_":"")+c.toLowerCase()});function nk(o,c,u){return u&&typeof u!="number"&&St(o,c,u)&&(c=u=t),u=u===t?Tn:u>>>0,u?(o=Ie(o),o&&(typeof c=="string"||c!=null&&!Od(c))&&(c=Kt(c),!c&&os(o))?Sr(pn(o),0,u):o.split(c,u)):[]}var rk=ps(function(o,c,u){return o+(u?" ":"")+Fd(c)});function ik(o,c,u){return o=Ie(o),u=u==null?0:hi(ie(u),0,o.length),c=Kt(c),o.slice(u,u+c.length)==c}function sk(o,c,u){var d=_.templateSettings;u&&St(o,c,u)&&(c=t),o=Ie(o),c=wu({},c,d,J_);var g=wu({},c.imports,d.imports,J_),y=rt(g),v=Qh(g,y),w,T,C=0,D=c.interpolate||Vc,x="__p += '",U=Jh((c.escape||Vc).source+"|"+D.source+"|"+(D===vm?FR:Vc).source+"|"+(c.evaluate||Vc).source+"|$","g"),G="//# sourceURL="+(Ee.call(c,"sourceURL")?(c.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++pS+"]")+`
`;o.replace(U,function(X,ce,fe,jt,bt,Qt){return fe||(fe=jt),x+=o.slice(C,Qt).replace(zR,VS),ce&&(w=!0,x+=`' +
__e(`+ce+`) +
'`),bt&&(T=!0,x+=`';
`+bt+`;
__p += '`),fe&&(x+=`' +
((__t = (`+fe+`)) == null ? '' : __t) +
'`),C=Qt+X.length,X}),x+=`';
`;var J=Ee.call(c,"variable")&&c.variable;if(!J)x=`with (obj) {
`+x+`
}
`;else if(LR.test(J))throw new ee(l);x=(T?x.replace(IR,""):x).replace(wR,"$1").replace(ER,"$1;"),x="function("+(J||"obj")+`) {
`+(J?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+x+`return __p
}`;var se=Wy(function(){return ve(y,G+"return "+x).apply(t,v)});if(se.source=x,Vd(se))throw se;return se}function ok(o){return Ie(o).toLowerCase()}function ak(o){return Ie(o).toUpperCase()}function ck(o,c,u){if(o=Ie(o),o&&(u||c===t))return Xm(o);if(!o||!(c=Kt(c)))return o;var d=pn(o),g=pn(c),y=Zm(d,g),v=e_(d,g)+1;return Sr(d,y,v).join("")}function uk(o,c,u){if(o=Ie(o),o&&(u||c===t))return o.slice(0,n_(o)+1);if(!o||!(c=Kt(c)))return o;var d=pn(o),g=e_(d,pn(c))+1;return Sr(d,0,g).join("")}function lk(o,c,u){if(o=Ie(o),o&&(u||c===t))return o.replace(Vh,"");if(!o||!(c=Kt(c)))return o;var d=pn(o),g=Zm(d,pn(c));return Sr(d,g).join("")}function hk(o,c){var u=ts,d=sR;if(Fe(c)){var g="separator"in c?c.separator:g;u="length"in c?ie(c.length):u,d="omission"in c?Kt(c.omission):d}o=Ie(o);var y=o.length;if(os(o)){var v=pn(o);y=v.length}if(u>=y)return o;var w=u-as(d);if(w<1)return d;var T=v?Sr(v,0,w).join(""):o.slice(0,w);if(g===t)return T+d;if(v&&(w+=T.length-w),Od(g)){if(o.slice(w).search(g)){var C,D=T;for(g.global||(g=Jh(g.source,Ie(Im.exec(g))+"g")),g.lastIndex=0;C=g.exec(D);)var x=C.index;T=T.slice(0,x===t?w:x)}}else if(o.indexOf(Kt(g),w)!=w){var U=T.lastIndexOf(g);U>-1&&(T=T.slice(0,U))}return T+d}function dk(o){return o=Ie(o),o&&TR.test(o)?o.replace(_m,qS):o}var fk=ps(function(o,c,u){return o+(u?" ":"")+c.toUpperCase()}),Fd=G_("toUpperCase");function $y(o,c,u){return o=Ie(o),c=u?t:c,c===t?LS(o)?GS(o):bS(o):o.match(c)||[]}var Wy=oe(function(o,c){try{return Gt(o,t,c)}catch(u){return Vd(u)?u:new ee(u)}}),pk=Zn(function(o,c){return tn(c,function(u){u=Sn(u),Jn(o,u,xd(o[u],o))}),o});function gk(o){var c=o==null?0:o.length,u=Q();return o=c?Ne(o,function(d){if(typeof d[1]!="function")throw new nn(a);return[u(d[0]),d[1]]}):[],oe(function(d){for(var g=-1;++g<c;){var y=o[g];if(Gt(y[0],this,d))return Gt(y[1],this,d)}})}function mk(o){return qb(sn(o,m))}function Ud(o){return function(){return o}}function _k(o,c){return o==null||o!==o?c:o}var yk=K_(),vk=K_(!0);function Ft(o){return o}function Bd(o){return E_(typeof o=="function"?o:sn(o,m))}function Ik(o){return A_(sn(o,m))}function wk(o,c){return R_(o,sn(c,m))}var Ek=oe(function(o,c){return function(u){return Fo(u,o,c)}}),Tk=oe(function(o,c){return function(u){return Fo(o,u,c)}});function qd(o,c,u){var d=rt(c),g=nu(c,d);u==null&&!(Fe(c)&&(g.length||!d.length))&&(u=c,c=o,o=this,g=nu(c,rt(c)));var y=!(Fe(u)&&"chain"in u)||!!u.chain,v=tr(o);return tn(g,function(w){var T=c[w];o[w]=T,v&&(o.prototype[w]=function(){var C=this.__chain__;if(y||C){var D=o(this.__wrapped__),x=D.__actions__=Ot(this.__actions__);return x.push({func:T,args:arguments,thisArg:o}),D.__chain__=C,D}return T.apply(o,Ir([this.value()],arguments))})}),o}function Ak(){return ht._===this&&(ht._=YS),this}function $d(){}function Rk(o){return o=ie(o),oe(function(c){return S_(c,o)})}var Sk=vd(Ne),bk=vd(Hm),Pk=vd(Gh);function Gy(o){return Sd(o)?zh(Sn(o)):iP(o)}function Ck(o){return function(c){return o==null?t:di(o,c)}}var Dk=j_(),kk=j_(!0);function Wd(){return[]}function Gd(){return!1}function xk(){return{}}function Nk(){return""}function Vk(){return!0}function Ok(o,c){if(o=ie(o),o<1||o>yr)return[];var u=Tn,d=vt(o,Tn);c=Q(c),o-=Tn;for(var g=jh(d,c);++u<o;)c(u);return g}function Lk(o){return te(o)?Ne(o,Sn):Ht(o)?[o]:Ot(ly(Ie(o)))}function Mk(o){var c=++jS;return Ie(o)+c}var Fk=cu(function(o,c){return o+c},0),Uk=Id("ceil"),Bk=cu(function(o,c){return o/c},1),qk=Id("floor");function $k(o){return o&&o.length?tu(o,Ft,sd):t}function Wk(o,c){return o&&o.length?tu(o,Q(c,2),sd):t}function Gk(o){return Ym(o,Ft)}function zk(o,c){return Ym(o,Q(c,2))}function Kk(o){return o&&o.length?tu(o,Ft,ud):t}function Hk(o,c){return o&&o.length?tu(o,Q(c,2),ud):t}var jk=cu(function(o,c){return o*c},1),Qk=Id("round"),Yk=cu(function(o,c){return o-c},0);function Jk(o){return o&&o.length?Hh(o,Ft):0}function Xk(o,c){return o&&o.length?Hh(o,Q(c,2)):0}return _.after=I1,_.ary=wy,_.assign=aD,_.assignIn=Oy,_.assignInWith=wu,_.assignWith=cD,_.at=uD,_.before=Ey,_.bind=xd,_.bindAll=pk,_.bindKey=Ty,_.castArray=x1,_.chain=yy,_.chunk=qP,_.compact=$P,_.concat=WP,_.cond=gk,_.conforms=mk,_.constant=Ud,_.countBy=JC,_.create=lD,_.curry=Ay,_.curryRight=Ry,_.debounce=Sy,_.defaults=hD,_.defaultsDeep=dD,_.defer=w1,_.delay=E1,_.difference=GP,_.differenceBy=zP,_.differenceWith=KP,_.drop=HP,_.dropRight=jP,_.dropRightWhile=QP,_.dropWhile=YP,_.fill=JP,_.filter=ZC,_.flatMap=n1,_.flatMapDeep=r1,_.flatMapDepth=i1,_.flatten=py,_.flattenDeep=XP,_.flattenDepth=ZP,_.flip=T1,_.flow=yk,_.flowRight=vk,_.fromPairs=eC,_.functions=vD,_.functionsIn=ID,_.groupBy=s1,_.initial=nC,_.intersection=rC,_.intersectionBy=iC,_.intersectionWith=sC,_.invert=ED,_.invertBy=TD,_.invokeMap=a1,_.iteratee=Bd,_.keyBy=c1,_.keys=rt,_.keysIn=Mt,_.map=gu,_.mapKeys=RD,_.mapValues=SD,_.matches=Ik,_.matchesProperty=wk,_.memoize=_u,_.merge=bD,_.mergeWith=Ly,_.method=Ek,_.methodOf=Tk,_.mixin=qd,_.negate=yu,_.nthArg=Rk,_.omit=PD,_.omitBy=CD,_.once=A1,_.orderBy=u1,_.over=Sk,_.overArgs=R1,_.overEvery=bk,_.overSome=Pk,_.partial=Nd,_.partialRight=by,_.partition=l1,_.pick=DD,_.pickBy=My,_.property=Gy,_.propertyOf=Ck,_.pull=uC,_.pullAll=my,_.pullAllBy=lC,_.pullAllWith=hC,_.pullAt=dC,_.range=Dk,_.rangeRight=kk,_.rearg=S1,_.reject=f1,_.remove=fC,_.rest=b1,_.reverse=Dd,_.sampleSize=g1,_.set=xD,_.setWith=ND,_.shuffle=m1,_.slice=pC,_.sortBy=v1,_.sortedUniq=wC,_.sortedUniqBy=EC,_.split=nk,_.spread=P1,_.tail=TC,_.take=AC,_.takeRight=RC,_.takeRightWhile=SC,_.takeWhile=bC,_.tap=$C,_.throttle=C1,_.thru=pu,_.toArray=xy,_.toPairs=Fy,_.toPairsIn=Uy,_.toPath=Lk,_.toPlainObject=Vy,_.transform=VD,_.unary=D1,_.union=PC,_.unionBy=CC,_.unionWith=DC,_.uniq=kC,_.uniqBy=xC,_.uniqWith=NC,_.unset=OD,_.unzip=kd,_.unzipWith=_y,_.update=LD,_.updateWith=MD,_.values=_s,_.valuesIn=FD,_.without=VC,_.words=$y,_.wrap=k1,_.xor=OC,_.xorBy=LC,_.xorWith=MC,_.zip=FC,_.zipObject=UC,_.zipObjectDeep=BC,_.zipWith=qC,_.entries=Fy,_.entriesIn=Uy,_.extend=Oy,_.extendWith=wu,qd(_,_),_.add=Fk,_.attempt=Wy,_.camelCase=$D,_.capitalize=By,_.ceil=Uk,_.clamp=UD,_.clone=N1,_.cloneDeep=O1,_.cloneDeepWith=L1,_.cloneWith=V1,_.conformsTo=M1,_.deburr=qy,_.defaultTo=_k,_.divide=Bk,_.endsWith=WD,_.eq=mn,_.escape=GD,_.escapeRegExp=zD,_.every=XC,_.find=e1,_.findIndex=dy,_.findKey=fD,_.findLast=t1,_.findLastIndex=fy,_.findLastKey=pD,_.floor=qk,_.forEach=vy,_.forEachRight=Iy,_.forIn=gD,_.forInRight=mD,_.forOwn=_D,_.forOwnRight=yD,_.get=Ld,_.gt=F1,_.gte=U1,_.has=wD,_.hasIn=Md,_.head=gy,_.identity=Ft,_.includes=o1,_.indexOf=tC,_.inRange=BD,_.invoke=AD,_.isArguments=gi,_.isArray=te,_.isArrayBuffer=B1,_.isArrayLike=Lt,_.isArrayLikeObject=je,_.isBoolean=q1,_.isBuffer=br,_.isDate=$1,_.isElement=W1,_.isEmpty=G1,_.isEqual=z1,_.isEqualWith=K1,_.isError=Vd,_.isFinite=H1,_.isFunction=tr,_.isInteger=Py,_.isLength=vu,_.isMap=Cy,_.isMatch=j1,_.isMatchWith=Q1,_.isNaN=Y1,_.isNative=J1,_.isNil=Z1,_.isNull=X1,_.isNumber=Dy,_.isObject=Fe,_.isObjectLike=Be,_.isPlainObject=Go,_.isRegExp=Od,_.isSafeInteger=eD,_.isSet=ky,_.isString=Iu,_.isSymbol=Ht,_.isTypedArray=ms,_.isUndefined=tD,_.isWeakMap=nD,_.isWeakSet=rD,_.join=oC,_.kebabCase=KD,_.last=an,_.lastIndexOf=aC,_.lowerCase=HD,_.lowerFirst=jD,_.lt=iD,_.lte=sD,_.max=$k,_.maxBy=Wk,_.mean=Gk,_.meanBy=zk,_.min=Kk,_.minBy=Hk,_.stubArray=Wd,_.stubFalse=Gd,_.stubObject=xk,_.stubString=Nk,_.stubTrue=Vk,_.multiply=jk,_.nth=cC,_.noConflict=Ak,_.noop=$d,_.now=mu,_.pad=QD,_.padEnd=YD,_.padStart=JD,_.parseInt=XD,_.random=qD,_.reduce=h1,_.reduceRight=d1,_.repeat=ZD,_.replace=ek,_.result=kD,_.round=Qk,_.runInContext=E,_.sample=p1,_.size=_1,_.snakeCase=tk,_.some=y1,_.sortedIndex=gC,_.sortedIndexBy=mC,_.sortedIndexOf=_C,_.sortedLastIndex=yC,_.sortedLastIndexBy=vC,_.sortedLastIndexOf=IC,_.startCase=rk,_.startsWith=ik,_.subtract=Yk,_.sum=Jk,_.sumBy=Xk,_.template=sk,_.times=Ok,_.toFinite=nr,_.toInteger=ie,_.toLength=Ny,_.toLower=ok,_.toNumber=cn,_.toSafeInteger=oD,_.toString=Ie,_.toUpper=ak,_.trim=ck,_.trimEnd=uk,_.trimStart=lk,_.truncate=hk,_.unescape=dk,_.uniqueId=Mk,_.upperCase=fk,_.upperFirst=Fd,_.each=vy,_.eachRight=Iy,_.first=gy,qd(_,function(){var o={};return An(_,function(c,u){Ee.call(_.prototype,u)||(o[u]=c)}),o}(),{chain:!1}),_.VERSION=r,tn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){_[o].placeholder=_}),tn(["drop","take"],function(o,c){le.prototype[o]=function(u){u=u===t?1:tt(ie(u),0);var d=this.__filtered__&&!c?new le(this):this.clone();return d.__filtered__?d.__takeCount__=vt(u,d.__takeCount__):d.__views__.push({size:vt(u,Tn),type:o+(d.__dir__<0?"Right":"")}),d},le.prototype[o+"Right"]=function(u){return this.reverse()[o](u).reverse()}}),tn(["filter","map","takeWhile"],function(o,c){var u=c+1,d=u==pm||u==uR;le.prototype[o]=function(g){var y=this.clone();return y.__iteratees__.push({iteratee:Q(g,3),type:u}),y.__filtered__=y.__filtered__||d,y}}),tn(["head","last"],function(o,c){var u="take"+(c?"Right":"");le.prototype[o]=function(){return this[u](1).value()[0]}}),tn(["initial","tail"],function(o,c){var u="drop"+(c?"":"Right");le.prototype[o]=function(){return this.__filtered__?new le(this):this[u](1)}}),le.prototype.compact=function(){return this.filter(Ft)},le.prototype.find=function(o){return this.filter(o).head()},le.prototype.findLast=function(o){return this.reverse().find(o)},le.prototype.invokeMap=oe(function(o,c){return typeof o=="function"?new le(this):this.map(function(u){return Fo(u,o,c)})}),le.prototype.reject=function(o){return this.filter(yu(Q(o)))},le.prototype.slice=function(o,c){o=ie(o);var u=this;return u.__filtered__&&(o>0||c<0)?new le(u):(o<0?u=u.takeRight(-o):o&&(u=u.drop(o)),c!==t&&(c=ie(c),u=c<0?u.dropRight(-c):u.take(c-o)),u)},le.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},le.prototype.toArray=function(){return this.take(Tn)},An(le.prototype,function(o,c){var u=/^(?:filter|find|map|reject)|While$/.test(c),d=/^(?:head|last)$/.test(c),g=_[d?"take"+(c=="last"?"Right":""):c],y=d||/^find/.test(c);g&&(_.prototype[c]=function(){var v=this.__wrapped__,w=d?[1]:arguments,T=v instanceof le,C=w[0],D=T||te(v),x=function(ce){var fe=g.apply(_,Ir([ce],w));return d&&U?fe[0]:fe};D&&u&&typeof C=="function"&&C.length!=1&&(T=D=!1);var U=this.__chain__,G=!!this.__actions__.length,J=y&&!U,se=T&&!G;if(!y&&D){v=se?v:new le(this);var X=o.apply(v,w);return X.__actions__.push({func:pu,args:[x],thisArg:t}),new rn(X,U)}return J&&se?o.apply(this,w):(X=this.thru(x),J?d?X.value()[0]:X.value():X)})}),tn(["pop","push","shift","sort","splice","unshift"],function(o){var c=Bc[o],u=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",d=/^(?:pop|shift)$/.test(o);_.prototype[o]=function(){var g=arguments;if(d&&!this.__chain__){var y=this.value();return c.apply(te(y)?y:[],g)}return this[u](function(v){return c.apply(te(v)?v:[],g)})}}),An(le.prototype,function(o,c){var u=_[c];if(u){var d=u.name+"";Ee.call(hs,d)||(hs[d]=[]),hs[d].push({name:c,func:u})}}),hs[au(t,Y).name]=[{name:"wrapper",func:t}],le.prototype.clone=db,le.prototype.reverse=fb,le.prototype.value=pb,_.prototype.at=WC,_.prototype.chain=GC,_.prototype.commit=zC,_.prototype.next=KC,_.prototype.plant=jC,_.prototype.reverse=QC,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=YC,_.prototype.first=_.prototype.head,ko&&(_.prototype[ko]=HC),_},cs=zS();ai?((ai.exports=cs)._=cs,Bh._=cs):ht._=cs}).call(ra)})(o$,tc);const tR=tc;function a$(){return Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)}const nR=document.querySelector(".search__wrapper"),aw=document.querySelector(".search__input"),Tl=document.querySelector(".filters__list"),dp=document.querySelector(".filters__category"),c$=tR.debounce(h$,500);async function u$(n){try{const e=await n.fetchFilters(),r=[...new Set(e.map(({filter:i})=>i))].map((i,s)=>{const a=i.toLowerCase().split(" ").join("-");return s===0?`<li id=${a} class="filters__item active">${i}</li>`:`<li id=${a} class="filters__item">${i}</li>`}).join("");Tl.insertAdjacentHTML("afterbegin",r),Jr()}catch(e){console.log("Error fetching filters:",e)}}function cw(n){const e=n.charAt(0).toUpperCase()+n.slice(1,n.length);dp.innerHTML=`<div>/</div>${e}`,dp.classList.add("active"),nR.classList.add("active")}function l$(){dp.classList.remove("active"),nR.classList.remove("active")}async function h$(n){const e=n.target.value.toLowerCase().trim();Pn.keyword=e,Jr()}function d$(n){const e=n.target,t=n.target.id;e.classList.contains("active")&&(W0({filter:t,bodypart:"",keyword:"",muscles:"",equipment:""},De),Jr()),[...Tl.children].forEach(r=>{r.classList.remove("active")}),e.classList.add("active"),l$(),De.currentPage=1,Jr()}function f$(){if(De.endPoint!=1){const n=new Al;u$(n)}}aw&&aw.addEventListener("input",c$);Tl&&Tl.addEventListener("click",d$);function rR(n){document.querySelector(n).scrollIntoView({behavior:"smooth"})}window.addEventListener("resize",tR.debounce(Jr,1e3));const p$=1440;let Pn={filter:"Muscles",bodypart:"",keyword:"",muscles:"",equipment:""};const De={currentPage:1,endPoint:3},$n={cardsLinks:null,pageLinks:null,workoutLinks:null};async function Jr(){document.querySelector(".exercise-cards__section").offsetHeight;const e=new Al,t=a$();let r,i;W0(Pn,De),w4(),s$(De.endPoint,t);try{switch(De.endPoint){case 1:I4(),JI(),r=await m4(De,t),Nu(),Vu(),console.log(r.currentData),f4(r.currentData),t<p$&&gf(De.currentPage,r.totalPages),mf(De.endPoint);break;case 2:if(v4(),XI(),rR(".exercises"),i=p4(De.currentPage,De.endPoint,e,Pn,i,t),r=await jI(i),r.length===0)throw new Error("No data");Nu(),Vu(),d4(r),gf(De.currentPage,e.maxPages),mf(De.endPoint),y$();break;case 3:JI(),XI(),i=g4(De.currentPage,De.endPoint,e,Pn,i,t),r=await jI(i),Nu(),Vu(),h4(r),gf(De.currentPage,e.maxPages),g$(),mf(De.endPoint);break}}catch(s){console.log("Error: ",s),Nu(),Vu(),De.endPoint===1?T4():A4(),E4()}}function g$(){$n.cardsLinks=document.querySelector(".js-cards"),$n.cardsLinks?$n.cardsLinks.addEventListener("click",iR):console.error("Element with class 'js-cards' not found.")}function iR(n){const e=R4(n);cw(e),cw(e),m$(e),e!=null&&(Pn.filter==="Muscles"?(De.endPoint=2,Pn.muscles=e):Pn.filter==="Body%20parts"?(De.endPoint=2,Pn.bodypart=e):Pn.filter==="Equipment"&&(De.endPoint=2,Pn.equipment=e)),$n.cardsLinks.removeEventListener("click",iR),De.currentPage=1,Jr()}function m$(n){return n.includes(" ")?n.replace(" ","%20"):n}function mf(){$n.pageLinks=document.querySelector(".js-pages"),$n.pageLinks?$n.pageLinks.addEventListener("click",_$):console.error("Element with class 'js-pages' not found.")}function _$(n){const e=S4(n);console.log("clicked page:",e),rR(window.location.href.includes("/favorites")?".favorites":".exercises"),De.currentPage!=e&&e!=null&&(De.currentPage=+e,Jr())}function y$(){$n.workoutLinks=document.querySelector(".js-cards"),$n.workoutLinks?$n.workoutLinks.addEventListener("click",v$):console.error("Element with class 'js-cards' not found for workout.")}async function v$(n){const e=b4(n);if(!e)return;const t=new Al;try{t.id=e;const r=await t.fetchExerciseById();if(tc.isEmpty(r))throw new Error("Exercise not found!");r.isFavorite=await Ws.idIsFavorite(e),Z0(r)}catch(r){console.error(r)}}function I$(){window.location.href.includes("/favorite")?(De.endPoint=1,Jr()):f$()}I$();document.querySelectorAll(".header__nav");const w$=document.querySelectorAll("section"),E$=n=>{const e={rootMargin:"100px",threshold:.2},t=(i,s)=>{i.forEach(({isIntersecting:a,target:l})=>{a&&(l.classList.add("appear"),s.unobserve(l))})},r=new IntersectionObserver(t,e);n.forEach(i=>r.observe(i))};setTimeout(()=>{E$(w$)},250);export{zi as d,Ws as f,Z0 as o,lp as r,l4 as s};
