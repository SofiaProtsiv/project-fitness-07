import{A as Tl}from"./index-6f755ea3.js";const zy=document.getElementById("daily-quote"),Ky=document.getElementById("quote-author"),jk=new Tl;function aw(){const n=new Date,e=n.getFullYear(),t=(n.getMonth()+1).toString().padStart(2,"0");return`${n.getDate().toString().padStart(2,"0")}/${t}/${e}`}async function Qk(){try{const n=await jk.fetchQuote(),e=n.quote,t=n.author,r=aw();return localStorage.setItem("today",r),localStorage.setItem("quote",e),localStorage.setItem("author",t),{quote:e,author:t}}catch(n){console.error("Error fetching quote:",n.message)}}const Hy=localStorage.getItem("today"),Yk=aw();if(!Hy||Hy!==Yk)Qk().then(({quote:n,author:e})=>{zy.textContent=n,Ky.textContent=e});else{const n=localStorage.getItem("quote");n&&(zy.textContent=n);const e=localStorage.getItem("author");e&&(Ky.textContent=e)}const cw=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Jk=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],l=n[t++],h=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},uw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,l=a?n[i+1]:0,h=i+2<n.length,f=h?n[i+2]:0,p=s>>2,m=(s&3)<<4|l>>4;let I=(l&15)<<2|f>>6,A=f&63;h||(A=64,a||(I=64)),r.push(t[p],t[m],t[I],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(cw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Jk(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const f=i<n.length?t[n.charAt(i)]:64;++i;const m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||f==null||m==null)throw new Xk;const I=s<<2|l>>4;if(r.push(I),f!==64){const A=l<<4&240|f>>2;if(r.push(A),m!==64){const L=f<<6&192|m;r.push(L)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Xk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Zk=function(n){const e=cw(n);return uw.encodeByteArray(e,!0)},zu=function(n){return Zk(n).replace(/\./g,"")},lw=function(n){try{return uw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ku(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!ex(t)||(n[t]=Ku(n[t],e[t]));return n}function ex(n){return n!=="__proto__"}function tx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const nx=()=>tx().__FIREBASE_DEFAULTS__,rx=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},ix=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&lw(n[1]);return e&&JSON.parse(e)},pp=()=>{try{return nx()||rx()||ix()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},hw=()=>{var n;return(n=pp())===null||n===void 0?void 0:n.config},sx=n=>{var e;return(e=pp())===null||e===void 0?void 0:e[`_${n}`]};class ox{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function ax(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n),l="";return[zu(JSON.stringify(t)),zu(JSON.stringify(a)),l].join(".")}function Ue(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cx(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ue())}function gp(){var n;const e=(n=pp())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ux(){return typeof self=="object"&&self.self===self}function dw(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function mp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fw(){const n=Ue();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function lx(){return!gp()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function va(){try{return typeof indexedDB=="object"}catch{return!1}}function hx(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}const dx="FirebaseError";class Dt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=dx,Object.setPrototypeOf(this,Dt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zi.prototype.create)}}class zi{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?fx(s,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new Dt(i,l,r)}}function fx(n,e){return n.replace(px,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const px=/\{\$([^}]+)}/g;function jy(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function gx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function yf(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(Qy(s)&&Qy(a)){if(!yf(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Qy(n){return n!==null&&typeof n=="object"}function to(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Cs(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function ta(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function pw(n,e){const t=new mx(n,e);return t.subscribe.bind(t)}class mx{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");_x(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Kd),i.error===void 0&&(i.error=Kd),i.complete===void 0&&(i.complete=Kd);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _x(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Kd(){}function H(n){return n&&n._delegate?n._delegate:n}class $n{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const mi="[DEFAULT]";class yx{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new ox;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ix(e))try{this.getOrInitializeService({instanceIdentifier:mi})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=mi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=mi){return this.instances.has(e)}getOptions(e=mi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&a.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:vx(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=mi){return this.component?this.component.multipleInstances?e:mi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vx(n){return n===mi?void 0:n}function Ix(n){return n.instantiationMode==="EAGER"}class wx{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new yx(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const _p=[];var ue;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ue||(ue={}));const gw={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},Ex=ue.INFO,Tx={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},Ax=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=Tx[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Al{constructor(e){this.name=e,this._logLevel=Ex,this._logHandler=Ax,this._userLogHandler=null,_p.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...e),this._logHandler(this,ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...e),this._logHandler(this,ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ue.INFO,...e),this._logHandler(this,ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ue.WARN,...e),this._logHandler(this,ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...e),this._logHandler(this,ue.ERROR,...e)}}function Rx(n){_p.forEach(e=>{e.setLogLevel(n)})}function Sx(n,e){for(const t of _p){let r=null;e&&e.level&&(r=gw[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...a)=>{const l=a.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");s>=(r??i.logLevel)&&n({level:ue[s].toLowerCase(),message:l,args:a,type:i.name})}}}const bx=(n,e)=>e.some(t=>n instanceof t);let Yy,Jy;function Px(){return Yy||(Yy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Cx(){return Jy||(Jy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mw=new WeakMap,vf=new WeakMap,_w=new WeakMap,Hd=new WeakMap,yp=new WeakMap;function Dx(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Lr(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&mw.set(t,n)}).catch(()=>{}),yp.set(e,n),e}function kx(n){if(vf.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});vf.set(n,e)}let If={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return vf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||_w.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Lr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function xx(n){If=n(If)}function Nx(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(jd(this),e,...t);return _w.set(r,e.sort?e.sort():[e]),Lr(r)}:Cx().includes(n)?function(...e){return n.apply(jd(this),e),Lr(mw.get(this))}:function(...e){return Lr(n.apply(jd(this),e))}}function Vx(n){return typeof n=="function"?Nx(n):(n instanceof IDBTransaction&&kx(n),bx(n,Px())?new Proxy(n,If):n)}function Lr(n){if(n instanceof IDBRequest)return Dx(n);if(Hd.has(n))return Hd.get(n);const e=Vx(n);return e!==n&&(Hd.set(n,e),yp.set(e,n)),e}const jd=n=>yp.get(n);function Ox(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),l=Lr(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Lr(a.result),h.oldVersion,h.newVersion,Lr(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),l.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const Lx=["get","getKey","getAll","getAllKeys","count"],Mx=["put","add","delete","clear"],Qd=new Map;function Xy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Qd.get(e))return Qd.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=Mx.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Lx.includes(t)))return;const s=async function(a,...l){const h=this.transaction(a,i?"readwrite":"readonly");let f=h.store;return r&&(f=f.index(l.shift())),(await Promise.all([f[t](...l),i&&h.done]))[0]};return Qd.set(e,s),s}xx(n=>({...n,get:(e,t,r)=>Xy(e,t)||n.get(e,t,r),has:(e,t)=>!!Xy(e,t)||n.has(e,t)}));class Fx{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Ux(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Ux(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const wf="@firebase/app",Zy="0.9.25";const xi=new Al("@firebase/app"),Bx="@firebase/app-compat",qx="@firebase/analytics-compat",$x="@firebase/analytics",Wx="@firebase/app-check-compat",Gx="@firebase/app-check",zx="@firebase/auth",Kx="@firebase/auth-compat",Hx="@firebase/database",jx="@firebase/database-compat",Qx="@firebase/functions",Yx="@firebase/functions-compat",Jx="@firebase/installations",Xx="@firebase/installations-compat",Zx="@firebase/messaging",eN="@firebase/messaging-compat",tN="@firebase/performance",nN="@firebase/performance-compat",rN="@firebase/remote-config",iN="@firebase/remote-config-compat",sN="@firebase/storage",oN="@firebase/storage-compat",aN="@firebase/firestore",cN="@firebase/firestore-compat",uN="firebase",lN="10.7.1";const Mr="[DEFAULT]",hN={[wf]:"fire-core",[Bx]:"fire-core-compat",[$x]:"fire-analytics",[qx]:"fire-analytics-compat",[Gx]:"fire-app-check",[Wx]:"fire-app-check-compat",[zx]:"fire-auth",[Kx]:"fire-auth-compat",[Hx]:"fire-rtdb",[jx]:"fire-rtdb-compat",[Qx]:"fire-fn",[Yx]:"fire-fn-compat",[Jx]:"fire-iid",[Xx]:"fire-iid-compat",[Zx]:"fire-fcm",[eN]:"fire-fcm-compat",[tN]:"fire-perf",[nN]:"fire-perf-compat",[rN]:"fire-rc",[iN]:"fire-rc-compat",[sN]:"fire-gcs",[oN]:"fire-gcs-compat",[aN]:"fire-fst",[cN]:"fire-fst-compat","fire-js":"fire-js",[uN]:"fire-js-all"};const Fr=new Map,Ia=new Map;function Hu(n,e){try{n.container.addComponent(e)}catch(t){xi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function yw(n,e){n.container.addOrOverwriteComponent(e)}function Ur(n){const e=n.name;if(Ia.has(e))return xi.debug(`There were multiple attempts to register component ${e}.`),!1;Ia.set(e,n);for(const t of Fr.values())Hu(t,n);return!0}function vw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function dN(n,e,t=Mr){vw(n,e).clearInstance(t)}function fN(){Ia.clear()}const pN={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},or=new zi("app","Firebase",pN);let gN=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw or.create("app-deleted",{appName:this._name})}};const Jr=lN;function vp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Mr,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw or.create("bad-app-name",{appName:String(i)});if(t||(t=hw()),!t)throw or.create("no-options");const s=Fr.get(i);if(s){if(yf(t,s.options)&&yf(r,s.config))return s;throw or.create("duplicate-app",{appName:i})}const a=new wx(i);for(const h of Ia.values())a.addComponent(h);const l=new gN(t,r,a);return Fr.set(i,l),l}function mN(n=Mr){const e=Fr.get(n);if(!e&&n===Mr&&hw())return vp();if(!e)throw or.create("no-app",{appName:n});return e}function _N(){return Array.from(Fr.values())}async function Iw(n){const e=n.name;Fr.has(e)&&(Fr.delete(e),await Promise.all(n.container.getProviders().map(t=>t.delete())),n.isDeleted=!0)}function Fn(n,e,t){var r;let i=(r=hN[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xi.warn(l.join(" "));return}Ur(new $n(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function ww(n,e){if(n!==null&&typeof n!="function")throw or.create("invalid-log-argument");Sx(n,e)}function Ew(n){Rx(n)}const yN="firebase-heartbeat-database",vN=1,wa="firebase-heartbeat-store";let Yd=null;function Tw(){return Yd||(Yd=Ox(yN,vN,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(wa)}}}).catch(n=>{throw or.create("idb-open",{originalErrorMessage:n.message})})),Yd}async function IN(n){try{return await(await Tw()).transaction(wa).objectStore(wa).get(Aw(n))}catch(e){if(e instanceof Dt)xi.warn(e.message);else{const t=or.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});xi.warn(t.message)}}}async function ev(n,e){try{const r=(await Tw()).transaction(wa,"readwrite");await r.objectStore(wa).put(e,Aw(n)),await r.done}catch(t){if(t instanceof Dt)xi.warn(t.message);else{const r=or.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});xi.warn(r.message)}}}function Aw(n){return`${n.name}!${n.options.appId}`}const wN=1024,EN=30*24*60*60*1e3;class TN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new RN(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=tv();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=EN}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=tv(),{heartbeatsToSend:r,unsentEntries:i}=AN(this._heartbeatsCache.heartbeats),s=zu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function tv(){return new Date().toISOString().substring(0,10)}function AN(n,e=wN){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),nv(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),nv(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class RN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return va()?hx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await IN(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return ev(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return ev(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function nv(n){return zu(JSON.stringify({version:2,heartbeats:n})).length}function SN(n){Ur(new $n("platform-logger",e=>new Fx(e),"PRIVATE")),Ur(new $n("heartbeat",e=>new TN(e),"PRIVATE")),Fn(wf,Zy,n),Fn(wf,Zy,"esm2017"),Fn("fire-js","")}SN("");const bN=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:Jr,_DEFAULT_ENTRY_NAME:Mr,_addComponent:Hu,_addOrOverwriteComponent:yw,_apps:Fr,_clearComponents:fN,_components:Ia,_getProvider:vw,_registerComponent:Ur,_removeServiceInstance:dN,deleteApp:Iw,getApp:mN,getApps:_N,initializeApp:vp,onLog:ww,registerVersion:Fn,setLogLevel:Ew,FirebaseError:Dt},Symbol.toStringTag,{value:"Module"}));class PN{constructor(e,t){this._delegate=e,this.firebase=t,Hu(e,new $n("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Iw(this._delegate)))}_getService(e,t=Mr){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=Mr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Hu(this._delegate,e)}_addOrOverwriteComponent(e){yw(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const CN={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},rv=new zi("app-compat","Firebase",CN);function DN(n){const e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Fn,setLogLevel:Ew,onLog:ww,apps:null,SDK_VERSION:Jr,INTERNAL:{registerComponent:l,removeApp:r,useAsService:h,modularAPIs:bN}};t.default=t,Object.defineProperty(t,"apps",{get:a});function r(f){delete e[f]}function i(f){if(f=f||Mr,!jy(e,f))throw rv.create("no-app",{appName:f});return e[f]}i.App=n;function s(f,p={}){const m=vp(f,p);if(jy(e,m.name))return e[m.name];const I=new n(m,t);return e[m.name]=I,I}function a(){return Object.keys(e).map(f=>e[f])}function l(f){const p=f.name,m=p.replace("-compat","");if(Ur(f)&&f.type==="PUBLIC"){const I=(A=i())=>{if(typeof A[m]!="function")throw rv.create("invalid-app-argument",{appName:p});return A[m]()};f.serviceProps!==void 0&&Ku(I,f.serviceProps),t[m]=I,n.prototype[m]=function(...A){return this._getService.bind(this,p).apply(this,f.multipleInstances?A:[])}}return f.type==="PUBLIC"?t[m]:null}function h(f,p){return p==="serverAuth"?null:p}return t}function Rw(){const n=DN(PN);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:Rw,extendNamespace:e,createSubscribe:pw,ErrorFactory:zi,deepExtend:Ku});function e(t){Ku(n,t)}return n}const kN=Rw();const iv=new Al("@firebase/app-compat"),xN="@firebase/app-compat",NN="0.2.25";function VN(n){Fn(xN,NN,n)}if(ux()&&self.firebase!==void 0){iv.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&iv.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const Br=kN;VN();var ON="firebase",LN="10.7.1";Br.registerVersion(ON,LN,"app-compat");function Ip(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}const Bo={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},_s={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function MN(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is incorrect, malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-password"]:"A non-empty password must be provided",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.",["missing-recaptcha-token"]:"The reCAPTCHA token is missing when sending request to the backend.",["invalid-recaptcha-token"]:"The reCAPTCHA token is invalid when sending request to the backend.",["invalid-recaptcha-action"]:"The reCAPTCHA action is invalid when sending request to the backend.",["recaptcha-not-enabled"]:"reCAPTCHA Enterprise integration is not enabled for this project.",["missing-client-type"]:"The reCAPTCHA client type is missing when sending request to the backend.",["missing-recaptcha-version"]:"The reCAPTCHA version is missing when sending request to the backend.",["invalid-req-type"]:"Invalid request parameters.",["invalid-recaptcha-version"]:"The reCAPTCHA version is invalid when sending request to the backend.",["unsupported-password-policy-schema-version"]:"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.",["password-does-not-meet-requirements"]:"The password does not meet the requirements."}}function Sw(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FN=MN,UN=Sw,bw=new zi("auth","Firebase",Sw());const ju=new Al("@firebase/auth");function BN(n,...e){ju.logLevel<=ue.WARN&&ju.warn(`Auth (${Jr}): ${n}`,...e)}function Nu(n,...e){ju.logLevel<=ue.ERROR&&ju.error(`Auth (${Jr}): ${n}`,...e)}function _t(n,...e){throw wp(n,...e)}function gt(n,...e){return wp(n,...e)}function Pw(n,e,t){const r=Object.assign(Object.assign({},UN()),{[e]:t});return new zi("auth","Firebase",r).create(e,{appName:n.name})}function no(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&_t(n,"argument-error"),Pw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function wp(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return bw.create(n,...e)}function O(n,e,...t){if(!n)throw wp(e,...t)}function Nn(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Nu(e),new Error(e)}function vn(n,e){n||Nn(e)}function Ea(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Ep(){return sv()==="http:"||sv()==="https:"}function sv(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function qN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ep()||dw()||"connection"in navigator)?navigator.onLine:!0}function $N(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Za{constructor(e,t){this.shortDelay=e,this.longDelay=t,vn(t>e,"Short delay should be less than long delay!"),this.isMobile=cx()||mp()}get(){return qN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Tp(n,e){vn(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Cw{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Nn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Nn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Nn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const WN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const GN=new Za(3e4,6e4);function ze(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ke(n,e,t,r,i={}){return Dw(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const l=to(Object.assign({key:n.config.apiKey},a)).slice(1),h=await n._getAdditionalHeaders();return h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode),Cw.fetch()(kw(n,n.config.apiHost,t,l),Object.assign({method:e,headers:h,referrerPolicy:"no-referrer"},s))})}async function Dw(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},WN),e);try{const i=new KN(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw na(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const l=s.ok?a.errorMessage:a.error.message,[h,f]=l.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw na(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw na(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw na(n,"user-disabled",a);const p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw Pw(n,p,f);_t(n,p)}}catch(i){if(i instanceof Dt)throw i;_t(n,"network-request-failed",{message:String(i)})}}async function dr(n,e,t,r,i={}){const s=await Ke(n,e,t,r,i);return"mfaPendingCredential"in s&&_t(n,"multi-factor-auth-required",{_serverResponse:s}),s}function kw(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?Tp(n.config,i):`${n.config.apiScheme}://${i}`}function zN(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class KN{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(gt(this.auth,"network-request-failed")),GN.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function na(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=gt(n,e,r);return i.customData._tokenResponse=t,i}function ov(n){return n!==void 0&&n.getResponse!==void 0}function av(n){return n!==void 0&&n.enterprise!==void 0}class HN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return zN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function jN(n){return(await Ke(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function QN(n,e){return Ke(n,"GET","/v2/recaptchaConfig",ze(n,e))}async function YN(n,e){return Ke(n,"POST","/v1/accounts:delete",e)}async function JN(n,e){return Ke(n,"POST","/v1/accounts:update",e)}async function XN(n,e){return Ke(n,"POST","/v1/accounts:lookup",e)}function ua(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ZN(n,e=!1){const t=H(n),r=await t.getIdToken(e),i=Rl(r);O(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:ua(Jd(i.auth_time)),issuedAtTime:ua(Jd(i.iat)),expirationTime:ua(Jd(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Jd(n){return Number(n)*1e3}function Rl(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Nu("JWT malformed, contained fewer than 3 sections"),null;try{const i=lw(t);return i?JSON.parse(i):(Nu("Failed to decode base64 JWT payload"),null)}catch(i){return Nu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function eV(n){const e=Rl(n);return O(e,"internal-error"),O(typeof e.exp<"u","internal-error"),O(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ur(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Dt&&tV(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function tV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class nV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class xw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ua(this.lastLoginAt),this.creationTime=ua(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ta(n){var e;const t=n.auth,r=await n.getIdToken(),i=await ur(n,XN(t,{idToken:r}));O(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?sV(s.providerUserInfo):[],l=iV(n.providerData,a),h=n.isAnonymous,f=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=h?f:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new xw(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)}async function rV(n){const e=H(n);await Ta(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function iV(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function sV(n){return n.map(e=>{var{providerId:t}=e,r=Ip(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function oV(n,e){const t=await Dw(n,{},async()=>{const r=to({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=kw(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",Cw.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function aV(n,e){return Ke(n,"POST","/v2/accounts:revokeToken",ze(n,e))}class Aa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){O(e.idToken,"internal-error"),O(typeof e.idToken<"u","internal-error"),O(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):eV(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return O(!this.accessToken||this.refreshToken,e,"user-token-expired"),!t&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await oV(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new Aa;return r&&(O(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(O(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(O(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Aa,this.toJSON())}_performRefresh(){return Nn("not implemented")}}function br(n,e){O(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Pi{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Ip(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new xw(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ur(this,this.stsTokenManager.getToken(this.auth,e));return O(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return ZN(this,e)}reload(){return rV(this)}_assign(e){this!==e&&(O(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Pi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){O(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Ta(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ur(this,YN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,l,h,f,p;const m=(r=t.displayName)!==null&&r!==void 0?r:void 0,I=(i=t.email)!==null&&i!==void 0?i:void 0,A=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,L=(a=t.photoURL)!==null&&a!==void 0?a:void 0,M=(l=t.tenantId)!==null&&l!==void 0?l:void 0,V=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,Y=(f=t.createdAt)!==null&&f!==void 0?f:void 0,ae=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:j,emailVerified:ye,isAnonymous:de,providerData:me,stsTokenManager:we}=t;O(j&&we,e,"internal-error");const Nt=Aa.fromJSON(this.name,we);O(typeof j=="string",e,"internal-error"),br(m,e.name),br(I,e.name),O(typeof ye=="boolean",e,"internal-error"),O(typeof de=="boolean",e,"internal-error"),br(A,e.name),br(L,e.name),br(M,e.name),br(V,e.name),br(Y,e.name),br(ae,e.name);const Kn=new Pi({uid:j,auth:e,email:I,emailVerified:ye,displayName:m,isAnonymous:de,photoURL:L,phoneNumber:A,tenantId:M,stsTokenManager:Nt,createdAt:Y,lastLoginAt:ae});return me&&Array.isArray(me)&&(Kn.providerData=me.map(es=>Object.assign({},es))),V&&(Kn._redirectEventId=V),Kn}static async _fromIdTokenResponse(e,t,r=!1){const i=new Aa;i.updateFromServerResponse(t);const s=new Pi({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Ta(s),s}}const cv=new Map;function Yt(n){vn(n instanceof Function,"Expected a class definition");let e=cv.get(n);return e?(vn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,cv.set(n,e),e)}class Nw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Nw.type="NONE";const Bs=Nw;function Ci(n,e,t){return`firebase:${n}:${e}:${t}`}class ks{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Ci(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ci("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Pi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new ks(Yt(Bs),e,r);const i=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let s=i[0]||Yt(Bs);const a=Ci(r,e.config.apiKey,e.name);let l=null;for(const f of t)try{const p=await f._get(a);if(p){const m=Pi._fromJSON(e,p);f!==s&&(l=m),s=f;break}}catch{}const h=i.filter(f=>f._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new ks(s,e,r):(s=h[0],l&&await s._set(a,l.toJSON()),await Promise.all(t.map(async f=>{if(f!==s)try{await f._remove(a)}catch{}})),new ks(s,e,r))}}function uv(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Lw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Vw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Mw(e))return"Blackberry";if(Fw(e))return"Webos";if(Ap(e))return"Safari";if((e.includes("chrome/")||Ow(e))&&!e.includes("edge/"))return"Chrome";if(ec(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Vw(n=Ue()){return/firefox\//i.test(n)}function Ap(n=Ue()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ow(n=Ue()){return/crios\//i.test(n)}function Lw(n=Ue()){return/iemobile/i.test(n)}function ec(n=Ue()){return/android/i.test(n)}function Mw(n=Ue()){return/blackberry/i.test(n)}function Fw(n=Ue()){return/webos/i.test(n)}function ro(n=Ue()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function cV(n=Ue()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function uV(n=Ue()){var e;return ro(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function lV(){return fw()&&document.documentMode===10}function Uw(n=Ue()){return ro(n)||ec(n)||Fw(n)||Mw(n)||/windows phone/i.test(n)||Lw(n)}function hV(){try{return!!(window&&window!==window.top)}catch{return!1}}function Bw(n,e=[]){let t;switch(n){case"Browser":t=uv(Ue());break;case"Worker":t=`${uv(Ue())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Jr}/${r}`}class dV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,l)=>{try{const h=e(s);a(h)}catch(h){l(h)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}async function fV(n,e={}){return Ke(n,"GET","/v2/passwordPolicy",ze(n,e))}const pV=6;class gV{constructor(e){var t,r,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:pV,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,l;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(l=h.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),h}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class mV{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lv(this),this.idTokenSubscription=new lv(this),this.beforeStateQueue=new dV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Yt(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ks.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===l)&&(h!=null&&h.user)&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return O(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ta(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$N()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?H(e):null;return t&&O(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&O(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Yt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await fV(this),t=new gV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new zi("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await aV(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Yt(e)||this._popupRedirectResolver;O(t,this,"argument-error"),this.redirectPersistenceManager=await ks.create(this,[Yt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(O(l,this,"internal-error"),l.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{const h=e.addObserver(t);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return O(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Bw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&BN(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function $e(n){return H(n)}class lv{constructor(e){this.auth=e,this.observer=null,this.addObserver=pw(t=>this.observer=t)}get next(){return O(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function _V(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}function Rp(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=gt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",_V().appendChild(r)})}function qw(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const yV="https://www.google.com/recaptcha/enterprise.js?render=",vV="recaptcha-enterprise",IV="NO_RECAPTCHA";class wV{constructor(e){this.type=vV,this.auth=$e(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,l)=>{QN(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const f=new HN(h);return s.tenantId==null?s._agentRecaptchaConfig=f:s._tenantRecaptchaConfigs[s.tenantId]=f,a(f.siteKey)}}).catch(h=>{l(h)})})}function i(s,a,l){const h=window.grecaptcha;av(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(f=>{a(f)}).catch(()=>{a(IV)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(l=>{if(!t&&av(window.grecaptcha))i(l,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}Rp(yV+l).then(()=>{i(l,s,a)}).catch(h=>{a(h)})}}).catch(l=>{a(l)})})}}async function hv(n,e,t,r=!1){const i=new wV(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Ra(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await hv(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await hv(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)})}function EV(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Yt);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function TV(n,e,t){const r=$e(n);O(r._canInitEmulator,r,"emulator-config-failed"),O(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=$w(e),{host:a,port:l}=AV(e),h=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||RV()}function $w(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function AV(n){const e=$w(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:dv(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:dv(a)}}}function dv(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function RV(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class io{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Nn("not implemented")}_getIdTokenResponse(e){return Nn("not implemented")}_linkToIdToken(e,t){return Nn("not implemented")}_getReauthenticationResolver(e){return Nn("not implemented")}}async function Ww(n,e){return Ke(n,"POST","/v1/accounts:resetPassword",ze(n,e))}async function SV(n,e){return Ke(n,"POST","/v1/accounts:update",e)}async function bV(n,e){return Ke(n,"POST","/v1/accounts:signUp",e)}async function PV(n,e){return Ke(n,"POST","/v1/accounts:update",ze(n,e))}async function CV(n,e){return dr(n,"POST","/v1/accounts:signInWithPassword",ze(n,e))}async function Sl(n,e){return Ke(n,"POST","/v1/accounts:sendOobCode",ze(n,e))}async function DV(n,e){return Sl(n,e)}async function kV(n,e){return Sl(n,e)}async function xV(n,e){return Sl(n,e)}async function NV(n,e){return Sl(n,e)}async function VV(n,e){return dr(n,"POST","/v1/accounts:signInWithEmailLink",ze(n,e))}async function OV(n,e){return dr(n,"POST","/v1/accounts:signInWithEmailLink",ze(n,e))}class Sa extends io{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Sa(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Sa(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ra(e,t,"signInWithPassword",CV);case"emailLink":return VV(e,{email:this._email,oobCode:this._password});default:_t(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ra(e,r,"signUpPassword",bV);case"emailLink":return OV(e,{idToken:t,email:this._email,oobCode:this._password});default:_t(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ar(n,e){return dr(n,"POST","/v1/accounts:signInWithIdp",ze(n,e))}const LV="http://localhost";class Wn extends io{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Wn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_t("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Ip(t,["providerId","signInMethod"]);if(!r||!i)return null;const a=new Wn(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return ar(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ar(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ar(e,t)}buildRequest(){const e={requestUri:LV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=to(t)}return e}}async function MV(n,e){return Ke(n,"POST","/v1/accounts:sendVerificationCode",ze(n,e))}async function FV(n,e){return dr(n,"POST","/v1/accounts:signInWithPhoneNumber",ze(n,e))}async function UV(n,e){const t=await dr(n,"POST","/v1/accounts:signInWithPhoneNumber",ze(n,e));if(t.temporaryProof)throw na(n,"account-exists-with-different-credential",t);return t}const BV={USER_NOT_FOUND:"user-not-found"};async function qV(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return dr(n,"POST","/v1/accounts:signInWithPhoneNumber",ze(n,t),BV)}class Di extends io{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Di({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Di({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return FV(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return UV(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return qV(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new Di({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}}function $V(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function WV(n){const e=Cs(ta(n)).link,t=e?Cs(ta(e)).deep_link_id:null,r=Cs(ta(n)).deep_link_id;return(r?Cs(ta(r)).link:null)||r||t||e||n}class bl{constructor(e){var t,r,i,s,a,l;const h=Cs(ta(e)),f=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,m=$V((i=h.mode)!==null&&i!==void 0?i:null);O(f&&p&&m,"argument-error"),this.apiKey=f,this.operation=m,this.code=p,this.continueUrl=(s=h.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(l=h.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=WV(e);try{return new bl(t)}catch{return null}}}class Xr{constructor(){this.providerId=Xr.PROVIDER_ID}static credential(e,t){return Sa._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=bl.parseLink(t);return O(r,"argument-error"),Sa._fromEmailAndCode(e,r.code,r.tenantId)}}Xr.PROVIDER_ID="password";Xr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Xr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class fr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class so extends fr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class xs extends so{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return O("providerId"in t&&"signInMethod"in t,"argument-error"),Wn._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return O(e.idToken||e.accessToken,"argument-error"),Wn._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return xs.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return xs.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:a,providerId:l}=e;if(!r&&!i&&!t&&!s||!l)return null;try{return new xs(l)._credential({idToken:t,accessToken:r,nonce:a,pendingToken:s})}catch{return null}}}class Pn extends so{constructor(){super("facebook.com")}static credential(e){return Wn._fromParams({providerId:Pn.PROVIDER_ID,signInMethod:Pn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pn.credentialFromTaggedObject(e)}static credentialFromError(e){return Pn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pn.credential(e.oauthAccessToken)}catch{return null}}}Pn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Pn.PROVIDER_ID="facebook.com";class Cn extends so{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Wn._fromParams({providerId:Cn.PROVIDER_ID,signInMethod:Cn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Cn.credentialFromTaggedObject(e)}static credentialFromError(e){return Cn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Cn.credential(t,r)}catch{return null}}}Cn.GOOGLE_SIGN_IN_METHOD="google.com";Cn.PROVIDER_ID="google.com";class Dn extends so{constructor(){super("github.com")}static credential(e){return Wn._fromParams({providerId:Dn.PROVIDER_ID,signInMethod:Dn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Dn.credentialFromTaggedObject(e)}static credentialFromError(e){return Dn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Dn.credential(e.oauthAccessToken)}catch{return null}}}Dn.GITHUB_SIGN_IN_METHOD="github.com";Dn.PROVIDER_ID="github.com";const GV="http://localhost";class qs extends io{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return ar(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ar(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ar(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new qs(r,s)}static _create(e,t){return new qs(e,t)}buildRequest(){return{requestUri:GV,returnSecureToken:!0,pendingToken:this.pendingToken}}}const zV="saml.";class Qu extends fr{constructor(e){O(e.startsWith(zV),"argument-error"),super(e)}static credentialFromResult(e){return Qu.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Qu.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=qs.fromJSON(e);return O(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return qs._create(r,t)}catch{return null}}}class kn extends so{constructor(){super("twitter.com")}static credential(e,t){return Wn._fromParams({providerId:kn.PROVIDER_ID,signInMethod:kn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return kn.credentialFromTaggedObject(e)}static credentialFromError(e){return kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return kn.credential(t,r)}catch{return null}}}kn.TWITTER_SIGN_IN_METHOD="twitter.com";kn.PROVIDER_ID="twitter.com";async function Gw(n,e){return dr(n,"POST","/v1/accounts:signUp",ze(n,e))}class ln{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Pi._fromIdTokenResponse(e,r,i),a=fv(r);return new ln({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=fv(r);return new ln({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function fv(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function KV(n){var e;const t=$e(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new ln({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await Gw(t,{returnSecureToken:!0}),i=await ln._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(i.user),i}class Yu extends Dt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Yu.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Yu(e,t,r,i)}}function zw(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Yu._fromErrorAndOperation(n,s,e,r):s})}function Kw(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}async function HV(n,e){const t=H(n);await Pl(!0,t,e);const{providerUserInfo:r}=await JN(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=Kw(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Sp(n,e,t=!1){const r=await ur(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ln._forOperation(n,"link",r)}async function Pl(n,e,t){await Ta(e);const r=Kw(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";O(r.has(t)===n,e.auth,i)}async function Hw(n,e,t=!1){const{auth:r}=n,i="reauthenticate";try{const s=await ur(n,zw(r,i,e,n),t);O(s.idToken,r,"internal-error");const a=Rl(s.idToken);O(a,r,"internal-error");const{sub:l}=a;return O(n.uid===l,r,"user-mismatch"),ln._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&_t(r,"user-mismatch"),s}}async function jw(n,e,t=!1){const r="signIn",i=await zw(n,r,e),s=await ln._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function Cl(n,e){return jw($e(n),e)}async function Qw(n,e){const t=H(n);return await Pl(!1,t,e.providerId),Sp(t,e)}async function Yw(n,e){return Hw(H(n),e)}async function jV(n,e){return dr(n,"POST","/v1/accounts:signInWithCustomToken",ze(n,e))}async function QV(n,e){const t=$e(n),r=await jV(t,{token:e,returnSecureToken:!0}),i=await ln._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}class tc{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?bp._fromServerResponse(e,t):"totpInfo"in t?Pp._fromServerResponse(e,t):_t(e,"internal-error")}}class bp extends tc{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new bp(t)}}class Pp extends tc{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Pp(t)}}function Dl(n,e,t){var r;O(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),O(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(O(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(O(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function Cp(n){const e=$e(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function YV(n,e,t){const r=$e(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Dl(r,i,t),await Ra(r,i,"getOobCode",kV)}async function JV(n,e,t){await Ww(H(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Cp(n),r})}async function XV(n,e){await PV(H(n),{oobCode:e})}async function Jw(n,e){const t=H(n),r=await Ww(t,{oobCode:e}),i=r.requestType;switch(O(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":O(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":O(r.mfaInfo,t,"internal-error");default:O(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=tc._fromServerResponse($e(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function ZV(n,e){const{data:t}=await Jw(H(n),e);return t.email}async function eO(n,e,t){const r=$e(n),a=await Ra(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Gw).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&Cp(n),h}),l=await ln._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function tO(n,e,t){return Cl(H(n),Xr.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Cp(n),r})}async function nO(n,e,t){const r=$e(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(a,l){O(l.handleCodeInApp,r,"argument-error"),l&&Dl(r,a,l)}s(i,t),await Ra(r,i,"getOobCode",xV)}function rO(n,e){const t=bl.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function iO(n,e,t){const r=H(n),i=Xr.credentialWithLink(e,t||Ea());return O(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Cl(r,i)}async function sO(n,e){return Ke(n,"POST","/v1/accounts:createAuthUri",ze(n,e))}async function oO(n,e){const t=Ep()?Ea():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await sO(H(n),r);return i||[]}async function aO(n,e){const t=H(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Dl(t.auth,i,e);const{email:s}=await DV(t.auth,i);s!==n.email&&await n.reload()}async function cO(n,e,t){const r=H(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Dl(r.auth,s,t);const{email:a}=await NV(r.auth,s);a!==n.email&&await n.reload()}async function uO(n,e){return Ke(n,"POST","/v1/accounts:update",e)}async function lO(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=H(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},a=await ur(r,uO(r.auth,s));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const l=r.providerData.find(({providerId:h})=>h==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function hO(n,e){return Xw(H(n),e,null)}function dO(n,e){return Xw(H(n),null,e)}async function Xw(n,e,t){const{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);const a=await ur(n,SV(r,s));await n._updateTokensIfNecessary(a,!0)}function fO(n){var e,t;if(!n)return null;const{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const a=(t=(e=Rl(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(a){const l=a!=="anonymous"&&a!=="custom"?a:null;return new Ns(s,l)}}if(!r)return null;switch(r){case"facebook.com":return new pO(s,i);case"github.com":return new gO(s,i);case"google.com":return new mO(s,i);case"twitter.com":return new _O(s,i,n.screenName||null);case"custom":case"anonymous":return new Ns(s,null);default:return new Ns(s,r,i)}}class Ns{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class Zw extends Ns{constructor(e,t,r,i){super(e,t,r),this.username=i}}class pO extends Ns{constructor(e,t){super(e,"facebook.com",t)}}class gO extends Zw{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class mO extends Ns{constructor(e,t){super(e,"google.com",t)}}class _O extends Zw{constructor(e,t,r){super(e,"twitter.com",t,r)}}function yO(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:fO(t)}class Ti{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new Ti("enroll",e,t)}static _fromMfaPendingCredential(e){return new Ti("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return Ti._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Ti._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Dp{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=$e(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(l=>tc._fromServerResponse(r,l));O(i.mfaPendingCredential,r,"internal-error");const a=Ti._fromMfaPendingCredential(i.mfaPendingCredential);return new Dp(a,s,async l=>{const h=await l._process(r,a);delete i.mfaInfo,delete i.mfaPendingCredential;const f=Object.assign(Object.assign({},i),{idToken:h.idToken,refreshToken:h.refreshToken});switch(t.operationType){case"signIn":const p=await ln._fromIdTokenResponse(r,t.operationType,f);return await r._updateCurrentUser(p.user),p;case"reauthenticate":return O(t.user,r,"internal-error"),ln._forOperation(t.user,t.operationType,f);default:_t(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function vO(n,e){var t;const r=H(n),i=e;return O(e.customData.operationType,r,"argument-error"),O((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),Dp._fromError(r,i)}function IO(n,e){return Ke(n,"POST","/v2/accounts/mfaEnrollment:start",ze(n,e))}function wO(n,e){return Ke(n,"POST","/v2/accounts/mfaEnrollment:finalize",ze(n,e))}function EO(n,e){return Ke(n,"POST","/v2/accounts/mfaEnrollment:withdraw",ze(n,e))}class kp{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>tc._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new kp(e)}async getSession(){return Ti._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),s=await ur(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await ur(this.user,EO(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Xd=new WeakMap;function TO(n){const e=H(n);return Xd.has(e)||Xd.set(e,kp._fromUser(e)),Xd.get(e)}const Ju="__sak";class eE{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ju,"1"),this.storage.removeItem(Ju),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}function AO(){const n=Ue();return Ap(n)||ro(n)}const RO=1e3,SO=10;class tE extends eE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=AO()&&hV(),this.fallbackToPolling=Uw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,l,h)=>{this.notifyListeners(a,h)});return}const r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(r);if(e.newValue!==a)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);lV()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,SO):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},RO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}tE.type="LOCAL";const xp=tE;class nE extends eE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}nE.type="SESSION";const Ni=nE;function bO(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class kl{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new kl(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(a).map(async f=>f(t.origin,s)),h=await bO(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}kl.receivers=[];function nc(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class PO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((l,h)=>{const f=nc("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(m){const I=m;if(I.data.eventId===f)switch(I.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(I.data.response);break;default:clearTimeout(p),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Xe(){return window}function CO(n){Xe().location.href=n}function Np(){return typeof Xe().WorkerGlobalScope<"u"&&typeof Xe().importScripts=="function"}async function DO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function kO(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function xO(){return Np()?self:null}const rE="firebaseLocalStorageDb",NO=1,Xu="firebaseLocalStorage",iE="fbase_key";class rc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function xl(n,e){return n.transaction([Xu],e?"readwrite":"readonly").objectStore(Xu)}function VO(){const n=indexedDB.deleteDatabase(rE);return new rc(n).toPromise()}function Ef(){const n=indexedDB.open(rE,NO);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Xu,{keyPath:iE})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Xu)?e(r):(r.close(),await VO(),e(await Ef()))})})}async function pv(n,e,t){const r=xl(n,!0).put({[iE]:e,value:t});return new rc(r).toPromise()}async function OO(n,e){const t=xl(n,!1).get(e),r=await new rc(t).toPromise();return r===void 0?null:r.value}function gv(n,e){const t=xl(n,!0).delete(e);return new rc(t).toPromise()}const LO=800,MO=3;class sE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ef(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>MO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Np()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=kl._getInstance(xO()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await DO(),!this.activeServiceWorker)return;this.sender=new PO(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||kO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ef();return await pv(e,Ju,"1"),await gv(e,Ju),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>pv(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>OO(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>gv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=xl(i,!1).getAll();return new rc(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),LO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}sE.type="LOCAL";const ba=sE;function FO(n,e){return Ke(n,"POST","/v2/accounts/mfaSignIn:start",ze(n,e))}function UO(n,e){return Ke(n,"POST","/v2/accounts/mfaSignIn:finalize",ze(n,e))}const BO=500,qO=6e4,vu=1e12;class $O{constructor(e){this.auth=e,this.counter=vu,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new WO(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||vu;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||vu;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||vu;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class WO{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;O(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=GO(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},qO)},BO))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function GO(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const Zd=qw("rcb"),zO=new Za(3e4,6e4),KO="https://www.google.com/recaptcha/api.js?";class HO{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Xe().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return O(jO(t),e,"argument-error"),this.shouldResolveImmediately(t)&&ov(Xe().grecaptcha)?Promise.resolve(Xe().grecaptcha):new Promise((r,i)=>{const s=Xe().setTimeout(()=>{i(gt(e,"network-request-failed"))},zO.get());Xe()[Zd]=()=>{Xe().clearTimeout(s),delete Xe()[Zd];const l=Xe().grecaptcha;if(!l||!ov(l)){i(gt(e,"internal-error"));return}const h=l.render;l.render=(f,p)=>{const m=h(f,p);return this.counter++,m},this.hostLanguage=t,r(l)};const a=`${KO}?${to({onload:Zd,render:"explicit",hl:t})}`;Rp(a).catch(()=>{clearTimeout(s),i(gt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=Xe().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function jO(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class QO{async load(e){return new $O(e)}clearedOneInstance(){}}const oE="recaptcha",YO={theme:"light",type:"image"};let JO=class{constructor(e,t,r=Object.assign({},YO)){this.parameters=r,this.type=oE,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=$e(e),this.isInvisible=this.parameters.size==="invisible",O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;O(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new QO:new HO,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const s=a=>{a&&(this.tokenChangeListeners.delete(s),i(a))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){O(!this.parameters.sitekey,this.auth,"argument-error"),O(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=Xe()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){O(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){O(Ep()&&!Np(),this.auth,"internal-error"),await XO(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await jN(this.auth);O(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return O(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function XO(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}class Vp{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Di._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function ZO(n,e,t){const r=$e(n),i=await Nl(r,e,H(t));return new Vp(i,s=>Cl(r,s))}async function eL(n,e,t){const r=H(n);await Pl(!1,r,"phone");const i=await Nl(r.auth,e,H(t));return new Vp(i,s=>Qw(r,s))}async function tL(n,e,t){const r=H(n),i=await Nl(r.auth,e,H(t));return new Vp(i,s=>Yw(r,s))}async function Nl(n,e,t){var r;const i=await t.verify();try{O(typeof i=="string",n,"argument-error"),O(t.type===oE,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const a=s.session;if("phoneNumber"in s)return O(a.type==="enroll",n,"internal-error"),(await IO(n,{idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{O(a.type==="signin",n,"internal-error");const l=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return O(l,n,"missing-multi-factor-info"),(await FO(n,{mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:a}=await MV(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return a}}finally{t._reset()}}async function nL(n,e){await Sp(H(n),e)}let Un=class{constructor(e){this.providerId=Un.PROVIDER_ID,this.auth=$e(e)}verifyPhoneNumber(e,t){return Nl(this.auth,e,H(t))}static credential(e,t){return Di._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Un.credentialFromTaggedObject(t)}static credentialFromError(e){return Un.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?Di._fromTokenResponse(t,r):null}};Un.PROVIDER_ID="phone";Un.PHONE_SIGN_IN_METHOD="phone";function Ki(n,e){return e?Yt(e):(O(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Op extends io{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ar(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ar(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ar(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function rL(n){return jw(n.auth,new Op(n),n.bypassAuthState)}function iL(n){const{auth:e,user:t}=n;return O(t,e,"internal-error"),Hw(t,new Op(n),n.bypassAuthState)}async function sL(n){const{auth:e,user:t}=n;return O(t,e,"internal-error"),Sp(t,new Op(n),n.bypassAuthState)}class aE{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:l}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(h))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return rL;case"linkViaPopup":case"linkViaRedirect":return sL;case"reauthViaPopup":case"reauthViaRedirect":return iL;default:_t(this.auth,"internal-error")}}resolve(e){vn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){vn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const oL=new Za(2e3,1e4);async function aL(n,e,t){const r=$e(n);no(n,e,fr);const i=Ki(r,t);return new rr(r,"signInViaPopup",e,i).executeNotNull()}async function cL(n,e,t){const r=H(n);no(r.auth,e,fr);const i=Ki(r.auth,t);return new rr(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function uL(n,e,t){const r=H(n);no(r.auth,e,fr);const i=Ki(r.auth,t);return new rr(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class rr extends aE{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,rr.currentPopupAction&&rr.currentPopupAction.cancel(),rr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return O(e,this.auth,"internal-error"),e}async onExecution(){vn(this.filter.length===1,"Popup operations only handle one event");const e=nc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(gt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(gt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,rr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(gt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,oL.get())};e()}}rr.currentPopupAction=null;const lL="pendingRedirect",la=new Map;class hL extends aE{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=la.get(this.auth._key());if(!e){try{const r=await dL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}la.set(this.auth._key(),e)}return this.bypassAuthState||la.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function dL(n,e){const t=uE(e),r=cE(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function Lp(n,e){return cE(n)._set(uE(e),"true")}function fL(){la.clear()}function Mp(n,e){la.set(n._key(),e)}function cE(n){return Yt(n._redirectPersistence)}function uE(n){return Ci(lL,n.config.apiKey,n.name)}function pL(n,e,t){return gL(n,e,t)}async function gL(n,e,t){const r=$e(n);no(n,e,fr),await r._initializationPromise;const i=Ki(r,t);return await Lp(i,r),i._openRedirect(r,e,"signInViaRedirect")}function mL(n,e,t){return _L(n,e,t)}async function _L(n,e,t){const r=H(n);no(r.auth,e,fr),await r.auth._initializationPromise;const i=Ki(r.auth,t);await Lp(i,r.auth);const s=await lE(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function yL(n,e,t){return vL(n,e,t)}async function vL(n,e,t){const r=H(n);no(r.auth,e,fr),await r.auth._initializationPromise;const i=Ki(r.auth,t);await Pl(!1,r,e.providerId),await Lp(i,r.auth);const s=await lE(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function IL(n,e){return await $e(n)._initializationPromise,Vl(n,e,!1)}async function Vl(n,e,t=!1){const r=$e(n),i=Ki(r,e),a=await new hL(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}async function lE(n){const e=nc(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}const wL=10*60*1e3;class hE{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!EL(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!dE(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(gt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=wL&&this.cachedEventUids.clear(),this.cachedEventUids.has(mv(e))}saveEventToCache(e){this.cachedEventUids.add(mv(e)),this.lastProcessedEventTime=Date.now()}}function mv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function dE({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function EL(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return dE(n);default:return!1}}async function fE(n,e={}){return Ke(n,"GET","/v1/projects",e)}const TL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,AL=/^https?/;async function RL(n){if(n.config.emulator)return;const{authorizedDomains:e}=await fE(n);for(const t of e)try{if(SL(t))return}catch{}_t(n,"unauthorized-domain")}function SL(n){const e=Ea(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!AL.test(t))return!1;if(TL.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const bL=new Za(3e4,6e4);function _v(){const n=Xe().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function PL(n){return new Promise((e,t)=>{var r,i,s;function a(){_v(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_v(),t(gt(n,"network-request-failed"))},timeout:bL.get()})}if(!((i=(r=Xe().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Xe().gapi)===null||s===void 0)&&s.load)a();else{const l=qw("iframefcb");return Xe()[l]=()=>{gapi.load?a():t(gt(n,"network-request-failed"))},Rp(`https://apis.google.com/js/api.js?onload=${l}`).catch(h=>t(h))}}).catch(e=>{throw Vu=null,e})}let Vu=null;function CL(n){return Vu=Vu||PL(n),Vu}const DL=new Za(5e3,15e3),kL="__/auth/iframe",xL="emulator/auth/iframe",NL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},VL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function OL(n){const e=n.config;O(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Tp(e,xL):`https://${n.config.authDomain}/${kL}`,r={apiKey:e.apiKey,appName:n.name,v:Jr},i=VL.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${to(r).slice(1)}`}async function LL(n){const e=await CL(n),t=Xe().gapi;return O(t,n,"internal-error"),e.open({where:document.body,url:OL(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:NL,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=gt(n,"network-request-failed"),l=Xe().setTimeout(()=>{s(a)},DL.get());function h(){Xe().clearTimeout(l),i(r)}r.ping(h).then(h,()=>{s(a)})}))}const ML={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},FL=500,UL=600,BL="_blank",qL="http://localhost";class yv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $L(n,e,t,r=FL,i=UL){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const h=Object.assign(Object.assign({},ML),{width:r.toString(),height:i.toString(),top:s,left:a}),f=Ue().toLowerCase();t&&(l=Ow(f)?BL:t),Vw(f)&&(e=e||qL,h.scrollbars="yes");const p=Object.entries(h).reduce((I,[A,L])=>`${I}${A}=${L},`,"");if(uV(f)&&l!=="_self")return WL(e||"",l),new yv(null);const m=window.open(e||"",l,p);O(m,n,"popup-blocked");try{m.focus()}catch{}return new yv(m)}function WL(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const GL="__/auth/handler",zL="emulator/auth/handler",KL=encodeURIComponent("fac");async function Tf(n,e,t,r,i,s){O(n.config.authDomain,n,"auth-domain-config-required"),O(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Jr,eventId:i};if(e instanceof fr){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",gx(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries(s||{}))a[p]=m}if(e instanceof so){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);const l=a;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const h=await n._getAppCheckToken(),f=h?`#${KL}=${encodeURIComponent(h)}`:"";return`${HL(n)}?${to(l).slice(1)}${f}`}function HL({config:n}){return n.emulator?Tp(n,zL):`https://${n.authDomain}/${GL}`}const ef="webStorageSupport";class jL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ni,this._completeRedirectFn=Vl,this._overrideRedirectResult=Mp}async _openPopup(e,t,r,i){var s;vn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Tf(e,t,r,Ea(),i);return $L(e,a,nc())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await Tf(e,t,r,Ea(),i);return CO(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(vn(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await LL(e),r=new hE(e);return t.register("authEvent",i=>(O(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ef,{type:ef},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[ef];a!==void 0&&t(!!a),_t(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=RL(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Uw()||Ap()||ro()}}const QL=jL;class YL{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Nn("unexpected MultiFactorSessionType")}}}class Fp extends YL{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Fp(e)}_finalizeEnroll(e,t,r){return wO(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return UO(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class pE{constructor(){}static assertion(e){return Fp._fromCredential(e)}}pE.FACTOR_ID="phone";var vv="@firebase/auth",Iv="1.5.1";class JL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){O(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function XL(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function ZL(n){Ur(new $n("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;O(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Bw(n)},f=new mV(r,i,s,h);return EV(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ur(new $n("auth-internal",e=>{const t=$e(e.getProvider("auth").getImmediate());return(r=>new JL(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fn(vv,Iv,XL(n)),Fn(vv,Iv,"esm2017")}const eM=5*60;sx("authIdTokenMaxAge");ZL("Browser");function Vi(){return window}const tM=2e3;async function nM(n,e,t){var r;const{BuildInfo:i}=Vi();vn(e.sessionId,"AuthEvent did not contain a session ID");const s=await aM(e.sessionId),a={};return ro()?a.ibi=i.packageName:ec()?a.apn=i.packageName:_t(n,"operation-not-supported-in-this-environment"),i.displayName&&(a.appDisplayName=i.displayName),a.sessionId=s,Tf(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,a)}async function rM(n){const{BuildInfo:e}=Vi(),t={};ro()?t.iosBundleId=e.packageName:ec()?t.androidPackageName=e.packageName:_t(n,"operation-not-supported-in-this-environment"),await fE(n,t)}function iM(n){const{cordova:e}=Vi();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,cV()?"_blank":"_system","location=yes"),t(i)})})}async function sM(n,e,t){const{cordova:r}=Vi();let i=()=>{};try{await new Promise((s,a)=>{let l=null;function h(){var m;s();const I=(m=r.plugins.browsertab)===null||m===void 0?void 0:m.close;typeof I=="function"&&I(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function f(){l||(l=window.setTimeout(()=>{a(gt(n,"redirect-cancelled-by-user"))},tM))}function p(){(document==null?void 0:document.visibilityState)==="visible"&&f()}e.addPassiveListener(h),document.addEventListener("resume",f,!1),ec()&&document.addEventListener("visibilitychange",p,!1),i=()=>{e.removePassiveListener(h),document.removeEventListener("resume",f,!1),document.removeEventListener("visibilitychange",p,!1),l&&window.clearTimeout(l)}})}finally{i()}}function oM(n){var e,t,r,i,s,a,l,h,f,p;const m=Vi();O(typeof((e=m==null?void 0:m.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),O(typeof((t=m==null?void 0:m.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),O(typeof((s=(i=(r=m==null?void 0:m.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((h=(l=(a=m==null?void 0:m.cordova)===null||a===void 0?void 0:a.plugins)===null||l===void 0?void 0:l.browsertab)===null||h===void 0?void 0:h.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((p=(f=m==null?void 0:m.cordova)===null||f===void 0?void 0:f.InAppBrowser)===null||p===void 0?void 0:p.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function aM(n){const e=cM(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function cM(n){if(vn(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}const uM=20;class lM extends hE{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function hM(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:pM(),postBody:null,tenantId:n.tenantId,error:gt(n,"no-auth-event")}}function dM(n,e){return Af()._set(Rf(n),e)}async function wv(n){const e=await Af()._get(Rf(n));return e&&await Af()._remove(Rf(n)),e}function fM(n,e){var t,r;const i=mM(e);if(i.includes("/__/auth/callback")){const s=Ou(i),a=s.firebaseError?gM(decodeURIComponent(s.firebaseError)):null,l=(r=(t=a==null?void 0:a.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],h=l?gt(l):null;return h?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:h,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function pM(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<uM;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function Af(){return Yt(xp)}function Rf(n){return Ci("authEvent",n.config.apiKey,n.name)}function gM(n){try{return JSON.parse(n)}catch{return null}}function mM(n){const e=Ou(n),t=e.link?decodeURIComponent(e.link):void 0,r=Ou(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Ou(i).link||i||r||t||n}function Ou(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return Cs(t.join("?"))}const _M=500;class yM{constructor(){this._redirectPersistence=Ni,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Vl,this._overrideRedirectResult=Mp}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new lM(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){_t(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){oM(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),fL(),await this._originValidation(e);const a=hM(e,r,i);await dM(e,a);const l=await nM(e,a,t),h=await iM(l);return sM(e,s,h)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=rM(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Vi(),a=setTimeout(async()=>{await wv(e),t.onEvent(Ev())},_M),l=async p=>{clearTimeout(a);const m=await wv(e);let I=null;m&&(p!=null&&p.url)&&(I=fM(m,p.url)),t.onEvent(I||Ev())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,l);const h=i,f=`${s.packageName.toLowerCase()}://`;Vi().handleOpenURL=async p=>{if(p.toLowerCase().startsWith(f)&&l({url:p}),typeof h=="function")try{h(p)}catch(m){console.error(m)}}}}const vM=yM;function Ev(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:gt("no-auth-event")}}function IM(n,e){$e(n)._logFramework(e)}var wM="@firebase/auth-compat",EM="0.5.1";const TM=1e3;function ha(){var n;return((n=self==null?void 0:self.location)===null||n===void 0?void 0:n.protocol)||null}function AM(){return ha()==="http:"||ha()==="https:"}function gE(n=Ue()){return!!((ha()==="file:"||ha()==="ionic:"||ha()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function RM(){return mp()||gp()}function SM(){return fw()&&(document==null?void 0:document.documentMode)===11}function bM(n=Ue()){return/Edge\/\d+/.test(n)}function PM(n=Ue()){return SM()||bM(n)}function mE(){try{const n=self.localStorage,e=nc();if(n)return n.setItem(e,"1"),n.removeItem(e),PM()?va():!0}catch{return Up()&&va()}return!1}function Up(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function tf(){return(AM()||dw()||gE())&&!RM()&&mE()&&!Up()}function _E(){return gE()&&typeof document<"u"}async function CM(){return _E()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},TM);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function DM(){return typeof window<"u"?window:null}const Qt={LOCAL:"local",NONE:"none",SESSION:"session"},qo=O,yE="persistence";function kM(n,e){if(qo(Object.values(Qt).includes(e),n,"invalid-persistence-type"),mp()){qo(e!==Qt.SESSION,n,"unsupported-persistence-type");return}if(gp()){qo(e===Qt.NONE,n,"unsupported-persistence-type");return}if(Up()){qo(e===Qt.NONE||e===Qt.LOCAL&&va(),n,"unsupported-persistence-type");return}qo(e===Qt.NONE||mE(),n,"unsupported-persistence-type")}async function Sf(n){await n._initializationPromise;const e=vE(),t=Ci(yE,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())}function xM(n,e){const t=vE();if(!t)return[];const r=Ci(yE,n,e);switch(t.getItem(r)){case Qt.NONE:return[Bs];case Qt.LOCAL:return[ba,Ni];case Qt.SESSION:return[Ni];default:return[]}}function vE(){var n;try{return((n=DM())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}const NM=O;class Nr{constructor(){this.browserResolver=Yt(QL),this.cordovaResolver=Yt(vM),this.underlyingResolver=null,this._redirectPersistence=Ni,this._completeRedirectFn=Vl,this._overrideRedirectResult=Mp}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return _E()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return NM(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await CM();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function IE(n){return n.unwrap()}function VM(n){return n.wrapped()}function OM(n){return wE(n)}function LM(n,e){var t;const r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new MM(n,vO(n,e))}else if(r){const i=wE(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function wE(n){const{_tokenResponse:e}=n instanceof Dt?n.customData:n;if(!e)return null;if(!(n instanceof Dt)&&"temporaryProof"in e&&"phoneNumber"in e)return Un.credentialFromResult(n);const t=e.providerId;if(!t||t===Bo.PASSWORD)return null;let r;switch(t){case Bo.GOOGLE:r=Cn;break;case Bo.FACEBOOK:r=Pn;break;case Bo.GITHUB:r=Dn;break;case Bo.TWITTER:r=kn;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:h}=e;return!s&&!a&&!i&&!l?null:l?t.startsWith("saml.")?qs._create(t,l):Wn._fromParams({providerId:t,signInMethod:t,pendingToken:l,idToken:i,accessToken:s}):new xs(t).credential({idToken:i,accessToken:s,rawNonce:h})}return n instanceof Dt?r.credentialFromError(n):r.credentialFromResult(n)}function Ft(n,e){return e.catch(t=>{throw t instanceof Dt&&LM(n,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:OM(t),additionalUserInfo:yO(t),user:Vr.getOrCreate(i)}})}async function bf(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>Ft(n,t.confirm(r))}}class MM{constructor(e,t){this.resolver=t,this.auth=VM(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Ft(IE(this.auth),this.resolver.resolveSignIn(e))}}let Vr=class{constructor(e){this._delegate=e,this.multiFactor=TO(e)}static getOrCreate(e){return Vr.USER_MAP.has(e)||Vr.USER_MAP.set(e,new Vr(e)),Vr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Ft(this.auth,Qw(this._delegate,e))}async linkWithPhoneNumber(e,t){return bf(this.auth,eL(this._delegate,e,t))}async linkWithPopup(e){return Ft(this.auth,uL(this._delegate,e,Nr))}async linkWithRedirect(e){return await Sf($e(this.auth)),yL(this._delegate,e,Nr)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Ft(this.auth,Yw(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return bf(this.auth,tL(this._delegate,e,t))}reauthenticateWithPopup(e){return Ft(this.auth,cL(this._delegate,e,Nr))}async reauthenticateWithRedirect(e){return await Sf($e(this.auth)),mL(this._delegate,e,Nr)}sendEmailVerification(e){return aO(this._delegate,e)}async unlink(e){return await HV(this._delegate,e),this}updateEmail(e){return hO(this._delegate,e)}updatePassword(e){return dO(this._delegate,e)}updatePhoneNumber(e){return nL(this._delegate,e)}updateProfile(e){return lO(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return cO(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Vr.USER_MAP=new WeakMap;const $o=O;class Pf{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;$o(r,"invalid-api-key",{appName:e.name}),$o(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?Nr:void 0;this._delegate=t.initialize({options:{persistence:FM(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(FN),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Vr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){TV(this._delegate,e,t)}applyActionCode(e){return XV(this._delegate,e)}checkActionCode(e){return Jw(this._delegate,e)}confirmPasswordReset(e,t){return JV(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Ft(this._delegate,eO(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return oO(this._delegate,e)}isSignInWithEmailLink(e){return rO(this._delegate,e)}async getRedirectResult(){$o(tf(),this._delegate,"operation-not-supported-in-this-environment");const e=await IL(this._delegate,Nr);return e?Ft(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){IM(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:s,complete:a}=Tv(e,t,r);return this._delegate.onAuthStateChanged(i,s,a)}onIdTokenChanged(e,t,r){const{next:i,error:s,complete:a}=Tv(e,t,r);return this._delegate.onIdTokenChanged(i,s,a)}sendSignInLinkToEmail(e,t){return nO(this._delegate,e,t)}sendPasswordResetEmail(e,t){return YV(this._delegate,e,t||void 0)}async setPersistence(e){kM(this._delegate,e);let t;switch(e){case Qt.SESSION:t=Ni;break;case Qt.LOCAL:t=await Yt(ba)._isAvailable()?ba:xp;break;case Qt.NONE:t=Bs;break;default:return _t("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Ft(this._delegate,KV(this._delegate))}signInWithCredential(e){return Ft(this._delegate,Cl(this._delegate,e))}signInWithCustomToken(e){return Ft(this._delegate,QV(this._delegate,e))}signInWithEmailAndPassword(e,t){return Ft(this._delegate,tO(this._delegate,e,t))}signInWithEmailLink(e,t){return Ft(this._delegate,iO(this._delegate,e,t))}signInWithPhoneNumber(e,t){return bf(this._delegate,ZO(this._delegate,e,t))}async signInWithPopup(e){return $o(tf(),this._delegate,"operation-not-supported-in-this-environment"),Ft(this._delegate,aL(this._delegate,e,Nr))}async signInWithRedirect(e){return $o(tf(),this._delegate,"operation-not-supported-in-this-environment"),await Sf(this._delegate),pL(this._delegate,e,Nr)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return ZV(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Pf.Persistence=Qt;function Tv(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const i=r;return{next:a=>i(a&&Vr.getOrCreate(a)),error:e,complete:t}}function FM(n,e){const t=xM(n,e);if(typeof self<"u"&&!t.includes(ba)&&t.push(ba),typeof window<"u")for(const r of[xp,Ni])t.includes(r)||t.push(r);return t.includes(Bs)||t.push(Bs),t}class Bp{constructor(){this.providerId="phone",this._delegate=new Un(IE(Br.auth()))}static credential(e,t){return Un.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}Bp.PHONE_SIGN_IN_METHOD=Un.PHONE_SIGN_IN_METHOD;Bp.PROVIDER_ID=Un.PROVIDER_ID;const UM=O;class BM{constructor(e,t,r=Br.app()){var i;UM((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new JO(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const qM="auth-compat";function $M(n){n.INTERNAL.registerComponent(new $n(qM,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Pf(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:_s.EMAIL_SIGNIN,PASSWORD_RESET:_s.PASSWORD_RESET,RECOVER_EMAIL:_s.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:_s.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:_s.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:_s.VERIFY_EMAIL}},EmailAuthProvider:Xr,FacebookAuthProvider:Pn,GithubAuthProvider:Dn,GoogleAuthProvider:Cn,OAuthProvider:xs,SAMLAuthProvider:Qu,PhoneAuthProvider:Bp,PhoneMultiFactorGenerator:pE,RecaptchaVerifier:BM,TwitterAuthProvider:kn,Auth:Pf,AuthCredential:io,Error:Dt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(wM,EM)}$M(Br);var WM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},q,qp=qp||{},Z=WM||self;function Ol(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function ic(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function GM(n){return Object.prototype.hasOwnProperty.call(n,nf)&&n[nf]||(n[nf]=++zM)}var nf="closure_uid_"+(1e9*Math.random()>>>0),zM=0;function KM(n,e,t){return n.call.apply(n.bind,arguments)}function HM(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function wt(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?wt=KM:wt=HM,wt.apply(null,arguments)}function Iu(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function at(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var a=Array(arguments.length-2),l=2;l<arguments.length;l++)a[l-2]=arguments[l];return e.prototype[i].apply(r,a)}}function Zr(){this.s=this.s,this.o=this.o}var jM=0;Zr.prototype.s=!1;Zr.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),jM!=0)&&GM(this)};Zr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const EE=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function $p(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Av(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Ol(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let a=0;a<s;a++)n[i+a]=r[a]}else n.push(r)}}function Et(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Et.prototype.h=function(){this.defaultPrevented=!0};var QM=function(){if(!Z.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const t=()=>{};Z.addEventListener("test",t,e),Z.removeEventListener("test",t,e)}catch{}return n}();function Pa(n){return/^[\s\xa0]*$/.test(n)}function Ll(){var n=Z.navigator;return n&&(n=n.userAgent)?n:""}function xn(n){return Ll().indexOf(n)!=-1}function Wp(n){return Wp[" "](n),n}Wp[" "]=function(){};function YM(n,e){var t=$F;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}var JM=xn("Opera"),$s=xn("Trident")||xn("MSIE"),TE=xn("Edge"),Cf=TE||$s,AE=xn("Gecko")&&!(Ll().toLowerCase().indexOf("webkit")!=-1&&!xn("Edge"))&&!(xn("Trident")||xn("MSIE"))&&!xn("Edge"),XM=Ll().toLowerCase().indexOf("webkit")!=-1&&!xn("Edge");function RE(){var n=Z.document;return n?n.documentMode:void 0}var Df;e:{var rf="",sf=function(){var n=Ll();if(AE)return/rv:([^\);]+)(\)|;)/.exec(n);if(TE)return/Edge\/([\d\.]+)/.exec(n);if($s)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(XM)return/WebKit\/(\S+)/.exec(n);if(JM)return/(?:Version)[ \/]?(\S+)/.exec(n)}();if(sf&&(rf=sf?sf[1]:""),$s){var of=RE();if(of!=null&&of>parseFloat(rf)){Df=String(of);break e}}Df=rf}var kf;if(Z.document&&$s){var Rv=RE();kf=Rv||parseInt(Df,10)||void 0}else kf=void 0;var ZM=kf;function Ca(n,e){if(Et.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(AE){e:{try{Wp(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:eF[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Ca.$.h.call(this)}}at(Ca,Et);var eF={2:"touch",3:"pen",4:"mouse"};Ca.prototype.h=function(){Ca.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var sc="closure_listenable_"+(1e6*Math.random()|0),tF=0;function nF(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++tF,this.fa=this.ia=!1}function Ml(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function Gp(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function rF(n,e){for(const t in n)e.call(void 0,n[t],t,n)}function SE(n){const e={};for(const t in n)e[t]=n[t];return e}const Sv="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function bE(n,e){let t,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(t in r)n[t]=r[t];for(let s=0;s<Sv.length;s++)t=Sv[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Fl(n){this.src=n,this.g={},this.h=0}Fl.prototype.add=function(n,e,t,r,i){var s=n.toString();n=this.g[s],n||(n=this.g[s]=[],this.h++);var a=Nf(n,e,r,i);return-1<a?(e=n[a],t||(e.ia=!1)):(e=new nF(e,this.src,s,!!r,i),e.ia=t,n.push(e)),e};function xf(n,e){var t=e.type;if(t in n.g){var r=n.g[t],i=EE(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Ml(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function Nf(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}var zp="closure_lm_"+(1e6*Math.random()|0),af={};function PE(n,e,t,r,i){if(r&&r.once)return DE(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)PE(n,e[s],t,r,i);return null}return t=jp(t),n&&n[sc]?n.O(e,t,ic(r)?!!r.capture:!!r,i):CE(n,e,t,!1,r,i)}function CE(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var a=ic(i)?!!i.capture:!!i,l=Hp(n);if(l||(n[zp]=l=new Fl(n)),t=l.add(e,t,r,a,s),t.proxy)return t;if(r=iF(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)QM||(i=a),i===void 0&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(xE(e.toString()),r);else if(n.addListener&&n.removeListener)n.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return t}function iF(){function n(t){return e.call(n.src,n.listener,t)}const e=sF;return n}function DE(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)DE(n,e[s],t,r,i);return null}return t=jp(t),n&&n[sc]?n.P(e,t,ic(r)?!!r.capture:!!r,i):CE(n,e,t,!0,r,i)}function kE(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)kE(n,e[s],t,r,i);else r=ic(r)?!!r.capture:!!r,t=jp(t),n&&n[sc]?(n=n.i,e=String(e).toString(),e in n.g&&(s=n.g[e],t=Nf(s,t,r,i),-1<t&&(Ml(s[t]),Array.prototype.splice.call(s,t,1),s.length==0&&(delete n.g[e],n.h--)))):n&&(n=Hp(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Nf(e,t,r,i)),(t=-1<n?e[n]:null)&&Kp(t))}function Kp(n){if(typeof n!="number"&&n&&!n.fa){var e=n.src;if(e&&e[sc])xf(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(xE(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Hp(e))?(xf(t,n),t.h==0&&(t.src=null,e[zp]=null)):Ml(n)}}}function xE(n){return n in af?af[n]:af[n]="on"+n}function sF(n,e){if(n.fa)n=!0;else{e=new Ca(e,this);var t=n.listener,r=n.la||n.src;n.ia&&Kp(n),n=t.call(r,e)}return n}function Hp(n){return n=n[zp],n instanceof Fl?n:null}var cf="__closure_events_fn_"+(1e9*Math.random()>>>0);function jp(n){return typeof n=="function"?n:(n[cf]||(n[cf]=function(e){return n.handleEvent(e)}),n[cf])}function ot(){Zr.call(this),this.i=new Fl(this),this.S=this,this.J=null}at(ot,Zr);ot.prototype[sc]=!0;ot.prototype.removeEventListener=function(n,e,t,r){kE(this,n,e,t,r)};function mt(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,typeof e=="string")e=new Et(e,n);else if(e instanceof Et)e.target=e.target||n;else{var i=e;e=new Et(r,n),bE(e,i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var a=e.g=t[s];i=wu(a,r,!0,e)&&i}if(a=e.g=n,i=wu(a,r,!0,e)&&i,i=wu(a,r,!1,e)&&i,t)for(s=0;s<t.length;s++)a=e.g=t[s],i=wu(a,r,!1,e)&&i}ot.prototype.N=function(){if(ot.$.N.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Ml(t[r]);delete n.g[e],n.h--}}this.J=null};ot.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)};ot.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};function wu(n,e,t,r){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==t){var l=a.listener,h=a.la||a.src;a.ia&&xf(n.i,a),i=l.call(h,r)!==!1&&i}}return i&&!r.defaultPrevented}var Qp=Z.JSON.stringify;class oF{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function aF(){var n=Yp;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}class cF{constructor(){this.h=this.g=null}add(e,t){const r=NE.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}}var NE=new oF(()=>new uF,n=>n.reset());class uF{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function lF(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function hF(n){Z.setTimeout(()=>{throw n},0)}let Da,ka=!1,Yp=new cF,VE=()=>{const n=Z.Promise.resolve(void 0);Da=()=>{n.then(dF)}};var dF=()=>{for(var n;n=aF();){try{n.h.call(n.g)}catch(t){hF(t)}var e=NE;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}ka=!1};function Ul(n,e){ot.call(this),this.h=n||1,this.g=e||Z,this.j=wt(this.qb,this),this.l=Date.now()}at(Ul,ot);q=Ul.prototype;q.ga=!1;q.T=null;q.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),mt(this,"tick"),this.ga&&(Jp(this),this.start()))}};q.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Jp(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}q.N=function(){Ul.$.N.call(this),Jp(this),delete this.g};function Xp(n,e,t){if(typeof n=="function")t&&(n=wt(n,t));else if(n&&typeof n.handleEvent=="function")n=wt(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Z.setTimeout(n,e||0)}function OE(n){n.g=Xp(()=>{n.g=null,n.i&&(n.i=!1,OE(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}class fF extends Zr{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:OE(this)}N(){super.N(),this.g&&(Z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xa(n){Zr.call(this),this.h=n,this.g={}}at(xa,Zr);var bv=[];function LE(n,e,t,r){Array.isArray(t)||(t&&(bv[0]=t.toString()),t=bv);for(var i=0;i<t.length;i++){var s=PE(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function ME(n){Gp(n.g,function(e,t){this.g.hasOwnProperty(t)&&Kp(e)},n),n.g={}}xa.prototype.N=function(){xa.$.N.call(this),ME(this)};xa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Bl(){this.g=!0}Bl.prototype.Ea=function(){this.g=!1};function pF(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var a="",l=s.split("&"),h=0;h<l.length;h++){var f=l[h].split("=");if(1<f.length){var p=f[0];f=f[1];var m=p.split("_");a=2<=m.length&&m[1]=="type"?a+(p+"="+f+"&"):a+(p+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+t+`
`+a})}function gF(n,e,t,r,i,s,a){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+t+`
`+s+" "+a})}function Ds(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+_F(n,t)+(r?" "+r:"")})}function mF(n,e){n.info(function(){return"TIMEOUT: "+e})}Bl.prototype.info=function(){};function _F(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return Qp(t)}catch{return e}}var Hi={},Pv=null;function ql(){return Pv=Pv||new ot}Hi.Ta="serverreachability";function FE(n){Et.call(this,Hi.Ta,n)}at(FE,Et);function Na(n){const e=ql();mt(e,new FE(e))}Hi.STAT_EVENT="statevent";function UE(n,e){Et.call(this,Hi.STAT_EVENT,n),this.stat=e}at(UE,Et);function Ct(n){const e=ql();mt(e,new UE(e,n))}Hi.Ua="timingevent";function BE(n,e){Et.call(this,Hi.Ua,n),this.size=e}at(BE,Et);function oc(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return Z.setTimeout(function(){n()},e)}var $l={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},qE={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Zp(){}Zp.prototype.h=null;function Cv(n){return n.h||(n.h=n.i())}function $E(){}var ac={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function eg(){Et.call(this,"d")}at(eg,Et);function tg(){Et.call(this,"c")}at(tg,Et);var Vf;function Wl(){}at(Wl,Zp);Wl.prototype.g=function(){return new XMLHttpRequest};Wl.prototype.i=function(){return{}};Vf=new Wl;function cc(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new xa(this),this.P=yF,n=Cf?125:void 0,this.V=new Ul(n),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new WE}function WE(){this.i=null,this.g="",this.h=!1}var yF=45e3,GE={},Of={};q=cc.prototype;q.setTimeout=function(n){this.P=n};function Lf(n,e,t){n.L=1,n.A=zl(lr(e)),n.u=t,n.S=!0,zE(n,null)}function zE(n,e){n.G=Date.now(),uc(n),n.B=lr(n.A);var t=n.B,r=n.W;Array.isArray(r)||(r=[String(r)]),ZE(t.i,"t",r),n.o=0,t=n.l.J,n.h=new WE,n.g=IT(n.l,t?e:null,!n.u),0<n.O&&(n.M=new fF(wt(n.Pa,n,n.g),n.O)),LE(n.U,n.g,"readystatechange",n.nb),e=n.I?SE(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),Na(),pF(n.j,n.v,n.B,n.m,n.W,n.u)}q.nb=function(n){n=n.target;const e=this.M;e&&Vn(n)==3?e.l():this.Pa(n)};q.Pa=function(n){try{if(n==this.g)e:{const p=Vn(this.g);var e=this.g.Ia();const m=this.g.da();if(!(3>p)&&(p!=3||Cf||this.g&&(this.h.h||this.g.ja()||Nv(this.g)))){this.J||p!=4||e==7||(e==8||0>=m?Na(3):Na(2)),Gl(this);var t=this.g.da();this.ca=t;t:if(KE(this)){var r=Nv(this.g);n="";var i=r.length,s=Vn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ai(this),da(this);var a="";break t}this.h.i=new Z.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=n,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=t==200,gF(this.j,this.v,this.B,this.m,this.W,p,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var l,h=this.g;if((l=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Pa(l)){var f=l;break t}}f=null}if(t=f)Ds(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Mf(this,t);else{this.i=!1,this.s=3,Ct(12),Ai(this),da(this);break e}}this.S?(HE(this,p,a),Cf&&this.i&&p==3&&(LE(this.U,this.V,"tick",this.mb),this.V.start())):(Ds(this.j,this.m,a,null),Mf(this,a)),p==4&&Ai(this),this.i&&!this.J&&(p==4?mT(this.l,this):(this.i=!1,uc(this)))}else UF(this.g),t==400&&0<a.indexOf("Unknown SID")?(this.s=3,Ct(12)):(this.s=0,Ct(13)),Ai(this),da(this)}}}catch{}finally{}};function KE(n){return n.g?n.v=="GET"&&n.L!=2&&n.l.Ha:!1}function HE(n,e,t){let r=!0,i;for(;!n.J&&n.o<t.length;)if(i=vF(n,t),i==Of){e==4&&(n.s=4,Ct(14),r=!1),Ds(n.j,n.m,null,"[Incomplete Response]");break}else if(i==GE){n.s=4,Ct(15),Ds(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}else Ds(n.j,n.m,i,null),Mf(n,i);KE(n)&&n.o!=0&&(n.h.g=n.h.g.slice(n.o),n.o=0),e!=4||t.length!=0||n.h.h||(n.s=1,Ct(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,e=n.l,e.g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),ag(e),e.M=!0,Ct(11))):(Ds(n.j,n.m,t,"[Invalid Chunked Response]"),Ai(n),da(n))}q.mb=function(){if(this.g){var n=Vn(this.g),e=this.g.ja();this.o<e.length&&(Gl(this),HE(this,n,e),this.i&&n!=4&&uc(this))}};function vF(n,e){var t=n.o,r=e.indexOf(`
`,t);return r==-1?Of:(t=Number(e.substring(t,r)),isNaN(t)?GE:(r+=1,r+t>e.length?Of:(e=e.slice(r,r+t),n.o=r+t,e)))}q.cancel=function(){this.J=!0,Ai(this)};function uc(n){n.Y=Date.now()+n.P,jE(n,n.P)}function jE(n,e){if(n.C!=null)throw Error("WatchDog timer not null");n.C=oc(wt(n.lb,n),e)}function Gl(n){n.C&&(Z.clearTimeout(n.C),n.C=null)}q.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(mF(this.j,this.B),this.L!=2&&(Na(),Ct(17)),Ai(this),this.s=2,da(this)):jE(this,this.Y-n)};function da(n){n.l.H==0||n.J||mT(n.l,n)}function Ai(n){Gl(n);var e=n.M;e&&typeof e.sa=="function"&&e.sa(),n.M=null,Jp(n.V),ME(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function Mf(n,e){try{var t=n.l;if(t.H!=0&&(t.g==n||Ff(t.i,n))){if(!n.K&&Ff(t.i,n)&&t.H==3){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<n.G)tl(t),Ql(t);else break e;og(t),Ct(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&t.A==0&&!t.v&&(t.v=oc(wt(t.ib,t),6e3));if(1>=nT(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Ri(t,11)}else if((n.K||t.g==n)&&tl(t),!Pa(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let f=i[e];if(t.V=f[0],f=f[1],t.H==2)if(f[0]=="c"){t.K=f[1],t.pa=f[2];const p=f[3];p!=null&&(t.ra=p,t.l.info("VER="+t.ra));const m=f[4];m!=null&&(t.Ga=m,t.l.info("SVER="+t.Ga));const I=f[5];I!=null&&typeof I=="number"&&0<I&&(r=1.5*I,t.L=r,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const A=n.g;if(A){const L=A.g?A.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(L){var s=r.i;s.g||L.indexOf("spdy")==-1&&L.indexOf("quic")==-1&&L.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(ng(s,s.h),s.h=null))}if(r.F){const M=A.g?A.g.getResponseHeader("X-HTTP-Session-Id"):null;M&&(r.Da=M,ke(r.I,r.F,M))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms")),r=t;var a=n;if(r.wa=vT(r,r.J?r.pa:null,r.Y),a.K){rT(r.i,a);var l=a,h=r.L;h&&l.setTimeout(h),l.C&&(Gl(l),uc(l)),r.g=a}else pT(r);0<t.j.length&&Yl(t)}else f[0]!="stop"&&f[0]!="close"||Ri(t,7);else t.H==3&&(f[0]=="stop"||f[0]=="close"?f[0]=="stop"?Ri(t,7):sg(t):f[0]!="noop"&&t.h&&t.h.Aa(f),t.A=0)}}Na(4)}catch{}}function IF(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(Ol(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}e=[],t=0;for(r in n)e[t++]=n[r];return e}function wF(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Ol(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}function QE(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(Ol(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=wF(n),r=IF(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}var YE=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function EF(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function ki(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof ki){this.h=n.h,Zu(this,n.j),this.s=n.s,this.g=n.g,el(this,n.m),this.l=n.l;var e=n.i,t=new Va;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Dv(this,t),this.o=n.o}else n&&(e=String(n).match(YE))?(this.h=!1,Zu(this,e[1]||"",!0),this.s=ra(e[2]||""),this.g=ra(e[3]||"",!0),el(this,e[4]),this.l=ra(e[5]||"",!0),Dv(this,e[6]||"",!0),this.o=ra(e[7]||"")):(this.h=!1,this.i=new Va(null,this.h))}ki.prototype.toString=function(){var n=[],e=this.j;e&&n.push(ia(e,kv,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(ia(e,kv,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(ia(t,t.charAt(0)=="/"?RF:AF,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",ia(t,bF)),n.join("")};function lr(n){return new ki(n)}function Zu(n,e,t){n.j=t?ra(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function el(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Dv(n,e,t){e instanceof Va?(n.i=e,PF(n.i,n.h)):(t||(e=ia(e,SF)),n.i=new Va(e,n.h))}function ke(n,e,t){n.i.set(e,t)}function zl(n){return ke(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function ra(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function ia(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,TF),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function TF(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var kv=/[#\/\?@]/g,AF=/[#\?:]/g,RF=/[#\?]/g,SF=/[#\?@]/g,bF=/#/g;function Va(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function ei(n){n.g||(n.g=new Map,n.h=0,n.i&&EF(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}q=Va.prototype;q.add=function(n,e){ei(this),this.i=null,n=oo(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function JE(n,e){ei(n),e=oo(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function XE(n,e){return ei(n),e=oo(n,e),n.g.has(e)}q.forEach=function(n,e){ei(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)};q.ta=function(){ei(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t};q.Z=function(n){ei(this);let e=[];if(typeof n=="string")XE(this,n)&&(e=e.concat(this.g.get(oo(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};q.set=function(n,e){return ei(this),this.i=null,n=oo(this,n),XE(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};q.get=function(n,e){return n?(n=this.Z(n),0<n.length?String(n[0]):e):e};function ZE(n,e,t){JE(n,e),0<t.length&&(n.i=null,n.g.set(oo(n,e),$p(t)),n.h+=t.length)}q.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;a[r]!==""&&(i+="="+encodeURIComponent(String(a[r]))),n.push(i)}}return this.i=n.join("&")};function oo(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function PF(n,e){e&&!n.j&&(ei(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(JE(this,r),ZE(this,i,t))},n)),n.j=e}var CF=class{constructor(n,e){this.g=n,this.map=e}};function eT(n){this.l=n||DF,Z.PerformanceNavigationTiming?(n=Z.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(Z.g&&Z.g.Ka&&Z.g.Ka()&&Z.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var DF=10;function tT(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function nT(n){return n.h?1:n.g?n.g.size:0}function Ff(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function ng(n,e){n.g?n.g.add(e):n.h=e}function rT(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}eT.prototype.cancel=function(){if(this.i=iT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function iT(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return $p(n.i)}var kF=class{stringify(n){return Z.JSON.stringify(n,void 0)}parse(n){return Z.JSON.parse(n,void 0)}};function xF(){this.g=new kF}function NF(n,e,t){const r=t||"";try{QE(n,function(i,s){let a=i;ic(i)&&(a=Qp(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function VF(n,e){const t=new Bl;if(Z.Image){const r=new Image;r.onload=Iu(Eu,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Iu(Eu,t,r,"TestLoadImage: error",!1,e),r.onabort=Iu(Eu,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Iu(Eu,t,r,"TestLoadImage: timeout",!1,e),Z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}function Eu(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Kl(n){this.l=n.ec||null,this.j=n.ob||!1}at(Kl,Zp);Kl.prototype.g=function(){return new Hl(this.l,this.j)};Kl.prototype.i=function(n){return function(){return n}}({});function Hl(n,e){ot.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=rg,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}at(Hl,ot);var rg=0;q=Hl.prototype;q.open=function(n,e){if(this.readyState!=rg)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Oa(this)};q.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||Z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};q.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,lc(this)),this.readyState=rg};q.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Oa(this)),this.g&&(this.readyState=3,Oa(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Z.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;sT(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function sT(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}q.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?lc(this):Oa(this),this.readyState==3&&sT(this)}};q.Za=function(n){this.g&&(this.response=this.responseText=n,lc(this))};q.Ya=function(n){this.g&&(this.response=n,lc(this))};q.ka=function(){this.g&&lc(this)};function lc(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Oa(n)}q.setRequestHeader=function(n,e){this.v.append(n,e)};q.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};q.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function Oa(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(Hl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var OF=Z.JSON.parse;function We(n){ot.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=oT,this.L=this.M=!1}at(We,ot);var oT="",LF=/^https?$/i,MF=["POST","PUT"];q=We.prototype;q.Oa=function(n){this.M=n};q.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Vf.g(),this.C=this.u?Cv(this.u):Cv(Vf),this.g.onreadystatechange=wt(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){xv(this,s);return}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())t.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(t.keys()).find(s=>s.toLowerCase()=="content-type"),i=Z.FormData&&n instanceof Z.FormData,!(0<=EE(MF,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of t)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{uT(this),0<this.B&&((this.L=FF(this.g))?(this.g.timeout=this.B,this.g.ontimeout=wt(this.ua,this)):this.A=Xp(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){xv(this,s)}};function FF(n){return $s&&typeof n.timeout=="number"&&n.ontimeout!==void 0}q.ua=function(){typeof qp<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,mt(this,"timeout"),this.abort(8))};function xv(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,aT(n),jl(n)}function aT(n){n.F||(n.F=!0,mt(n,"complete"),mt(n,"error"))}q.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,mt(this,"complete"),mt(this,"abort"),jl(this))};q.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),jl(this,!0)),We.$.N.call(this)};q.La=function(){this.s||(this.G||this.v||this.l?cT(this):this.kb())};q.kb=function(){cT(this)};function cT(n){if(n.h&&typeof qp<"u"&&(!n.C[1]||Vn(n)!=4||n.da()!=2)){if(n.v&&Vn(n)==4)Xp(n.La,0,n);else if(mt(n,"readystatechange"),Vn(n)==4){n.h=!1;try{const a=n.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=a===0){var i=String(n.I).match(YE)[1]||null;!i&&Z.self&&Z.self.location&&(i=Z.self.location.protocol.slice(0,-1)),r=!LF.test(i?i.toLowerCase():"")}t=r}if(t)mt(n,"complete"),mt(n,"success");else{n.m=6;try{var s=2<Vn(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",aT(n)}}finally{jl(n)}}}}function jl(n,e){if(n.g){uT(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||mt(n,"ready");try{t.onreadystatechange=r}catch{}}}function uT(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(Z.clearTimeout(n.A),n.A=null)}q.isActive=function(){return!!this.g};function Vn(n){return n.g?n.g.readyState:0}q.da=function(){try{return 2<Vn(this)?this.g.status:-1}catch{return-1}};q.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};q.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),OF(e)}};function Nv(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case oT:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function UF(n){const e={};n=(n.g&&2<=Vn(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<n.length;r++){if(Pa(n[r]))continue;var t=lF(n[r]);const i=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}rF(e,function(r){return r.join(", ")})}q.Ia=function(){return this.m};q.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function lT(n){let e="";return Gp(n,function(t,r){e+=r,e+=":",e+=t,e+=`\r
`}),e}function ig(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=lT(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):ke(n,e,t))}function Wo(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function hT(n){this.Ga=0,this.j=[],this.l=new Bl,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Wo("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Wo("baseRetryDelayMs",5e3,n),this.hb=Wo("retryDelaySeedMs",1e4,n),this.eb=Wo("forwardChannelMaxRetries",2,n),this.xa=Wo("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new eT(n&&n.concurrentRequestLimit),this.Ja=new xF,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}q=hT.prototype;q.ra=8;q.H=1;function sg(n){if(dT(n),n.H==3){var e=n.W++,t=lr(n.I);if(ke(t,"SID",n.K),ke(t,"RID",e),ke(t,"TYPE","terminate"),hc(n,t),e=new cc(n,n.l,e),e.L=2,e.A=zl(lr(t)),t=!1,Z.navigator&&Z.navigator.sendBeacon)try{t=Z.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&Z.Image&&(new Image().src=e.A,t=!0),t||(e.g=IT(e.l,null),e.g.ha(e.A)),e.G=Date.now(),uc(e)}yT(n)}function Ql(n){n.g&&(ag(n),n.g.cancel(),n.g=null)}function dT(n){Ql(n),n.u&&(Z.clearTimeout(n.u),n.u=null),tl(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&Z.clearTimeout(n.m),n.m=null)}function Yl(n){if(!tT(n.i)&&!n.m){n.m=!0;var e=n.Na;Da||VE(),ka||(Da(),ka=!0),Yp.add(e,n),n.C=0}}function BF(n,e){return nT(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=e.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=oc(wt(n.Na,n,e),_T(n,n.C)),n.C++,!0)}q.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new cc(this,this.l,n);let s=this.s;if(this.U&&(s?(s=SE(s),bE(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var r=this.j[t];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=fT(this,i,e),t=lr(this.I),ke(t,"RID",n),ke(t,"CVER",22),this.F&&ke(t,"X-HTTP-Session-Id",this.F),hc(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(lT(s)))+"&"+e:this.o&&ig(t,this.o,s)),ng(this.i,i),this.bb&&ke(t,"TYPE","init"),this.P?(ke(t,"$req",e),ke(t,"SID","null"),i.aa=!0,Lf(i,t,null)):Lf(i,t,e),this.H=2}}else this.H==3&&(n?Vv(this,n):this.j.length==0||tT(this.i)||Vv(this))};function Vv(n,e){var t;e?t=e.m:t=n.W++;const r=lr(n.I);ke(r,"SID",n.K),ke(r,"RID",t),ke(r,"AID",n.V),hc(n,r),n.o&&n.s&&ig(r,n.o,n.s),t=new cc(n,n.l,t,n.C+1),n.o===null&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=fT(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),ng(n.i,t),Lf(t,r,e)}function hc(n,e){n.na&&Gp(n.na,function(t,r){ke(e,r,t)}),n.h&&QE({},function(t,r){ke(e,r,t)})}function fT(n,e,t){t=Math.min(n.j.length,t);var r=n.h?wt(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const a=["count="+t];s==-1?0<t?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let l=!0;for(let h=0;h<t;h++){let f=i[h].g;const p=i[h].map;if(f-=s,0>f)s=Math.max(0,i[h].g-100),l=!1;else try{NF(p,a,"req"+f+"_")}catch{r&&r(p)}}if(l){r=a.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function pT(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Da||VE(),ka||(Da(),ka=!0),Yp.add(e,n),n.A=0}}function og(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=oc(wt(n.Ma,n),_T(n,n.A)),n.A++,!0)}q.Ma=function(){if(this.u=null,gT(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=oc(wt(this.jb,this),n)}};q.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Ct(10),Ql(this),gT(this))};function ag(n){n.B!=null&&(Z.clearTimeout(n.B),n.B=null)}function gT(n){n.g=new cc(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var e=lr(n.wa);ke(e,"RID","rpc"),ke(e,"SID",n.K),ke(e,"AID",n.V),ke(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&ke(e,"TO",n.qa),ke(e,"TYPE","xmlhttp"),hc(n,e),n.o&&n.s&&ig(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=zl(lr(e)),t.u=null,t.S=!0,zE(t,n)}q.ib=function(){this.v!=null&&(this.v=null,Ql(this),og(this),Ct(19))};function tl(n){n.v!=null&&(Z.clearTimeout(n.v),n.v=null)}function mT(n,e){var t=null;if(n.g==e){tl(n),ag(n),n.g=null;var r=2}else if(Ff(n.i,e))t=e.F,rT(n.i,e),r=1;else return;if(n.H!=0){if(e.i)if(r==1){t=e.u?e.u.length:0,e=Date.now()-e.G;var i=n.C;r=ql(),mt(r,new BE(r,t)),Yl(n)}else pT(n);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&BF(n,e)||r==2&&og(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Ri(n,5);break;case 4:Ri(n,10);break;case 3:Ri(n,6);break;default:Ri(n,2)}}}function _T(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Ri(n,e){if(n.l.info("Error code "+e),e==2){var t=null;n.h&&(t=null);var r=wt(n.pb,n);t||(t=new ki("//www.google.com/images/cleardot.gif"),Z.location&&Z.location.protocol=="http"||Zu(t,"https"),zl(t)),VF(t.toString(),r)}else Ct(2);n.H=0,n.h&&n.h.za(e),yT(n),dT(n)}q.pb=function(n){n?(this.l.info("Successfully pinged google.com"),Ct(2)):(this.l.info("Failed to ping google.com"),Ct(1))};function yT(n){if(n.H=0,n.ma=[],n.h){const e=iT(n.i);(e.length!=0||n.j.length!=0)&&(Av(n.ma,e),Av(n.ma,n.j),n.i.i.length=0,$p(n.j),n.j.length=0),n.h.ya()}}function vT(n,e,t){var r=t instanceof ki?lr(t):new ki(t);if(r.g!="")e&&(r.g=e+"."+r.g),el(r,r.m);else{var i=Z.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new ki(null);r&&Zu(s,r),e&&(s.g=e),i&&el(s,i),t&&(s.l=t),r=s}return t=n.F,e=n.Da,t&&e&&ke(r,t,e),ke(r,"VER",n.ra),hc(n,r),r}function IT(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n.Ha&&!n.va?new We(new Kl({ob:t})):new We(n.va),e.Oa(n.J),e}q.isActive=function(){return!!this.h&&this.h.isActive(this)};function wT(){}q=wT.prototype;q.Ba=function(){};q.Aa=function(){};q.za=function(){};q.ya=function(){};q.isActive=function(){return!0};q.Va=function(){};function nl(){if($s&&!(10<=Number(ZM)))throw Error("Environmental error: no available transport.")}nl.prototype.g=function(n,e){return new Jt(n,e)};function Jt(n,e){ot.call(this),this.g=new hT(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Pa(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Pa(e)&&(this.g.F=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new ao(this)}at(Jt,ot);Jt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;Ct(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=vT(n,null,n.Y),Yl(n)};Jt.prototype.close=function(){sg(this.g)};Jt.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=Qp(n),n=t);e.j.push(new CF(e.fb++,n)),e.H==3&&Yl(e)};Jt.prototype.N=function(){this.g.h=null,delete this.j,sg(this.g),delete this.g,Jt.$.N.call(this)};function ET(n){eg.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}at(ET,eg);function TT(){tg.call(this),this.status=1}at(TT,tg);function ao(n){this.g=n}at(ao,wT);ao.prototype.Ba=function(){mt(this.g,"a")};ao.prototype.Aa=function(n){mt(this.g,new ET(n))};ao.prototype.za=function(n){mt(this.g,new TT)};ao.prototype.ya=function(){mt(this.g,"b")};function qF(){this.blockSize=-1}function In(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}at(In,qF);In.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function uf(n,e,t){t||(t=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=n.g[0],t=n.g[1],i=n.g[2];var s=n.g[3],a=e+(s^t&(i^s))+r[0]+3614090360&4294967295;e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[1]+3905402710&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[3]+3250441966&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[4]+4118548399&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[5]+1200080426&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[7]+4249261313&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[8]+1770035416&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[9]+2336552879&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[11]+2304563134&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[12]+1804603682&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[13]+4254626195&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[15]+1236535329&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(i^s&(t^i))+r[1]+4129170786&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[6]+3225465664&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[0]+3921069994&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[5]+3593408605&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[10]+38016083&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[4]+3889429448&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[9]+568446438&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[14]+3275163606&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[8]+1163531501&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[13]+2850285829&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[2]+4243563512&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[12]+2368359562&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(t^i^s)+r[5]+4294588738&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[8]+2272392833&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[14]+4259657740&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[1]+2763975236&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[4]+1272893353&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[10]+3200236656&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[13]+681279174&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[0]+3936430074&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[6]+76029189&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[9]+3654602809&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[12]+3873151461&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[2]+3299628645&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(i^(t|~s))+r[0]+4096336452&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[7]+1126891415&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[5]+4237533241&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[12]+1700485571&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[3]+2399980690&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[1]+2240044497&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[8]+1873313359&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[15]+4264355552&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[13]+1309151649&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[4]+4149444226&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[11]+3174756917&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}In.prototype.j=function(n,e){e===void 0&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=t;)uf(this,n,s),s+=this.blockSize;if(typeof n=="string"){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){uf(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){uf(this,r),i=0;break}}this.h=i,this.i+=e};In.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=t&255,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};function Ae(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=n[i]|0;r&&s==e||(t[i]=s,r=!1)}this.g=t}var $F={};function cg(n){return-128<=n&&128>n?YM(n,function(e){return new Ae([e|0],0>e?-1:0)}):new Ae([n|0],0>n?-1:0)}function On(n){if(isNaN(n)||!isFinite(n))return Vs;if(0>n)return ft(On(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=Uf;return new Ae(e,0)}function AT(n,e){if(n.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(n.charAt(0)=="-")return ft(AT(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=On(Math.pow(e,8)),r=Vs,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),a=parseInt(n.substring(i,i+s),e);8>s?(s=On(Math.pow(e,s)),r=r.R(s).add(On(a))):(r=r.R(t),r=r.add(On(a)))}return r}var Uf=4294967296,Vs=cg(0),Bf=cg(1),Ov=cg(16777216);q=Ae.prototype;q.ea=function(){if(cn(this))return-ft(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:Uf+r)*e,e*=Uf}return n};q.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(ir(this))return"0";if(cn(this))return"-"+ft(this).toString(n);for(var e=On(Math.pow(n,6)),t=this,r="";;){var i=il(t,e).g;t=rl(t,i.R(e));var s=((0<t.g.length?t.g[0]:t.h)>>>0).toString(n);if(t=i,ir(t))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};q.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function ir(n){if(n.h!=0)return!1;for(var e=0;e<n.g.length;e++)if(n.g[e]!=0)return!1;return!0}function cn(n){return n.h==-1}q.X=function(n){return n=rl(this,n),cn(n)?-1:ir(n)?0:1};function ft(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new Ae(t,~n.h).add(Bf)}q.abs=function(){return cn(this)?ft(this):this};q.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(n.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=a>>>16,s&=65535,a&=65535,t[i]=a<<16|s}return new Ae(t,t[t.length-1]&-2147483648?-1:0)};function rl(n,e){return n.add(ft(e))}q.R=function(n){if(ir(this)||ir(n))return Vs;if(cn(this))return cn(n)?ft(this).R(ft(n)):ft(ft(this).R(n));if(cn(n))return ft(this.R(ft(n)));if(0>this.X(Ov)&&0>n.X(Ov))return On(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,a=this.D(r)&65535,l=n.D(i)>>>16,h=n.D(i)&65535;t[2*r+2*i]+=a*h,Tu(t,2*r+2*i),t[2*r+2*i+1]+=s*h,Tu(t,2*r+2*i+1),t[2*r+2*i+1]+=a*l,Tu(t,2*r+2*i+1),t[2*r+2*i+2]+=s*l,Tu(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new Ae(t,0)};function Tu(n,e){for(;(n[e]&65535)!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function Go(n,e){this.g=n,this.h=e}function il(n,e){if(ir(e))throw Error("division by zero");if(ir(n))return new Go(Vs,Vs);if(cn(n))return e=il(ft(n),e),new Go(ft(e.g),ft(e.h));if(cn(e))return e=il(n,ft(e)),new Go(ft(e.g),e.h);if(30<n.g.length){if(cn(n)||cn(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Bf,r=e;0>=r.X(n);)t=Lv(t),r=Lv(r);var i=ys(t,1),s=ys(r,1);for(r=ys(r,2),t=ys(t,2);!ir(r);){var a=s.add(r);0>=a.X(n)&&(i=i.add(t),s=a),r=ys(r,1),t=ys(t,1)}return e=rl(n,i.R(e)),new Go(i,e)}for(i=Vs;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=Math.ceil(Math.log(t)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=On(t),a=s.R(e);cn(a)||0<a.X(n);)t-=r,s=On(t),a=s.R(e);ir(s)&&(s=Bf),i=i.add(s),n=rl(n,a)}return new Go(i,n)}q.gb=function(n){return il(this,n).h};q.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new Ae(t,this.h&n.h)};q.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new Ae(t,this.h|n.h)};q.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new Ae(t,this.h^n.h)};function Lv(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new Ae(t,n.h)}function ys(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new Ae(i,n.h)}nl.prototype.createWebChannel=nl.prototype.g;Jt.prototype.send=Jt.prototype.u;Jt.prototype.open=Jt.prototype.m;Jt.prototype.close=Jt.prototype.close;$l.NO_ERROR=0;$l.TIMEOUT=8;$l.HTTP_ERROR=6;qE.COMPLETE="complete";$E.EventType=ac;ac.OPEN="a";ac.CLOSE="b";ac.ERROR="c";ac.MESSAGE="d";ot.prototype.listen=ot.prototype.O;We.prototype.listenOnce=We.prototype.P;We.prototype.getLastError=We.prototype.Sa;We.prototype.getLastErrorCode=We.prototype.Ia;We.prototype.getStatus=We.prototype.da;We.prototype.getResponseJson=We.prototype.Wa;We.prototype.getResponseText=We.prototype.ja;We.prototype.send=We.prototype.ha;We.prototype.setWithCredentials=We.prototype.Oa;In.prototype.digest=In.prototype.l;In.prototype.reset=In.prototype.reset;In.prototype.update=In.prototype.j;Ae.prototype.add=Ae.prototype.add;Ae.prototype.multiply=Ae.prototype.R;Ae.prototype.modulo=Ae.prototype.gb;Ae.prototype.compare=Ae.prototype.X;Ae.prototype.toNumber=Ae.prototype.ea;Ae.prototype.toString=Ae.prototype.toString;Ae.prototype.getBits=Ae.prototype.D;Ae.fromNumber=On;Ae.fromString=AT;var WF=function(){return new nl},GF=function(){return ql()},lf=$l,zF=qE,KF=Hi,Mv={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Au=$E,HF=We,jF=In,Os=Ae;const Fv="@firebase/firestore";class it{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}it.UNAUTHENTICATED=new it(null),it.GOOGLE_CREDENTIALS=new it("google-credentials-uid"),it.FIRST_PARTY=new it("first-party-uid"),it.MOCK_USER=new it("mock-user");let co="10.7.0";const qr=new Al("@firebase/firestore");function As(){return qr.logLevel}function QF(n){qr.setLogLevel(n)}function N(n,...e){if(qr.logLevel<=ue.DEBUG){const t=e.map(ug);qr.debug(`Firestore (${co}): ${n}`,...t)}}function Qe(n,...e){if(qr.logLevel<=ue.ERROR){const t=e.map(ug);qr.error(`Firestore (${co}): ${n}`,...t)}}function wn(n,...e){if(qr.logLevel<=ue.WARN){const t=e.map(ug);qr.warn(`Firestore (${co}): ${n}`,...t)}}function ug(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function $(n="Unexpected state"){const e=`FIRESTORE (${co}) INTERNAL ASSERTION FAILED: `+n;throw Qe(e),new Error(e)}function z(n,e){n||$()}function YF(n,e){n||$()}function B(n,e){return n}const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends Dt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class st{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class RT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class JF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(it.UNAUTHENTICATED))}shutdown(){}}class XF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class ZF{constructor(e){this.t=e,this.currentUser=it.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let s=new st;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new st,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=s;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},l=h=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?l(h):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new st)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(z(typeof r.accessToken=="string"),new RT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return z(e===null||typeof e=="string"),new it(e)}}class e2{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=it.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class t2{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new e2(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(it.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class n2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class r2{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{s.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,N("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(z(typeof t.token=="string"),this.R=t.token,new n2(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function i2(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class ST{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=i2(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function ne(n,e){return n<e?-1:n>e?1:0}function Ws(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function bT(n){return n+"\0"}class Le{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new k(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Le.fromMillis(Date.now())}static fromDate(e){return Le.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Le(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class K{constructor(e){this.timestamp=e}static fromTimestamp(e){return new K(e)}static min(){return new K(new Le(0,0))}static max(){return new K(new Le(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class La{constructor(e,t,r){t===void 0?t=0:t>e.length&&$(),r===void 0?r=e.length-t:r>e.length-t&&$(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return La.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof La?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ge extends La{construct(e,t,r){return new ge(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new k(b.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new ge(t)}static emptyPath(){return new ge([])}}const s2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ve extends La{construct(e,t,r){return new Ve(e,t,r)}static isValidIdentifier(e){return s2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ve.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ve(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new k(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new k(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new k(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(s(),i++)}if(s(),a)throw new k(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ve(t)}static emptyPath(){return new Ve([])}}class F{constructor(e){this.path=e}static fromPath(e){return new F(ge.fromString(e))}static fromName(e){return new F(ge.fromString(e).popFirst(5))}static empty(){return new F(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ge.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new ge(e.slice()))}}class sl{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function qf(n){return n.fields.find(e=>e.kind===2)}function _i(n){return n.fields.filter(e=>e.kind!==2)}sl.UNKNOWN_ID=-1;class Lu{constructor(e,t){this.fieldPath=e,this.kind=t}}class Ma{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ma(0,Xt.min())}}function PT(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new Le(t+1,0):new Le(t,r));return new Xt(i,F.empty(),e)}function CT(n){return new Xt(n.readTime,n.key,-1)}class Xt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Xt(K.min(),F.empty(),-1)}static max(){return new Xt(K.max(),F.empty(),-1)}}function lg(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:ne(n.largestBatchId,e.largestBatchId))}const DT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class kT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function ti(n){if(n.code!==b.FAILED_PRECONDITION||n.message!==DT)throw n;N("LocalStore","Unexpectedly lost primary lease")}class R{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new R((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof R?t:R.resolve(t)}catch(t){return R.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):R.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):R.reject(t)}static resolve(e){return new R((t,r)=>{t(e)})}static reject(e){return new R((t,r)=>{r(e)})}static waitFor(e){return new R((t,r)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&t()},h=>r(h))}),a=!0,s===i&&t()})}static or(e){let t=R.resolve(!1);for(const r of e)t=t.next(i=>i?R.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new R((r,i)=>{const s=e.length,a=new Array(s);let l=0;for(let h=0;h<s;h++){const f=h;t(e[f]).next(p=>{a[f]=p,++l,l===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new R((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}class Jl{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new st,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new fa(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=hg(r.target.error);this.V.reject(new fa(e,i))}}static open(e,t,r,i){try{return new Jl(t,e.transaction(i,r))}catch(s){throw new fa(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(N("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new a2(t)}}class yn{constructor(e,t,r){this.name=e,this.version=t,this.p=r,yn.S(Ue())===12.2&&Qe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return N("SimpleDb","Removing database:",e),yi(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!va())return!1;if(yn.C())return!0;const e=Ue(),t=yn.S(e),r=0<t&&t<10,i=yn.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async O(e){return this.db||(N("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new fa(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new k(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new k(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new fa(e,a))},i.onupgradeneeded=s=>{N("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.p.N(a,i.transaction,s.oldVersion,this.version).next(()=>{N("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.O(e);const l=Jl.open(this.db,e,s?"readonly":"readwrite",r),h=i(l).next(f=>(l.g(),f)).catch(f=>(l.abort(f),R.reject(f))).toPromise();return h.catch(()=>{}),await l.m,h}catch(l){const h=l,f=h.name!=="FirebaseError"&&a<3;if(N("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),this.close(),!f)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}class o2{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return yi(this.k.delete())}}class fa extends k{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ni(n){return n.name==="IndexedDbTransactionError"}class a2{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(N("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(N("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),yi(r)}add(e){return N("SimpleDb","ADD",this.store.name,e,e),yi(this.store.add(e))}get(e){return yi(this.store.get(e)).next(t=>(t===void 0&&(t=null),N("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return N("SimpleDb","DELETE",this.store.name,e),yi(this.store.delete(e))}count(){return N("SimpleDb","COUNT",this.store.name),yi(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.G(i,(a,l)=>{s.push(l)}).next(()=>s)}{const i=this.store.getAll(r.range);return new R((s,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{s(l.target.result)}})}}j(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new R((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}H(e,t){N("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.J=!1;const i=this.cursor(r);return this.G(i,(s,a,l)=>l.delete())}Y(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Z(e){const t=this.cursor({});return new R((r,i)=>{t.onerror=s=>{const a=hg(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(l=>{l?a.continue():r()}):r()}})}G(e,t){const r=[];return new R((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const l=a.target.result;if(!l)return void i();const h=new o2(l),f=t(l.primaryKey,l.value,h);if(f instanceof R){const p=f.catch(m=>(h.done(),R.reject(m)));r.push(p)}h.isDone?i():h.$===null?l.continue():l.continue(h.$)}}).next(()=>R.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function yi(n){return new R((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=hg(r.target.error);t(i)}})}let Uv=!1;function hg(n){const e=yn.S(Ue());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Uv||(Uv=!0,setTimeout(()=>{throw r},0)),r}}return n}class c2{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){N("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{N("IndexBackiller",`Documents written: ${await this.X.te()}`)}catch(t){ni(t)?N("IndexBackiller","Ignoring IndexedDB error during index backfill: ",t):await ti(t)}await this.ee(6e4)})}}class u2{constructor(e,t){this.localStore=e,this.persistence=t}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ne(t,e))}ne(e,t){const r=new Set;let i=t,s=!0;return R.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return N("IndexBackiller",`Processing collection: ${a}`),this.re(e,a,i).next(l=>{i-=l,r.add(a)});s=!1})).next(()=>t-i)}re(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ie(i,s)).next(l=>(N("IndexBackiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>a.size)}))}ie(e,t){let r=e;return t.changes.forEach((i,s)=>{const a=CT(s);lg(a,r)>0&&(r=a)}),new Xt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Bt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.se(r),this.oe=r=>t.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}Bt._e=-1;function dc(n){return n==null}function Fa(n){return n===0&&1/n==-1/0}function xT(n){return typeof n=="number"&&Number.isInteger(n)&&!Fa(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function kt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Bv(e)),e=l2(n.get(t),e);return Bv(e)}function l2(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function Bv(n){return n+""}function Ln(n){const e=n.length;if(z(e>=2),e===2)return z(n.charAt(0)===""&&n.charAt(1)===""),ge.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf("",s);switch((a<0||a>t)&&$(),n.charAt(a+1)){case"":const l=n.substring(s,a);let h;i.length===0?h=l:(i+=l,h=i,i=""),r.push(h);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:$()}s=a+2}return new ge(r)}const qv=["userId","batchId"];function Mu(n,e){return[n,kt(e)]}function NT(n,e,t){return[n,kt(e),t]}const h2={},d2=["prefixPath","collectionGroup","readTime","documentId"],f2=["prefixPath","collectionGroup","documentId"],p2=["collectionGroup","readTime","prefixPath","documentId"],g2=["canonicalId","targetId"],m2=["targetId","path"],_2=["path","targetId"],y2=["collectionId","parent"],v2=["indexId","uid"],I2=["uid","sequenceNumber"],w2=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],E2=["indexId","uid","orderedDocumentKey"],T2=["userId","collectionPath","documentId"],A2=["userId","collectionPath","largestBatchId"],R2=["userId","collectionGroup","largestBatchId"],VT=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],S2=[...VT,"documentOverlays"],OT=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],LT=OT,b2=[...LT,"indexConfiguration","indexState","indexEntries"];class $f extends kT{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function ct(n,e){const t=B(n);return yn.M(t.ae,e)}function $v(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ji(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function MT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Pe{constructor(e,t){this.comparator=e,this.root=t||dt.EMPTY}insert(e,t){return new Pe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,dt.BLACK,null,null))}remove(e){return new Pe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ru(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ru(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ru(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ru(this.root,e,this.comparator,!0)}}class Ru{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dt{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??dt.RED,this.left=i??dt.EMPTY,this.right=s??dt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new dt(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return dt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return dt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $();const e=this.left.check();if(e!==this.right.check())throw $();return e+(this.isRed()?0:1)}}dt.EMPTY=null,dt.RED=!0,dt.BLACK=!1;dt.EMPTY=new class{constructor(){this.size=0}get key(){throw $()}get value(){throw $()}get color(){throw $()}get left(){throw $()}get right(){throw $()}copy(e,t,r,i,s){return this}insert(e,t,r){return new dt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Re{constructor(e){this.comparator=e,this.data=new Pe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Wv(this.data.getIterator())}getIteratorFrom(e){return new Wv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Re(this.comparator);return t.data=e,t}}class Wv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function vs(n){return n.hasNext()?n.getNext():void 0}class qt{constructor(e){this.fields=e,e.sort(Ve.comparator)}static empty(){return new qt([])}unionWith(e){let t=new Re(Ve.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new qt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ws(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class FT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function P2(){return typeof atob<"u"}class tt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new FT("Invalid base64 string: "+s):s}}(e);return new tt(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new tt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tt.EMPTY_BYTE_STRING=new tt("");const C2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $r(n){if(z(!!n),typeof n=="string"){let e=0;const t=C2.exec(n);if(z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:qe(n.seconds),nanos:qe(n.nanos)}}function qe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Wr(n){return typeof n=="string"?tt.fromBase64String(n):tt.fromUint8Array(n)}function Xl(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function dg(n){const e=n.mapValue.fields.__previous_value__;return Xl(e)?dg(e):e}function Ua(n){const e=$r(n.mapValue.fields.__local_write_time__.timestampValue);return new Le(e.seconds,e.nanos)}class D2{constructor(e,t,r,i,s,a,l,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=f}}class Gr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Gr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Gr&&e.projectId===this.projectId&&e.database===this.database}}const Or={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Fu={nullValue:"NULL_VALUE"};function Oi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Xl(n)?4:UT(n)?9007199254740991:10:$()}function Gn(n,e){if(n===e)return!0;const t=Oi(n);if(t!==Oi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ua(n).isEqual(Ua(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=$r(i.timestampValue),l=$r(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Wr(i.bytesValue).isEqual(Wr(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return qe(i.geoPointValue.latitude)===qe(s.geoPointValue.latitude)&&qe(i.geoPointValue.longitude)===qe(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return qe(i.integerValue)===qe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=qe(i.doubleValue),l=qe(s.doubleValue);return a===l?Fa(a)===Fa(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return Ws(n.arrayValue.values||[],e.arrayValue.values||[],Gn);case 10:return function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if($v(a)!==$v(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(l[h]===void 0||!Gn(a[h],l[h])))return!1;return!0}(n,e);default:return $()}}function Ba(n,e){return(n.values||[]).find(t=>Gn(t,e))!==void 0}function zr(n,e){if(n===e)return 0;const t=Oi(n),r=Oi(e);if(t!==r)return ne(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ne(n.booleanValue,e.booleanValue);case 2:return function(s,a){const l=qe(s.integerValue||s.doubleValue),h=qe(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return Gv(n.timestampValue,e.timestampValue);case 4:return Gv(Ua(n),Ua(e));case 5:return ne(n.stringValue,e.stringValue);case 6:return function(s,a){const l=Wr(s),h=Wr(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),h=a.split("/");for(let f=0;f<l.length&&f<h.length;f++){const p=ne(l[f],h[f]);if(p!==0)return p}return ne(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){const l=ne(qe(s.latitude),qe(a.latitude));return l!==0?l:ne(qe(s.longitude),qe(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,a){const l=s.values||[],h=a.values||[];for(let f=0;f<l.length&&f<h.length;++f){const p=zr(l[f],h[f]);if(p)return p}return ne(l.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===Or.mapValue&&a===Or.mapValue)return 0;if(s===Or.mapValue)return 1;if(a===Or.mapValue)return-1;const l=s.fields||{},h=Object.keys(l),f=a.fields||{},p=Object.keys(f);h.sort(),p.sort();for(let m=0;m<h.length&&m<p.length;++m){const I=ne(h[m],p[m]);if(I!==0)return I;const A=zr(l[h[m]],f[p[m]]);if(A!==0)return A}return ne(h.length,p.length)}(n.mapValue,e.mapValue);default:throw $()}}function Gv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ne(n,e);const t=$r(n),r=$r(e),i=ne(t.seconds,r.seconds);return i!==0?i:ne(t.nanos,r.nanos)}function Gs(n){return Wf(n)}function Wf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=$r(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Wr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return F.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Wf(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${Wf(t.fields[a])}`;return i+"}"}(n.mapValue):$()}function Li(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Gf(n){return!!n&&"integerValue"in n}function qa(n){return!!n&&"arrayValue"in n}function zv(n){return!!n&&"nullValue"in n}function Kv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Uu(n){return!!n&&"mapValue"in n}function pa(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ji(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=pa(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=pa(n.arrayValue.values[t]);return e}return Object.assign({},n)}function UT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function k2(n){return"nullValue"in n?Fu:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Li(Gr.empty(),F.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:$()}function x2(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Li(Gr.empty(),F.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Or:$()}function Hv(n,e){const t=zr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function jv(n,e){const t=zr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class pt{constructor(e){this.value=e}static empty(){return new pt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Uu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=pa(t)}setAll(e){let t=Ve.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!t.isImmediateParentOf(l)){const h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=l.popLast()}a?r[l.lastSegment()]=pa(a):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Uu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Gn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Uu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ji(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new pt(pa(this.value))}}function BT(n){const e=[];return ji(n.fields,(t,r)=>{const i=new Ve([t]);if(Uu(r)){const s=BT(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new qt(e)}class xe{constructor(e,t,r,i,s,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new xe(e,0,K.min(),K.min(),K.min(),pt.empty(),0)}static newFoundDocument(e,t,r,i){return new xe(e,1,t,K.min(),r,i,0)}static newNoDocument(e,t){return new xe(e,2,t,K.min(),K.min(),pt.empty(),0)}static newUnknownDocument(e,t){return new xe(e,3,t,K.min(),K.min(),pt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Kr{constructor(e,t){this.position=e,this.inclusive=t}}function Qv(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=zr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Yv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Gn(n.position[t],e.position[t]))return!1;return!0}class $a{constructor(e,t="asc"){this.field=e,this.dir=t}}function N2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class qT{}class he extends qT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new V2(e,t,r):t==="array-contains"?new M2(e,r):t==="in"?new HT(e,r):t==="not-in"?new F2(e,r):t==="array-contains-any"?new U2(e,r):new he(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new O2(e,r):new L2(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(zr(t,this.value)):t!==null&&Oi(this.value)===Oi(t)&&this.matchesComparison(zr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Te extends qT{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Te(e,t)}matches(e){return zs(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function zs(n){return n.op==="and"}function zf(n){return n.op==="or"}function fg(n){return $T(n)&&zs(n)}function $T(n){for(const e of n.filters)if(e instanceof Te)return!1;return!0}function Kf(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+Gs(n.value);if(fg(n))return n.filters.map(e=>Kf(e)).join(",");{const e=n.filters.map(t=>Kf(t)).join(",");return`${n.op}(${e})`}}function WT(n,e){return n instanceof he?function(r,i){return i instanceof he&&r.op===i.op&&r.field.isEqual(i.field)&&Gn(r.value,i.value)}(n,e):n instanceof Te?function(r,i){return i instanceof Te&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,l)=>s&&WT(a,i.filters[l]),!0):!1}(n,e):void $()}function GT(n,e){const t=n.filters.concat(e);return Te.create(t,n.op)}function zT(n){return n instanceof he?function(t){return`${t.field.canonicalString()} ${t.op} ${Gs(t.value)}`}(n):n instanceof Te?function(t){return t.op.toString()+" {"+t.getFilters().map(zT).join(" ,")+"}"}(n):"Filter"}class V2 extends he{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){const t=F.comparator(e.key,this.key);return this.matchesComparison(t)}}class O2 extends he{constructor(e,t){super(e,"in",t),this.keys=KT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class L2 extends he{constructor(e,t){super(e,"not-in",t),this.keys=KT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function KT(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>F.fromName(r.referenceValue))}class M2 extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return qa(t)&&Ba(t.arrayValue,this.value)}}class HT extends he{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ba(this.value.arrayValue,t)}}class F2 extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ba(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Ba(this.value.arrayValue,t)}}class U2 extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!qa(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ba(this.value.arrayValue,r))}}class B2{constructor(e,t=null,r=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.ce=null}}function Hf(n,e=null,t=[],r=[],i=null,s=null,a=null){return new B2(n,e,t,r,i,s,a)}function Mi(n){const e=B(n);if(e.ce===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Kf(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),dc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Gs(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Gs(r)).join(",")),e.ce=t}return e.ce}function fc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!N2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!WT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Yv(n.startAt,e.startAt)&&Yv(n.endAt,e.endAt)}function ol(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function al(n,e){return n.filters.filter(t=>t instanceof he&&t.field.isEqual(e))}function Jv(n,e,t){let r=Fu,i=!0;for(const s of al(n,e)){let a=Fu,l=!0;switch(s.op){case"<":case"<=":a=k2(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,l=!1;break;case"!=":case"not-in":a=Fu}Hv({value:r,inclusive:i},{value:a,inclusive:l})<0&&(r=a,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Hv({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function Xv(n,e,t){let r=Or,i=!0;for(const s of al(n,e)){let a=Or,l=!0;switch(s.op){case">=":case">":a=x2(s.value),l=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,l=!1;break;case"!=":case"not-in":a=Or}jv({value:r,inclusive:i},{value:a,inclusive:l})>0&&(r=a,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];jv({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class pr{constructor(e,t=null,r=[],i=[],s=null,a="F",l=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=h,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function jT(n,e,t,r,i,s,a,l){return new pr(n,e,t,r,i,s,a,l)}function uo(n){return new pr(n)}function Zv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function pg(n){return n.collectionGroup!==null}function Ls(n){const e=B(n);if(e.le===null){e.le=[];const t=new Set;for(const s of e.explicitOrderBy)e.le.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Re(Ve.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.le.push(new $a(s,r))}),t.has(Ve.keyField().canonicalString())||e.le.push(new $a(Ve.keyField(),r))}return e.le}function xt(n){const e=B(n);return e.he||(e.he=q2(e,Ls(n))),e.he}function q2(n,e){if(n.limitType==="F")return Hf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new $a(i.field,s)});const t=n.endAt?new Kr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Kr(n.startAt.position,n.startAt.inclusive):null;return Hf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function jf(n,e){const t=n.filters.concat([e]);return new pr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function cl(n,e,t){return new pr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function pc(n,e){return fc(xt(n),xt(e))&&n.limitType===e.limitType}function QT(n){return`${Mi(xt(n))}|lt:${n.limitType}`}function Rs(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>zT(i)).join(", ")}]`),dc(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Gs(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Gs(i)).join(",")),`Target(${r})`}(xt(n))}; limitType=${n.limitType})`}function gc(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):F.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Ls(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,l,h){const f=Qv(a,l,h);return a.inclusive?f<=0:f<0}(r.startAt,Ls(r),i)||r.endAt&&!function(a,l,h){const f=Qv(a,l,h);return a.inclusive?f>=0:f>0}(r.endAt,Ls(r),i))}(n,e)}function YT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function JT(n){return(e,t)=>{let r=!1;for(const i of Ls(n)){const s=$2(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function $2(n,e,t){const r=n.field.isKeyField()?F.comparator(e.key,t.key):function(s,a,l){const h=a.data.field(s),f=l.data.field(s);return h!==null&&f!==null?zr(h,f):$()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return $()}}class ri{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ji(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return MT(this.inner)}size(){return this.innerSize}}const W2=new Pe(F.comparator);function $t(){return W2}const XT=new Pe(F.comparator);function sa(...n){let e=XT;for(const t of n)e=e.insert(t.key,t);return e}function ZT(n){let e=XT;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Mn(){return ga()}function eA(){return ga()}function ga(){return new ri(n=>n.toString(),(n,e)=>n.isEqual(e))}const G2=new Pe(F.comparator),z2=new Re(F.comparator);function re(...n){let e=z2;for(const t of n)e=e.add(t);return e}const K2=new Re(ne);function gg(){return K2}function tA(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fa(e)?"-0":e}}function nA(n){return{integerValue:""+n}}function rA(n,e){return xT(e)?nA(e):tA(n,e)}class Zl{constructor(){this._=void 0}}function H2(n,e,t){return n instanceof Ks?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Xl(s)&&(s=dg(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof Fi?sA(n,e):n instanceof Ui?oA(n,e):function(i,s){const a=iA(i,s),l=eI(a)+eI(i.Ie);return Gf(a)&&Gf(i.Ie)?nA(l):tA(i.serializer,l)}(n,e)}function j2(n,e,t){return n instanceof Fi?sA(n,e):n instanceof Ui?oA(n,e):t}function iA(n,e){return n instanceof Hs?function(r){return Gf(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ks extends Zl{}class Fi extends Zl{constructor(e){super(),this.elements=e}}function sA(n,e){const t=aA(e);for(const r of n.elements)t.some(i=>Gn(i,r))||t.push(r);return{arrayValue:{values:t}}}class Ui extends Zl{constructor(e){super(),this.elements=e}}function oA(n,e){let t=aA(e);for(const r of n.elements)t=t.filter(i=>!Gn(i,r));return{arrayValue:{values:t}}}class Hs extends Zl{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function eI(n){return qe(n.integerValue||n.doubleValue)}function aA(n){return qa(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class mc{constructor(e,t){this.field=e,this.transform=t}}function Q2(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Fi&&i instanceof Fi||r instanceof Ui&&i instanceof Ui?Ws(r.elements,i.elements,Gn):r instanceof Hs&&i instanceof Hs?Gn(r.Ie,i.Ie):r instanceof Ks&&i instanceof Ks}(n.transform,e.transform)}class Y2{constructor(e,t){this.version=e,this.transformResults=t}}class Oe{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Oe}static exists(e){return new Oe(void 0,e)}static updateTime(e){return new Oe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class eh{}function cA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ho(n.key,Oe.none()):new lo(n.key,n.data,Oe.none());{const t=n.data,r=pt.empty();let i=new Re(Ve.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new gr(n.key,r,new qt(i.toArray()),Oe.none())}}function J2(n,e,t){n instanceof lo?function(i,s,a){const l=i.value.clone(),h=nI(i.fieldTransforms,s,a.transformResults);l.setAll(h),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof gr?function(i,s,a){if(!Bu(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=nI(i.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(uA(i)),h.setAll(l),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function ma(n,e,t,r){return n instanceof lo?function(s,a,l,h){if(!Bu(s.precondition,a))return l;const f=s.value.clone(),p=rI(s.fieldTransforms,h,a);return f.setAll(p),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof gr?function(s,a,l,h){if(!Bu(s.precondition,a))return l;const f=rI(s.fieldTransforms,h,a),p=a.data;return p.setAll(uA(s)),p.setAll(f),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,a,l){return Bu(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(n,e,t)}function X2(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=iA(r.transform,i||null);s!=null&&(t===null&&(t=pt.empty()),t.set(r.field,s))}return t||null}function tI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ws(r,i,(s,a)=>Q2(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class lo extends eh{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class gr extends eh{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function uA(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function nI(n,e,t){const r=new Map;z(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,l=e.data.field(s.field);r.set(s.field,j2(a,l,t[i]))}return r}function rI(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,H2(s,a,e))}return r}class ho extends eh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mg extends eh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class _g{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&J2(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ma(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ma(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=eA();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=t.has(i.key)?null:l;const h=cA(a,l);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),re())}isEqual(e){return this.batchId===e.batchId&&Ws(this.mutations,e.mutations,(t,r)=>tI(t,r))&&Ws(this.baseMutations,e.baseMutations,(t,r)=>tI(t,r))}}class yg{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){z(e.mutations.length===r.length);let i=function(){return G2}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new yg(e,t,r,i)}}class vg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Z2{constructor(e,t){this.count=e,this.unchangedNames=t}}var Je,pe;function lA(n){switch(n){default:return $();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function hA(n){if(n===void 0)return Qe("GRPC error has no .code"),b.UNKNOWN;switch(n){case Je.OK:return b.OK;case Je.CANCELLED:return b.CANCELLED;case Je.UNKNOWN:return b.UNKNOWN;case Je.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Je.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Je.INTERNAL:return b.INTERNAL;case Je.UNAVAILABLE:return b.UNAVAILABLE;case Je.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Je.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Je.NOT_FOUND:return b.NOT_FOUND;case Je.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Je.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Je.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Je.ABORTED:return b.ABORTED;case Je.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Je.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Je.DATA_LOSS:return b.DATA_LOSS;default:return $()}}(pe=Je||(Je={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";function dA(){return new TextEncoder}const eU=new Os([4294967295,4294967295],0);function iI(n){const e=dA().encode(n),t=new jF;return t.update(e),new Uint8Array(t.digest())}function sI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Os([t,r],0),new Os([i,s],0)]}class Ig{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new oa(`Invalid padding: ${t}`);if(r<0)throw new oa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new oa(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new oa(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=Os.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(Os.fromNumber(r)));return i.compare(eU)===1&&(i=new Os([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const t=iI(e),[r,i]=sI(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);if(!this.Ae(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Ig(s,i,t);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Te===0)return;const t=iI(e),[r,i]=sI(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);this.Re(a)}}Re(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class oa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class _c{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,yc.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new _c(K.min(),i,new Pe(ne),$t(),re())}}class yc{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new yc(r,t,re(),re(),re())}}class qu{constructor(e,t,r,i){this.Ve=e,this.removedTargetIds=t,this.key=r,this.me=i}}class fA{constructor(e,t){this.targetId=e,this.fe=t}}class pA{constructor(e,t,r=tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class oI{constructor(){this.ge=0,this.pe=cI(),this.ye=tt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=re(),t=re(),r=re();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:$()}}),new yc(this.ye,this.we,e,t,r)}Fe(){this.Se=!1,this.pe=cI()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,z(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class tU{constructor(e){this.Le=e,this.ke=new Map,this.qe=$t(),this.Qe=aI(),this.Ke=new Pe(ne)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(t);break;case 3:this.je(t)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.Ce(e.resumeToken));break;default:$()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){const t=e.targetId,r=e.fe.count,i=this.Ye(t);if(i){const s=i.target;if(ol(s))if(r===0){const a=new F(s.path);this.We(t,a,xe.newNoDocument(a,K.min()))}else z(r===1);else{const a=this.Ze(t);if(a!==r){const l=this.Xe(e),h=l?this.et(l,e,a):1;if(h!==0){this.He(t);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,f)}}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,l;try{a=Wr(r).toUint8Array()}catch(h){if(h instanceof FT)return wn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{l=new Ig(a,i,s)}catch(h){return wn(h instanceof oa?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return l.Te===0?null:l}et(e,t,r){return t.fe.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const a=this.Le.nt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.We(t,s,null),i++)}),i}it(e){const t=new Map;this.ke.forEach((s,a)=>{const l=this.Ye(a);if(l){if(s.current&&ol(l.target)){const h=new F(l.target.path);this.qe.get(h)!==null||this.st(a,h)||this.We(a,h,xe.newNoDocument(h,e))}s.De&&(t.set(a,s.ve()),s.Fe())}});let r=re();this.Qe.forEach((s,a)=>{let l=!0;a.forEachWhile(h=>{const f=this.Ye(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(e));const i=new _c(e,t,this.Ke,this.qe,r);return this.qe=$t(),this.Qe=aI(),this.Ke=new Pe(ne),i}Ue(e,t){if(!this.je(e))return;const r=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,r),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,t)?i.Me(t,1):i.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),r&&(this.qe=this.qe.insert(t,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new oI,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new Re(ne),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=this.Ye(e)!==null;return t||N("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new oI),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function aI(){return new Pe(F.comparator)}function cI(){return new Pe(F.comparator)}const nU=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),rU=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),iU=(()=>({and:"AND",or:"OR"}))();class sU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Qf(n,e){return n.useProto3Json||dc(e)?e:{value:e}}function js(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function gA(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function oU(n,e){return js(n,e.toTimestamp())}function Ye(n){return z(!!n),K.fromTimestamp(function(t){const r=$r(t);return new Le(r.seconds,r.nanos)}(n))}function wg(n,e){return function(r){return new ge(["projects",r.projectId,"databases",r.database])}(n).child("documents").child(e).canonicalString()}function mA(n){const e=ge.fromString(n);return z(RA(e)),e}function Wa(n,e){return wg(n.databaseId,e.path)}function Bn(n,e){const t=mA(e);if(t.get(1)!==n.databaseId.projectId)throw new k(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new k(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(yA(t))}function Yf(n,e){return wg(n.databaseId,e)}function _A(n){const e=mA(n);return e.length===4?ge.emptyPath():yA(e)}function Ga(n){return new ge(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function yA(n){return z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function uI(n,e,t){return{name:Wa(n,e),fields:t.value.mapValue.fields}}function vA(n,e,t){const r=Bn(n,e.name),i=Ye(e.updateTime),s=e.createTime?Ye(e.createTime):K.min(),a=new pt({mapValue:{fields:e.fields}}),l=xe.newFoundDocument(r,i,s,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function aU(n,e){return"found"in e?function(r,i){z(!!i.found),i.found.name,i.found.updateTime;const s=Bn(r,i.found.name),a=Ye(i.found.updateTime),l=i.found.createTime?Ye(i.found.createTime):K.min(),h=new pt({mapValue:{fields:i.found.fields}});return xe.newFoundDocument(s,a,l,h)}(n,e):"missing"in e?function(r,i){z(!!i.missing),z(!!i.readTime);const s=Bn(r,i.missing),a=Ye(i.readTime);return xe.newNoDocument(s,a)}(n,e):$()}function cU(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:$()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(f,p){return f.useProto3Json?(z(p===void 0||typeof p=="string"),tt.fromBase64String(p||"")):(z(p===void 0||p instanceof Uint8Array),tt.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(f){const p=f.code===void 0?b.UNKNOWN:hA(f.code);return new k(p,f.message||"")}(a);t=new pA(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Bn(n,r.document.name),s=Ye(r.document.updateTime),a=r.document.createTime?Ye(r.document.createTime):K.min(),l=new pt({mapValue:{fields:r.document.fields}}),h=xe.newFoundDocument(i,s,a,l),f=r.targetIds||[],p=r.removedTargetIds||[];t=new qu(f,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Bn(n,r.document),s=r.readTime?Ye(r.readTime):K.min(),a=xe.newNoDocument(i,s),l=r.removedTargetIds||[];t=new qu([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Bn(n,r.document),s=r.removedTargetIds||[];t=new qu([],s,i,null)}else{if(!("filter"in e))return $();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new Z2(i,s),l=r.targetId;t=new fA(l,a)}}return t}function za(n,e){let t;if(e instanceof lo)t={update:uI(n,e.key,e.value)};else if(e instanceof ho)t={delete:Wa(n,e.key)};else if(e instanceof gr)t={update:uI(n,e.key,e.data),updateMask:pU(e.fieldMask)};else{if(!(e instanceof mg))return $();t={verify:Wa(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const l=a.transform;if(l instanceof Ks)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Fi)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ui)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Hs)return{fieldPath:a.field.canonicalString(),increment:l.Ie};throw $()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:oU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:$()}(n,e.precondition)),t}function Jf(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Oe.updateTime(Ye(s.updateTime)):s.exists!==void 0?Oe.exists(s.exists):Oe.none()}(e.currentDocument):Oe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;if("setToServerValue"in l)z(l.setToServerValue==="REQUEST_TIME"),h=new Ks;else if("appendMissingElements"in l){const p=l.appendMissingElements.values||[];h=new Fi(p)}else if("removeAllFromArray"in l){const p=l.removeAllFromArray.values||[];h=new Ui(p)}else"increment"in l?h=new Hs(a,l.increment):$();const f=Ve.fromServerFormat(l.fieldPath);return new mc(f,h)}(n,i)):[];if(e.update){e.update.name;const i=Bn(n,e.update.name),s=new pt({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(h){const f=h.fieldPaths||[];return new qt(f.map(p=>Ve.fromServerFormat(p)))}(e.updateMask);return new gr(i,s,a,t,r)}return new lo(i,s,t,r)}if(e.delete){const i=Bn(n,e.delete);return new ho(i,t)}if(e.verify){const i=Bn(n,e.verify);return new mg(i,t)}return $()}function uU(n,e){return n&&n.length>0?(z(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?Ye(i.updateTime):Ye(s);return a.isEqual(K.min())&&(a=Ye(s)),new Y2(a,i.transformResults||[])}(t,e))):[]}function IA(n,e){return{documents:[Yf(n,e.path)]}}function wA(n,e){const t={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(t.parent=Yf(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Yf(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(h){if(h.length!==0)return AA(Te.create(h,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(h){if(h.length!==0)return h.map(f=>function(m){return{field:Ss(m.field),direction:hU(m.dir)}}(f))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=Qf(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),t}function EA(n){let e=_A(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){z(r===1);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){const I=TA(m);return I instanceof Te&&fg(I)?I.getFilters():[I]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(I=>function(L){return new $a(bs(L.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(L.direction))}(I))}(t.orderBy));let l=null;t.limit&&(l=function(m){let I;return I=typeof m=="object"?m.value:m,dc(I)?null:I}(t.limit));let h=null;t.startAt&&(h=function(m){const I=!!m.before,A=m.values||[];return new Kr(A,I)}(t.startAt));let f=null;return t.endAt&&(f=function(m){const I=!m.before,A=m.values||[];return new Kr(A,I)}(t.endAt)),jT(e,i,a,s,l,"F",h,f)}function lU(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function TA(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=bs(t.unaryFilter.field);return he.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=bs(t.unaryFilter.field);return he.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=bs(t.unaryFilter.field);return he.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=bs(t.unaryFilter.field);return he.create(a,"!=",{nullValue:"NULL_VALUE"});default:return $()}}(n):n.fieldFilter!==void 0?function(t){return he.create(bs(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Te.create(t.compositeFilter.filters.map(r=>TA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $()}}(t.compositeFilter.op))}(n):$()}function hU(n){return nU[n]}function dU(n){return rU[n]}function fU(n){return iU[n]}function Ss(n){return{fieldPath:n.canonicalString()}}function bs(n){return Ve.fromServerFormat(n.fieldPath)}function AA(n){return n instanceof he?function(t){if(t.op==="=="){if(Kv(t.value))return{unaryFilter:{field:Ss(t.field),op:"IS_NAN"}};if(zv(t.value))return{unaryFilter:{field:Ss(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Kv(t.value))return{unaryFilter:{field:Ss(t.field),op:"IS_NOT_NAN"}};if(zv(t.value))return{unaryFilter:{field:Ss(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ss(t.field),op:dU(t.op),value:t.value}}}(n):n instanceof Te?function(t){const r=t.getFilters().map(i=>AA(i));return r.length===1?r[0]:{compositeFilter:{op:fU(t.op),filters:r}}}(n):$()}function pU(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function RA(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class sr{constructor(e,t,r,i,s=K.min(),a=K.min(),l=tt.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(e){return new sr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new sr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class SA{constructor(e){this.ut=e}}function gU(n,e){let t;if(e.document)t=vA(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=F.fromSegments(e.noDocument.path),i=qi(e.noDocument.readTime);t=xe.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return $();{const r=F.fromSegments(e.unknownDocument.path),i=qi(e.unknownDocument.version);t=xe.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Le(i[0],i[1]);return K.fromTimestamp(s)}(e.readTime)),t}function lI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ul(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,a){return{name:Wa(s,a.key),fields:a.data.value.mapValue.fields,updateTime:js(s,a.version.toTimestamp()),createTime:js(s,a.createTime.toTimestamp())}}(n.ut,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Bi(e.version)};else{if(!e.isUnknownDocument())return $();r.unknownDocument={path:t.path.toArray(),version:Bi(e.version)}}return r}function ul(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Bi(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function qi(n){const e=new Le(n.seconds,n.nanoseconds);return K.fromTimestamp(e)}function vi(n,e){const t=(e.baseMutations||[]).map(s=>Jf(n.ut,s));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];a.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Jf(n.ut,s)),i=Le.fromMillis(e.localWriteTimeMs);return new _g(e.batchId,i,t,r)}function aa(n){const e=qi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?qi(n.lastLimboFreeSnapshotVersion):K.min();let r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return z(s.documents.length===1),xt(uo(_A(s.documents[0])))}(n.query):function(s){return xt(EA(s))}(n.query),new sr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,tt.fromBase64String(n.resumeToken))}function bA(n,e){const t=Bi(e.snapshotVersion),r=Bi(e.lastLimboFreeSnapshotVersion);let i;i=ol(e.target)?IA(n.ut,e.target):wA(n.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Mi(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Eg(n){const e=EA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?cl(e,e.limit,"L"):e}function hf(n,e){return new vg(e.largestBatchId,Jf(n.ut,e.overlayMutation))}function hI(n,e){const t=e.path.lastSegment();return[n,kt(e.path.popLast()),t]}function dI(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Bi(r.readTime),documentKey:kt(r.documentKey.path),largestBatchId:r.largestBatchId}}class mU{getBundleMetadata(e,t){return fI(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:qi(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return fI(e).put(function(i){return{bundleId:i.id,createTime:Bi(Ye(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return pI(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:Eg(s.bundledQuery),readTime:qi(s.readTime)}}(r)})}saveNamedQuery(e,t){return pI(e).put(function(i){return{name:i.name,readTime:Bi(Ye(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function fI(n){return ct(n,"bundles")}function pI(n){return ct(n,"namedQueries")}class th{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){const r=t.uid||"";return new th(e,r)}getOverlay(e,t){return zo(e).get(hI(this.userId,t)).next(r=>r?hf(this.serializer,r):null)}getOverlays(e,t){const r=Mn();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,a)=>{const l=new vg(t,a);i.push(this.lt(e,l))}),R.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(a=>i.add(kt(a.getCollectionPath())));const s=[];return i.forEach(a=>{const l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(zo(e).H("collectionPathOverlayIndex",l))}),R.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Mn(),s=kt(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return zo(e).W("collectionPathOverlayIndex",a).next(l=>{for(const h of l){const f=hf(this.serializer,h);i.set(f.getKey(),f)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Mn();let a;const l=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return zo(e).Y({index:"collectionGroupOverlayIndex",range:l},(h,f,p)=>{const m=hf(this.serializer,f);s.size()<i||m.largestBatchId===a?(s.set(m.getKey(),m),a=m.largestBatchId):p.done()}).next(()=>s)}lt(e,t){return zo(e).put(function(i,s,a){const[l,h,f]=hI(s,a.mutation.key);return{userId:s,collectionPath:h,documentId:f,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:za(i.ut,a.mutation)}}(this.serializer,this.userId,t))}}function zo(n){return ct(n,"documentOverlays")}class Ii{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(qe(e.integerValue));else if("doubleValue"in e){const r=qe(e.doubleValue);isNaN(r)?this.Tt(t,13):(this.Tt(t,15),Fa(r)?t.Et(0):t.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(t,20),typeof r=="string"?t.dt(r):(t.dt(`${r.seconds||""}`),t.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(Wr(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(t,45),t.Et(r.latitude||0),t.Et(r.longitude||0)}else"mapValue"in e?UT(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):$()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const r=e.fields||{};this.Tt(t,55);for(const i of Object.keys(r))this.At(i,t),this.Pt(r[i],t)}yt(e,t){const r=e.values||[];this.Tt(t,50);for(const i of r)this.Pt(i,t)}ft(e,t){this.Tt(t,37),F.fromName(e).path.forEach(r=>{this.Tt(t,60),this.wt(r,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}Ii.St=new Ii;function _U(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function gI(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const a=_U(255&r[s]);if(i+=a,a!==8)break}return i}(n);return Math.ceil(e/8)}class yU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Dt(r.value),r=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=t.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const t=this.Bt(e),r=gI(t);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}kt(e){const t=this.Bt(e),r=gI(t);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Dt(e){const t=255&e;t===0?(this.Qt(0),this.Qt(255)):t===255?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;t===0?(this.$t(0),this.$t(255)):t===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class vU{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class IU{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class Ko{constructor(){this.Wt=new yU,this.Gt=new vU(this.Wt),this.zt=new IU(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class wi{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new wi(this.indexId,this.documentKey,this.arrayValue,r)}}function Pr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=mI(n.arrayValue,e.arrayValue),t!==0?t:(t=mI(n.directionalValue,e.directionalValue),t!==0?t:F.comparator(n.documentKey,e.documentKey)))}function mI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}class _I{constructor(e){this.Jt=new Re((t,r)=>Ve.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const r=t;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(z(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=qf(e);if(t!==void 0&&!this.tn(t))return!1;const r=_i(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const l=this.Jt.getIterator().getNext();if(!i.has(l.field.canonicalString())){const h=r[s];if(!this.nn(l,h)||!this.rn(this.Yt[a++],h))return!1}++s}for(;s<r.length;++s){const l=r[s];if(a>=this.Yt.length||!this.rn(this.Yt[a++],l))return!1}return!0}sn(){if(this.Xt)return null;let e=new Re(Ve.comparator);const t=[];for(const r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Lu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Lu(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Lu(r.field,r.dir==="asc"?0:1)));return new sl(sl.UNKNOWN_ID,this.collectionId,t,Ma.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function PA(n){var e,t;if(z(n instanceof he||n instanceof Te),n instanceof he){if(n instanceof HT){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>he.create(n.field,"==",s)))||[];return Te.create(i,"or")}return n}const r=n.filters.map(i=>PA(i));return Te.create(r,n.op)}function wU(n){if(n.getFilters().length===0)return[];const e=ep(PA(n));return z(CA(e)),Xf(e)||Zf(e)?[e]:e.getFilters()}function Xf(n){return n instanceof he}function Zf(n){return n instanceof Te&&fg(n)}function CA(n){return Xf(n)||Zf(n)||function(t){if(t instanceof Te&&zf(t)){for(const r of t.getFilters())if(!Xf(r)&&!Zf(r))return!1;return!0}return!1}(n)}function ep(n){if(z(n instanceof he||n instanceof Te),n instanceof he)return n;if(n.filters.length===1)return ep(n.filters[0]);const e=n.filters.map(r=>ep(r));let t=Te.create(e,n.op);return t=ll(t),CA(t)?t:(z(t instanceof Te),z(zs(t)),z(t.filters.length>1),t.filters.reduce((r,i)=>Tg(r,i)))}function Tg(n,e){let t;return z(n instanceof he||n instanceof Te),z(e instanceof he||e instanceof Te),t=n instanceof he?e instanceof he?function(i,s){return Te.create([i,s],"and")}(n,e):yI(n,e):e instanceof he?yI(e,n):function(i,s){if(z(i.filters.length>0&&s.filters.length>0),zs(i)&&zs(s))return GT(i,s.getFilters());const a=zf(i)?i:s,l=zf(i)?s:i,h=a.filters.map(f=>Tg(f,l));return Te.create(h,"or")}(n,e),ll(t)}function yI(n,e){if(zs(e))return GT(e,n.getFilters());{const t=e.filters.map(r=>Tg(n,r));return Te.create(t,"or")}}function ll(n){if(z(n instanceof he||n instanceof Te),n instanceof he)return n;const e=n.getFilters();if(e.length===1)return ll(e[0]);if($T(n))return n;const t=e.map(i=>ll(i)),r=[];return t.forEach(i=>{i instanceof he?r.push(i):i instanceof Te&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Te.create(r,n.op)}class EU{constructor(){this.on=new Ag}addToCollectionParentIndex(e,t){return this.on.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(Xt.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(Xt.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}}class Ag{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Re(ge.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Re(ge.comparator)).toArray()}}const Su=new Uint8Array(0);class TU{constructor(e,t){this.user=e,this.databaseId=t,this._n=new Ag,this.an=new ri(r=>Mi(r),(r,i)=>fc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:r,parent:kt(i)};return vI(e).put(s)}return R.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[bT(t),""],!1,!0);return vI(e).W(i).next(s=>{for(const a of s){if(a.collectionId!==t)break;r.push(Ln(a.parent))}return r})}addFieldIndex(e,t){const r=Ho(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=ws(e);return s.next(l=>{a.put(dI(l,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=Ho(e),i=ws(e),s=Is(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Ho(e),r=Is(e),i=ws(e);return t.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,t){return R.forEach(this.un(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new _I(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=Is(e);let i=!0;const s=new Map;return R.forEach(this.un(t),a=>this.cn(e,a).next(l=>{i&&(i=!!l),s.set(a,l)})).next(()=>{if(i){let a=re();const l=[];return R.forEach(s,(h,f)=>{N("IndexedDbIndexManager",`Using index ${function(j){return`id=${j.indexId}|cg=${j.collectionGroup}|f=${j.fields.map(ye=>`${ye.fieldPath}:${ye.kind}`).join(",")}`}(h)} to execute ${Mi(t)}`);const p=function(j,ye){const de=qf(ye);if(de===void 0)return null;for(const me of al(j,de.fieldPath))switch(me.op){case"array-contains-any":return me.value.arrayValue.values||[];case"array-contains":return[me.value]}return null}(f,h),m=function(j,ye){const de=new Map;for(const me of _i(ye))for(const we of al(j,me.fieldPath))switch(we.op){case"==":case"in":de.set(me.fieldPath.canonicalString(),we.value);break;case"not-in":case"!=":return de.set(me.fieldPath.canonicalString(),we.value),Array.from(de.values())}return null}(f,h),I=function(j,ye){const de=[];let me=!0;for(const we of _i(ye)){const Nt=we.kind===0?Jv(j,we.fieldPath,j.startAt):Xv(j,we.fieldPath,j.startAt);de.push(Nt.value),me&&(me=Nt.inclusive)}return new Kr(de,me)}(f,h),A=function(j,ye){const de=[];let me=!0;for(const we of _i(ye)){const Nt=we.kind===0?Xv(j,we.fieldPath,j.endAt):Jv(j,we.fieldPath,j.endAt);de.push(Nt.value),me&&(me=Nt.inclusive)}return new Kr(de,me)}(f,h),L=this.ln(h,f,I),M=this.ln(h,f,A),V=this.hn(h,f,m),Y=this.Pn(h.indexId,p,L,I.inclusive,M,A.inclusive,V);return R.forEach(Y,ae=>r.j(ae,t.limit).next(j=>{j.forEach(ye=>{const de=F.fromSegments(ye.documentKey);a.has(de)||(a=a.add(de),l.push(de))})}))}).next(()=>l)}return R.resolve(null)})}un(e){let t=this.an.get(e);return t||(e.filters.length===0?t=[e]:t=wU(Te.create(e.filters,"and")).map(r=>Hf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,r,i,s,a,l){const h=(t!=null?t.length:1)*Math.max(r.length,s.length),f=h/(t!=null?t.length:1),p=[];for(let m=0;m<h;++m){const I=t?this.In(t[m/f]):Su,A=this.Tn(e,I,r[m%f],i),L=this.En(e,I,s[m%f],a),M=l.map(V=>this.Tn(e,I,V,!0));p.push(...this.createRange(A,L,M))}return p}Tn(e,t,r,i){const s=new wi(e,F.empty(),t,r);return i?s:s.Ht()}En(e,t,r,i){const s=new wi(e,F.empty(),t,r);return i?s.Ht():s}cn(e,t){const r=new _I(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const l of s)r.en(l)&&(!a||l.fields.length>a.fields.length)&&(a=l);return a})}getIndexType(e,t){let r=2;const i=this.un(t);return R.forEach(i,s=>this.cn(e,s).next(a=>{a?r!==0&&a.fields.length<function(h){let f=new Re(Ve.comparator),p=!1;for(const m of h.filters)for(const I of m.getFlattenedFilters())I.field.isKeyField()||(I.op==="array-contains"||I.op==="array-contains-any"?p=!0:f=f.add(I.field));for(const m of h.orderBy)m.field.isKeyField()||(f=f.add(m.field));return f.size+(p?1:0)}(s)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(t)&&i.length>1&&r===2?1:r)}dn(e,t){const r=new Ko;for(const i of _i(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.jt(i.kind);Ii.St.ht(s,a)}return r.Ut()}In(e){const t=new Ko;return Ii.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const r=new Ko;return Ii.St.ht(Li(this.databaseId,t),r.jt(function(s){const a=_i(s);return a.length===0?0:a[a.length-1].kind}(e))),r.Ut()}hn(e,t,r){if(r===null)return[];let i=[];i.push(new Ko);let s=0;for(const a of _i(e)){const l=r[s++];for(const h of i)if(this.Rn(t,a.fieldPath)&&qa(l))i=this.Vn(i,a,l);else{const f=h.jt(a.kind);Ii.St.ht(l,f)}}return this.mn(i)}ln(e,t,r){return this.hn(e,t,r.position)}mn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ut();return t}Vn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const l of i){const h=new Ko;h.seed(l.Ut()),Ii.St.ht(a,h.jt(t.kind)),s.push(h)}return s}Rn(e,t){return!!e.filters.find(r=>r instanceof he&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Ho(e),i=ws(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(s=>{const a=[];return R.forEach(s,l=>i.get([l.indexId,this.uid]).next(h=>{a.push(function(p,m){const I=m?new Ma(m.sequenceNumber,new Xt(qi(m.readTime),new F(Ln(m.documentKey)),m.largestBatchId)):Ma.empty(),A=p.fields.map(([L,M])=>new Lu(Ve.fromServerFormat(L),M));return new sl(p.indexId,p.collectionGroup,A,I)}(l,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ne(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Ho(e),s=ws(e);return this.fn(e).next(a=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(l=>R.forEach(l,h=>s.put(dI(h.indexId,this.user,a,r)))))}updateIndexEntries(e,t){const r=new Map;return R.forEach(t,(i,s)=>{const a=r.get(i.collectionGroup);return(a?R.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(r.set(i.collectionGroup,l),R.forEach(l,h=>this.gn(e,i,h).next(f=>{const p=this.pn(s,h);return f.isEqual(p)?R.resolve():this.yn(e,s,h,f,p)}))))})}wn(e,t,r,i){return Is(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,r,i){return Is(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,t.key),t.key.path.toArray()])}gn(e,t,r){const i=Is(e);let s=new Re(Pr);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,t)])},(a,l)=>{s=s.add(new wi(r.indexId,t,l.arrayValue,l.directionalValue))}).next(()=>s)}pn(e,t){let r=new Re(Pr);const i=this.dn(t,e);if(i==null)return r;const s=qf(t);if(s!=null){const a=e.data.field(s.fieldPath);if(qa(a))for(const l of a.arrayValue.values||[])r=r.add(new wi(t.indexId,e.key,this.In(l),i))}else r=r.add(new wi(t.indexId,e.key,Su,i));return r}yn(e,t,r,i,s){N("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(h,f,p,m,I){const A=h.getIterator(),L=f.getIterator();let M=vs(A),V=vs(L);for(;M||V;){let Y=!1,ae=!1;if(M&&V){const j=p(M,V);j<0?ae=!0:j>0&&(Y=!0)}else M!=null?ae=!0:Y=!0;Y?(m(V),V=vs(L)):ae?(I(M),M=vs(A)):(M=vs(A),V=vs(L))}}(i,s,Pr,l=>{a.push(this.wn(e,t,r,l))},l=>{a.push(this.Sn(e,t,r,l))}),R.waitFor(a)}fn(e){let t=1;return ws(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((a,l)=>Pr(a,l)).filter((a,l,h)=>!l||Pr(a,h[l-1])!==0);const i=[];i.push(e);for(const a of r){const l=Pr(a,e),h=Pr(a,t);if(l===0)i[0]=e.Ht();else if(l>0&&h<0)i.push(a),i.push(a.Ht());else if(h>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.bn(i[a],i[a+1]))return[];const l=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Su,[]],h=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Su,[]];s.push(IDBKeyRange.bound(l,h))}return s}bn(e,t){return Pr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(II)}getMinOffset(e,t){return R.mapArray(this.un(t),r=>this.cn(e,r).next(i=>i||$())).next(II)}}function vI(n){return ct(n,"collectionParents")}function Is(n){return ct(n,"indexEntries")}function Ho(n){return ct(n,"indexConfiguration")}function ws(n){return ct(n,"indexState")}function II(n){z(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;lg(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Xt(e.readTime,e.documentKey,t)}const wI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ut{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Ut(e,Ut.DEFAULT_COLLECTION_PERCENTILE,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function DA(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let l=0;const h=r.Y({range:a},(p,m,I)=>(l++,I.delete()));s.push(h.next(()=>{z(l===1)}));const f=[];for(const p of t.mutations){const m=NT(e,p.key.path,t.batchId);s.push(i.delete(m)),f.push(p.key)}return R.waitFor(s).next(()=>f)}function hl(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw $();e=n.noDocument}return JSON.stringify(e).length}Ut.DEFAULT_COLLECTION_PERCENTILE=10,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ut.DEFAULT=new Ut(41943040,Ut.DEFAULT_COLLECTION_PERCENTILE,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ut.DISABLED=new Ut(-1,0,0);class nh{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,t,r,i){z(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new nh(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Cr(e).Y({index:"userMutationsIndex",range:r},(i,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Ps(e),a=Cr(e);return a.add({}).next(l=>{z(typeof l=="number");const h=new _g(l,t,r,i),f=function(A,L,M){const V=M.baseMutations.map(ae=>za(A.ut,ae)),Y=M.mutations.map(ae=>za(A.ut,ae));return{userId:L,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:V,mutations:Y}}(this.serializer,this.userId,h),p=[];let m=new Re((I,A)=>ne(I.canonicalString(),A.canonicalString()));for(const I of i){const A=NT(this.userId,I.key.path,l);m=m.add(I.key.path.popLast()),p.push(a.put(f)),p.push(s.put(A,h2))}return m.forEach(I=>{p.push(this.indexManager.addToCollectionParentIndex(e,I))}),e.addOnCommittedListener(()=>{this.Dn[l]=h.keys()}),R.waitFor(p).next(()=>h)})}lookupMutationBatch(e,t){return Cr(e).get(t).next(r=>r?(z(r.userId===this.userId),vi(this.serializer,r)):null)}Cn(e,t){return this.Dn[t]?R.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Dn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Cr(e).Y({index:"userMutationsIndex",range:i},(a,l,h)=>{l.userId===this.userId&&(z(l.batchId>=r),s=vi(this.serializer,l)),h.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Cr(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(i,s,a)=>{r=s.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Cr(e).W("userMutationsIndex",t).next(r=>r.map(i=>vi(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Mu(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Ps(e).Y({range:i},(a,l,h)=>{const[f,p,m]=a,I=Ln(p);if(f===this.userId&&t.path.isEqual(I))return Cr(e).get(m).next(A=>{if(!A)throw $();z(A.userId===this.userId),s.push(vi(this.serializer,A))});h.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(ne);const i=[];return t.forEach(s=>{const a=Mu(this.userId,s.path),l=IDBKeyRange.lowerBound(a),h=Ps(e).Y({range:l},(f,p,m)=>{const[I,A,L]=f,M=Ln(A);I===this.userId&&s.path.isEqual(M)?r=r.add(L):m.done()});i.push(h)}),R.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Mu(this.userId,r),a=IDBKeyRange.lowerBound(s);let l=new Re(ne);return Ps(e).Y({range:a},(h,f,p)=>{const[m,I,A]=h,L=Ln(I);m===this.userId&&r.isPrefixOf(L)?L.length===i&&(l=l.add(A)):p.done()}).next(()=>this.vn(e,l))}vn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(Cr(e).get(s).next(a=>{if(a===null)throw $();z(a.userId===this.userId),r.push(vi(this.serializer,a))}))}),R.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return DA(e.ae,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),R.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return R.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return Ps(e).Y({range:r},(s,a,l)=>{if(s[0]===this.userId){const h=Ln(s[1]);i.push(h)}else l.done()}).next(()=>{z(i.length===0)})})}containsKey(e,t){return kA(e,this.userId,t)}Mn(e){return xA(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function kA(n,e,t){const r=Mu(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Ps(n).Y({range:s,J:!0},(l,h,f)=>{const[p,m,I]=l;p===e&&m===i&&(a=!0),f.done()}).next(()=>a)}function Cr(n){return ct(n,"mutations")}function Ps(n){return ct(n,"documentMutations")}function xA(n){return ct(n,"mutationQueues")}class $i{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new $i(0)}static Nn(){return new $i(-1)}}class AU{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const r=new $i(t.highestTargetId);return t.highestTargetId=r.next(),this.Ln(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>K.fromTimestamp(new Le(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Ln(e,i)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(t,r),this.Ln(e,r))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Es(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(z(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Es(e).Y((a,l)=>{const h=aa(l);h.sequenceNumber<=t&&r.get(h.targetId)===null&&(i++,s.push(this.removeTargetData(e,h)))}).next(()=>R.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Es(e).Y((r,i)=>{const s=aa(i);t(s)})}Bn(e){return EI(e).get("targetGlobalKey").next(t=>(z(t!==null),t))}Ln(e,t){return EI(e).put("targetGlobalKey",t)}kn(e,t){return Es(e).put(bA(this.serializer,t))}qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Mi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Es(e).Y({range:i,index:"queryTargetsIndex"},(a,l,h)=>{const f=aa(l);fc(t,f.target)&&(s=f,h.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=kr(e);return t.forEach(a=>{const l=kt(a.path);i.push(s.put({targetId:r,path:l})),i.push(this.referenceDelegate.addReference(e,r,a))}),R.waitFor(i)}removeMatchingKeys(e,t,r){const i=kr(e);return R.forEach(t,s=>{const a=kt(s.path);return R.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=kr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=kr(e);let s=re();return i.Y({range:r,J:!0},(a,l,h)=>{const f=Ln(a[1]),p=new F(f);s=s.add(p)}).next(()=>s)}containsKey(e,t){const r=kt(t.path),i=IDBKeyRange.bound([r],[bT(r)],!1,!0);let s=0;return kr(e).Y({index:"documentTargetsIndex",J:!0,range:i},([a,l],h,f)=>{a!==0&&(s++,f.done())}).next(()=>s>0)}_t(e,t){return Es(e).get(t).next(r=>r?aa(r):null)}}function Es(n){return ct(n,"targets")}function EI(n){return ct(n,"targetGlobal")}function kr(n){return ct(n,"targetDocuments")}function TI([n,e],[t,r]){const i=ne(n,t);return i===0?ne(e,r):i}class RU{constructor(e){this.Qn=e,this.buffer=new Re(TI),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();TI(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class SU{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){N("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ni(t)?N("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await ti(t)}await this.Gn(3e5)})}}class bU{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(Bt._e);const r=new RU(t);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(N("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(wI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(N("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),wI):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let r,i,s,a,l,h,f;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(N("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,a=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,t))).next(m=>(s=m,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(f=Date.now(),As()<=ue.DEBUG&&N("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${s} targets in `+(h-l)+`ms
	Removed ${m} documents in `+(f-h)+`ms
Total Duration: ${f-p}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function PU(n,e){return new bU(n,e)}class CU{constructor(e,t){this.db=e,this.garbageCollector=PU(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Yn(e){let t=0;return this.Hn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(r,i)=>t(i))}addReference(e,t,r){return bu(e,r)}removeReference(e,t,r){return bu(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return bu(e,t)}Xn(e,t){return function(i,s){let a=!1;return xA(i).Z(l=>kA(i,l,s).next(h=>(h&&(a=!0),R.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(a,l)=>{if(l<=t){const h=this.Xn(e,a).next(f=>{if(!f)return s++,r.getEntry(e,a).next(()=>(r.removeEntry(a,K.min()),kr(e).delete(function(m){return[0,kt(m.path)]}(a))))});i.push(h)}}).next(()=>R.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return bu(e,t)}Zn(e,t){const r=kr(e);let i,s=Bt._e;return r.Y({index:"documentTargetsIndex"},([a,l],{path:h,sequenceNumber:f})=>{a===0?(s!==Bt._e&&t(new F(Ln(i)),s),s=f,i=h):s=Bt._e}).next(()=>{s!==Bt._e&&t(new F(Ln(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function bu(n,e){return kr(n).put(function(r,i){return{targetId:0,path:kt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}class NA{constructor(){this.changes=new ri(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class DU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return gi(e).put(r)}removeEntry(e,t,r){return gi(e).delete(function(s,a){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],ul(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.er(e,r)))}getEntry(e,t){let r=xe.newInvalidDocument(t);return gi(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(jo(t))},(i,s)=>{r=this.tr(t,s)}).next(()=>r)}nr(e,t){let r={size:0,document:xe.newInvalidDocument(t)};return gi(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(jo(t))},(i,s)=>{r={document:this.tr(t,s),size:hl(s)}}).next(()=>r)}getEntries(e,t){let r=$t();return this.rr(e,t,(i,s)=>{const a=this.tr(i,s);r=r.insert(i,a)}).next(()=>r)}ir(e,t){let r=$t(),i=new Pe(F.comparator);return this.rr(e,t,(s,a)=>{const l=this.tr(s,a);r=r.insert(s,l),i=i.insert(s,hl(a))}).next(()=>({documents:r,sr:i}))}rr(e,t,r){if(t.isEmpty())return R.resolve();let i=new Re(SI);t.forEach(h=>i=i.add(h));const s=IDBKeyRange.bound(jo(i.first()),jo(i.last())),a=i.getIterator();let l=a.getNext();return gi(e).Y({index:"documentKeyIndex",range:s},(h,f,p)=>{const m=F.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;l&&SI(l,m)<0;)r(l,null),l=a.getNext();l&&l.isEqual(m)&&(r(l,f),l=a.hasNext()?a.getNext():null),l?p.U(jo(l)):p.done()}).next(()=>{for(;l;)r(l,null),l=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,l=[a.popLast().toArray(),a.lastSegment(),ul(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return gi(e).W(IDBKeyRange.bound(l,h,!0)).next(f=>{s==null||s.incrementDocumentReadCount(f.length);let p=$t();for(const m of f){const I=this.tr(F.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);I.isFoundDocument()&&(gc(t,I)||i.has(I.key))&&(p=p.insert(I.key,I))}return p})}getAllFromCollectionGroup(e,t,r,i){let s=$t();const a=RI(t,r),l=RI(t,Xt.max());return gi(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,l,!0)},(h,f,p)=>{const m=this.tr(F.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(m.key,m),s.size===i&&p.done()}).next(()=>s)}newChangeBuffer(e){return new kU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return AI(e).get("remoteDocumentGlobalKey").next(t=>(z(!!t),t))}er(e,t){return AI(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const r=gU(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(K.min())))return r}return xe.newInvalidDocument(e)}}function VA(n){return new DU(n)}class kU extends NA{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new ri(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Re((s,a)=>ne(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const l=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,l.readTime)),a.isValidDocument()){const h=lI(this._r.serializer,a);i=i.add(s.path.popLast());const f=hl(h);r+=f-l.size,t.push(this._r.addEntry(e,s,h))}else if(r-=l.size,this.trackRemovals){const h=lI(this._r.serializer,a.convertToNoDocument(K.min()));t.push(this._r.addEntry(e,s,h))}}),i.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,r)),R.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(r=>(this.ar.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:r,sr:i})=>(i.forEach((s,a)=>{this.ar.set(s,{size:a,readTime:r.get(s).readTime})}),r))}}function AI(n){return ct(n,"remoteDocumentGlobal")}function gi(n){return ct(n,"remoteDocumentsV14")}function jo(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function RI(n,e){const t=e.documentKey.path.toArray();return[n,ul(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function SI(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ne(t[s],r[s]),i)return i;return i=ne(t.length,r.length),i||(i=ne(t[t.length-2],r[r.length-2]),i||ne(t[t.length-1],r[r.length-1]))}class xU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class OA{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ma(r.mutation,i,qt.empty(),Le.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,t,r=re()){const i=Mn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=sa();return s.forEach((l,h)=>{a=a.insert(l,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=Mn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,re()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{t.set(a,l)})})}computeViews(e,t,r,i){let s=$t();const a=ga(),l=function(){return ga()}();return t.forEach((h,f)=>{const p=r.get(f.key);i.has(f.key)&&(p===void 0||p.mutation instanceof gr)?s=s.insert(f.key,f):p!==void 0?(a.set(f.key,p.mutation.getFieldMask()),ma(p.mutation,f,p.mutation.getFieldMask(),Le.now())):a.set(f.key,qt.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((f,p)=>a.set(f,p)),t.forEach((f,p)=>{var m;return l.set(f,new xU(p,(m=a.get(f))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,t){const r=ga();let i=new Pe((a,l)=>a-l),s=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const l of a)l.keys().forEach(h=>{const f=t.get(h);if(f===null)return;let p=r.get(h)||qt.empty();p=l.applyToLocalView(f,p),r.set(h,p);const m=(i.get(l.batchId)||re()).add(h);i=i.insert(l.batchId,m)})}).next(()=>{const a=[],l=i.getReverseIterator();for(;l.hasNext();){const h=l.getNext(),f=h.key,p=h.value,m=eA();p.forEach(I=>{if(!s.has(I)){const A=cA(t.get(I),r.get(I));A!==null&&m.set(I,A),s=s.add(I)}}),a.push(this.documentOverlayCache.saveOverlays(e,f,m))}return R.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):pg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):R.resolve(Mn());let l=-1,h=s;return a.next(f=>R.forEach(f,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(p)?R.resolve():this.remoteDocumentCache.getEntry(e,p).next(I=>{h=h.insert(p,I)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,h,f,re())).next(p=>({batchId:l,changes:ZT(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=sa();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=sa();return this.indexManager.getCollectionParents(e,s).next(l=>R.forEach(l,h=>{const f=function(m,I){return new pr(I,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next(p=>{p.forEach((m,I)=>{a=a.insert(m,I)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((h,f)=>{const p=f.getKey();a.get(p)===null&&(a=a.insert(p,xe.newInvalidDocument(p)))});let l=sa();return a.forEach((h,f)=>{const p=s.get(h);p!==void 0&&ma(p.mutation,f,qt.empty(),Le.now()),gc(t,f)&&(l=l.insert(h,f))}),l})}}class NU{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return R.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ye(i.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,function(i){return{name:i.name,query:Eg(i.bundledQuery),readTime:Ye(i.readTime)}}(t)),R.resolve()}}class VU{constructor(){this.overlays=new Pe(F.comparator),this.lr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Mn();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.lt(e,t,s)}),R.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){const i=Mn(),s=t.length+1,a=new F(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const h=l.getNext().value,f=h.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Pe((f,p)=>f-p);const a=this.overlays.getIterator();for(;a.hasNext();){const f=a.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let p=s.get(f.largestBatchId);p===null&&(p=Mn(),s=s.insert(f.largestBatchId,p)),p.set(f.getKey(),f)}}const l=Mn(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((f,p)=>l.set(f,p)),!(l.size()>=i)););return R.resolve(l)}lt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new vg(t,r));let s=this.lr.get(t);s===void 0&&(s=re(),this.lr.set(t,s)),this.lr.set(t,s.add(r.key))}}class Rg{constructor(){this.hr=new Re(rt.Pr),this.Ir=new Re(rt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const r=new rt(e,t);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.dr(new rt(e,t))}Ar(e,t){e.forEach(r=>this.removeReference(r,t))}Rr(e){const t=new F(new ge([])),r=new rt(t,e),i=new rt(t,e+1),s=[];return this.Ir.forEachInRange([r,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new F(new ge([])),r=new rt(t,e),i=new rt(t,e+1);let s=re();return this.Ir.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new rt(e,0),r=this.hr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class rt{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return F.comparator(e.key,t.key)||ne(e.gr,t.gr)}static Tr(e,t){return ne(e.gr,t.gr)||F.comparator(e.key,t.key)}}class OU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new Re(rt.Pr)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new _g(s,t,r,i);this.mutationQueue.push(a);for(const l of i)this.yr=this.yr.add(new rt(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Sr(r),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new rt(t,0),i=new rt(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],a=>{const l=this.wr(a.gr);s.push(l)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(ne);return t.forEach(i=>{const s=new rt(i,0),a=new rt(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],l=>{r=r.add(l.gr)})}),R.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;F.isDocumentKey(s)||(s=s.child(""));const a=new rt(new F(s),0);let l=new Re(ne);return this.yr.forEachWhile(h=>{const f=h.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(l=l.add(h.gr)),!0)},a),R.resolve(this.br(l))}br(e){const t=[];return e.forEach(r=>{const i=this.wr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){z(this.Dr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return R.forEach(t.mutations,i=>{const s=new rt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,t){const r=new rt(t,0),i=this.yr.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class LU{constructor(e){this.Cr=e,this.docs=function(){return new Pe(F.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Cr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():xe.newInvalidDocument(t))}getEntries(e,t){let r=$t();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():xe.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=$t();const a=t.path,l=new F(a.child("")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){const{key:f,value:{document:p}}=h.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||lg(CT(p),r)<=0||(i.has(p.key)||gc(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,t,r,i){$()}vr(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new MU(this)}getSize(e){return R.resolve(this.size)}}class MU extends NA{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class FU{constructor(e){this.persistence=e,this.Fr=new ri(t=>Mi(t),fc),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Mr=0,this.Or=new Rg,this.targetCount=0,this.Nr=$i.On()}forEachTarget(e,t){return this.Fr.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Mr&&(this.Mr=t),R.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new $i(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.kn(t),R.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Fr.forEach((a,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){const r=this.Fr.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.Or.Er(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.Or.Ar(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),R.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Or.mr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.Or.containsKey(t))}}class LA{constructor(e,t){this.Br={},this.overlays={},this.Lr=new Bt(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new FU(this),this.indexManager=new EU,this.remoteDocumentCache=function(i){return new LU(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new SA(t),this.Kr=new NU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new VU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new OU(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,r){N("MemoryPersistence","Starting transaction:",e);const i=new UU(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,t){return R.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class UU extends kT{constructor(e){super(),this.currentSequenceNumber=e}}class rh{constructor(e){this.persistence=e,this.Gr=new Rg,this.zr=null}static jr(e){return new rh(e)}get Hr(){if(this.zr)return this.zr;throw $()}addReference(e,t,r){return this.Gr.addReference(r,t),this.Hr.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Gr.removeReference(r,t),this.Hr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Hr,r=>{const i=F.fromPath(r);return this.Jr(e,i).next(s=>{s||t.removeEntry(i,K.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(r=>{r?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return R.or([()=>R.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class BU{constructor(e){this.serializer=e}N(e,t,r,i){const s=new Jl("createOrUpgrade",t);r<1&&i>=1&&(function(h){h.createObjectStore("owner")}(e),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qv,{unique:!0}),h.createObjectStore("documentMutations")}(e),bI(e),function(h){h.createObjectStore("remoteDocuments")}(e));let a=R.resolve();return r<3&&i>=3&&(r!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),bI(e)),a=a.next(()=>function(h){const f=h.store("targetGlobal"),p={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:K.min().toTimestamp(),targetCount:0};return f.put("targetGlobalKey",p)}(s))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(h,f){return f.store("mutations").W().next(p=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qv,{unique:!0});const m=f.store("mutations"),I=p.map(A=>m.put(A));return R.waitFor(I)})}(e,s))),a=a.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.Zr(s))),r<6&&i>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(a=a.next(()=>this.ei(s))),r<8&&i>=8&&(a=a.next(()=>this.ti(e,s))),r<9&&i>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.ni(s))),r<11&&i>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(h){const f=h.createObjectStore("documentOverlays",{keyPath:T2});f.createIndex("collectionPathOverlayIndex",A2,{unique:!1}),f.createIndex("collectionGroupOverlayIndex",R2,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(h){const f=h.createObjectStore("remoteDocumentsV14",{keyPath:d2});f.createIndex("documentKeyIndex",f2),f.createIndex("collectionGroupIndex",p2)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ii(e,s))),r<15&&i>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:v2}).createIndex("sequenceNumberIndex",I2,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:w2}).createIndex("documentKeyIndex",E2,{unique:!1})}(e))),a}Xr(e){let t=0;return e.store("remoteDocuments").Y((r,i)=>{t+=hl(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>R.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next(l=>R.forEach(l,h=>{z(h.userId===s.userId);const f=vi(this.serializer,h);return DA(e,s.userId,f).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((a,l)=>{const h=new ge(a),f=function(m){return[0,kt(m)]}(h);s.push(t.get(f).next(p=>p?R.resolve():(m=>t.put({targetId:0,path:kt(m),sequenceNumber:i.highestListenSequenceNumber}))(h)))}).next(()=>R.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:y2});const r=t.store("collectionParents"),i=new Ag,s=a=>{if(i.add(a)){const l=a.lastSegment(),h=a.popLast();return r.put({collectionId:l,parent:kt(h)})}};return t.store("remoteDocuments").Y({J:!0},(a,l)=>{const h=new ge(a);return s(h.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([a,l,h],f)=>{const p=Ln(l);return s(p.popLast())}))}ni(e){const t=e.store("targets");return t.Y((r,i)=>{const s=aa(i),a=bA(this.serializer,s);return t.put(a)})}ri(e,t){const r=t.store("remoteDocuments"),i=[];return r.Y((s,a)=>{const l=t.store("remoteDocumentsV14"),h=function(m){return m.document?new F(ge.fromString(m.document.name).popFirst(5)):m.noDocument?F.fromSegments(m.noDocument.path):m.unknownDocument?F.fromSegments(m.unknownDocument.path):$()}(a).path.toArray(),f={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(l.put(f))}).next(()=>R.waitFor(i))}ii(e,t){const r=t.store("mutations"),i=VA(this.serializer),s=new LA(rh.jr,this.serializer.ut);return r.W().next(a=>{const l=new Map;return a.forEach(h=>{var f;let p=(f=l.get(h.userId))!==null&&f!==void 0?f:re();vi(this.serializer,h).keys().forEach(m=>p=p.add(m)),l.set(h.userId,p)}),R.forEach(l,(h,f)=>{const p=new it(f),m=th.ct(this.serializer,p),I=s.getIndexManager(p),A=nh.ct(p,this.serializer,I,s.referenceDelegate);return new OA(i,A,m,I).recalculateAndSaveOverlaysForDocumentKeys(new $f(t,Bt._e),h).next()})})}}function bI(n){n.createObjectStore("targetDocuments",{keyPath:m2}).createIndex("documentTargetsIndex",_2,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",g2,{unique:!0}),n.createObjectStore("targetGlobal")}const df="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Sg{constructor(e,t,r,i,s,a,l,h,f,p,m=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.si=s,this.window=a,this.document=l,this.oi=f,this._i=p,this.ai=m,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=I=>Promise.resolve(),!Sg.D())throw new k(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new CU(this,i),this.Ii=t+"main",this.serializer=new SA(h),this.Ti=new yn(this.Ii,this.ai,new BU(this.serializer)),this.qr=new AU(this.referenceDelegate,this.serializer),this.remoteDocumentCache=VA(this.serializer),this.Kr=new mU,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,p===!1&&Qe("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(b.FAILED_PRECONDITION,df);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new Bt(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.di()}))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Pu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if(ni(e))return N("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return N("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return Qo(e).get("owner").next(t=>R.resolve(this.wi(t)))}Si(e){return Pu(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=ct(t,"clientMetadata");return r.W().next(i=>{const s=this.Ci(i,18e5),a=i.filter(l=>s.indexOf(l)===-1);return R.forEach(a,l=>r.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ei)for(const t of e)this.Ei.removeItem(this.vi(t.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?R.resolve(!0):Qo(e).get("owner").next(t=>{if(t!==null&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new k(b.FAILED_PRECONDITION,df);return!1}}return!(!this.networkEnabled||!this.inForeground)||Pu(e).W().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||a&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&N("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new $f(e,Bt._e);return this.pi(t).next(()=>this.Si(t))}),this.Ti.close(),this.Ni()}Ci(e,t){return e.filter(r=>this.Di(r.updateTimeMs,t)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Pu(e).W().next(t=>this.Ci(t,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return nh.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new TU(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return th.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,r){N("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(h){return h===15?b2:h===14?LT:h===13?OT:h===12?S2:h===11?VT:void $()}(this.ai);let a;return this.Ti.runTransaction(e,i,s,l=>(a=new $f(l,this.Lr?this.Lr.next():Bt._e),t==="readwrite-primary"?this.fi(a).next(h=>!!h||this.gi(a)).next(h=>{if(!h)throw Qe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new k(b.FAILED_PRECONDITION,DT);return r(a)}).next(h=>this.yi(a).next(()=>h)):this.Li(a).next(()=>r(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Li(e){return Qo(e).get("owner").next(t=>{if(t!==null&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new k(b.FAILED_PRECONDITION,df)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Qo(e).put("owner",t)}static D(){return yn.D()}pi(e){const t=Qo(e);return t.get("owner").next(r=>this.wi(r)?(N("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):R.resolve())}Di(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Qe(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;lx()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const r=((t=this.Ei)===null||t===void 0?void 0:t.getItem(this.vi(e)))!==null;return N("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Qe("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){Qe("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Qo(n){return ct(n,"owner")}function Pu(n){return ct(n,"clientMetadata")}function bg(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Pg{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ki=r,this.qi=i}static Qi(e,t){let r=re(),i=re();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Pg(e,t.fromCache,r,i)}}class qU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class MA{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.zi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new qU;return this.Hi(e,t,a).next(l=>{if(s.result=l,this.$i)return this.Ji(e,t,a,l.size)})}).next(()=>s.result)}Ji(e,t,r,i){return r.documentReadCount<this.Ui?(As()<=ue.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",Rs(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),R.resolve()):(As()<=ue.DEBUG&&N("QueryEngine","Query:",Rs(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(As()<=ue.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",Rs(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,xt(t))):R.resolve())}zi(e,t){if(Zv(t))return R.resolve(null);let r=xt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=cl(t,null,"F"),r=xt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=re(...s);return this.Gi.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(h=>{const f=this.Yi(t,l);return this.Zi(t,f,a,h.readTime)?this.zi(e,cl(t,null,"F")):this.Xi(e,f,t,h)}))})))}ji(e,t,r,i){return Zv(t)||i.isEqual(K.min())?R.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const a=this.Yi(t,s);return this.Zi(t,a,r,i)?R.resolve(null):(As()<=ue.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Rs(t)),this.Xi(e,a,t,PT(i,-1)).next(l=>l))})}Yi(e,t){let r=new Re(JT(e));return t.forEach((i,s)=>{gc(e,s)&&(r=r.add(s))}),r}Zi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,t,r){return As()<=ue.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",Rs(t)),this.Gi.getDocumentsMatchingQuery(e,t,Xt.min(),r)}Xi(e,t,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}class $U{constructor(e,t,r,i){this.persistence=e,this.es=t,this.serializer=i,this.ts=new Pe(ne),this.ns=new ri(s=>Mi(s),fc),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new OA(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function FA(n,e,t,r){return new $U(n,e,t,r)}async function UA(n,e){const t=B(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.os(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],l=[];let h=re();for(const f of i){a.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}for(const f of s){l.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(f=>({_s:f,removedBatchIds:a,addedBatchIds:l}))})})}function WU(n,e){const t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(l,h,f,p){const m=f.batch,I=m.keys();let A=R.resolve();return I.forEach(L=>{A=A.next(()=>p.getEntry(h,L)).next(M=>{const V=f.docVersions.get(L);z(V!==null),M.version.compareTo(V)<0&&(m.applyToRemoteDocument(M,f),M.isValidDocument()&&(M.setReadTime(f.commitVersion),p.addEntry(M)))})}),A.next(()=>l.mutationQueue.removeMutationBatch(h,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=re();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(h=h.add(l.batch.mutations[f].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function BA(n){const e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function GU(n,e){const t=B(n),r=e.snapshotVersion;let i=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.ss.newChangeBuffer({trackRemovals:!0});i=t.ts;const l=[];e.targetChanges.forEach((p,m)=>{const I=i.get(m);if(!I)return;l.push(t.qr.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.qr.addMatchingKeys(s,p.addedDocuments,m)));let A=I.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?A=A.withResumeToken(tt.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):p.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(p.resumeToken,r)),i=i.insert(m,A),function(M,V,Y){return M.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0}(I,A,p)&&l.push(t.qr.updateTargetData(s,A))});let h=$t(),f=re();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(qA(s,a,e.documentUpdates).next(p=>{h=p.us,f=p.cs})),!r.isEqual(K.min())){const p=t.qr.getLastRemoteSnapshotVersion(s).next(m=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(p)}return R.waitFor(l).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,h,f)).next(()=>h)}).then(s=>(t.ts=i,s))}function qA(n,e,t){let r=re(),i=re();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=$t();return t.forEach((l,h)=>{const f=s.get(l);h.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(l)),h.isNoDocument()&&h.version.isEqual(K.min())?(e.removeEntry(l,h.readTime),a=a.insert(l,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(h),a=a.insert(l,h)):N("LocalStore","Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",h.version)}),{us:a,cs:i}})}function zU(n,e){const t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Qs(n,e){const t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.qr.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):t.qr.allocateTargetId(r).next(a=>(i=new sr(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ts=t.ts.insert(r.targetId,r),t.ns.set(e,r.targetId)),r})}async function Ys(n,e,t){const r=B(n),i=r.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!ni(a))throw a;N("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}function dl(n,e,t){const r=B(n);let i=K.min(),s=re();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,f,p){const m=B(h),I=m.ns.get(p);return I!==void 0?R.resolve(m.ts.get(I)):m.qr.getTargetData(f,p)}(r,a,xt(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(a,l.targetId).next(h=>{s=h})}).next(()=>r.es.getDocumentsMatchingQuery(a,e,t?i:K.min(),t?s:re())).next(l=>(GA(r,YT(e),l),{documents:l,ls:s})))}function $A(n,e){const t=B(n),r=B(t.qr),i=t.ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(a=>a?a.target:null))}function WA(n,e){const t=B(n),r=t.rs.get(e)||K.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ss.getAllFromCollectionGroup(i,e,PT(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(GA(t,e,i),i))}function GA(n,e,t){let r=n.rs.get(e)||K.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.rs.set(e,r)}async function KU(n,e,t,r){const i=B(n);let s=re(),a=$t();for(const f of t){const p=e.hs(f.metadata.name);f.document&&(s=s.add(p));const m=e.Ps(f);m.setReadTime(e.Is(f.metadata.readTime)),a=a.insert(p,m)}const l=i.ss.newChangeBuffer({trackRemovals:!0}),h=await Qs(i,function(p){return xt(uo(ge.fromString(`__bundle__/docs/${p}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",f=>qA(f,l,a).next(p=>(l.apply(f),p)).next(p=>i.qr.removeMatchingKeysForTargetId(f,h.targetId).next(()=>i.qr.addMatchingKeys(f,s,h.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(f,p.us,p.cs)).next(()=>p.us)))}async function HU(n,e,t=re()){const r=await Qs(n,xt(Eg(e.bundledQuery))),i=B(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const a=Ye(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return i.Kr.saveNamedQuery(s,e);const l=r.withResumeToken(tt.EMPTY_BYTE_STRING,a);return i.ts=i.ts.insert(l.targetId,l),i.qr.updateTargetData(s,l).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,t,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}function PI(n,e){return`firestore_clients_${n}_${e}`}function CI(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function ff(n,e){return`firestore_targets_${n}_${e}`}class fl{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ts(e,t,r){const i=JSON.parse(r);let s,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new k(i.error.code,i.error.message))),a?new fl(e,t,i.state,s):(Qe("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class _a{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ts(e,t){const r=JSON.parse(t);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new k(r.error.code,r.error.message))),s?new _a(e,r.state,i):(Qe("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pl{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=gg();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=xT(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return i?new pl(e,s):(Qe("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Cg{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Cg(t.clientId,t.onlineState):(Qe("SharedClientState",`Failed to parse online state: ${e}`),null)}}class tp{constructor(){this.activeTargetIds=gg()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pf{constructor(e,t,r,i,s){this.window=e,this.si=t,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Pe(ne),this.started=!1,this.ps=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=PI(this.persistenceKey,this.Rs),this.ws=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new tp),this.Ss=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.Cs=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.vs=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const r of e){if(r===this.Rs)continue;const i=this.getItem(PI(this.persistenceKey,r));if(i){const s=pl.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();const t=this.storage.getItem(this.Cs);if(t){const r=this.Ms(t);r&&this.xs(r)}for(const r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,r){this.Ns(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(ff(this.persistenceKey,e));if(r){const i=_a.Ts(e,r);i&&(t=i.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(ff(this.persistenceKey,e))}updateQueryState(e,t,r){this.ks(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return N("SharedClientState","READ",e,t),t}setItem(e,t){N("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){N("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const t=e;if(t.storageArea===this.storage){if(N("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ys)return void Qe("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Ss.test(t.key)){if(t.newValue==null){const r=this.Ks(t.key);return this.$s(r,null)}{const r=this.Us(t.key,t.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(t.key)){if(t.newValue!==null){const r=this.Ws(t.key,t.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){const r=this.zs(t.key,t.newValue);if(r)return this.js(r)}}else if(t.key===this.Cs){if(t.newValue!==null){const r=this.Ms(t.newValue);if(r)return this.xs(r)}}else if(t.key===this.ws){const r=function(s){let a=Bt._e;if(s!=null)try{const l=JSON.parse(s);z(typeof l=="number"),a=l}catch(l){Qe("SharedClientState","Failed to read sequence number from WebStorage",l)}return a}(t.newValue);r!==Bt._e&&this.sequenceNumberHandler(r)}else if(t.key===this.vs){const r=this.Hs(t.newValue);await Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(t)})}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,r){const i=new fl(this.currentUser,e,t,r),s=CI(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const t=CI(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){const t={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(t))}ks(e,t,r){const i=ff(this.persistenceKey,e),s=new _a(e,t,r);this.setItem(i,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const r=this.Ks(e);return pl.Ts(r,t)}Ws(e,t){const r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return fl.Ts(new it(s),i,t)}zs(e,t){const r=this.Ds.exec(e),i=Number(r[1]);return _a.Ts(i,t)}Ms(e){return Cg.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);N("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const r=t?this.gs.insert(e,t):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),a=[],l=[];return s.forEach(h=>{i.has(h)||a.push(h)}),i.forEach(h=>{s.has(h)||l.push(h)}),this.syncEngine.Xs(a,l).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=gg();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class zA{constructor(){this.eo=new tp,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,r){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new tp,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class jU{ro(e){}shutdown(){}}class DI{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){N("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){N("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Cu=null;function gf(){return Cu===null?Cu=function(){return 268435456+Math.round(2147483648*Math.random())}():Cu++,"0x"+Cu.toString(16)}const QU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class YU{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const It="WebChannelConnection";class JU extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+t.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(t,r,i,s,a){const l=gf(),h=this.So(t,r);N("RestConnection",`Sending RPC '${t}' ${l}:`,h,i);const f={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(f,s,a),this.Do(t,h,f,i).then(p=>(N("RestConnection",`Received RPC '${t}' ${l}: `,p),p),p=>{throw wn("RestConnection",`RPC '${t}' ${l} failed with error: `,p,"url: ",h,"request:",i),p})}Co(t,r,i,s,a,l){return this.wo(t,r,i,s,a)}bo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+co}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}So(t,r){const i=QU[t];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,r,i){const s=gf();return new Promise((a,l)=>{const h=new HF;h.setWithCredentials(!0),h.listenOnce(zF.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case lf.NO_ERROR:const p=h.getResponseJson();N(It,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case lf.TIMEOUT:N(It,`RPC '${e}' ${s} timed out`),l(new k(b.DEADLINE_EXCEEDED,"Request time out"));break;case lf.HTTP_ERROR:const m=h.getStatus();if(N(It,`RPC '${e}' ${s} failed with status:`,m,"response text:",h.getResponseText()),m>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);const A=I==null?void 0:I.error;if(A&&A.status&&A.message){const L=function(V){const Y=V.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(Y)>=0?Y:b.UNKNOWN}(A.status);l(new k(L,A.message))}else l(new k(b.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new k(b.UNAVAILABLE,"Connection failed."));break;default:$()}}finally{N(It,`RPC '${e}' ${s} completed.`)}});const f=JSON.stringify(i);N(It,`RPC '${e}' ${s} sending request:`,i),h.send(t,"POST",f,r,15)})}vo(e,t,r){const i=gf(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=WF(),l=GF(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.bo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const p=s.join("");N(It,`Creating RPC '${e}' stream ${i}: ${p}`,h);const m=a.createWebChannel(p,h);let I=!1,A=!1;const L=new YU({co:V=>{A?N(It,`Not sending because RPC '${e}' stream ${i} is closed:`,V):(I||(N(It,`Opening RPC '${e}' stream ${i} transport.`),m.open(),I=!0),N(It,`RPC '${e}' stream ${i} sending:`,V),m.send(V))},lo:()=>m.close()}),M=(V,Y,ae)=>{V.listen(Y,j=>{try{ae(j)}catch(ye){setTimeout(()=>{throw ye},0)}})};return M(m,Au.EventType.OPEN,()=>{A||N(It,`RPC '${e}' stream ${i} transport opened.`)}),M(m,Au.EventType.CLOSE,()=>{A||(A=!0,N(It,`RPC '${e}' stream ${i} transport closed`),L.Ro())}),M(m,Au.EventType.ERROR,V=>{A||(A=!0,wn(It,`RPC '${e}' stream ${i} transport errored:`,V),L.Ro(new k(b.UNAVAILABLE,"The operation could not be completed")))}),M(m,Au.EventType.MESSAGE,V=>{var Y;if(!A){const ae=V.data[0];z(!!ae);const j=ae,ye=j.error||((Y=j[0])===null||Y===void 0?void 0:Y.error);if(ye){N(It,`RPC '${e}' stream ${i} received error:`,ye);const de=ye.status;let me=function(Kn){const es=Je[Kn];if(es!==void 0)return hA(es)}(de),we=ye.message;me===void 0&&(me=b.INTERNAL,we="Unknown error status: "+de+" with message "+ye.message),A=!0,L.Ro(new k(me,we)),m.close()}else N(It,`RPC '${e}' stream ${i} received:`,ae),L.Vo(ae)}}),M(l,KF.STAT_EVENT,V=>{V.stat===Mv.PROXY?N(It,`RPC '${e}' stream ${i} detected buffering proxy`):V.stat===Mv.NOPROXY&&N(It,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{L.Ao()},0),L}}function KA(){return typeof window<"u"?window:null}function $u(){return typeof document<"u"?document:null}function vc(n){return new sU(n,!0)}class Dg{constructor(e,t,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=t,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,t-r);i>0&&N("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class HA{constructor(e,t,r,i,s,a,l,h){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new Dg(e,t)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,t){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(Qe(t.toString()),Qe("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):t&&t.code===b.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(t)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===t&&this.s_(r,i)},r=>{e(()=>{const i=new k(b.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,t){const r=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return N("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(N("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class XU extends HA{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=cU(this.serializer,e),r=function(s){if(!("targetChange"in s))return K.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?K.min():a.readTime?Ye(a.readTime):K.min()}(e);return this.listener.a_(t,r)}u_(e){const t={};t.database=Ga(this.serializer),t.addTarget=function(s,a){let l;const h=a.target;if(l=ol(h)?{documents:IA(s,h)}:{query:wA(s,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=gA(s,a.resumeToken);const f=Qf(s,a.expectedCount);f!==null&&(l.expectedCount=f)}else if(a.snapshotVersion.compareTo(K.min())>0){l.readTime=js(s,a.snapshotVersion.toTimestamp());const f=Qf(s,a.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,e);const r=lU(this.serializer,e);r&&(t.labels=r),this.e_(t)}c_(e){const t={};t.database=Ga(this.serializer),t.removeTarget=e,this.e_(t)}}class ZU extends HA{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=uU(e.writeResults,e.commitTime),r=Ye(e.commitTime);return this.listener.I_(r,t)}return z(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=Ga(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>za(this.serializer,r))};this.e_(t)}}class eB extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new k(b.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,t,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new k(b.UNKNOWN,i.toString())})}Co(e,t,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,t,r,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(b.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class tB{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(Qe(t),this.f_=!1):N("OnlineStateTracker",t)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}class nB{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget(async()=>{ii(this)&&(N("RemoteStore","Restarting streams for network reachability change."),await async function(h){const f=B(h);f.C_.add(4),await fo(f),f.M_.set("Unknown"),f.C_.delete(4),await Ic(f)}(this))})}),this.M_=new tB(r,i)}}async function Ic(n){if(ii(n))for(const e of n.v_)await e(!0)}async function fo(n){for(const e of n.v_)await e(!1)}function ih(n,e){const t=B(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),Ng(t)?xg(t):go(t).Ho()&&kg(t,e))}function Ka(n,e){const t=B(n),r=go(t);t.D_.delete(e),r.Ho()&&jA(t,e),t.D_.size===0&&(r.Ho()?r.Zo():ii(t)&&t.M_.set("Unknown"))}function kg(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}go(n).u_(e)}function jA(n,e){n.x_.Oe(e),go(n).c_(e)}function xg(n){n.x_=new tU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),go(n).start(),n.M_.g_()}function Ng(n){return ii(n)&&!go(n).jo()&&n.D_.size>0}function ii(n){return B(n).C_.size===0}function QA(n){n.x_=void 0}async function rB(n){n.D_.forEach((e,t)=>{kg(n,e)})}async function iB(n,e){QA(n),Ng(n)?(n.M_.w_(e),xg(n)):n.M_.set("Unknown")}async function sB(n,e,t){if(n.M_.set("Online"),e instanceof pA&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const l of s.targetIds)i.D_.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.D_.delete(l),i.x_.removeTarget(l))}(n,e)}catch(r){N("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await gl(n,r)}else if(e instanceof qu?n.x_.$e(e):e instanceof fA?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(K.min()))try{const r=await BA(n.localStore);t.compareTo(r)>=0&&await function(s,a){const l=s.x_.it(a);return l.targetChanges.forEach((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const p=s.D_.get(f);p&&s.D_.set(f,p.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach((h,f)=>{const p=s.D_.get(h);if(!p)return;s.D_.set(h,p.withResumeToken(tt.EMPTY_BYTE_STRING,p.snapshotVersion)),jA(s,h);const m=new sr(p.target,h,f,p.sequenceNumber);kg(s,m)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(r){N("RemoteStore","Failed to raise snapshot:",r),await gl(n,r)}}async function gl(n,e,t){if(!ni(e))throw e;n.C_.add(1),await fo(n),n.M_.set("Offline"),t||(t=()=>BA(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{N("RemoteStore","Retrying IndexedDB access"),await t(),n.C_.delete(1),await Ic(n)})}function YA(n,e){return e().catch(t=>gl(n,t,e))}async function po(n){const e=B(n),t=Hr(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;oB(e);)try{const i=await zU(e.localStore,r);if(i===null){e.b_.length===0&&t.Zo();break}r=i.batchId,aB(e,i)}catch(i){await gl(e,i)}JA(e)&&XA(e)}function oB(n){return ii(n)&&n.b_.length<10}function aB(n,e){n.b_.push(e);const t=Hr(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function JA(n){return ii(n)&&!Hr(n).jo()&&n.b_.length>0}function XA(n){Hr(n).start()}async function cB(n){Hr(n).E_()}async function uB(n){const e=Hr(n);for(const t of n.b_)e.P_(t.mutations)}async function lB(n,e,t){const r=n.b_.shift(),i=yg.from(r,e,t);await YA(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await po(n)}async function hB(n,e){e&&Hr(n).h_&&await async function(r,i){if(function(a){return lA(a)&&a!==b.ABORTED}(i.code)){const s=r.b_.shift();Hr(r).Yo(),await YA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await po(r)}}(n,e),JA(n)&&XA(n)}async function kI(n,e){const t=B(n);t.asyncQueue.verifyOperationInProgress(),N("RemoteStore","RemoteStore received new credentials");const r=ii(t);t.C_.add(3),await fo(t),r&&t.M_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),await Ic(t)}async function np(n,e){const t=B(n);e?(t.C_.delete(2),await Ic(t)):e||(t.C_.add(2),await fo(t),t.M_.set("Unknown"))}function go(n){return n.O_||(n.O_=function(t,r,i){const s=B(t);return s.A_(),new XU(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:rB.bind(null,n),Io:iB.bind(null,n),a_:sB.bind(null,n)}),n.v_.push(async e=>{e?(n.O_.Yo(),Ng(n)?xg(n):n.M_.set("Unknown")):(await n.O_.stop(),QA(n))})),n.O_}function Hr(n){return n.N_||(n.N_=function(t,r,i){const s=B(t);return s.A_(),new ZU(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:cB.bind(null,n),Io:hB.bind(null,n),T_:uB.bind(null,n),I_:lB.bind(null,n)}),n.v_.push(async e=>{e?(n.N_.Yo(),await po(n)):(await n.N_.stop(),n.b_.length>0&&(N("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))})),n.N_}class Vg{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new st,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,l=new Vg(e,t,a,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function mo(n,e){if(Qe("AsyncQueue",`${e}: ${n}`),ni(n))return new k(b.UNAVAILABLE,`${e}: ${n}`);throw n}class Ms{constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=sa(),this.sortedSet=new Pe(this.comparator)}static emptySet(e){return new Ms(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ms)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Ms;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class xI{constructor(){this.B_=new Pe(F.comparator)}track(e){const t=e.doc.key,r=this.B_.get(t);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(t,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(t):e.type===1&&r.type===2?this.B_=this.B_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):$():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Js{constructor(e,t,r,i,s,a,l,h,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new Js(e,t,Ms.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class dB{constructor(){this.k_=void 0,this.listeners=[]}}class fB{constructor(){this.queries=new ri(e=>QT(e),pc),this.onlineState="Unknown",this.q_=new Set}}async function Og(n,e){const t=B(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new dB),i)try{s.k_=await t.onListen(r)}catch(a){const l=mo(a,`Initialization of query '${Rs(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,s),s.listeners.push(e),e.Q_(t.onlineState),s.k_&&e.K_(s.k_)&&Mg(t)}async function Lg(n,e){const t=B(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return t.queries.delete(r),t.onUnlisten(r)}function pB(n,e){const t=B(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const l of a.listeners)l.K_(i)&&(r=!0);a.k_=i}}r&&Mg(t)}function gB(n,e,t){const r=B(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function Mg(n){n.q_.forEach(e=>{e.next()})}class Fg{constructor(e,t,r){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Js(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){if(!e.fromCache)return!0;const r=t!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const t=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}H_(e){e=Js.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class mB{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class NI{constructor(e){this.serializer=e}hs(e){return Bn(this.serializer,e)}Ps(e){return e.metadata.exists?vA(this.serializer,e.document,!1):xe.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return Ye(e)}}class _B{constructor(e,t,r){this.X_=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=ZA(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const r=ge.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,r=new NI(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const a of i.metadata.queries){const l=(t.get(a)||re()).add(s);t.set(a,l)}}return t}async complete(){const e=await KU(this.localStore,new NI(this.serializer),this.documents,this.X_.id),t=this.ta(this.documents);for(const r of this.queries)await HU(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,na:this.collectionGroups,ra:e}}}function ZA(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class e0{constructor(e){this.key=e}}class t0{constructor(e){this.key=e}}class n0{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=re(),this.mutatedKeys=re(),this._a=JT(e),this.aa=new Ms(this._a)}get ua(){return this.ia}ca(e,t){const r=t?t.la:new xI,i=t?t.aa:this.aa;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,l=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{const I=i.get(p),A=gc(this.query,m)?m:null,L=!!I&&this.mutatedKeys.has(I.key),M=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let V=!1;I&&A?I.data.isEqual(A.data)?L!==M&&(r.track({type:3,doc:A}),V=!0):this.ha(I,A)||(r.track({type:2,doc:A}),V=!0,(h&&this._a(A,h)>0||f&&this._a(A,f)<0)&&(l=!0)):!I&&A?(r.track({type:0,doc:A}),V=!0):I&&!A&&(r.track({type:1,doc:I}),V=!0,(h||f)&&(l=!0)),V&&(A?(a=a.add(A),s=M?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{aa:a,la:r,Zi:l,mutatedKeys:s}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const a=e.la.L_();a.sort((p,m)=>function(A,L){const M=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $()}};return M(A)-M(L)}(p.type,m.type)||this._a(p.doc,m.doc)),this.Pa(r),i=i!=null&&i;const l=t&&!i?this.Ia():[],h=this.oa.size===0&&this.current&&!i?1:0,f=h!==this.sa;return this.sa=h,a.length!==0||f?{snapshot:new Js(this.query,e.aa,s,a,e.mutatedKeys,h===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:l}:{Ta:l}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new xI,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=re(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const t=[];return e.forEach(r=>{this.oa.has(r)||t.push(new t0(r))}),this.oa.forEach(r=>{e.has(r)||t.push(new e0(r))}),t}da(e){this.ia=e.ls,this.oa=re();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return Js.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class yB{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class vB{constructor(e){this.key=e,this.Ra=!1}}class IB{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new ri(l=>QT(l),pc),this.fa=new Map,this.ga=new Set,this.pa=new Pe(F.comparator),this.ya=new Map,this.wa=new Rg,this.Sa={},this.ba=new Map,this.Da=$i.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function wB(n,e){const t=Wg(n);let r,i;const s=t.ma.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const a=await Qs(t.localStore,xt(e)),l=t.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=await Ug(t,e,r,l==="current",a.resumeToken),t.isPrimaryClient&&ih(t.remoteStore,a)}return i}async function Ug(n,e,t,r,i){n.va=(m,I,A)=>async function(M,V,Y,ae){let j=V.view.ca(Y);j.Zi&&(j=await dl(M.localStore,V.query,!1).then(({documents:we})=>V.view.ca(we,j)));const ye=ae&&ae.targetChanges.get(V.targetId),de=ae&&ae.targetMismatches.get(V.targetId)!=null,me=V.view.applyChanges(j,M.isPrimaryClient,ye,de);return rp(M,V.targetId,me.Ta),me.snapshot}(n,m,I,A);const s=await dl(n.localStore,e,!0),a=new n0(e,s.ls),l=a.ca(s.documents),h=yc.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),f=a.applyChanges(l,n.isPrimaryClient,h);rp(n,t,f.Ta);const p=new yB(e,t,a);return n.ma.set(e,p),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),f.snapshot}async function EB(n,e){const t=B(n),r=t.ma.get(e),i=t.fa.get(r.targetId);if(i.length>1)return t.fa.set(r.targetId,i.filter(s=>!pc(s,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||await Ys(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Ka(t.remoteStore,r.targetId),Xs(t,r.targetId)}).catch(ti)):(Xs(t,r.targetId),await Ys(t.localStore,r.targetId,!0))}async function TB(n,e,t){const r=Gg(n);try{const i=await function(a,l){const h=B(a),f=Le.now(),p=l.reduce((A,L)=>A.add(L.key),re());let m,I;return h.persistence.runTransaction("Locally write mutations","readwrite",A=>{let L=$t(),M=re();return h.ss.getEntries(A,p).next(V=>{L=V,L.forEach((Y,ae)=>{ae.isValidDocument()||(M=M.add(Y))})}).next(()=>h.localDocuments.getOverlayedDocuments(A,L)).next(V=>{m=V;const Y=[];for(const ae of l){const j=X2(ae,m.get(ae.key).overlayedDocument);j!=null&&Y.push(new gr(ae.key,j,BT(j.value.mapValue),Oe.exists(!0)))}return h.mutationQueue.addMutationBatch(A,f,Y,l)}).next(V=>{I=V;const Y=V.applyToLocalDocumentSet(m,M);return h.documentOverlayCache.saveOverlays(A,V.batchId,Y)})}).then(()=>({batchId:I.batchId,changes:ZT(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let f=a.Sa[a.currentUser.toKey()];f||(f=new Pe(ne)),f=f.insert(l,h),a.Sa[a.currentUser.toKey()]=f}(r,i.batchId,t),await mr(r,i.changes),await po(r.remoteStore)}catch(i){const s=mo(i,"Failed to persist write");t.reject(s)}}async function r0(n,e){const t=B(n);try{const r=await GU(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.ya.get(s);a&&(z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?z(a.Ra):i.removedDocuments.size>0&&(z(a.Ra),a.Ra=!1))}),await mr(t,r,e)}catch(r){await ti(r)}}function VI(n,e,t){const r=B(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.ma.forEach((s,a)=>{const l=a.view.Q_(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){const h=B(a);h.onlineState=l;let f=!1;h.queries.forEach((p,m)=>{for(const I of m.listeners)I.Q_(l)&&(f=!0)}),f&&Mg(h)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function AB(n,e,t){const r=B(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ya.get(e),s=i&&i.key;if(s){let a=new Pe(F.comparator);a=a.insert(s,xe.newNoDocument(s,K.min()));const l=re().add(s),h=new _c(K.min(),new Map,new Pe(ne),a,l);await r0(r,h),r.pa=r.pa.remove(s),r.ya.delete(e),$g(r)}else await Ys(r.localStore,e,!1).then(()=>Xs(r,e,t)).catch(ti)}async function RB(n,e){const t=B(n),r=e.batch.batchId;try{const i=await WU(t.localStore,e);qg(t,r,null),Bg(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await mr(t,i)}catch(i){await ti(i)}}async function SB(n,e,t){const r=B(n);try{const i=await function(a,l){const h=B(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let p;return h.mutationQueue.lookupMutationBatch(f,l).next(m=>(z(m!==null),p=m.keys(),h.mutationQueue.removeMutationBatch(f,m))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,p,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,p)).next(()=>h.localDocuments.getDocuments(f,p))})}(r.localStore,e);qg(r,e,t),Bg(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await mr(r,i)}catch(i){await ti(i)}}async function bB(n,e){const t=B(n);ii(t.remoteStore)||N("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(a){const l=B(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(r===-1)return void e.resolve();const i=t.ba.get(r)||[];i.push(e),t.ba.set(r,i)}catch(r){const i=mo(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Bg(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function qg(n,e,t){const r=B(n);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Xs(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.fa.get(e))n.ma.delete(r),t&&n.Va.Fa(r,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(r=>{n.wa.containsKey(r)||i0(n,r)})}function i0(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);t!==null&&(Ka(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),$g(n))}function rp(n,e,t){for(const r of t)r instanceof e0?(n.wa.addReference(r.key,e),PB(n,r)):r instanceof t0?(N("SyncEngine","Document no longer in limbo: "+r.key),n.wa.removeReference(r.key,e),n.wa.containsKey(r.key)||i0(n,r.key)):$()}function PB(n,e){const t=e.key,r=t.path.canonicalString();n.pa.get(t)||n.ga.has(r)||(N("SyncEngine","New document in limbo: "+t),n.ga.add(r),$g(n))}function $g(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new F(ge.fromString(e)),r=n.Da.next();n.ya.set(r,new vB(t)),n.pa=n.pa.insert(t,r),ih(n.remoteStore,new sr(xt(uo(t.path)),r,"TargetPurposeLimboResolution",Bt._e))}}async function mr(n,e,t){const r=B(n),i=[],s=[],a=[];r.ma.isEmpty()||(r.ma.forEach((l,h)=>{a.push(r.va(h,e,t).then(f=>{if((f||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(h.targetId,f!=null&&f.fromCache?"not-current":"current"),f){i.push(f);const p=Pg.Qi(h.targetId,f);s.push(p)}}))}),await Promise.all(a),r.Va.a_(i),await async function(h,f){const p=B(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>R.forEach(f,I=>R.forEach(I.ki,A=>p.persistence.referenceDelegate.addReference(m,I.targetId,A)).next(()=>R.forEach(I.qi,A=>p.persistence.referenceDelegate.removeReference(m,I.targetId,A)))))}catch(m){if(!ni(m))throw m;N("LocalStore","Failed to update sequence numbers: "+m)}for(const m of f){const I=m.targetId;if(!m.fromCache){const A=p.ts.get(I),L=A.snapshotVersion,M=A.withLastLimboFreeSnapshotVersion(L);p.ts=p.ts.insert(I,M)}}}(r.localStore,s))}async function CB(n,e){const t=B(n);if(!t.currentUser.isEqual(e)){N("SyncEngine","User change. New user:",e.toKey());const r=await UA(t.localStore,e);t.currentUser=e,function(s,a){s.ba.forEach(l=>{l.forEach(h=>{h.reject(new k(b.CANCELLED,a))})}),s.ba.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await mr(t,r._s)}}function DB(n,e){const t=B(n),r=t.ya.get(e);if(r&&r.Ra)return re().add(r.key);{let i=re();const s=t.fa.get(e);if(!s)return i;for(const a of s){const l=t.ma.get(a);i=i.unionWith(l.view.ua)}return i}}async function kB(n,e){const t=B(n),r=await dl(t.localStore,e.query,!0),i=e.view.da(r);return t.isPrimaryClient&&rp(t,e.targetId,i.Ta),i}async function xB(n,e){const t=B(n);return WA(t.localStore,e).then(r=>mr(t,r))}async function NB(n,e,t,r){const i=B(n),s=await function(l,h){const f=B(l),p=B(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",m=>p.Cn(m,h).next(I=>I?f.localDocuments.getDocuments(m,I):R.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await po(i.remoteStore):t==="acknowledged"||t==="rejected"?(qg(i,e,r||null),Bg(i,e),function(l,h){B(B(l).mutationQueue).Fn(h)}(i.localStore,e)):$(),await mr(i,s)):N("SyncEngine","Cannot apply mutation batch with id: "+e)}async function VB(n,e){const t=B(n);if(Wg(t),Gg(t),e===!0&&t.Ca!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await OI(t,r.toArray());t.Ca=!0,await np(t.remoteStore,!0);for(const s of i)ih(t.remoteStore,s)}else if(e===!1&&t.Ca!==!1){const r=[];let i=Promise.resolve();t.fa.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(Xs(t,a),Ys(t.localStore,a,!0))),Ka(t.remoteStore,a)}),await i,await OI(t,r),function(a){const l=B(a);l.ya.forEach((h,f)=>{Ka(l.remoteStore,f)}),l.wa.Vr(),l.ya=new Map,l.pa=new Pe(F.comparator)}(t),t.Ca=!1,await np(t.remoteStore,!1)}}async function OI(n,e,t){const r=B(n),i=[],s=[];for(const a of e){let l;const h=r.fa.get(a);if(h&&h.length!==0){l=await Qs(r.localStore,xt(h[0]));for(const f of h){const p=r.ma.get(f),m=await kB(r,p);m.snapshot&&s.push(m.snapshot)}}else{const f=await $A(r.localStore,a);l=await Qs(r.localStore,f),await Ug(r,s0(f),a,!1,l.resumeToken)}i.push(l)}return r.Va.a_(s),i}function s0(n){return jT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function OB(n){return function(t){return B(B(t).persistence).Bi()}(B(n).localStore)}async function LB(n,e,t,r){const i=B(n);if(i.Ca)return void N("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=await WA(i.localStore,YT(s[0])),l=_c.createSynthesizedRemoteEventForCurrentChange(e,t==="current",tt.EMPTY_BYTE_STRING);await mr(i,a,l);break}case"rejected":await Ys(i.localStore,e,!0),Xs(i,e,r);break;default:$()}}async function MB(n,e,t){const r=Wg(n);if(r.Ca){for(const i of e){if(r.fa.has(i)){N("SyncEngine","Adding an already active target "+i);continue}const s=await $A(r.localStore,i),a=await Qs(r.localStore,s);await Ug(r,s0(s),a.targetId,!1,a.resumeToken),ih(r.remoteStore,a)}for(const i of t)r.fa.has(i)&&await Ys(r.localStore,i,!1).then(()=>{Ka(r.remoteStore,i),Xs(r,i)}).catch(ti)}}function Wg(n){const e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=r0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=AB.bind(null,e),e.Va.a_=pB.bind(null,e.eventManager),e.Va.Fa=gB.bind(null,e.eventManager),e}function Gg(n){const e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=RB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=SB.bind(null,e),e}function FB(n,e,t){const r=B(n);(async function(s,a,l){try{const h=await a.getMetadata();if(await function(A,L){const M=B(A),V=Ye(L.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",Y=>M.Kr.getBundleMetadata(Y,L.id)).then(Y=>!!Y&&Y.createTime.compareTo(V)>=0)}(s.localStore,h))return await a.close(),l._completeWith(function(A){return{taskState:"Success",documentsLoaded:A.totalDocuments,bytesLoaded:A.totalBytes,totalDocuments:A.totalDocuments,totalBytes:A.totalBytes}}(h)),Promise.resolve(new Set);l._updateProgress(ZA(h));const f=new _B(h,s.localStore,a.serializer);let p=await a.Ma();for(;p;){const I=await f.ea(p);I&&l._updateProgress(I),p=await a.Ma()}const m=await f.complete();return await mr(s,m.ra,void 0),await function(A,L){const M=B(A);return M.persistence.runTransaction("Save bundle","readwrite",V=>M.Kr.saveBundleMetadata(V,L))}(s.localStore,h),l._completeWith(m.progress),Promise.resolve(m.na)}catch(h){return wn("SyncEngine",`Loading bundle failed with ${h}`),l._failWith(h),Promise.resolve(new Set)}})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class ip{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=vc(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return FA(this.persistence,new MA,e.initialUser,this.serializer)}createPersistence(e){return new LA(rh.jr,this.serializer)}createSharedClientState(e){return new zA}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class o0 extends ip{constructor(e,t,r){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xa.initialize(this,e),await Gg(this.xa.syncEngine),await po(this.xa.remoteStore),await this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return FA(this.persistence,new MA,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new SU(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new u2(t,this.persistence);return new c2(e.asyncQueue,r)}createPersistence(e){const t=bg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ut.withCacheSize(this.cacheSizeBytes):Ut.DEFAULT;return new Sg(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,KA(),$u(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new zA}}class UB extends o0{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xa.syncEngine;this.sharedClientState instanceof pf&&(this.sharedClientState.syncEngine={Ys:NB.bind(null,t),Zs:LB.bind(null,t),Xs:MB.bind(null,t),Bi:OB.bind(null,t),Js:xB.bind(null,t)},await this.sharedClientState.start()),await this.persistence.mi(async r=>{await VB(this.xa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const t=KA();if(!pf.D(t))throw new k(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=bg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new pf(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class zg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>VI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=CB.bind(null,this.syncEngine),await np(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new fB}()}createDatastore(e){const t=vc(e.databaseInfo.databaseId),r=function(s){return new JU(s)}(e.databaseInfo);return function(s,a,l,h){return new eB(s,a,l,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,a,l){return new nB(r,i,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,t=>VI(this.syncEngine,t,0),function(){return DI.D()?new DI:new jU}())}createSyncEngine(e,t){return function(i,s,a,l,h,f,p){const m=new IB(i,s,a,l,h,f);return p&&(m.Ca=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(t){const r=B(t);N("RemoteStore","RemoteStore shutting down."),r.C_.add(5),await fo(r),r.F_.shutdown(),r.M_.set("Unknown")}(this.remoteStore)}}function LI(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class sh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):Qe("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class BB{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new st,this.buffer=new Uint8Array,this.La=function(){return new TextDecoder("utf-8")}(),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}async getMetadata(){return this.metadata.promise}async Ma(){return await this.getMetadata(),this.ka()}async ka(){const e=await this.qa();if(e===null)return null;const t=this.La.decode(e),r=Number(t);isNaN(r)&&this.Qa(`length string (${t}) is not valid number`);const i=await this.Ka(r);return new mB(JSON.parse(i),e.length+r)}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async qa(){for(;this.$a()<0&&!await this.Ua(););if(this.buffer.length===0)return null;const e=this.$a();e<0&&this.Qa("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Ka(e){for(;this.buffer.length<e;)await this.Ua()&&this.Qa("Reached the end of bundle when more is expected.");const t=this.La.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ua(){const e=await this.Ba.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class qB{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new k(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(i,s){const a=B(i),l=Ga(a.serializer)+"/documents",h={documents:s.map(I=>Wa(a.serializer,I))},f=await a.Co("BatchGetDocuments",l,h,s.length),p=new Map;f.forEach(I=>{const A=aU(a.serializer,I);p.set(A.key.toString(),A)});const m=[];return s.forEach(I=>{const A=p.get(I.toString());z(!!A),m.push(A)}),m}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ho(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=F.fromPath(r);this.mutations.push(new mg(i,this.precondition(i)))}),await async function(r,i){const s=B(r),a=Ga(s.serializer)+"/documents",l={writes:i.map(h=>za(s.serializer,h))};await s.wo("Commit",a,l)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw $();t=K.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new k(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(K.min())?Oe.exists(!1):Oe.updateTime(t):Oe.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(K.min()))throw new k(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Oe.updateTime(t)}return Oe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class $B{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new Dg(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko(async()=>{const e=new qB(this.datastore),t=this.za(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ja(i)}))}).catch(r=>{this.ja(r)})})}za(e){try{const t=this.updateFunction(e);return!dc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!lA(t)}return!1}}class WB{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=it.UNAUTHENTICATED,this.clientId=ST.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{N("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(N("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new st;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=mo(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Wu(n,e){n.asyncQueue.verifyOperationInProgress(),N("FirestoreClient","Initializing OfflineComponentProvider");const t=await n.getConfiguration();await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await UA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function sp(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Kg(n);N("FirestoreClient","Initializing OnlineComponentProvider");const r=await n.getConfiguration();await e.initialize(t,r),n.setCredentialChangeListener(i=>kI(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>kI(e.remoteStore,s)),n._onlineComponents=e}function a0(n){return n.name==="FirebaseError"?n.code===b.FAILED_PRECONDITION||n.code===b.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function Kg(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){N("FirestoreClient","Using user provided OfflineComponentProvider");try{await Wu(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!a0(t))throw t;wn("Error using user provided cache. Falling back to memory cache: "+t),await Wu(n,new ip)}}else N("FirestoreClient","Using default OfflineComponentProvider"),await Wu(n,new ip);return n._offlineComponents}async function oh(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(N("FirestoreClient","Using user provided OnlineComponentProvider"),await sp(n,n._uninitializedComponentsProvider._online)):(N("FirestoreClient","Using default OnlineComponentProvider"),await sp(n,new zg))),n._onlineComponents}function c0(n){return Kg(n).then(e=>e.persistence)}function Hg(n){return Kg(n).then(e=>e.localStore)}function u0(n){return oh(n).then(e=>e.remoteStore)}function jg(n){return oh(n).then(e=>e.syncEngine)}function GB(n){return oh(n).then(e=>e.datastore)}async function Zs(n){const e=await oh(n),t=e.eventManager;return t.onListen=wB.bind(null,e.syncEngine),t.onUnlisten=EB.bind(null,e.syncEngine),t}function zB(n){return n.asyncQueue.enqueue(async()=>{const e=await c0(n),t=await u0(n);return e.setNetworkEnabled(!0),function(i){const s=B(i);return s.C_.delete(0),Ic(s)}(t)})}function KB(n){return n.asyncQueue.enqueue(async()=>{const e=await c0(n),t=await u0(n);return e.setNetworkEnabled(!1),async function(i){const s=B(i);s.C_.add(0),await fo(s),s.M_.set("Offline")}(t)})}function HB(n,e){const t=new st;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await function(f,p){const m=B(f);return m.persistence.runTransaction("read document","readonly",I=>m.localDocuments.getDocument(I,p))}(i,s);l.isFoundDocument()?a.resolve(l):l.isNoDocument()?a.resolve(null):a.reject(new k(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const h=mo(l,`Failed to get document '${s} from cache`);a.reject(h)}}(await Hg(n),e,t)),t.promise}function l0(n,e,t={}){const r=new st;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const p=new sh({next:I=>{a.enqueueAndForget(()=>Lg(s,m));const A=I.docs.has(l);!A&&I.fromCache?f.reject(new k(b.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&I.fromCache&&h&&h.source==="server"?f.reject(new k(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(I)},error:I=>f.reject(I)}),m=new Fg(uo(l.path),p,{includeMetadataChanges:!0,J_:!0});return Og(s,m)}(await Zs(n),n.asyncQueue,e,t,r)),r.promise}function jB(n,e){const t=new st;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await dl(i,s,!0),h=new n0(s,l.ls),f=h.ca(l.documents),p=h.applyChanges(f,!1);a.resolve(p.snapshot)}catch(l){const h=mo(l,`Failed to execute query '${s} against cache`);a.reject(h)}}(await Hg(n),e,t)),t.promise}function h0(n,e,t={}){const r=new st;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const p=new sh({next:I=>{a.enqueueAndForget(()=>Lg(s,m)),I.fromCache&&h.source==="server"?f.reject(new k(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(I)},error:I=>f.reject(I)}),m=new Fg(l,p,{includeMetadataChanges:!0,J_:!0});return Og(s,m)}(await Zs(n),n.asyncQueue,e,t,r)),r.promise}function QB(n,e){const t=new sh(e);return n.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).q_.add(s),s.next()}(await Zs(n),t)),()=>{t.Na(),n.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).q_.delete(s)}(await Zs(n),t))}}function YB(n,e,t,r){const i=function(a,l){let h;return h=typeof a=="string"?dA().encode(a):a,function(p,m){return new BB(p,m)}(function(p,m){if(p instanceof Uint8Array)return LI(p,m);if(p instanceof ArrayBuffer)return LI(new Uint8Array(p),m);if(p instanceof ReadableStream)return p.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),l)}(t,vc(e));n.asyncQueue.enqueueAndForget(async()=>{FB(await jg(n),i,r)})}function JB(n,e){return n.asyncQueue.enqueue(async()=>function(r,i){const s=B(r);return s.persistence.runTransaction("Get named query","readonly",a=>s.Kr.getNamedQuery(a,i))}(await Hg(n),e))}function d0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const MI=new Map;function Qg(n,e,t){if(!t)throw new k(b.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function f0(n,e,t,r){if(e===!0&&r===!0)throw new k(b.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function FI(n){if(!F.isDocumentKey(n))throw new k(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function UI(n){if(F.isDocumentKey(n))throw new k(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ah(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$()}function _e(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new k(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ah(n);throw new k(b.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function p0(n,e){if(e<=0)throw new k(b.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class BI{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new k(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}f0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=d0((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new k(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new k(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new k(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wc{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new BI({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new k(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new k(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new BI(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new JF;switch(r.type){case"firstParty":return new t2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new k(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=MI.get(t);r&&(N("ComponentProvider","Removing Datastore"),MI.delete(t),r.terminate())}(this),Promise.resolve()}}function XB(n,e,t,r={}){var i;const s=(n=_e(n,wc))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&wn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let l,h;if(typeof r.mockUserToken=="string")l=r.mockUserToken,h=it.MOCK_USER;else{l=ax(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new k(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new it(f)}n._authCredentials=new XF(new RT(l,h))}}let Tt=class{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Tt(this.firestore,e,this._query)}},Me=class{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new cr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Me(this.firestore,e,this._key)}},cr=class extends Tt{constructor(e,t,r){super(e,t,uo(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new F(e))}withConverter(e){return new cr(this.firestore,e,this._path)}};function g0(n,e,...t){if(n=H(n),Qg("collection","path",e),n instanceof wc){const r=ge.fromString(e,...t);return UI(r),new cr(n,null,r)}{if(!(n instanceof Me||n instanceof cr))throw new k(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ge.fromString(e,...t));return UI(r),new cr(n.firestore,null,r)}}function ZB(n,e){if(n=_e(n,wc),Qg("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(b.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Tt(n,null,function(r){return new pr(ge.emptyPath(),r)}(e))}function Ha(n,e,...t){if(n=H(n),arguments.length===1&&(e=ST.newId()),Qg("doc","path",e),n instanceof wc){const r=ge.fromString(e,...t);return FI(r),new Me(n,null,new F(r))}{if(!(n instanceof Me||n instanceof cr))throw new k(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ge.fromString(e,...t));return FI(r),new Me(n.firestore,n instanceof cr?n.converter:null,new F(r))}}function m0(n,e){return n=H(n),e=H(e),(n instanceof Me||n instanceof cr)&&(e instanceof Me||e instanceof cr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function _0(n,e){return n=H(n),e=H(e),n instanceof Tt&&e instanceof Tt&&n.firestore===e.firestore&&pc(n._query,e._query)&&n.converter===e.converter}class eq{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new Dg(this,"async_queue_retry"),this.iu=()=>{const t=$u();t&&N("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=$u();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=$u();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new st;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!ni(e))throw e;N("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;const i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw Qe("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=t,t}enqueueAfterDelay(e,t,r){this.su(),this.ru.indexOf(e)>-1&&(t=0);const i=Vg.createAndSchedule(this,e,t,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&$()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function op(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class tq{constructor(){this._progressObserver={},this._taskCompletionResolver=new st,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const nq=-1;let Ge=class extends wc{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new eq}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||y0(this),this._firestoreClient.terminate()}};function ut(n){return n._firestoreClient||y0(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function y0(n){var e,t,r;const i=n._freezeSettings(),s=function(l,h,f,p){return new D2(l,h,f,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,d0(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new WB(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function rq(n,e){I0(n=_e(n,Ge));const t=ut(n);if(t._uninitializedComponentsProvider)throw new k(b.FAILED_PRECONDITION,"SDK cache is already specified.");wn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new zg;return v0(t,i,new o0(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function iq(n){I0(n=_e(n,Ge));const e=ut(n);if(e._uninitializedComponentsProvider)throw new k(b.FAILED_PRECONDITION,"SDK cache is already specified.");wn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new zg;return v0(e,r,new UB(r,t.cacheSizeBytes))}function v0(n,e,t){const r=new st;return n.asyncQueue.enqueue(async()=>{try{await Wu(n,t),await sp(n,e),r.resolve()}catch(i){const s=i;if(!a0(s))throw s;wn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function sq(n){if(n._initialized&&!n._terminated)throw new k(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new st;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!yn.D())return Promise.resolve();const i=r+"main";await yn.delete(i)}(bg(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function oq(n){return function(t){const r=new st;return t.asyncQueue.enqueueAndForget(async()=>bB(await jg(t),r)),r.promise}(ut(n=_e(n,Ge)))}function aq(n){return zB(ut(n=_e(n,Ge)))}function cq(n){return KB(ut(n=_e(n,Ge)))}function uq(n,e){const t=ut(n=_e(n,Ge)),r=new tq;return YB(t,n._databaseId,e,r),r}function lq(n,e){return JB(ut(n=_e(n,Ge)),e).then(t=>t?new Tt(n,null,t.query):null)}function I0(n){if(n._initialized||n._terminated)throw new k(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class zn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new zn(tt.fromBase64String(e))}catch(t){throw new k(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new zn(tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}let jr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new k(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let Qi=class{constructor(e){this._methodName=e}};class ch{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new k(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}}const hq=/^__.*__$/;class dq{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new gr(e,this.data,this.fieldMask,t,this.fieldTransforms):new lo(e,this.data,t,this.fieldTransforms)}}class w0{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new gr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function E0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $()}}class uh{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new uh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return ml(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(E0(this.Iu)&&hq.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class fq{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||vc(e)}pu(e,t,r,i=!1){return new uh({Iu:e,methodName:t,gu:r,path:Ve.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yi(n){const e=n._freezeSettings(),t=vc(n._databaseId);return new fq(n._databaseId,!!e.ignoreUndefinedProperties,t)}function lh(n,e,t,r,i,s={}){const a=n.pu(s.merge||s.mergeFields?2:0,e,t,i);Zg("Data must be an object, but it was:",a,r);const l=R0(r,a);let h,f;if(s.merge)h=new qt(a.fieldMask),f=a.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const I=ap(e,m,t);if(!a.contains(I))throw new k(b.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);b0(p,I)||p.push(I)}h=new qt(p),f=a.fieldTransforms.filter(m=>h.covers(m.field))}else h=null,f=a.fieldTransforms;return new dq(new pt(l),h,f)}class Ec extends Qi{_toFieldTransform(e){if(e.Iu!==2)throw e.Iu===1?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ec}}function T0(n,e,t){return new uh({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Yg extends Qi{_toFieldTransform(e){return new mc(e.path,new Ks)}isEqual(e){return e instanceof Yg}}class pq extends Qi{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=T0(this,e,!0),r=this.yu.map(s=>Ji(s,t)),i=new Fi(r);return new mc(e.path,i)}isEqual(e){return this===e}}class gq extends Qi{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=T0(this,e,!0),r=this.yu.map(s=>Ji(s,t)),i=new Ui(r);return new mc(e.path,i)}isEqual(e){return this===e}}class mq extends Qi{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new Hs(e.serializer,rA(e.serializer,this.wu));return new mc(e.path,t)}isEqual(e){return this===e}}function Jg(n,e,t,r){const i=n.pu(1,e,t);Zg("Data must be an object, but it was:",i,r);const s=[],a=pt.empty();ji(r,(h,f)=>{const p=em(e,h,t);f=H(f);const m=i.Ru(p);if(f instanceof Ec)s.push(p);else{const I=Ji(f,m);I!=null&&(s.push(p),a.set(p,I))}});const l=new qt(s);return new w0(a,l,i.fieldTransforms)}function Xg(n,e,t,r,i,s){const a=n.pu(1,e,t),l=[ap(e,r,t)],h=[i];if(s.length%2!=0)throw new k(b.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<s.length;I+=2)l.push(ap(e,s[I])),h.push(s[I+1]);const f=[],p=pt.empty();for(let I=l.length-1;I>=0;--I)if(!b0(f,l[I])){const A=l[I];let L=h[I];L=H(L);const M=a.Ru(A);if(L instanceof Ec)f.push(A);else{const V=Ji(L,M);V!=null&&(f.push(A),p.set(A,V))}}const m=new qt(f);return new w0(p,m,a.fieldTransforms)}function A0(n,e,t,r=!1){return Ji(t,n.pu(r?4:3,e))}function Ji(n,e){if(S0(n=H(n)))return Zg("Unsupported field value:",e,n),R0(n,e);if(n instanceof Qi)return function(r,i){if(!E0(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const l of r){let h=Ji(l,i.Vu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=H(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return rA(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Le.fromDate(r);return{timestampValue:js(i.serializer,s)}}if(r instanceof Le){const s=new Le(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:js(i.serializer,s)}}if(r instanceof ch)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof zn)return{bytesValue:gA(i.serializer,r._byteString)};if(r instanceof Me){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:wg(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${ah(r)}`)}(n,e)}function R0(n,e){const t={};return MT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ji(n,(r,i)=>{const s=Ji(i,e.Eu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function S0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Le||n instanceof ch||n instanceof zn||n instanceof Me||n instanceof Qi)}function Zg(n,e,t){if(!S0(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=ah(t);throw r==="an object"?e.mu(n+" a custom object"):e.mu(n+" "+r)}}function ap(n,e,t){if((e=H(e))instanceof jr)return e._internalPath;if(typeof e=="string")return em(n,e);throw ml("Field path arguments must be of type string or ",n,!1,void 0,t)}const _q=new RegExp("[~\\*/\\[\\]]");function em(n,e,t){if(e.search(_q)>=0)throw ml(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new jr(...e.split("."))._internalPath}catch{throw ml(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ml(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new k(b.INVALID_ARGUMENT,l+n+h)}function b0(n,e){return n.some(t=>t.isEqual(e))}class ja{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new yq(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(hh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class yq extends ja{data(){return super.data()}}function hh(n,e){return typeof e=="string"?em(n,e):e instanceof jr?e._internalPath:e._delegate._internalPath}function P0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new k(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class tm{}class Tc extends tm{}function Dr(n,e,...t){let r=[];e instanceof tm&&r.push(e),r=r.concat(t),function(s){const a=s.filter(h=>h instanceof nm).length,l=s.filter(h=>h instanceof dh).length;if(a>1||a>0&&l>0)throw new k(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class dh extends Tc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new dh(e,t,r)}_apply(e){const t=this._parse(e);return D0(e._query,t),new Tt(e.firestore,e.converter,jf(e._query,t))}_parse(e){const t=Yi(e.firestore);return function(s,a,l,h,f,p,m){let I;if(f.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new k(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){$I(m,p);const A=[];for(const L of m)A.push(qI(h,s,L));I={arrayValue:{values:A}}}else I=qI(h,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||$I(m,p),I=A0(l,a,m,p==="in"||p==="not-in");return he.create(f,p,I)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function vq(n,e,t){const r=e,i=hh("where",n);return dh._create(i,r,t)}class nm extends tm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new nm(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Te.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i;const l=s.getFlattenedFilters();for(const h of l)D0(a,h),a=jf(a,h)}(e._query,t),new Tt(e.firestore,e.converter,jf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class rm extends Tc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new rm(e,t)}_apply(e){const t=function(i,s,a){if(i.startAt!==null)throw new k(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new k(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new $a(s,a)}(e._query,this._field,this._direction);return new Tt(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new pr(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function Iq(n,e="asc"){const t=e,r=hh("orderBy",n);return rm._create(r,t)}class fh extends Tc{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new fh(e,t,r)}_apply(e){return new Tt(e.firestore,e.converter,cl(e._query,this._limit,this._limitType))}}function wq(n){return p0("limit",n),fh._create("limit",n,"F")}function Eq(n){return p0("limitToLast",n),fh._create("limitToLast",n,"L")}class ph extends Tc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new ph(e,t,r)}_apply(e){const t=C0(e,this.type,this._docOrFields,this._inclusive);return new Tt(e.firestore,e.converter,function(i,s){return new pr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}}function Tq(...n){return ph._create("startAt",n,!0)}function Aq(...n){return ph._create("startAfter",n,!1)}class gh extends Tc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new gh(e,t,r)}_apply(e){const t=C0(e,this.type,this._docOrFields,this._inclusive);return new Tt(e.firestore,e.converter,function(i,s){return new pr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}}function Rq(...n){return gh._create("endBefore",n,!1)}function Sq(...n){return gh._create("endAt",n,!0)}function C0(n,e,t,r){if(t[0]=H(t[0]),t[0]instanceof ja)return function(s,a,l,h,f){if(!h)throw new k(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const p=[];for(const m of Ls(s))if(m.field.isKeyField())p.push(Li(a,h.key));else{const I=h.data.field(m.field);if(Xl(I))throw new k(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+m.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(I===null){const A=m.field.canonicalString();throw new k(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${A}' (used as the orderBy) does not exist.`)}p.push(I)}return new Kr(p,f)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Yi(n.firestore);return function(a,l,h,f,p,m){const I=a.explicitOrderBy;if(p.length>I.length)throw new k(b.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const A=[];for(let L=0;L<p.length;L++){const M=p[L];if(I[L].field.isKeyField()){if(typeof M!="string")throw new k(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof M}`);if(!pg(a)&&M.indexOf("/")!==-1)throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${M}' contains a slash.`);const V=a.path.child(ge.fromString(M));if(!F.isDocumentKey(V))throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${V}' is not because it contains an odd number of segments.`);const Y=new F(V);A.push(Li(l,Y))}else{const V=A0(h,f,M);A.push(V)}}return new Kr(A,m)}(n._query,n.firestore._databaseId,i,e,t,r)}}function qI(n,e,t){if(typeof(t=H(t))=="string"){if(t==="")throw new k(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pg(e)&&t.indexOf("/")!==-1)throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ge.fromString(t));if(!F.isDocumentKey(r))throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Li(n,new F(r))}if(t instanceof Me)return Li(n,t._key);throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ah(t)}.`)}function $I(n,e){if(!Array.isArray(n)||n.length===0)throw new k(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function D0(n,e){const t=function(i,s){for(const a of i)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new k(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new k(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class im{convertValue(e,t="none"){switch(Oi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Wr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw $()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ji(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new ch(qe(e.latitude),qe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=dg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ua(e));default:return null}}convertTimestamp(e){const t=$r(e);return new Le(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ge.fromString(e);z(RA(r));const i=new Gr(r.get(1),r.get(3)),s=new F(r.popFirst(5));return i.isEqual(t)||Qe(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function mh(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class bq extends im{constructor(e){super(),this.firestore=e}convertBytes(e){return new zn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}}class Si{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let hr=class extends ja{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ya(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(hh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},ya=class extends hr{data(e={}){return super.data(e)}},Qr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Si(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ya(this._firestore,this._userDataWriter,r.key,r,new Si(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new k(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{const h=new ya(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Si(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const h=new ya(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Si(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,p=-1;return l.type!==0&&(f=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:Pq(l.type),doc:h,oldIndex:f,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Pq(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $()}}function k0(n,e){return n instanceof hr&&e instanceof hr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Qr&&e instanceof Qr&&n._firestore===e._firestore&&_0(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function x0(n){n=_e(n,Me);const e=_e(n.firestore,Ge);return l0(ut(e),n._key).then(t=>sm(e,n,t))}class Xi extends im{constructor(e){super(),this.firestore=e}convertBytes(e){return new zn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}}function Cq(n){n=_e(n,Me);const e=_e(n.firestore,Ge),t=ut(e),r=new Xi(e);return HB(t,n._key).then(i=>new hr(e,r,n._key,i,new Si(i!==null&&i.hasLocalMutations,!0),n.converter))}function Dq(n){n=_e(n,Me);const e=_e(n.firestore,Ge);return l0(ut(e),n._key,{source:"server"}).then(t=>sm(e,n,t))}function kq(n){n=_e(n,Tt);const e=_e(n.firestore,Ge),t=ut(e),r=new Xi(e);return P0(n._query),h0(t,n._query).then(i=>new Qr(e,r,n,i))}function xq(n){n=_e(n,Tt);const e=_e(n.firestore,Ge),t=ut(e),r=new Xi(e);return jB(t,n._query).then(i=>new Qr(e,r,n,i))}function Nq(n){n=_e(n,Tt);const e=_e(n.firestore,Ge),t=ut(e),r=new Xi(e);return h0(t,n._query,{source:"server"}).then(i=>new Qr(e,r,n,i))}function WI(n,e,t){n=_e(n,Me);const r=_e(n.firestore,Ge),i=mh(n.converter,e,t);return Ac(r,[lh(Yi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Oe.none())])}function GI(n,e,t,...r){n=_e(n,Me);const i=_e(n.firestore,Ge),s=Yi(i);let a;return a=typeof(e=H(e))=="string"||e instanceof jr?Xg(s,"updateDoc",n._key,e,t,r):Jg(s,"updateDoc",n._key,e),Ac(i,[a.toMutation(n._key,Oe.exists(!0))])}function Vq(n){return Ac(_e(n.firestore,Ge),[new ho(n._key,Oe.none())])}function Oq(n,e){const t=_e(n.firestore,Ge),r=Ha(n),i=mh(n.converter,e);return Ac(t,[lh(Yi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Oe.exists(!1))]).then(()=>r)}function N0(n,...e){var t,r,i;n=H(n);let s={includeMetadataChanges:!1},a=0;typeof e[a]!="object"||op(e[a])||(s=e[a],a++);const l={includeMetadataChanges:s.includeMetadataChanges};if(op(e[a])){const m=e[a];e[a]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[a+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[a+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let h,f,p;if(n instanceof Me)f=_e(n.firestore,Ge),p=uo(n._key.path),h={next:m=>{e[a]&&e[a](sm(f,n,m))},error:e[a+1],complete:e[a+2]};else{const m=_e(n,Tt);f=_e(m.firestore,Ge),p=m._query;const I=new Xi(f);h={next:A=>{e[a]&&e[a](new Qr(f,I,m,A))},error:e[a+1],complete:e[a+2]},P0(n._query)}return function(I,A,L,M){const V=new sh(M),Y=new Fg(A,V,L);return I.asyncQueue.enqueueAndForget(async()=>Og(await Zs(I),Y)),()=>{V.Na(),I.asyncQueue.enqueueAndForget(async()=>Lg(await Zs(I),Y))}}(ut(f),p,l,h)}function Lq(n,e){return QB(ut(n=_e(n,Ge)),op(e)?e:{next:e})}function Ac(n,e){return function(r,i){const s=new st;return r.asyncQueue.enqueueAndForget(async()=>TB(await jg(r),i,s)),s.promise}(ut(n),e)}function sm(n,e,t){const r=t.docs.get(e._key),i=new Xi(n);return new hr(n,i,e._key,r,new Si(t.hasPendingWrites,t.fromCache),e.converter)}const Mq={maxAttempts:5};let Fq=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Yi(e)}set(e,t,r){this._verifyNotCommitted();const i=xr(e,this._firestore),s=mh(i.converter,t,r),a=lh(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(a.toMutation(i._key,Oe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=xr(e,this._firestore);let a;return a=typeof(t=H(t))=="string"||t instanceof jr?Xg(this._dataReader,"WriteBatch.update",s._key,t,r,i):Jg(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Oe.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=xr(e,this._firestore);return this._mutations=this._mutations.concat(new ho(t._key,Oe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function xr(n,e){if((n=H(n)).firestore!==e)throw new k(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}let Uq=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Yi(t)}get(t){const r=xr(t,this._firestore),i=new bq(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return $();const a=s[0];if(a.isFoundDocument())return new ja(this._firestore,i,a.key,a,r.converter);if(a.isNoDocument())return new ja(this._firestore,i,r._key,null,r.converter);throw $()})}set(t,r,i){const s=xr(t,this._firestore),a=mh(s.converter,r,i),l=lh(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(t,r,i,...s){const a=xr(t,this._firestore);let l;return l=typeof(r=H(r))=="string"||r instanceof jr?Xg(this._dataReader,"Transaction.update",a._key,r,i,s):Jg(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,l),this}delete(t){const r=xr(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=xr(e,this._firestore),r=new Xi(this._firestore);return super.get(e).then(i=>new hr(this._firestore,r,t._key,i._document,new Si(!1,!1),t.converter))}};function Bq(n,e,t){n=_e(n,Ge);const r=Object.assign(Object.assign({},Mq),t);return function(s){if(s.maxAttempts<1)throw new k(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,a,l){const h=new st;return s.asyncQueue.enqueueAndForget(async()=>{const f=await GB(s);new $B(s.asyncQueue,f,l,a,h).run()}),h.promise}(ut(n),i=>e(new Uq(n,i)),r)}function qq(){return new Ec("deleteField")}function $q(){return new Yg("serverTimestamp")}function Wq(...n){return new pq("arrayUnion",n)}function Gq(...n){return new gq("arrayRemove",n)}function zq(n){return new mq("increment",n)}(function(e,t=!0){(function(i){co=i})(Jr),Ur(new $n("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),l=new Ge(new ZF(r.getProvider("auth-internal")),new r2(r.getProvider("app-check-internal")),function(f,p){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new k(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gr(f.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Fn(Fv,"4.4.0",e),Fn(Fv,"4.4.0","esm2017")})();const Kq="@firebase/firestore-compat",Hq="0.3.23";function om(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function zI(){if(typeof Uint8Array>"u")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function KI(){if(!P2())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Qa{constructor(e){this._delegate=e}static fromBase64String(e){return KI(),new Qa(zn.fromBase64String(e))}static fromUint8Array(e){return zI(),new Qa(zn.fromUint8Array(e))}toBase64(){return KI(),this._delegate.toBase64()}toUint8Array(){return zI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function cp(n){return jq(n,["next","error","complete"])}function jq(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class Qq{enableIndexedDbPersistence(e,t){return rq(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return iq(e._delegate)}clearIndexedDbPersistence(e){return sq(e._delegate)}}class V0{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Gr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&wn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){XB(this._delegate,e,t,r)}enableNetwork(){return aq(this._delegate)}disableNetwork(){return cq(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,f0("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return oq(this._delegate)}onSnapshotsInSync(e){return Lq(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new eo(this,g0(this._delegate,e))}catch(t){throw Pt(t,"collection()","Firestore.collection()")}}doc(e){try{return new un(this,Ha(this._delegate,e))}catch(t){throw Pt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new bt(this,ZB(this._delegate,e))}catch(t){throw Pt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Bq(this._delegate,t=>e(new O0(this,t)))}batch(){return ut(this._delegate),new L0(new Fq(this._delegate,e=>Ac(this._delegate,e)))}loadBundle(e){return uq(this._delegate,e)}namedQuery(e){return lq(this._delegate,e).then(t=>t?new bt(this,t):null)}}class _h extends im{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qa(new zn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return un.forKey(t,this.firestore,null)}}function Yq(n){QF(n)}class O0{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new _h(e)}get(e){const t=bi(e);return this._delegate.get(t).then(r=>new Ya(this._firestore,new hr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=bi(e);return r?(om("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=bi(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=bi(e);return this._delegate.delete(t),this}}class L0{constructor(e){this._delegate=e}set(e,t,r){const i=bi(e);return r?(om("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=bi(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=bi(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Wi{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new ya(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ja(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Wi.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new Wi(e,new _h(e),t),i.set(t,s)),s}}Wi.INSTANCES=new WeakMap;class un{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new _h(e)}static forPath(e,t,r){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new un(t,new Me(t._delegate,r,new F(e)))}static forKey(e,t,r){return new un(t,new Me(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new eo(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new eo(this.firestore,g0(this._delegate,e))}catch(t){throw Pt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=H(e),e instanceof Me?m0(this._delegate,e):!1}set(e,t){t=om("DocumentReference.set",t);try{return t?WI(this._delegate,e,t):WI(this._delegate,e)}catch(r){throw Pt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?GI(this._delegate,e):GI(this._delegate,e,t,...r)}catch(i){throw Pt(i,"updateDoc()","DocumentReference.update()")}}delete(){return Vq(this._delegate)}onSnapshot(...e){const t=M0(e),r=F0(e,i=>new Ya(this.firestore,new hr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return N0(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=Cq(this._delegate):(e==null?void 0:e.source)==="server"?t=Dq(this._delegate):t=x0(this._delegate),t.then(r=>new Ya(this.firestore,new hr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new un(this.firestore,e?this._delegate.withConverter(Wi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Pt(n,e,t){return n.message=n.message.replace(e,t),n}function M0(n){for(const e of n)if(typeof e=="object"&&!cp(e))return e;return{}}function F0(n,e){var t,r;let i;return cp(n[0])?i=n[0]:cp(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class Ya{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new un(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return k0(this._delegate,e._delegate)}}class Ja extends Ya{data(e){const t=this._delegate.data(e);return this._delegate._converter||YF(t!==void 0),t}}class bt{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new _h(e)}where(e,t,r){try{return new bt(this.firestore,Dr(this._delegate,vq(e,t,r)))}catch(i){throw Pt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new bt(this.firestore,Dr(this._delegate,Iq(e,t)))}catch(r){throw Pt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new bt(this.firestore,Dr(this._delegate,wq(e)))}catch(t){throw Pt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new bt(this.firestore,Dr(this._delegate,Eq(e)))}catch(t){throw Pt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new bt(this.firestore,Dr(this._delegate,Tq(...e)))}catch(t){throw Pt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new bt(this.firestore,Dr(this._delegate,Aq(...e)))}catch(t){throw Pt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new bt(this.firestore,Dr(this._delegate,Rq(...e)))}catch(t){throw Pt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new bt(this.firestore,Dr(this._delegate,Sq(...e)))}catch(t){throw Pt(t,"endAt()","Query.endAt()")}}isEqual(e){return _0(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=xq(this._delegate):(e==null?void 0:e.source)==="server"?t=Nq(this._delegate):t=kq(this._delegate),t.then(r=>new up(this.firestore,new Qr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=M0(e),r=F0(e,i=>new up(this.firestore,new Qr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return N0(this._delegate,t,r)}withConverter(e){return new bt(this.firestore,e?this._delegate.withConverter(Wi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Jq{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ja(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class up{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new bt(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ja(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Jq(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Ja(this._firestore,r))})}isEqual(e){return k0(this._delegate,e._delegate)}}class eo extends bt{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new un(this.firestore,e):null}doc(e){try{return e===void 0?new un(this.firestore,Ha(this._delegate)):new un(this.firestore,Ha(this._delegate,e))}catch(t){throw Pt(t,"doc()","CollectionReference.doc()")}}add(e){return Oq(this._delegate,e).then(t=>new un(this.firestore,t))}isEqual(e){return m0(this._delegate,e._delegate)}withConverter(e){return new eo(this.firestore,e?this._delegate.withConverter(Wi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function bi(n){return _e(n,Me)}class am{constructor(...e){this._delegate=new jr(...e)}static documentId(){return new am(Ve.keyField().canonicalString())}isEqual(e){return e=H(e),e instanceof jr?this._delegate._internalPath.isEqual(e._internalPath):!1}}class Ei{constructor(e){this._delegate=e}static serverTimestamp(){const e=$q();return e._methodName="FieldValue.serverTimestamp",new Ei(e)}static delete(){const e=qq();return e._methodName="FieldValue.delete",new Ei(e)}static arrayUnion(...e){const t=Wq(...e);return t._methodName="FieldValue.arrayUnion",new Ei(t)}static arrayRemove(...e){const t=Gq(...e);return t._methodName="FieldValue.arrayRemove",new Ei(t)}static increment(e){const t=zq(e);return t._methodName="FieldValue.increment",new Ei(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Xq={Firestore:V0,GeoPoint:ch,Timestamp:Le,Blob:Qa,Transaction:O0,WriteBatch:L0,DocumentReference:un,DocumentSnapshot:Ya,Query:bt,QueryDocumentSnapshot:Ja,QuerySnapshot:up,CollectionReference:eo,FieldPath:am,FieldValue:Ei,setLogLevel:Yq,CACHE_SIZE_UNLIMITED:nq};function Zq(n,e){n.INTERNAL.registerComponent(new $n("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Xq)))}function e4(n){Zq(n,(e,t)=>new V0(e,t,new Qq)),n.registerVersion(Kq,Hq)}e4(Br);const t4={apiKey:"AIzaSyCfFGZC07caKFCARPJmMU-qsuAW8jLIu3E",authDomain:"project-fitness-07.firebaseapp.com",projectId:"project-fitness-07",storageBucket:"project-fitness-07.appspot.com",messagingSenderId:"607206642972",appId:"1:607206642972:web:ea1d5c525a976b668cd6d9"},Gi=Br.initializeApp(t4);async function n4({email:n,password:e,name:t}){await Gi.auth().createUserWithEmailAndPassword(n,e),await(await Gi.auth().currentUser).updateProfile({displayName:t})}async function r4({email:n,password:e}){try{await Gi.auth().signInWithEmailAndPassword(n,e)}catch(t){console.log(t.message)}}async function i4(){await Gi.auth().signOut()}const Yo={fs:Br.firestore(),getCurrentUserID:async function(){return new Promise((n,e)=>{Gi.auth().onAuthStateChanged(t=>{t?n(t.uid):e("User not authenticated")})})},addData:async function(n,e){const t=await this.getCurrentUserID();this.fs.collection("users").doc(t).set({[n]:e},{merge:!0}).then(()=>!0).catch(r=>(console.error("Error writing document: ",r),!1))},removeData:async function(n){const e=await this.getCurrentUserID();this.fs.collection("users").doc(e).update({[n]:Br.firestore.FieldValue.delete()},{merge:!0}).then(()=>!0).catch(t=>(console.error("Error writing document: ",t),!1))},getData:async function(){const n=await this.getCurrentUserID(),e=Ha(this.fs,"users",n),t=await x0(e);if(t.exists())return t.data();console.error("No such document")}},yh=document.querySelector(".js-cards"),Fs="/project-fitness-07/";function s4(n){const e=n.map(({filter:t,name:r,imgURL:i})=>`
        <li class="exercise-cards__gallery-link js-card" data-card-name="${r}">
            <div class="exercise-cards__gallery-card">
                
                <img class="exercise-cards__gallery-image"  src="${i}" alt="${t+"-"+r}" loading="lazy" />
                <div class="exercise-cards__gallery-info">
                    <h3 class="exercise-cards__head3-name">${r}</h3>
                    <p class="exercise-cards__parag-filter">${t}</p>
                </div>
            </div>
        </li>
        `).join("");yh.insertAdjacentHTML("beforeend",e)}function o4(n){const e=n.map(({_id:t,bodyPart:r,name:i,target:s,burnedCalories:a,time:l,rating:h})=>`
        <li class="workout-cards__gallery-link js-workout-card" data-id="${t}">
            <div class="workout-cards__gallery-card" >
                <div class="workout-cards__first-line-wrapper">
                    <p class="workout-cards__parag-workout">Workout</p>
                    <p class="workout-cards__parag-rating">${Math.round(h*10)/10}</p>
                    <svg class="workout-cards__icon-star">
                        <use href="${Fs}images/icons-sprite.svg#icon-star"></use>
                    </svg>
                    <p class="workout-cards__parag-start">Start</p>
                    <svg class="workout-cards__icon-arrow-up">
                        <use href="${Fs}images/icons-sprite.svg#icon-arrow-up"></use>
                    </svg>
                </div>
                <div class="workout-cards__second-line-wrapper">
                    <div class="workout-cards__wrapper-icon-running-stick">
                        <svg class="workout-cards__icon-running-stick">
                            <use href="${Fs}images/icons-sprite.svg#icon-running-stick"></use>
                        </svg>
                    </div>
                    <h3 class="workout-cards__head3-name">${i}</h3>
                </div>
                <div class="workout-cards__third-line-wrapper">
                  <ul class="workout-cards__list-info">
                    <li class="workout-cards__list-point">
                      <p class="workout-cards__parag-burned-calories">Burned calories:</p>
                      <p class="workout-cards__parag-burned-calories-result">${a} / ${l} min<p>
                    </li>
                    <li class="workout-cards__list-point">
                      <p class="workout-cards__parag-body-part">Body part:</p>
                      <p class="workout-cards__parag-body-part-result">${r}<p>
                    </li>
                    <li class="workout-cards__list-point">
                      <p class="workout-cards__parag-target">Target:</p>
                      <p class="workout-cards__parag-target-result">${s}<p>
                    </li>
                  </ul>
                </div>
            </div>
          </li>
        `).join("");yh.insertAdjacentHTML("beforeend",e)}function a4(n){const e=n.map(({_id:t,bodyPart:r,name:i,target:s,burnedCalories:a,time:l})=>`
        <li class="favorite-cards__gallery-link" data-id="${t}">
            <div class="favorite-cards__gallery-card">
                <div class="favorite-cards__first-line-wrapper">
                    <p class="favorite-cards__parag-workout">Workout</p>
                    <svg class="favorite-cards__icon-trash">
                        <use href="${Fs}images/icons-sprite.svg#icon-trash"></use>
                    </svg>
                    <p class="favorite-cards__parag-start">Start</p>
                    <svg class="favorite-cards__icon-arrow-up">
                        <use href="${Fs}images/icons-sprite.svg#icon-arrow-up"></use>
                    </svg>
                </div>
                <div class="favorite-cards__second-line-wrapper">
                    <div class="workout-cards__wrapper-icon-running-stick">
                      <svg class="favorite-cards__icon-running-stick">
                          <use href="${Fs}images/icons-sprite.svg#icon-running-stick"></use>
                      </svg>
                    </div>
                    <h3 class="favorite-cards__head3-name">${i}</h3>
                </div>
                <div class="favorite-cards__third-line-wrapper">
                  <ul class="favorite-cards__list-info">
                    <li class="favorite-cards__list-point">
                      <p class="favorite-cards__parag-burned-calories">Burned calories:</p>
                      <p class="favorite-cards__parag-burned-calories-result">${a} / ${l} min<p>
                    </li>
                    <li class="favorite-cards__list-point">
                      <p class="favorite-cards__parag-body-part">Body part:</p>
                      <p class="favorite-cards__parag-body-part-result">${r}<p>
                    </li>
                    <li class="favorite-cards__list-point">
                      <p class="favorite-cards__parag-target">Target:</p>
                      <p class="favorite-cards__parag-target-result">${s}<p>
                    </li>
                  </ul>
                </div>
            </div>
          </li>
        `).join("");yh.insertAdjacentHTML("beforeend",e)}function Du(){yh.innerHTML=""}function Jo(n,e){let t="";for(let r=0;r<n;r+=1)e.classList.contains("workout-cards__wrapper")?t+=`
      <li class='workouts__skeleton-loader'>
        <div class='svg-container'>
          <svg
            role="img"
            width="100%"
            height="141"
            aria-labelledby="loading-aria"
            viewBox="0 0 405 141"
            preserveAspectRatio="none"
          >
            <title id="loading-aria">Loading...</title>
            <rect
              x="0"
              y="0"
              width="100%"
              height="100%"
              clip-path="url(#clip-path)"
              style='fill: url("#fill");'
            ></rect>
            <defs>
              <clipPath id="clip-path">
                  <rect x="9" y="5" rx="10" ry="10" width="81" height="19" />
                  <rect x="107" y="5" rx="3" ry="3" width="19" height="18" />
                  <circle cx="28" cy="67" r="19" />
                  <rect x="311" y="7" rx="4" ry="4" width="58" height="20" />
                  <rect x="381" y="18" rx="0" ry="0" width="40" height="0" />
                  <rect x="74" y="54" rx="0" ry="0" width="192" height="25" />
                  <rect x="6" y="108" rx="0" ry="0" width="123" height="28" />
                  <rect x="164" y="109" rx="0" ry="0" width="122" height="26" />
                  <rect x="314" y="109" rx="0" ry="0" width="77" height="27" />
                  <rect x="379" y="8" rx="7" ry="7" width="19" height="19" />
              </clipPath>
              <linearGradient id="fill">
                <stop
                  offset="0.599964"
                  stop-color="#ecebeb"
                  stop-opacity="1"
                >
                  <animate
                    attributeName="offset"
                    values="-2; -2; 1"
                    keyTimes="0; 0.25; 1"
                    dur="2s"
                    repeatCount="indefinite"
                  ></animate>
                </stop>
                <stop
                  offset="1.59996"
                  stop-color="#ffffff"
                  stop-opacity="1"
                >
                  <animate
                    attributeName="offset"
                    values="-1; -1; 2"
                    keyTimes="0; 0.25; 1"
                    dur="2s"
                    repeatCount="indefinite"
                  ></animate>
                </stop>
                <stop
                  offset="2.59996"
                  stop-color="#ecebeb"
                  stop-opacity="1"
                >
                  <animate
                    attributeName="offset"
                    values="0; 0; 3"
                    keyTimes="0; 0.25; 1"
                    dur="2s"
                    repeatCount="indefinite"
                  ></animate>
                </stop>
              </linearGradient>
            </defs>
          </svg>
        </div>
      </li>
      `:t+=`
      <li class='exercises__skeleton-loader'>
        <div class='card'>
          <div class='cover-image-skeleton'></div>
        </div>
      </li>
      `;return t}function Xo(n,e){n.innerHTML=e}const Us={add:function(n,e){return new Promise((t,r)=>{try{Yo.addData(n,e),t(!0)}catch{r(!1)}})},get:function(){return new Promise(async(n,e)=>{try{const t=await Yo.getData();n(Object.values(t))}catch{e([])}})},idIsFavorite:async function(n){try{return(await this.get()).some(t=>t._id===n)}catch{return!1}},getObjectById:async function(n){try{const t=(await this.get()).find(r=>r._id===n)||null;return t?{...t,isFavorite:!0}:null}catch{return null}},addAndGet:async function(n,e){return new Promise(async(t,r)=>{try{await Yo.addData(n,e),setTimeout(async()=>{const i=await Yo.getData();t(Object.values(i))},200)}catch{r([])}})},remove:async function(n){return new Promise((e,t)=>{try{Yo.removeData(n),e(!0)}catch{t(!1)}})}},Sn=document.querySelector(".js-cards");function U0(n,e){if(e>=768)return n!=3?(Xo(Sn,Jo(10,Sn)),10):(Xo(Sn,Jo(12,Sn)),12);if(e<768){if(n===1)return Xo(Sn,Jo(8,Sn)),8;if(n===2||n===1)return Xo(Sn,Jo(8,Sn)),8}return Xo(Sn,Jo(9,Sn)),9}function B0(n){const e={filter:"Body%20parts",bodypart:"",keyword:"",muscles:"",equipment:""};for(const t in n)if(n.hasOwnProperty(t)&&n[t]!==e[t])return!0;return!1}function c4(n,e,t,r,i){return B0(r)?(t.bodyPart=r.bodypart,t.searchQuery=r.keyword,t.muscles=r.muscles,t.equipment=r.equipment,i=_l(n,e,t).fetchFilteredExercises()):i=_l(n,e,t).fetchExercise(),i}function u4(n,e,t,r,i,s){return B0(r)&&(t.filter=r.filter),i=_l(n,e,t,s).fetchMuscles(),i}function _l(n,e,t,r){const i=U0(e,r);return t.pageCounter=n,t.limit=i,t}function HI(n){return n.then(e=>e).catch(e=>{throw console.error("Error in getData:",e),e})}function q0(n,e){const t=document.querySelector(".filters__list .active");if(t){const r=t.id.includes("-")?(t.id.charAt(0).toUpperCase()+t.id.slice(1)).replace("-","%20"):t.id.charAt(0).toUpperCase()+t.id.slice(1);if(r!=n.filter||n.filter===""){n.filter=r;for(const i in n)i!=="filter"&&(n[i]="");e.currentPage=1,e.endPoint=3}}}async function l4({currentPage:n,endPoint:e},t){let r;const i=U0(e,t),s=localStorage.getItem("favoriteData"),a=localStorage.getItem("isDataOld"),l=a?JSON.parse(a):[];if(console.log(l),l||l.length===1)try{const h=await Us.get();console.log("current data: ",h),r=jI(h,i),localStorage.setItem("favoriteData",JSON.stringify(h)),s&&localStorage.setItem("isDataOld",JSON.stringify(!1));const f=QI(n,r);return console.log("current page: ",s,a),{totalPages:r.totalPages,currentData:f}}catch(h){console.log("Favorite data error: ",h)}else{const h=s?JSON.parse(s):[],f=jI(h,i),p=QI(n,f);return console.log("current data from array: ",p),{totalPages:f.totalPages,currentData:p}}}function jI(n,e){const t=n.length;if(t<=e)return{totalPages:1,slicedData:n};if(t>e){const r=Math.ceil(t/e);let i=[];for(let s=0;s<r;s++){const a=s*e,l=(s+1)*e;i.push(n.slice(a,l))}return{totalPages:r,slicedData:i}}}function QI(n,{totalPages:e,slicedData:t}){return e===1?t:t[n-1]}const vh=document.querySelector(".exercise-cards__wrapper"),Ih=document.querySelector(".exercise-cards__parag-empty"),h4="It appears that you haven't added any exercises to your favorites yet. To get started, you can add exercises that you like to your favorites for easier access in the future.",d4="Sorry, but we don`t have anything for you with such filter. Please try another search";function f4(){vh.classList.add("workout-cards__wrapper")}function YI(){vh.classList.remove("workout-cards__wrapper")}function p4(){vh.classList.add("favorite-cards__wrapper")}function JI(){vh.classList.remove("favorite-cards__wrapper")}function g4(){Ih.classList.add("visually-hidden")}function m4(){Ih.classList.remove("visually-hidden")}function _4(){Ih.innerHTML=h4}function y4(){Ih.innerHTML=d4}const lp=document.querySelector(".js-pages");function mf(n,e){const t=[];if(e>1){for(let i=n-3;i<=n+3;i++)if(i>0&&i<=e){const s=i===n?"exercise-cards__wrapper-page exercise-cards__current-page":"exercise-cards__wrapper-page js-pages";t.push(`
                    <div class="${s}">
                        <a class="exercise-cards__page js-page" data-page="${i}" href="">
                            ${i}
                        </a>
                    </div>
                `)}lp.innerHTML="";for(const i of t)lp.insertAdjacentHTML("beforeend",i)}}function ku(){lp.innerHTML=""}function v4(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-cards")?void 0:e.closest(".js-card").dataset.cardName}function I4(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-page")?e.closest(".js-page").dataset.page:void 0}function w4(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-cards")?void 0:e.closest(".js-workout-card").dataset.id}const E4=async function(n){const{_id:e}=n;try{if(await Us.idIsFavorite(e)){const r=await Us.remove(e);return console.log(`Object with _id ${e} removed from favorites.`),!1}else{const r=await Us.add(e,n);return console.log(`Object with _id ${e} added to favorites.`),r}}catch(t){return console.error(t),!1}},T4=n=>typeof n!="string"?n:n.split(" ").filter(e=>e).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),XI=n=>typeof n!="string"?n:n.charAt(0).toUpperCase()+n.slice(1),A4=n=>typeof n!="string"?n:n.replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase(),R4=n=>{const e=getComputedStyle(document.documentElement).getPropertyValue("--rating-color-inactive"),t=getComputedStyle(document.documentElement).getPropertyValue("--rating-color-active");return`
<!-- DEFINE SVGs -->
<svg height="0" width="0">
  <defs>
    <!-- DEFINE ONE STAR -->
    <symbol viewBox="0 0 32 32" id="iconstar">
      <path
        d="M13.826 3.262c.684-2.106 3.663-2.106 4.348 0l1.932 5.945a2.285 2.285 0 0 0 2.174 1.579h6.251c2.214 0 3.135 2.833 1.344 4.135l-5.057 3.674a2.286 2.286 0 0 0-.83 2.556l1.931 5.945c.684 2.106-1.726 3.857-3.517 2.555l-5.057-3.674a2.286 2.286 0 0 0-2.687 0l-5.057 3.674c-1.791 1.302-4.202-.45-3.517-2.555l1.932-5.945a2.287 2.287 0 0 0-.83-2.556l-5.057-3.674c-1.791-1.302-.871-4.135 1.344-4.135h6.251c.99 0 1.868-.638 2.174-1.579l1.932-5.945z" />
    </symbol>
    <!-- DEFINE PATTERN FOR EMPTY STARS -->
    <pattern id="stars-empty" patternUnits="userSpaceOnUse" width="24" height="24">
      <use x="0" y="0" xlink:href="#iconstar" fill="${e}" height="24" width="24"/>
    </pattern>
    <!-- DEFINE PATTERN FOR FULL STARS -->
    <pattern id="stars-full" patternUnits="userSpaceOnUse" width="24" height="24">
      <use x="0" y="0" xlink:href="#iconstar" fill="${t}" height="24" width="24"/>
    </pattern>
  </defs>
</svg>

<!-- INSERT STARS -->
<svg height="24" viewBox="0 0 120 24" width="120">
  <rect fill="url(#stars-empty)" x="0" y="0" height="24" width="120"/>
  <rect fill="url(#stars-full)" x="0" y="0" height="24" width="${n}%"/>
</svg>
`},S4="/project-fitness-07/",_n={exercise:{},ratingText:"Rating",iconStar:`${S4}images/icons-sprite.svg#icon-star`,ratingMax:5,closeKeyBoardBtn:"Escape",beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null},cm=document.querySelector("form.modal-form"),yl=document.querySelector(".rating-modal-window"),b4=document.querySelector(".rating-close");document.querySelector(".modal-email-validate");const P4=()=>{const n=[];for(let e=0;e<_n.ratingMax;e++){let t=_n.ratingMax-e;n.push(`
        <input type="radio" class="visually-hidden" id="star${t}" name="rating" value="${t}">
        <label class="rating-star" for="star${t}">
            <svg class="rating-star-icon">
                <use href=${_n.iconStar} />
            </svg>
        </label>
        `)}return`
    <div class="rating-wrapper">
        <p class="rating-text">${_n.ratingText}</p>
        <div class="rating-stars">
            ${n.join("")}
            <p class="rating-count">0.0</p>
        </div>
    </div>
    `},$0=n=>{n.key===_n.closeKeyBoardBtn&&wh()},W0=n=>{um.forEach(e=>{delete e.dataset.dataChecked}),n.target.dataset.dataChecked="checked",lm.innerHTML=n.target.value},C4=()=>{lm.innerHTML="0.0"};cm.insertAdjacentHTML("afterbegin",P4());const um=document.querySelectorAll(".rating-stars input"),lm=document.querySelector(".rating-count"),wh=()=>{_n.afterClose&&_n.afterClose(_n.exercise),um.forEach(n=>{n.removeEventListener("change",W0)}),yl.classList.remove("open"),document.body.style.overflow="visible",document.removeEventListener("keydown",$0),_n.afterClose&&_n.afterClose(),lm.innerHTML="0.0",cm.reset()},D4=()=>{yl.classList.add("open"),document.body.style.overflow="hidden",document.addEventListener("keydown",$0),um.forEach(n=>{n.addEventListener("change",W0)})};b4.addEventListener("click",wh);cm.addEventListener("reset",C4);yl.addEventListener("click",n=>{n.target===yl&&wh()});const hp={modalConfig:_n,openRatingModal:D4,closeRatingModal:wh},hm=document.querySelector(".header__auth_btn"),vl=document.querySelector(".authModal__backdrop"),G0=document.querySelector(".authModal__button-close"),Eh=document.querySelector(".authForm"),ZI=document.querySelector(".action__text"),ca=document.querySelector(".action__button"),ew=document.querySelector(".authForm__fieldset.username"),tw=document.querySelector(".authForm__title"),nw=document.querySelectorAll(".header__nav-authorized"),rw=document.querySelectorAll(".header__nav__item.auth"),Il=document.querySelectorAll(".header__logout_btn");let Gu=!0;const Rc=()=>{vl.classList.remove("open"),G0.removeEventListener("click",Rc),hm.addEventListener("click",Th),document.body.style.overflow="visible"},Th=()=>{vl.classList.add("open"),G0.addEventListener("click",Rc),hm.removeEventListener("click",Th),document.body.style.overflow="hidden"},dp=()=>{Eh.reset()},k4=async n=>{n.preventDefault();const e=[...Eh.elements].reduce((t,r)=>(r.name&&(t[r.name]=r.value),t),{});Gu&&await n4(e),await r4(e),dp(),Rc()},x4=()=>{Gu?(ca.textContent="Registration",ew.classList.add("hidden"),ca.setAttribute("data-action","log_in"),tw.textContent="Log in",ZI.textContent="Don't have an account?",dp(),Gu=!1):(ca.textContent="Log in",ca.setAttribute("data-action","reg"),ew.classList.remove("hidden"),tw.textContent="Registration",ZI.textContent="Already have an account?",dp(),Gu=!0),Eh.elements.name.toggleAttribute("required")},N4=async()=>{await Gi.auth().onAuthStateChanged(n=>{n?(rw.forEach(e=>{e.classList.add("hidden")}),Il.forEach(e=>{e.classList.add("visible")}),nw.forEach(e=>{e.classList.add("visible")})):(rw.forEach(e=>{e.classList.remove("hidden")}),Il.forEach(e=>{e.classList.remove("visible")}),nw.forEach(e=>{e.classList.remove("visible")}))})},V4=async()=>{await i4(),Il.forEach(n=>{n.classList.add("hidden")}),window.location.pathname="/project-fitness-07/"};hm.addEventListener("click",Th);Eh.addEventListener("submit",k4);ca.addEventListener("click",x4);Il.forEach(n=>{n.addEventListener("click",V4)});document.addEventListener("keydown",n=>{n.key==="Escape"&&Rc()});vl.addEventListener("click",n=>{n.target===vl&&Rc()});N4();const wl=document.querySelector(".js-backdrop"),Zi=document.querySelector(".modalExercise"),z0=Zi.querySelector(".x-button"),iw=Zi.querySelector(".modalExercise__img-wrapper"),Zo=Zi.querySelector(".exercise-content"),Ts=Zi.querySelector(".button-box"),O4="/project-fitness-07/",L4=5;let M4,Ah={};const F4=n=>{const{gifUrl:e,name:t,rating:r,_id:i,isFavorite:s,description:a}=n,l=B4(n);Ah=n,Zi.setAttribute("data-id",i),iw.innerHTML="",iw.insertAdjacentHTML("afterbegin",W4(e,t)),Zo.innerHTML="",Zo.insertAdjacentHTML("beforeend",q4(t)),Zo.insertAdjacentHTML("beforeend",$4(r)),Zo.insertAdjacentHTML("beforeend",G4(l)),Zo.insertAdjacentHTML("beforeend",z4(a)),H0(s),hp.modalConfig.afterClose=U4,document.querySelector(".js-give-rating").addEventListener("click",K0)},K0=n=>{_o(),hp.modalConfig.exercise=Ah,hp.openRatingModal()},U4=()=>{document.querySelector(".js-give-rating").removeEventListener("click",K0),j0(Ah)},B4=n=>({bodyPart:n.bodyPart,equipment:n.equipment,rating:n.rating,burnedCalories:n.burnedCalories,time:n.time,popular:n.popularity}),H0=(n=!1)=>{Ts.innerHTML="",n?Ts.insertAdjacentHTML("beforeend",H4()):Ts.insertAdjacentHTML("beforeend",K4()),Ts.insertAdjacentHTML("beforeend",j4());const e=Ts.querySelector(".js-toggle-favorite");Ts.querySelector(".js-give-rating"),e.addEventListener("click",Q0)},q4=n=>`
    <h3 class="title">${T4(n)}</h3>
  `,$4=n=>{const e=[],t=Math.round(n*10)/10;e.push(`<li class="rating__item value">${t}</li>`);const r=Math.round(n/L4*100);return e.push(`<li ${R4(r)}</li>`),`<ul class="rating">${e.join("")}</ul>`},W4=(n,e)=>`
    <img src="${n}" alt="${e}"/>
  `,G4=({burnedCalories:n,time:e,...t})=>{const r=[];for(const[i,s]of Object.entries(t)){const a=A4(i),l=XI(a),h=XI(s);r.push(`
      <li class="exercise_details-item">
        <p class="detail-name">${l}</p>
        <p class="detail-value">${h}</p>
      </li>
    `)}return r.push(`
      <li class="exercise_details-item">
        <p class="detail-name">Burned Calories</p>
        <p class="detail-value">${n}/${e} min</p>
      </li>
  `),`<ul class="exercise_details">${r.join("")}</ul>`},z4=n=>`
    <p class="exercise_description">${n}</p>
  `,K4=()=>dm({text:"Add to favorites",iconId:"icon-heart",className:"js-toggle-favorite"}),H4=()=>dm({text:"Remove from favorites",iconId:"icon-trash",className:"js-toggle-favorite"}),j4=()=>dm({text:"Give a rating",className:"js-give-rating ghost"}),dm=({text:n,iconId:e,className:t=""})=>{let r;return e&&(r=`
      <svg class="btn-icon">
        <use href=${O4}images/icons-sprite.svg#${e} />
      </svg>
    `),`
    <button id="js-toggle-favorite" type="button" class="button ${t}">
      <span>${n}</span>
      ${e?r:""}
    </button>
  `},_o=()=>{wl.classList.remove("open"),Zi.classList.remove("open"),z0.removeEventListener("click",_o),document.body.style.overflow="visible";const n="js-toggle-favorite";try{document.getElementById(n).removeEventListener("click",M4)}catch{console.error(`${n} not found!`)}},j0=async n=>{const{_id:e}=n;n.isFavorite=await Us.idIsFavorite(e),F4(n),wl.classList.add("open"),Zi.classList.add("open"),z0.addEventListener("click",_o),document.body.style.overflow="hidden"},Q0=async n=>{Gi.auth().currentUser||(_o(),Th());const{target:t}=n;try{const r=await E4(Ah);t.removeEventListener("click",Q0),H0(r)}catch(r){console.error(r)}};document.addEventListener("keydown",n=>{n.key==="Escape"&&_o()});wl.addEventListener("click",n=>{n.target===wl&&_o()});const xu=document.querySelector(".exercise-cards__wrapper");function Q4(n,e){e>=375&&e<768&&n!=3?xu.style.height="1268px":e>1440&&n===1?xu.style.height="487px":e>768&&n!=3?xu.style.height="833px":xu.style.height=""}var ea=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xa={},Y4={get exports(){return Xa},set exports(n){Xa=n}};(function(n,e){(function(){var t,r="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",l="Invalid `variable` option passed into `_.template`",h="__lodash_hash_undefined__",f=500,p="__lodash_placeholder__",m=1,I=2,A=4,L=1,M=2,V=1,Y=2,ae=4,j=8,ye=16,de=32,me=64,we=128,Nt=256,Kn=512,es=30,eR="...",tR=800,nR=16,fm=1,rR=2,iR=3,si=1/0,_r=9007199254740991,sR=17976931348623157e292,Sc=0/0,En=4294967295,oR=En-1,aR=En>>>1,cR=[["ary",we],["bind",V],["bindKey",Y],["curry",j],["curryRight",ye],["flip",Kn],["partial",de],["partialRight",me],["rearg",Nt]],ts="[object Arguments]",bc="[object Array]",uR="[object AsyncFunction]",yo="[object Boolean]",vo="[object Date]",lR="[object DOMException]",Pc="[object Error]",Cc="[object Function]",pm="[object GeneratorFunction]",hn="[object Map]",Io="[object Number]",hR="[object Null]",Hn="[object Object]",gm="[object Promise]",dR="[object Proxy]",wo="[object RegExp]",dn="[object Set]",Eo="[object String]",Dc="[object Symbol]",fR="[object Undefined]",To="[object WeakMap]",pR="[object WeakSet]",Ao="[object ArrayBuffer]",ns="[object DataView]",Rh="[object Float32Array]",Sh="[object Float64Array]",bh="[object Int8Array]",Ph="[object Int16Array]",Ch="[object Int32Array]",Dh="[object Uint8Array]",kh="[object Uint8ClampedArray]",xh="[object Uint16Array]",Nh="[object Uint32Array]",gR=/\b__p \+= '';/g,mR=/\b(__p \+=) '' \+/g,_R=/(__e\(.*?\)|\b__t\)) \+\n'';/g,mm=/&(?:amp|lt|gt|quot|#39);/g,_m=/[&<>"']/g,yR=RegExp(mm.source),vR=RegExp(_m.source),IR=/<%-([\s\S]+?)%>/g,wR=/<%([\s\S]+?)%>/g,ym=/<%=([\s\S]+?)%>/g,ER=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,TR=/^\w*$/,AR=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Vh=/[\\^$.*+?()[\]{}|]/g,RR=RegExp(Vh.source),Oh=/^\s+/,SR=/\s/,bR=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,PR=/\{\n\/\* \[wrapped with (.+)\] \*/,CR=/,? & /,DR=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,kR=/[()=,{}\[\]\/\s]/,xR=/\\(\\)?/g,NR=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vm=/\w*$/,VR=/^[-+]0x[0-9a-f]+$/i,OR=/^0b[01]+$/i,LR=/^\[object .+?Constructor\]$/,MR=/^0o[0-7]+$/i,FR=/^(?:0|[1-9]\d*)$/,UR=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,kc=/($^)/,BR=/['\n\r\u2028\u2029\\]/g,xc="\\ud800-\\udfff",qR="\\u0300-\\u036f",$R="\\ufe20-\\ufe2f",WR="\\u20d0-\\u20ff",Im=qR+$R+WR,wm="\\u2700-\\u27bf",Em="a-z\\xdf-\\xf6\\xf8-\\xff",GR="\\xac\\xb1\\xd7\\xf7",zR="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",KR="\\u2000-\\u206f",HR=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Tm="A-Z\\xc0-\\xd6\\xd8-\\xde",Am="\\ufe0e\\ufe0f",Rm=GR+zR+KR+HR,Lh="['’]",jR="["+xc+"]",Sm="["+Rm+"]",Nc="["+Im+"]",bm="\\d+",QR="["+wm+"]",Pm="["+Em+"]",Cm="[^"+xc+Rm+bm+wm+Em+Tm+"]",Mh="\\ud83c[\\udffb-\\udfff]",YR="(?:"+Nc+"|"+Mh+")",Dm="[^"+xc+"]",Fh="(?:\\ud83c[\\udde6-\\uddff]){2}",Uh="[\\ud800-\\udbff][\\udc00-\\udfff]",rs="["+Tm+"]",km="\\u200d",xm="(?:"+Pm+"|"+Cm+")",JR="(?:"+rs+"|"+Cm+")",Nm="(?:"+Lh+"(?:d|ll|m|re|s|t|ve))?",Vm="(?:"+Lh+"(?:D|LL|M|RE|S|T|VE))?",Om=YR+"?",Lm="["+Am+"]?",XR="(?:"+km+"(?:"+[Dm,Fh,Uh].join("|")+")"+Lm+Om+")*",ZR="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",eS="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Mm=Lm+Om+XR,tS="(?:"+[QR,Fh,Uh].join("|")+")"+Mm,nS="(?:"+[Dm+Nc+"?",Nc,Fh,Uh,jR].join("|")+")",rS=RegExp(Lh,"g"),iS=RegExp(Nc,"g"),Bh=RegExp(Mh+"(?="+Mh+")|"+nS+Mm,"g"),sS=RegExp([rs+"?"+Pm+"+"+Nm+"(?="+[Sm,rs,"$"].join("|")+")",JR+"+"+Vm+"(?="+[Sm,rs+xm,"$"].join("|")+")",rs+"?"+xm+"+"+Nm,rs+"+"+Vm,eS,ZR,bm,tS].join("|"),"g"),oS=RegExp("["+km+xc+Im+Am+"]"),aS=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,cS=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],uS=-1,Ce={};Ce[Rh]=Ce[Sh]=Ce[bh]=Ce[Ph]=Ce[Ch]=Ce[Dh]=Ce[kh]=Ce[xh]=Ce[Nh]=!0,Ce[ts]=Ce[bc]=Ce[Ao]=Ce[yo]=Ce[ns]=Ce[vo]=Ce[Pc]=Ce[Cc]=Ce[hn]=Ce[Io]=Ce[Hn]=Ce[wo]=Ce[dn]=Ce[Eo]=Ce[To]=!1;var be={};be[ts]=be[bc]=be[Ao]=be[ns]=be[yo]=be[vo]=be[Rh]=be[Sh]=be[bh]=be[Ph]=be[Ch]=be[hn]=be[Io]=be[Hn]=be[wo]=be[dn]=be[Eo]=be[Dc]=be[Dh]=be[kh]=be[xh]=be[Nh]=!0,be[Pc]=be[Cc]=be[To]=!1;var lS={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},hS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},dS={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},fS={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},pS=parseFloat,gS=parseInt,Fm=typeof ea=="object"&&ea&&ea.Object===Object&&ea,mS=typeof self=="object"&&self&&self.Object===Object&&self,lt=Fm||mS||Function("return this")(),qh=e&&!e.nodeType&&e,oi=qh&&!0&&n&&!n.nodeType&&n,Um=oi&&oi.exports===qh,$h=Um&&Fm.process,Zt=function(){try{var E=oi&&oi.require&&oi.require("util").types;return E||$h&&$h.binding&&$h.binding("util")}catch{}}(),Bm=Zt&&Zt.isArrayBuffer,qm=Zt&&Zt.isDate,$m=Zt&&Zt.isMap,Wm=Zt&&Zt.isRegExp,Gm=Zt&&Zt.isSet,zm=Zt&&Zt.isTypedArray;function Wt(E,P,S){switch(S.length){case 0:return E.call(P);case 1:return E.call(P,S[0]);case 2:return E.call(P,S[0],S[1]);case 3:return E.call(P,S[0],S[1],S[2])}return E.apply(P,S)}function _S(E,P,S,W){for(var ee=-1,ve=E==null?0:E.length;++ee<ve;){var Ze=E[ee];P(W,Ze,S(Ze),E)}return W}function en(E,P){for(var S=-1,W=E==null?0:E.length;++S<W&&P(E[S],S,E)!==!1;);return E}function yS(E,P){for(var S=E==null?0:E.length;S--&&P(E[S],S,E)!==!1;);return E}function Km(E,P){for(var S=-1,W=E==null?0:E.length;++S<W;)if(!P(E[S],S,E))return!1;return!0}function yr(E,P){for(var S=-1,W=E==null?0:E.length,ee=0,ve=[];++S<W;){var Ze=E[S];P(Ze,S,E)&&(ve[ee++]=Ze)}return ve}function Vc(E,P){var S=E==null?0:E.length;return!!S&&is(E,P,0)>-1}function Wh(E,P,S){for(var W=-1,ee=E==null?0:E.length;++W<ee;)if(S(P,E[W]))return!0;return!1}function Ne(E,P){for(var S=-1,W=E==null?0:E.length,ee=Array(W);++S<W;)ee[S]=P(E[S],S,E);return ee}function vr(E,P){for(var S=-1,W=P.length,ee=E.length;++S<W;)E[ee+S]=P[S];return E}function Gh(E,P,S,W){var ee=-1,ve=E==null?0:E.length;for(W&&ve&&(S=E[++ee]);++ee<ve;)S=P(S,E[ee],ee,E);return S}function vS(E,P,S,W){var ee=E==null?0:E.length;for(W&&ee&&(S=E[--ee]);ee--;)S=P(S,E[ee],ee,E);return S}function zh(E,P){for(var S=-1,W=E==null?0:E.length;++S<W;)if(P(E[S],S,E))return!0;return!1}var IS=Kh("length");function wS(E){return E.split("")}function ES(E){return E.match(DR)||[]}function Hm(E,P,S){var W;return S(E,function(ee,ve,Ze){if(P(ee,ve,Ze))return W=ve,!1}),W}function Oc(E,P,S,W){for(var ee=E.length,ve=S+(W?1:-1);W?ve--:++ve<ee;)if(P(E[ve],ve,E))return ve;return-1}function is(E,P,S){return P===P?VS(E,P,S):Oc(E,jm,S)}function TS(E,P,S,W){for(var ee=S-1,ve=E.length;++ee<ve;)if(W(E[ee],P))return ee;return-1}function jm(E){return E!==E}function Qm(E,P){var S=E==null?0:E.length;return S?jh(E,P)/S:Sc}function Kh(E){return function(P){return P==null?t:P[E]}}function Hh(E){return function(P){return E==null?t:E[P]}}function Ym(E,P,S,W,ee){return ee(E,function(ve,Ze,Se){S=W?(W=!1,ve):P(S,ve,Ze,Se)}),S}function AS(E,P){var S=E.length;for(E.sort(P);S--;)E[S]=E[S].value;return E}function jh(E,P){for(var S,W=-1,ee=E.length;++W<ee;){var ve=P(E[W]);ve!==t&&(S=S===t?ve:S+ve)}return S}function Qh(E,P){for(var S=-1,W=Array(E);++S<E;)W[S]=P(S);return W}function RS(E,P){return Ne(P,function(S){return[S,E[S]]})}function Jm(E){return E&&E.slice(0,t_(E)+1).replace(Oh,"")}function Gt(E){return function(P){return E(P)}}function Yh(E,P){return Ne(P,function(S){return E[S]})}function Ro(E,P){return E.has(P)}function Xm(E,P){for(var S=-1,W=E.length;++S<W&&is(P,E[S],0)>-1;);return S}function Zm(E,P){for(var S=E.length;S--&&is(P,E[S],0)>-1;);return S}function SS(E,P){for(var S=E.length,W=0;S--;)E[S]===P&&++W;return W}var bS=Hh(lS),PS=Hh(hS);function CS(E){return"\\"+fS[E]}function DS(E,P){return E==null?t:E[P]}function ss(E){return oS.test(E)}function kS(E){return aS.test(E)}function xS(E){for(var P,S=[];!(P=E.next()).done;)S.push(P.value);return S}function Jh(E){var P=-1,S=Array(E.size);return E.forEach(function(W,ee){S[++P]=[ee,W]}),S}function e_(E,P){return function(S){return E(P(S))}}function Ir(E,P){for(var S=-1,W=E.length,ee=0,ve=[];++S<W;){var Ze=E[S];(Ze===P||Ze===p)&&(E[S]=p,ve[ee++]=S)}return ve}function Lc(E){var P=-1,S=Array(E.size);return E.forEach(function(W){S[++P]=W}),S}function NS(E){var P=-1,S=Array(E.size);return E.forEach(function(W){S[++P]=[W,W]}),S}function VS(E,P,S){for(var W=S-1,ee=E.length;++W<ee;)if(E[W]===P)return W;return-1}function OS(E,P,S){for(var W=S+1;W--;)if(E[W]===P)return W;return W}function os(E){return ss(E)?MS(E):IS(E)}function fn(E){return ss(E)?FS(E):wS(E)}function t_(E){for(var P=E.length;P--&&SR.test(E.charAt(P)););return P}var LS=Hh(dS);function MS(E){for(var P=Bh.lastIndex=0;Bh.test(E);)++P;return P}function FS(E){return E.match(Bh)||[]}function US(E){return E.match(sS)||[]}var BS=function E(P){P=P==null?lt:as.defaults(lt.Object(),P,as.pick(lt,cS));var S=P.Array,W=P.Date,ee=P.Error,ve=P.Function,Ze=P.Math,Se=P.Object,Xh=P.RegExp,qS=P.String,tn=P.TypeError,Mc=S.prototype,$S=ve.prototype,cs=Se.prototype,Fc=P["__core-js_shared__"],Uc=$S.toString,Ee=cs.hasOwnProperty,WS=0,n_=function(){var o=/[^.]+$/.exec(Fc&&Fc.keys&&Fc.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Bc=cs.toString,GS=Uc.call(Se),zS=lt._,KS=Xh("^"+Uc.call(Ee).replace(Vh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qc=Um?P.Buffer:t,wr=P.Symbol,$c=P.Uint8Array,r_=qc?qc.allocUnsafe:t,Wc=e_(Se.getPrototypeOf,Se),i_=Se.create,s_=cs.propertyIsEnumerable,Gc=Mc.splice,o_=wr?wr.isConcatSpreadable:t,So=wr?wr.iterator:t,ai=wr?wr.toStringTag:t,zc=function(){try{var o=di(Se,"defineProperty");return o({},"",{}),o}catch{}}(),HS=P.clearTimeout!==lt.clearTimeout&&P.clearTimeout,jS=W&&W.now!==lt.Date.now&&W.now,QS=P.setTimeout!==lt.setTimeout&&P.setTimeout,Kc=Ze.ceil,Hc=Ze.floor,Zh=Se.getOwnPropertySymbols,YS=qc?qc.isBuffer:t,a_=P.isFinite,JS=Mc.join,XS=e_(Se.keys,Se),et=Ze.max,yt=Ze.min,ZS=W.now,eb=P.parseInt,c_=Ze.random,tb=Mc.reverse,ed=di(P,"DataView"),bo=di(P,"Map"),td=di(P,"Promise"),us=di(P,"Set"),Po=di(P,"WeakMap"),Co=di(Se,"create"),jc=Po&&new Po,ls={},nb=fi(ed),rb=fi(bo),ib=fi(td),sb=fi(us),ob=fi(Po),Qc=wr?wr.prototype:t,Do=Qc?Qc.valueOf:t,u_=Qc?Qc.toString:t;function _(o){if(Be(o)&&!te(o)&&!(o instanceof le)){if(o instanceof nn)return o;if(Ee.call(o,"__wrapped__"))return ly(o)}return new nn(o)}var hs=function(){function o(){}return function(c){if(!Fe(c))return{};if(i_)return i_(c);o.prototype=c;var u=new o;return o.prototype=t,u}}();function Yc(){}function nn(o,c){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!c,this.__index__=0,this.__values__=t}_.templateSettings={escape:IR,evaluate:wR,interpolate:ym,variable:"",imports:{_}},_.prototype=Yc.prototype,_.prototype.constructor=_,nn.prototype=hs(Yc.prototype),nn.prototype.constructor=nn;function le(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=En,this.__views__=[]}function ab(){var o=new le(this.__wrapped__);return o.__actions__=Vt(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=Vt(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=Vt(this.__views__),o}function cb(){if(this.__filtered__){var o=new le(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function ub(){var o=this.__wrapped__.value(),c=this.__dir__,u=te(o),d=c<0,g=u?o.length:0,y=wP(0,g,this.__views__),v=y.start,w=y.end,T=w-v,C=d?w:v-1,D=this.__iteratees__,x=D.length,U=0,G=yt(T,this.__takeCount__);if(!u||!d&&g==T&&G==T)return N_(o,this.__actions__);var J=[];e:for(;T--&&U<G;){C+=c;for(var se=-1,X=o[C];++se<x;){var ce=D[se],fe=ce.iteratee,Ht=ce.type,St=fe(X);if(Ht==rR)X=St;else if(!St){if(Ht==fm)continue e;break e}}J[U++]=X}return J}le.prototype=hs(Yc.prototype),le.prototype.constructor=le;function ci(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var d=o[c];this.set(d[0],d[1])}}function lb(){this.__data__=Co?Co(null):{},this.size=0}function hb(o){var c=this.has(o)&&delete this.__data__[o];return this.size-=c?1:0,c}function db(o){var c=this.__data__;if(Co){var u=c[o];return u===h?t:u}return Ee.call(c,o)?c[o]:t}function fb(o){var c=this.__data__;return Co?c[o]!==t:Ee.call(c,o)}function pb(o,c){var u=this.__data__;return this.size+=this.has(o)?0:1,u[o]=Co&&c===t?h:c,this}ci.prototype.clear=lb,ci.prototype.delete=hb,ci.prototype.get=db,ci.prototype.has=fb,ci.prototype.set=pb;function jn(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var d=o[c];this.set(d[0],d[1])}}function gb(){this.__data__=[],this.size=0}function mb(o){var c=this.__data__,u=Jc(c,o);if(u<0)return!1;var d=c.length-1;return u==d?c.pop():Gc.call(c,u,1),--this.size,!0}function _b(o){var c=this.__data__,u=Jc(c,o);return u<0?t:c[u][1]}function yb(o){return Jc(this.__data__,o)>-1}function vb(o,c){var u=this.__data__,d=Jc(u,o);return d<0?(++this.size,u.push([o,c])):u[d][1]=c,this}jn.prototype.clear=gb,jn.prototype.delete=mb,jn.prototype.get=_b,jn.prototype.has=yb,jn.prototype.set=vb;function Qn(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var d=o[c];this.set(d[0],d[1])}}function Ib(){this.size=0,this.__data__={hash:new ci,map:new(bo||jn),string:new ci}}function wb(o){var c=uu(this,o).delete(o);return this.size-=c?1:0,c}function Eb(o){return uu(this,o).get(o)}function Tb(o){return uu(this,o).has(o)}function Ab(o,c){var u=uu(this,o),d=u.size;return u.set(o,c),this.size+=u.size==d?0:1,this}Qn.prototype.clear=Ib,Qn.prototype.delete=wb,Qn.prototype.get=Eb,Qn.prototype.has=Tb,Qn.prototype.set=Ab;function ui(o){var c=-1,u=o==null?0:o.length;for(this.__data__=new Qn;++c<u;)this.add(o[c])}function Rb(o){return this.__data__.set(o,h),this}function Sb(o){return this.__data__.has(o)}ui.prototype.add=ui.prototype.push=Rb,ui.prototype.has=Sb;function pn(o){var c=this.__data__=new jn(o);this.size=c.size}function bb(){this.__data__=new jn,this.size=0}function Pb(o){var c=this.__data__,u=c.delete(o);return this.size=c.size,u}function Cb(o){return this.__data__.get(o)}function Db(o){return this.__data__.has(o)}function kb(o,c){var u=this.__data__;if(u instanceof jn){var d=u.__data__;if(!bo||d.length<i-1)return d.push([o,c]),this.size=++u.size,this;u=this.__data__=new Qn(d)}return u.set(o,c),this.size=u.size,this}pn.prototype.clear=bb,pn.prototype.delete=Pb,pn.prototype.get=Cb,pn.prototype.has=Db,pn.prototype.set=kb;function l_(o,c){var u=te(o),d=!u&&pi(o),g=!u&&!d&&Sr(o),y=!u&&!d&&!g&&gs(o),v=u||d||g||y,w=v?Qh(o.length,qS):[],T=w.length;for(var C in o)(c||Ee.call(o,C))&&!(v&&(C=="length"||g&&(C=="offset"||C=="parent")||y&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||Zn(C,T)))&&w.push(C);return w}function h_(o){var c=o.length;return c?o[dd(0,c-1)]:t}function xb(o,c){return lu(Vt(o),li(c,0,o.length))}function Nb(o){return lu(Vt(o))}function nd(o,c,u){(u!==t&&!gn(o[c],u)||u===t&&!(c in o))&&Yn(o,c,u)}function ko(o,c,u){var d=o[c];(!(Ee.call(o,c)&&gn(d,u))||u===t&&!(c in o))&&Yn(o,c,u)}function Jc(o,c){for(var u=o.length;u--;)if(gn(o[u][0],c))return u;return-1}function Vb(o,c,u,d){return Er(o,function(g,y,v){c(d,g,u(g),v)}),d}function d_(o,c){return o&&An(c,nt(c),o)}function Ob(o,c){return o&&An(c,Lt(c),o)}function Yn(o,c,u){c=="__proto__"&&zc?zc(o,c,{configurable:!0,enumerable:!0,value:u,writable:!0}):o[c]=u}function rd(o,c){for(var u=-1,d=c.length,g=S(d),y=o==null;++u<d;)g[u]=y?t:Md(o,c[u]);return g}function li(o,c,u){return o===o&&(u!==t&&(o=o<=u?o:u),c!==t&&(o=o>=c?o:c)),o}function rn(o,c,u,d,g,y){var v,w=c&m,T=c&I,C=c&A;if(u&&(v=g?u(o,d,g,y):u(o)),v!==t)return v;if(!Fe(o))return o;var D=te(o);if(D){if(v=TP(o),!w)return Vt(o,v)}else{var x=vt(o),U=x==Cc||x==pm;if(Sr(o))return L_(o,w);if(x==Hn||x==ts||U&&!g){if(v=T||U?{}:ty(o),!w)return T?dP(o,Ob(v,o)):hP(o,d_(v,o))}else{if(!be[x])return g?o:{};v=AP(o,x,w)}}y||(y=new pn);var G=y.get(o);if(G)return G;y.set(o,v),Dy(o)?o.forEach(function(X){v.add(rn(X,c,u,X,o,y))}):Py(o)&&o.forEach(function(X,ce){v.set(ce,rn(X,c,u,ce,o,y))});var J=C?T?Td:Ed:T?Lt:nt,se=D?t:J(o);return en(se||o,function(X,ce){se&&(ce=X,X=o[ce]),ko(v,ce,rn(X,c,u,ce,o,y))}),v}function Lb(o){var c=nt(o);return function(u){return f_(u,o,c)}}function f_(o,c,u){var d=u.length;if(o==null)return!d;for(o=Se(o);d--;){var g=u[d],y=c[g],v=o[g];if(v===t&&!(g in o)||!y(v))return!1}return!0}function p_(o,c,u){if(typeof o!="function")throw new tn(a);return Fo(function(){o.apply(t,u)},c)}function xo(o,c,u,d){var g=-1,y=Vc,v=!0,w=o.length,T=[],C=c.length;if(!w)return T;u&&(c=Ne(c,Gt(u))),d?(y=Wh,v=!1):c.length>=i&&(y=Ro,v=!1,c=new ui(c));e:for(;++g<w;){var D=o[g],x=u==null?D:u(D);if(D=d||D!==0?D:0,v&&x===x){for(var U=C;U--;)if(c[U]===x)continue e;T.push(D)}else y(c,x,d)||T.push(D)}return T}var Er=q_(Tn),g_=q_(sd,!0);function Mb(o,c){var u=!0;return Er(o,function(d,g,y){return u=!!c(d,g,y),u}),u}function Xc(o,c,u){for(var d=-1,g=o.length;++d<g;){var y=o[d],v=c(y);if(v!=null&&(w===t?v===v&&!Kt(v):u(v,w)))var w=v,T=y}return T}function Fb(o,c,u,d){var g=o.length;for(u=ie(u),u<0&&(u=-u>g?0:g+u),d=d===t||d>g?g:ie(d),d<0&&(d+=g),d=u>d?0:xy(d);u<d;)o[u++]=c;return o}function m_(o,c){var u=[];return Er(o,function(d,g,y){c(d,g,y)&&u.push(d)}),u}function ht(o,c,u,d,g){var y=-1,v=o.length;for(u||(u=SP),g||(g=[]);++y<v;){var w=o[y];c>0&&u(w)?c>1?ht(w,c-1,u,d,g):vr(g,w):d||(g[g.length]=w)}return g}var id=$_(),__=$_(!0);function Tn(o,c){return o&&id(o,c,nt)}function sd(o,c){return o&&__(o,c,nt)}function Zc(o,c){return yr(c,function(u){return er(o[u])})}function hi(o,c){c=Ar(c,o);for(var u=0,d=c.length;o!=null&&u<d;)o=o[Rn(c[u++])];return u&&u==d?o:t}function y_(o,c,u){var d=c(o);return te(o)?d:vr(d,u(o))}function At(o){return o==null?o===t?fR:hR:ai&&ai in Se(o)?IP(o):NP(o)}function od(o,c){return o>c}function Ub(o,c){return o!=null&&Ee.call(o,c)}function Bb(o,c){return o!=null&&c in Se(o)}function qb(o,c,u){return o>=yt(c,u)&&o<et(c,u)}function ad(o,c,u){for(var d=u?Wh:Vc,g=o[0].length,y=o.length,v=y,w=S(y),T=1/0,C=[];v--;){var D=o[v];v&&c&&(D=Ne(D,Gt(c))),T=yt(D.length,T),w[v]=!u&&(c||g>=120&&D.length>=120)?new ui(v&&D):t}D=o[0];var x=-1,U=w[0];e:for(;++x<g&&C.length<T;){var G=D[x],J=c?c(G):G;if(G=u||G!==0?G:0,!(U?Ro(U,J):d(C,J,u))){for(v=y;--v;){var se=w[v];if(!(se?Ro(se,J):d(o[v],J,u)))continue e}U&&U.push(J),C.push(G)}}return C}function $b(o,c,u,d){return Tn(o,function(g,y,v){c(d,u(g),y,v)}),d}function No(o,c,u){c=Ar(c,o),o=sy(o,c);var d=o==null?o:o[Rn(on(c))];return d==null?t:Wt(d,o,u)}function v_(o){return Be(o)&&At(o)==ts}function Wb(o){return Be(o)&&At(o)==Ao}function Gb(o){return Be(o)&&At(o)==vo}function Vo(o,c,u,d,g){return o===c?!0:o==null||c==null||!Be(o)&&!Be(c)?o!==o&&c!==c:zb(o,c,u,d,Vo,g)}function zb(o,c,u,d,g,y){var v=te(o),w=te(c),T=v?bc:vt(o),C=w?bc:vt(c);T=T==ts?Hn:T,C=C==ts?Hn:C;var D=T==Hn,x=C==Hn,U=T==C;if(U&&Sr(o)){if(!Sr(c))return!1;v=!0,D=!1}if(U&&!D)return y||(y=new pn),v||gs(o)?X_(o,c,u,d,g,y):yP(o,c,T,u,d,g,y);if(!(u&L)){var G=D&&Ee.call(o,"__wrapped__"),J=x&&Ee.call(c,"__wrapped__");if(G||J){var se=G?o.value():o,X=J?c.value():c;return y||(y=new pn),g(se,X,u,d,y)}}return U?(y||(y=new pn),vP(o,c,u,d,g,y)):!1}function Kb(o){return Be(o)&&vt(o)==hn}function cd(o,c,u,d){var g=u.length,y=g,v=!d;if(o==null)return!y;for(o=Se(o);g--;){var w=u[g];if(v&&w[2]?w[1]!==o[w[0]]:!(w[0]in o))return!1}for(;++g<y;){w=u[g];var T=w[0],C=o[T],D=w[1];if(v&&w[2]){if(C===t&&!(T in o))return!1}else{var x=new pn;if(d)var U=d(C,D,T,o,c,x);if(!(U===t?Vo(D,C,L|M,d,x):U))return!1}}return!0}function I_(o){if(!Fe(o)||PP(o))return!1;var c=er(o)?KS:LR;return c.test(fi(o))}function Hb(o){return Be(o)&&At(o)==wo}function jb(o){return Be(o)&&vt(o)==dn}function Qb(o){return Be(o)&&mu(o.length)&&!!Ce[At(o)]}function w_(o){return typeof o=="function"?o:o==null?Mt:typeof o=="object"?te(o)?A_(o[0],o[1]):T_(o):Wy(o)}function ud(o){if(!Mo(o))return XS(o);var c=[];for(var u in Se(o))Ee.call(o,u)&&u!="constructor"&&c.push(u);return c}function Yb(o){if(!Fe(o))return xP(o);var c=Mo(o),u=[];for(var d in o)d=="constructor"&&(c||!Ee.call(o,d))||u.push(d);return u}function ld(o,c){return o<c}function E_(o,c){var u=-1,d=Ot(o)?S(o.length):[];return Er(o,function(g,y,v){d[++u]=c(g,y,v)}),d}function T_(o){var c=Rd(o);return c.length==1&&c[0][2]?ry(c[0][0],c[0][1]):function(u){return u===o||cd(u,o,c)}}function A_(o,c){return bd(o)&&ny(c)?ry(Rn(o),c):function(u){var d=Md(u,o);return d===t&&d===c?Fd(u,o):Vo(c,d,L|M)}}function eu(o,c,u,d,g){o!==c&&id(c,function(y,v){if(g||(g=new pn),Fe(y))Jb(o,c,v,u,eu,d,g);else{var w=d?d(Cd(o,v),y,v+"",o,c,g):t;w===t&&(w=y),nd(o,v,w)}},Lt)}function Jb(o,c,u,d,g,y,v){var w=Cd(o,u),T=Cd(c,u),C=v.get(T);if(C){nd(o,u,C);return}var D=y?y(w,T,u+"",o,c,v):t,x=D===t;if(x){var U=te(T),G=!U&&Sr(T),J=!U&&!G&&gs(T);D=T,U||G||J?te(w)?D=w:He(w)?D=Vt(w):G?(x=!1,D=L_(T,!0)):J?(x=!1,D=M_(T,!0)):D=[]:Uo(T)||pi(T)?(D=w,pi(w)?D=Ny(w):(!Fe(w)||er(w))&&(D=ty(T))):x=!1}x&&(v.set(T,D),g(D,T,d,y,v),v.delete(T)),nd(o,u,D)}function R_(o,c){var u=o.length;if(u)return c+=c<0?u:0,Zn(c,u)?o[c]:t}function S_(o,c,u){c.length?c=Ne(c,function(y){return te(y)?function(v){return hi(v,y.length===1?y[0]:y)}:y}):c=[Mt];var d=-1;c=Ne(c,Gt(Q()));var g=E_(o,function(y,v,w){var T=Ne(c,function(C){return C(y)});return{criteria:T,index:++d,value:y}});return AS(g,function(y,v){return lP(y,v,u)})}function Xb(o,c){return b_(o,c,function(u,d){return Fd(o,d)})}function b_(o,c,u){for(var d=-1,g=c.length,y={};++d<g;){var v=c[d],w=hi(o,v);u(w,v)&&Oo(y,Ar(v,o),w)}return y}function Zb(o){return function(c){return hi(c,o)}}function hd(o,c,u,d){var g=d?TS:is,y=-1,v=c.length,w=o;for(o===c&&(c=Vt(c)),u&&(w=Ne(o,Gt(u)));++y<v;)for(var T=0,C=c[y],D=u?u(C):C;(T=g(w,D,T,d))>-1;)w!==o&&Gc.call(w,T,1),Gc.call(o,T,1);return o}function P_(o,c){for(var u=o?c.length:0,d=u-1;u--;){var g=c[u];if(u==d||g!==y){var y=g;Zn(g)?Gc.call(o,g,1):gd(o,g)}}return o}function dd(o,c){return o+Hc(c_()*(c-o+1))}function eP(o,c,u,d){for(var g=-1,y=et(Kc((c-o)/(u||1)),0),v=S(y);y--;)v[d?y:++g]=o,o+=u;return v}function fd(o,c){var u="";if(!o||c<1||c>_r)return u;do c%2&&(u+=o),c=Hc(c/2),c&&(o+=o);while(c);return u}function oe(o,c){return Dd(iy(o,c,Mt),o+"")}function tP(o){return h_(ms(o))}function nP(o,c){var u=ms(o);return lu(u,li(c,0,u.length))}function Oo(o,c,u,d){if(!Fe(o))return o;c=Ar(c,o);for(var g=-1,y=c.length,v=y-1,w=o;w!=null&&++g<y;){var T=Rn(c[g]),C=u;if(T==="__proto__"||T==="constructor"||T==="prototype")return o;if(g!=v){var D=w[T];C=d?d(D,T,w):t,C===t&&(C=Fe(D)?D:Zn(c[g+1])?[]:{})}ko(w,T,C),w=w[T]}return o}var C_=jc?function(o,c){return jc.set(o,c),o}:Mt,rP=zc?function(o,c){return zc(o,"toString",{configurable:!0,enumerable:!1,value:Bd(c),writable:!0})}:Mt;function iP(o){return lu(ms(o))}function sn(o,c,u){var d=-1,g=o.length;c<0&&(c=-c>g?0:g+c),u=u>g?g:u,u<0&&(u+=g),g=c>u?0:u-c>>>0,c>>>=0;for(var y=S(g);++d<g;)y[d]=o[d+c];return y}function sP(o,c){var u;return Er(o,function(d,g,y){return u=c(d,g,y),!u}),!!u}function tu(o,c,u){var d=0,g=o==null?d:o.length;if(typeof c=="number"&&c===c&&g<=aR){for(;d<g;){var y=d+g>>>1,v=o[y];v!==null&&!Kt(v)&&(u?v<=c:v<c)?d=y+1:g=y}return g}return pd(o,c,Mt,u)}function pd(o,c,u,d){var g=0,y=o==null?0:o.length;if(y===0)return 0;c=u(c);for(var v=c!==c,w=c===null,T=Kt(c),C=c===t;g<y;){var D=Hc((g+y)/2),x=u(o[D]),U=x!==t,G=x===null,J=x===x,se=Kt(x);if(v)var X=d||J;else C?X=J&&(d||U):w?X=J&&U&&(d||!G):T?X=J&&U&&!G&&(d||!se):G||se?X=!1:X=d?x<=c:x<c;X?g=D+1:y=D}return yt(y,oR)}function D_(o,c){for(var u=-1,d=o.length,g=0,y=[];++u<d;){var v=o[u],w=c?c(v):v;if(!u||!gn(w,T)){var T=w;y[g++]=v===0?0:v}}return y}function k_(o){return typeof o=="number"?o:Kt(o)?Sc:+o}function zt(o){if(typeof o=="string")return o;if(te(o))return Ne(o,zt)+"";if(Kt(o))return u_?u_.call(o):"";var c=o+"";return c=="0"&&1/o==-si?"-0":c}function Tr(o,c,u){var d=-1,g=Vc,y=o.length,v=!0,w=[],T=w;if(u)v=!1,g=Wh;else if(y>=i){var C=c?null:mP(o);if(C)return Lc(C);v=!1,g=Ro,T=new ui}else T=c?[]:w;e:for(;++d<y;){var D=o[d],x=c?c(D):D;if(D=u||D!==0?D:0,v&&x===x){for(var U=T.length;U--;)if(T[U]===x)continue e;c&&T.push(x),w.push(D)}else g(T,x,u)||(T!==w&&T.push(x),w.push(D))}return w}function gd(o,c){return c=Ar(c,o),o=sy(o,c),o==null||delete o[Rn(on(c))]}function x_(o,c,u,d){return Oo(o,c,u(hi(o,c)),d)}function nu(o,c,u,d){for(var g=o.length,y=d?g:-1;(d?y--:++y<g)&&c(o[y],y,o););return u?sn(o,d?0:y,d?y+1:g):sn(o,d?y+1:0,d?g:y)}function N_(o,c){var u=o;return u instanceof le&&(u=u.value()),Gh(c,function(d,g){return g.func.apply(g.thisArg,vr([d],g.args))},u)}function md(o,c,u){var d=o.length;if(d<2)return d?Tr(o[0]):[];for(var g=-1,y=S(d);++g<d;)for(var v=o[g],w=-1;++w<d;)w!=g&&(y[g]=xo(y[g]||v,o[w],c,u));return Tr(ht(y,1),c,u)}function V_(o,c,u){for(var d=-1,g=o.length,y=c.length,v={};++d<g;){var w=d<y?c[d]:t;u(v,o[d],w)}return v}function _d(o){return He(o)?o:[]}function yd(o){return typeof o=="function"?o:Mt}function Ar(o,c){return te(o)?o:bd(o,c)?[o]:uy(Ie(o))}var oP=oe;function Rr(o,c,u){var d=o.length;return u=u===t?d:u,!c&&u>=d?o:sn(o,c,u)}var O_=HS||function(o){return lt.clearTimeout(o)};function L_(o,c){if(c)return o.slice();var u=o.length,d=r_?r_(u):new o.constructor(u);return o.copy(d),d}function vd(o){var c=new o.constructor(o.byteLength);return new $c(c).set(new $c(o)),c}function aP(o,c){var u=c?vd(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.byteLength)}function cP(o){var c=new o.constructor(o.source,vm.exec(o));return c.lastIndex=o.lastIndex,c}function uP(o){return Do?Se(Do.call(o)):{}}function M_(o,c){var u=c?vd(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.length)}function F_(o,c){if(o!==c){var u=o!==t,d=o===null,g=o===o,y=Kt(o),v=c!==t,w=c===null,T=c===c,C=Kt(c);if(!w&&!C&&!y&&o>c||y&&v&&T&&!w&&!C||d&&v&&T||!u&&T||!g)return 1;if(!d&&!y&&!C&&o<c||C&&u&&g&&!d&&!y||w&&u&&g||!v&&g||!T)return-1}return 0}function lP(o,c,u){for(var d=-1,g=o.criteria,y=c.criteria,v=g.length,w=u.length;++d<v;){var T=F_(g[d],y[d]);if(T){if(d>=w)return T;var C=u[d];return T*(C=="desc"?-1:1)}}return o.index-c.index}function U_(o,c,u,d){for(var g=-1,y=o.length,v=u.length,w=-1,T=c.length,C=et(y-v,0),D=S(T+C),x=!d;++w<T;)D[w]=c[w];for(;++g<v;)(x||g<y)&&(D[u[g]]=o[g]);for(;C--;)D[w++]=o[g++];return D}function B_(o,c,u,d){for(var g=-1,y=o.length,v=-1,w=u.length,T=-1,C=c.length,D=et(y-w,0),x=S(D+C),U=!d;++g<D;)x[g]=o[g];for(var G=g;++T<C;)x[G+T]=c[T];for(;++v<w;)(U||g<y)&&(x[G+u[v]]=o[g++]);return x}function Vt(o,c){var u=-1,d=o.length;for(c||(c=S(d));++u<d;)c[u]=o[u];return c}function An(o,c,u,d){var g=!u;u||(u={});for(var y=-1,v=c.length;++y<v;){var w=c[y],T=d?d(u[w],o[w],w,u,o):t;T===t&&(T=o[w]),g?Yn(u,w,T):ko(u,w,T)}return u}function hP(o,c){return An(o,Sd(o),c)}function dP(o,c){return An(o,Z_(o),c)}function ru(o,c){return function(u,d){var g=te(u)?_S:Vb,y=c?c():{};return g(u,o,Q(d,2),y)}}function ds(o){return oe(function(c,u){var d=-1,g=u.length,y=g>1?u[g-1]:t,v=g>2?u[2]:t;for(y=o.length>3&&typeof y=="function"?(g--,y):t,v&&Rt(u[0],u[1],v)&&(y=g<3?t:y,g=1),c=Se(c);++d<g;){var w=u[d];w&&o(c,w,d,y)}return c})}function q_(o,c){return function(u,d){if(u==null)return u;if(!Ot(u))return o(u,d);for(var g=u.length,y=c?g:-1,v=Se(u);(c?y--:++y<g)&&d(v[y],y,v)!==!1;);return u}}function $_(o){return function(c,u,d){for(var g=-1,y=Se(c),v=d(c),w=v.length;w--;){var T=v[o?w:++g];if(u(y[T],T,y)===!1)break}return c}}function fP(o,c,u){var d=c&V,g=Lo(o);function y(){var v=this&&this!==lt&&this instanceof y?g:o;return v.apply(d?u:this,arguments)}return y}function W_(o){return function(c){c=Ie(c);var u=ss(c)?fn(c):t,d=u?u[0]:c.charAt(0),g=u?Rr(u,1).join(""):c.slice(1);return d[o]()+g}}function fs(o){return function(c){return Gh(qy(By(c).replace(rS,"")),o,"")}}function Lo(o){return function(){var c=arguments;switch(c.length){case 0:return new o;case 1:return new o(c[0]);case 2:return new o(c[0],c[1]);case 3:return new o(c[0],c[1],c[2]);case 4:return new o(c[0],c[1],c[2],c[3]);case 5:return new o(c[0],c[1],c[2],c[3],c[4]);case 6:return new o(c[0],c[1],c[2],c[3],c[4],c[5]);case 7:return new o(c[0],c[1],c[2],c[3],c[4],c[5],c[6])}var u=hs(o.prototype),d=o.apply(u,c);return Fe(d)?d:u}}function pP(o,c,u){var d=Lo(o);function g(){for(var y=arguments.length,v=S(y),w=y,T=ps(g);w--;)v[w]=arguments[w];var C=y<3&&v[0]!==T&&v[y-1]!==T?[]:Ir(v,T);if(y-=C.length,y<u)return j_(o,c,iu,g.placeholder,t,v,C,t,t,u-y);var D=this&&this!==lt&&this instanceof g?d:o;return Wt(D,this,v)}return g}function G_(o){return function(c,u,d){var g=Se(c);if(!Ot(c)){var y=Q(u,3);c=nt(c),u=function(w){return y(g[w],w,g)}}var v=o(c,u,d);return v>-1?g[y?c[v]:v]:t}}function z_(o){return Xn(function(c){var u=c.length,d=u,g=nn.prototype.thru;for(o&&c.reverse();d--;){var y=c[d];if(typeof y!="function")throw new tn(a);if(g&&!v&&cu(y)=="wrapper")var v=new nn([],!0)}for(d=v?d:u;++d<u;){y=c[d];var w=cu(y),T=w=="wrapper"?Ad(y):t;T&&Pd(T[0])&&T[1]==(we|j|de|Nt)&&!T[4].length&&T[9]==1?v=v[cu(T[0])].apply(v,T[3]):v=y.length==1&&Pd(y)?v[w]():v.thru(y)}return function(){var C=arguments,D=C[0];if(v&&C.length==1&&te(D))return v.plant(D).value();for(var x=0,U=u?c[x].apply(this,C):D;++x<u;)U=c[x].call(this,U);return U}})}function iu(o,c,u,d,g,y,v,w,T,C){var D=c&we,x=c&V,U=c&Y,G=c&(j|ye),J=c&Kn,se=U?t:Lo(o);function X(){for(var ce=arguments.length,fe=S(ce),Ht=ce;Ht--;)fe[Ht]=arguments[Ht];if(G)var St=ps(X),jt=SS(fe,St);if(d&&(fe=U_(fe,d,g,G)),y&&(fe=B_(fe,y,v,G)),ce-=jt,G&&ce<C){var je=Ir(fe,St);return j_(o,c,iu,X.placeholder,u,fe,je,w,T,C-ce)}var mn=x?u:this,nr=U?mn[o]:o;return ce=fe.length,w?fe=VP(fe,w):J&&ce>1&&fe.reverse(),D&&T<ce&&(fe.length=T),this&&this!==lt&&this instanceof X&&(nr=se||Lo(nr)),nr.apply(mn,fe)}return X}function K_(o,c){return function(u,d){return $b(u,o,c(d),{})}}function su(o,c){return function(u,d){var g;if(u===t&&d===t)return c;if(u!==t&&(g=u),d!==t){if(g===t)return d;typeof u=="string"||typeof d=="string"?(u=zt(u),d=zt(d)):(u=k_(u),d=k_(d)),g=o(u,d)}return g}}function Id(o){return Xn(function(c){return c=Ne(c,Gt(Q())),oe(function(u){var d=this;return o(c,function(g){return Wt(g,d,u)})})})}function ou(o,c){c=c===t?" ":zt(c);var u=c.length;if(u<2)return u?fd(c,o):c;var d=fd(c,Kc(o/os(c)));return ss(c)?Rr(fn(d),0,o).join(""):d.slice(0,o)}function gP(o,c,u,d){var g=c&V,y=Lo(o);function v(){for(var w=-1,T=arguments.length,C=-1,D=d.length,x=S(D+T),U=this&&this!==lt&&this instanceof v?y:o;++C<D;)x[C]=d[C];for(;T--;)x[C++]=arguments[++w];return Wt(U,g?u:this,x)}return v}function H_(o){return function(c,u,d){return d&&typeof d!="number"&&Rt(c,u,d)&&(u=d=t),c=tr(c),u===t?(u=c,c=0):u=tr(u),d=d===t?c<u?1:-1:tr(d),eP(c,u,d,o)}}function au(o){return function(c,u){return typeof c=="string"&&typeof u=="string"||(c=an(c),u=an(u)),o(c,u)}}function j_(o,c,u,d,g,y,v,w,T,C){var D=c&j,x=D?v:t,U=D?t:v,G=D?y:t,J=D?t:y;c|=D?de:me,c&=~(D?me:de),c&ae||(c&=~(V|Y));var se=[o,c,g,G,x,J,U,w,T,C],X=u.apply(t,se);return Pd(o)&&oy(X,se),X.placeholder=d,ay(X,o,c)}function wd(o){var c=Ze[o];return function(u,d){if(u=an(u),d=d==null?0:yt(ie(d),292),d&&a_(u)){var g=(Ie(u)+"e").split("e"),y=c(g[0]+"e"+(+g[1]+d));return g=(Ie(y)+"e").split("e"),+(g[0]+"e"+(+g[1]-d))}return c(u)}}var mP=us&&1/Lc(new us([,-0]))[1]==si?function(o){return new us(o)}:Wd;function Q_(o){return function(c){var u=vt(c);return u==hn?Jh(c):u==dn?NS(c):RS(c,o(c))}}function Jn(o,c,u,d,g,y,v,w){var T=c&Y;if(!T&&typeof o!="function")throw new tn(a);var C=d?d.length:0;if(C||(c&=~(de|me),d=g=t),v=v===t?v:et(ie(v),0),w=w===t?w:ie(w),C-=g?g.length:0,c&me){var D=d,x=g;d=g=t}var U=T?t:Ad(o),G=[o,c,u,d,g,D,x,y,v,w];if(U&&kP(G,U),o=G[0],c=G[1],u=G[2],d=G[3],g=G[4],w=G[9]=G[9]===t?T?0:o.length:et(G[9]-C,0),!w&&c&(j|ye)&&(c&=~(j|ye)),!c||c==V)var J=fP(o,c,u);else c==j||c==ye?J=pP(o,c,w):(c==de||c==(V|de))&&!g.length?J=gP(o,c,u,d):J=iu.apply(t,G);var se=U?C_:oy;return ay(se(J,G),o,c)}function Y_(o,c,u,d){return o===t||gn(o,cs[u])&&!Ee.call(d,u)?c:o}function J_(o,c,u,d,g,y){return Fe(o)&&Fe(c)&&(y.set(c,o),eu(o,c,t,J_,y),y.delete(c)),o}function _P(o){return Uo(o)?t:o}function X_(o,c,u,d,g,y){var v=u&L,w=o.length,T=c.length;if(w!=T&&!(v&&T>w))return!1;var C=y.get(o),D=y.get(c);if(C&&D)return C==c&&D==o;var x=-1,U=!0,G=u&M?new ui:t;for(y.set(o,c),y.set(c,o);++x<w;){var J=o[x],se=c[x];if(d)var X=v?d(se,J,x,c,o,y):d(J,se,x,o,c,y);if(X!==t){if(X)continue;U=!1;break}if(G){if(!zh(c,function(ce,fe){if(!Ro(G,fe)&&(J===ce||g(J,ce,u,d,y)))return G.push(fe)})){U=!1;break}}else if(!(J===se||g(J,se,u,d,y))){U=!1;break}}return y.delete(o),y.delete(c),U}function yP(o,c,u,d,g,y,v){switch(u){case ns:if(o.byteLength!=c.byteLength||o.byteOffset!=c.byteOffset)return!1;o=o.buffer,c=c.buffer;case Ao:return!(o.byteLength!=c.byteLength||!y(new $c(o),new $c(c)));case yo:case vo:case Io:return gn(+o,+c);case Pc:return o.name==c.name&&o.message==c.message;case wo:case Eo:return o==c+"";case hn:var w=Jh;case dn:var T=d&L;if(w||(w=Lc),o.size!=c.size&&!T)return!1;var C=v.get(o);if(C)return C==c;d|=M,v.set(o,c);var D=X_(w(o),w(c),d,g,y,v);return v.delete(o),D;case Dc:if(Do)return Do.call(o)==Do.call(c)}return!1}function vP(o,c,u,d,g,y){var v=u&L,w=Ed(o),T=w.length,C=Ed(c),D=C.length;if(T!=D&&!v)return!1;for(var x=T;x--;){var U=w[x];if(!(v?U in c:Ee.call(c,U)))return!1}var G=y.get(o),J=y.get(c);if(G&&J)return G==c&&J==o;var se=!0;y.set(o,c),y.set(c,o);for(var X=v;++x<T;){U=w[x];var ce=o[U],fe=c[U];if(d)var Ht=v?d(fe,ce,U,c,o,y):d(ce,fe,U,o,c,y);if(!(Ht===t?ce===fe||g(ce,fe,u,d,y):Ht)){se=!1;break}X||(X=U=="constructor")}if(se&&!X){var St=o.constructor,jt=c.constructor;St!=jt&&"constructor"in o&&"constructor"in c&&!(typeof St=="function"&&St instanceof St&&typeof jt=="function"&&jt instanceof jt)&&(se=!1)}return y.delete(o),y.delete(c),se}function Xn(o){return Dd(iy(o,t,fy),o+"")}function Ed(o){return y_(o,nt,Sd)}function Td(o){return y_(o,Lt,Z_)}var Ad=jc?function(o){return jc.get(o)}:Wd;function cu(o){for(var c=o.name+"",u=ls[c],d=Ee.call(ls,c)?u.length:0;d--;){var g=u[d],y=g.func;if(y==null||y==o)return g.name}return c}function ps(o){var c=Ee.call(_,"placeholder")?_:o;return c.placeholder}function Q(){var o=_.iteratee||qd;return o=o===qd?w_:o,arguments.length?o(arguments[0],arguments[1]):o}function uu(o,c){var u=o.__data__;return bP(c)?u[typeof c=="string"?"string":"hash"]:u.map}function Rd(o){for(var c=nt(o),u=c.length;u--;){var d=c[u],g=o[d];c[u]=[d,g,ny(g)]}return c}function di(o,c){var u=DS(o,c);return I_(u)?u:t}function IP(o){var c=Ee.call(o,ai),u=o[ai];try{o[ai]=t;var d=!0}catch{}var g=Bc.call(o);return d&&(c?o[ai]=u:delete o[ai]),g}var Sd=Zh?function(o){return o==null?[]:(o=Se(o),yr(Zh(o),function(c){return s_.call(o,c)}))}:Gd,Z_=Zh?function(o){for(var c=[];o;)vr(c,Sd(o)),o=Wc(o);return c}:Gd,vt=At;(ed&&vt(new ed(new ArrayBuffer(1)))!=ns||bo&&vt(new bo)!=hn||td&&vt(td.resolve())!=gm||us&&vt(new us)!=dn||Po&&vt(new Po)!=To)&&(vt=function(o){var c=At(o),u=c==Hn?o.constructor:t,d=u?fi(u):"";if(d)switch(d){case nb:return ns;case rb:return hn;case ib:return gm;case sb:return dn;case ob:return To}return c});function wP(o,c,u){for(var d=-1,g=u.length;++d<g;){var y=u[d],v=y.size;switch(y.type){case"drop":o+=v;break;case"dropRight":c-=v;break;case"take":c=yt(c,o+v);break;case"takeRight":o=et(o,c-v);break}}return{start:o,end:c}}function EP(o){var c=o.match(PR);return c?c[1].split(CR):[]}function ey(o,c,u){c=Ar(c,o);for(var d=-1,g=c.length,y=!1;++d<g;){var v=Rn(c[d]);if(!(y=o!=null&&u(o,v)))break;o=o[v]}return y||++d!=g?y:(g=o==null?0:o.length,!!g&&mu(g)&&Zn(v,g)&&(te(o)||pi(o)))}function TP(o){var c=o.length,u=new o.constructor(c);return c&&typeof o[0]=="string"&&Ee.call(o,"index")&&(u.index=o.index,u.input=o.input),u}function ty(o){return typeof o.constructor=="function"&&!Mo(o)?hs(Wc(o)):{}}function AP(o,c,u){var d=o.constructor;switch(c){case Ao:return vd(o);case yo:case vo:return new d(+o);case ns:return aP(o,u);case Rh:case Sh:case bh:case Ph:case Ch:case Dh:case kh:case xh:case Nh:return M_(o,u);case hn:return new d;case Io:case Eo:return new d(o);case wo:return cP(o);case dn:return new d;case Dc:return uP(o)}}function RP(o,c){var u=c.length;if(!u)return o;var d=u-1;return c[d]=(u>1?"& ":"")+c[d],c=c.join(u>2?", ":" "),o.replace(bR,`{
/* [wrapped with `+c+`] */
`)}function SP(o){return te(o)||pi(o)||!!(o_&&o&&o[o_])}function Zn(o,c){var u=typeof o;return c=c??_r,!!c&&(u=="number"||u!="symbol"&&FR.test(o))&&o>-1&&o%1==0&&o<c}function Rt(o,c,u){if(!Fe(u))return!1;var d=typeof c;return(d=="number"?Ot(u)&&Zn(c,u.length):d=="string"&&c in u)?gn(u[c],o):!1}function bd(o,c){if(te(o))return!1;var u=typeof o;return u=="number"||u=="symbol"||u=="boolean"||o==null||Kt(o)?!0:TR.test(o)||!ER.test(o)||c!=null&&o in Se(c)}function bP(o){var c=typeof o;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?o!=="__proto__":o===null}function Pd(o){var c=cu(o),u=_[c];if(typeof u!="function"||!(c in le.prototype))return!1;if(o===u)return!0;var d=Ad(u);return!!d&&o===d[0]}function PP(o){return!!n_&&n_ in o}var CP=Fc?er:zd;function Mo(o){var c=o&&o.constructor,u=typeof c=="function"&&c.prototype||cs;return o===u}function ny(o){return o===o&&!Fe(o)}function ry(o,c){return function(u){return u==null?!1:u[o]===c&&(c!==t||o in Se(u))}}function DP(o){var c=pu(o,function(d){return u.size===f&&u.clear(),d}),u=c.cache;return c}function kP(o,c){var u=o[1],d=c[1],g=u|d,y=g<(V|Y|we),v=d==we&&u==j||d==we&&u==Nt&&o[7].length<=c[8]||d==(we|Nt)&&c[7].length<=c[8]&&u==j;if(!(y||v))return o;d&V&&(o[2]=c[2],g|=u&V?0:ae);var w=c[3];if(w){var T=o[3];o[3]=T?U_(T,w,c[4]):w,o[4]=T?Ir(o[3],p):c[4]}return w=c[5],w&&(T=o[5],o[5]=T?B_(T,w,c[6]):w,o[6]=T?Ir(o[5],p):c[6]),w=c[7],w&&(o[7]=w),d&we&&(o[8]=o[8]==null?c[8]:yt(o[8],c[8])),o[9]==null&&(o[9]=c[9]),o[0]=c[0],o[1]=g,o}function xP(o){var c=[];if(o!=null)for(var u in Se(o))c.push(u);return c}function NP(o){return Bc.call(o)}function iy(o,c,u){return c=et(c===t?o.length-1:c,0),function(){for(var d=arguments,g=-1,y=et(d.length-c,0),v=S(y);++g<y;)v[g]=d[c+g];g=-1;for(var w=S(c+1);++g<c;)w[g]=d[g];return w[c]=u(v),Wt(o,this,w)}}function sy(o,c){return c.length<2?o:hi(o,sn(c,0,-1))}function VP(o,c){for(var u=o.length,d=yt(c.length,u),g=Vt(o);d--;){var y=c[d];o[d]=Zn(y,u)?g[y]:t}return o}function Cd(o,c){if(!(c==="constructor"&&typeof o[c]=="function")&&c!="__proto__")return o[c]}var oy=cy(C_),Fo=QS||function(o,c){return lt.setTimeout(o,c)},Dd=cy(rP);function ay(o,c,u){var d=c+"";return Dd(o,RP(d,OP(EP(d),u)))}function cy(o){var c=0,u=0;return function(){var d=ZS(),g=nR-(d-u);if(u=d,g>0){if(++c>=tR)return arguments[0]}else c=0;return o.apply(t,arguments)}}function lu(o,c){var u=-1,d=o.length,g=d-1;for(c=c===t?d:c;++u<c;){var y=dd(u,g),v=o[y];o[y]=o[u],o[u]=v}return o.length=c,o}var uy=DP(function(o){var c=[];return o.charCodeAt(0)===46&&c.push(""),o.replace(AR,function(u,d,g,y){c.push(g?y.replace(xR,"$1"):d||u)}),c});function Rn(o){if(typeof o=="string"||Kt(o))return o;var c=o+"";return c=="0"&&1/o==-si?"-0":c}function fi(o){if(o!=null){try{return Uc.call(o)}catch{}try{return o+""}catch{}}return""}function OP(o,c){return en(cR,function(u){var d="_."+u[0];c&u[1]&&!Vc(o,d)&&o.push(d)}),o.sort()}function ly(o){if(o instanceof le)return o.clone();var c=new nn(o.__wrapped__,o.__chain__);return c.__actions__=Vt(o.__actions__),c.__index__=o.__index__,c.__values__=o.__values__,c}function LP(o,c,u){(u?Rt(o,c,u):c===t)?c=1:c=et(ie(c),0);var d=o==null?0:o.length;if(!d||c<1)return[];for(var g=0,y=0,v=S(Kc(d/c));g<d;)v[y++]=sn(o,g,g+=c);return v}function MP(o){for(var c=-1,u=o==null?0:o.length,d=0,g=[];++c<u;){var y=o[c];y&&(g[d++]=y)}return g}function FP(){var o=arguments.length;if(!o)return[];for(var c=S(o-1),u=arguments[0],d=o;d--;)c[d-1]=arguments[d];return vr(te(u)?Vt(u):[u],ht(c,1))}var UP=oe(function(o,c){return He(o)?xo(o,ht(c,1,He,!0)):[]}),BP=oe(function(o,c){var u=on(c);return He(u)&&(u=t),He(o)?xo(o,ht(c,1,He,!0),Q(u,2)):[]}),qP=oe(function(o,c){var u=on(c);return He(u)&&(u=t),He(o)?xo(o,ht(c,1,He,!0),t,u):[]});function $P(o,c,u){var d=o==null?0:o.length;return d?(c=u||c===t?1:ie(c),sn(o,c<0?0:c,d)):[]}function WP(o,c,u){var d=o==null?0:o.length;return d?(c=u||c===t?1:ie(c),c=d-c,sn(o,0,c<0?0:c)):[]}function GP(o,c){return o&&o.length?nu(o,Q(c,3),!0,!0):[]}function zP(o,c){return o&&o.length?nu(o,Q(c,3),!0):[]}function KP(o,c,u,d){var g=o==null?0:o.length;return g?(u&&typeof u!="number"&&Rt(o,c,u)&&(u=0,d=g),Fb(o,c,u,d)):[]}function hy(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=u==null?0:ie(u);return g<0&&(g=et(d+g,0)),Oc(o,Q(c,3),g)}function dy(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=d-1;return u!==t&&(g=ie(u),g=u<0?et(d+g,0):yt(g,d-1)),Oc(o,Q(c,3),g,!0)}function fy(o){var c=o==null?0:o.length;return c?ht(o,1):[]}function HP(o){var c=o==null?0:o.length;return c?ht(o,si):[]}function jP(o,c){var u=o==null?0:o.length;return u?(c=c===t?1:ie(c),ht(o,c)):[]}function QP(o){for(var c=-1,u=o==null?0:o.length,d={};++c<u;){var g=o[c];d[g[0]]=g[1]}return d}function py(o){return o&&o.length?o[0]:t}function YP(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=u==null?0:ie(u);return g<0&&(g=et(d+g,0)),is(o,c,g)}function JP(o){var c=o==null?0:o.length;return c?sn(o,0,-1):[]}var XP=oe(function(o){var c=Ne(o,_d);return c.length&&c[0]===o[0]?ad(c):[]}),ZP=oe(function(o){var c=on(o),u=Ne(o,_d);return c===on(u)?c=t:u.pop(),u.length&&u[0]===o[0]?ad(u,Q(c,2)):[]}),eC=oe(function(o){var c=on(o),u=Ne(o,_d);return c=typeof c=="function"?c:t,c&&u.pop(),u.length&&u[0]===o[0]?ad(u,t,c):[]});function tC(o,c){return o==null?"":JS.call(o,c)}function on(o){var c=o==null?0:o.length;return c?o[c-1]:t}function nC(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=d;return u!==t&&(g=ie(u),g=g<0?et(d+g,0):yt(g,d-1)),c===c?OS(o,c,g):Oc(o,jm,g,!0)}function rC(o,c){return o&&o.length?R_(o,ie(c)):t}var iC=oe(gy);function gy(o,c){return o&&o.length&&c&&c.length?hd(o,c):o}function sC(o,c,u){return o&&o.length&&c&&c.length?hd(o,c,Q(u,2)):o}function oC(o,c,u){return o&&o.length&&c&&c.length?hd(o,c,t,u):o}var aC=Xn(function(o,c){var u=o==null?0:o.length,d=rd(o,c);return P_(o,Ne(c,function(g){return Zn(g,u)?+g:g}).sort(F_)),d});function cC(o,c){var u=[];if(!(o&&o.length))return u;var d=-1,g=[],y=o.length;for(c=Q(c,3);++d<y;){var v=o[d];c(v,d,o)&&(u.push(v),g.push(d))}return P_(o,g),u}function kd(o){return o==null?o:tb.call(o)}function uC(o,c,u){var d=o==null?0:o.length;return d?(u&&typeof u!="number"&&Rt(o,c,u)?(c=0,u=d):(c=c==null?0:ie(c),u=u===t?d:ie(u)),sn(o,c,u)):[]}function lC(o,c){return tu(o,c)}function hC(o,c,u){return pd(o,c,Q(u,2))}function dC(o,c){var u=o==null?0:o.length;if(u){var d=tu(o,c);if(d<u&&gn(o[d],c))return d}return-1}function fC(o,c){return tu(o,c,!0)}function pC(o,c,u){return pd(o,c,Q(u,2),!0)}function gC(o,c){var u=o==null?0:o.length;if(u){var d=tu(o,c,!0)-1;if(gn(o[d],c))return d}return-1}function mC(o){return o&&o.length?D_(o):[]}function _C(o,c){return o&&o.length?D_(o,Q(c,2)):[]}function yC(o){var c=o==null?0:o.length;return c?sn(o,1,c):[]}function vC(o,c,u){return o&&o.length?(c=u||c===t?1:ie(c),sn(o,0,c<0?0:c)):[]}function IC(o,c,u){var d=o==null?0:o.length;return d?(c=u||c===t?1:ie(c),c=d-c,sn(o,c<0?0:c,d)):[]}function wC(o,c){return o&&o.length?nu(o,Q(c,3),!1,!0):[]}function EC(o,c){return o&&o.length?nu(o,Q(c,3)):[]}var TC=oe(function(o){return Tr(ht(o,1,He,!0))}),AC=oe(function(o){var c=on(o);return He(c)&&(c=t),Tr(ht(o,1,He,!0),Q(c,2))}),RC=oe(function(o){var c=on(o);return c=typeof c=="function"?c:t,Tr(ht(o,1,He,!0),t,c)});function SC(o){return o&&o.length?Tr(o):[]}function bC(o,c){return o&&o.length?Tr(o,Q(c,2)):[]}function PC(o,c){return c=typeof c=="function"?c:t,o&&o.length?Tr(o,t,c):[]}function xd(o){if(!(o&&o.length))return[];var c=0;return o=yr(o,function(u){if(He(u))return c=et(u.length,c),!0}),Qh(c,function(u){return Ne(o,Kh(u))})}function my(o,c){if(!(o&&o.length))return[];var u=xd(o);return c==null?u:Ne(u,function(d){return Wt(c,t,d)})}var CC=oe(function(o,c){return He(o)?xo(o,c):[]}),DC=oe(function(o){return md(yr(o,He))}),kC=oe(function(o){var c=on(o);return He(c)&&(c=t),md(yr(o,He),Q(c,2))}),xC=oe(function(o){var c=on(o);return c=typeof c=="function"?c:t,md(yr(o,He),t,c)}),NC=oe(xd);function VC(o,c){return V_(o||[],c||[],ko)}function OC(o,c){return V_(o||[],c||[],Oo)}var LC=oe(function(o){var c=o.length,u=c>1?o[c-1]:t;return u=typeof u=="function"?(o.pop(),u):t,my(o,u)});function _y(o){var c=_(o);return c.__chain__=!0,c}function MC(o,c){return c(o),o}function hu(o,c){return c(o)}var FC=Xn(function(o){var c=o.length,u=c?o[0]:0,d=this.__wrapped__,g=function(y){return rd(y,o)};return c>1||this.__actions__.length||!(d instanceof le)||!Zn(u)?this.thru(g):(d=d.slice(u,+u+(c?1:0)),d.__actions__.push({func:hu,args:[g],thisArg:t}),new nn(d,this.__chain__).thru(function(y){return c&&!y.length&&y.push(t),y}))});function UC(){return _y(this)}function BC(){return new nn(this.value(),this.__chain__)}function qC(){this.__values__===t&&(this.__values__=ky(this.value()));var o=this.__index__>=this.__values__.length,c=o?t:this.__values__[this.__index__++];return{done:o,value:c}}function $C(){return this}function WC(o){for(var c,u=this;u instanceof Yc;){var d=ly(u);d.__index__=0,d.__values__=t,c?g.__wrapped__=d:c=d;var g=d;u=u.__wrapped__}return g.__wrapped__=o,c}function GC(){var o=this.__wrapped__;if(o instanceof le){var c=o;return this.__actions__.length&&(c=new le(this)),c=c.reverse(),c.__actions__.push({func:hu,args:[kd],thisArg:t}),new nn(c,this.__chain__)}return this.thru(kd)}function zC(){return N_(this.__wrapped__,this.__actions__)}var KC=ru(function(o,c,u){Ee.call(o,u)?++o[u]:Yn(o,u,1)});function HC(o,c,u){var d=te(o)?Km:Mb;return u&&Rt(o,c,u)&&(c=t),d(o,Q(c,3))}function jC(o,c){var u=te(o)?yr:m_;return u(o,Q(c,3))}var QC=G_(hy),YC=G_(dy);function JC(o,c){return ht(du(o,c),1)}function XC(o,c){return ht(du(o,c),si)}function ZC(o,c,u){return u=u===t?1:ie(u),ht(du(o,c),u)}function yy(o,c){var u=te(o)?en:Er;return u(o,Q(c,3))}function vy(o,c){var u=te(o)?yS:g_;return u(o,Q(c,3))}var e1=ru(function(o,c,u){Ee.call(o,u)?o[u].push(c):Yn(o,u,[c])});function t1(o,c,u,d){o=Ot(o)?o:ms(o),u=u&&!d?ie(u):0;var g=o.length;return u<0&&(u=et(g+u,0)),_u(o)?u<=g&&o.indexOf(c,u)>-1:!!g&&is(o,c,u)>-1}var n1=oe(function(o,c,u){var d=-1,g=typeof c=="function",y=Ot(o)?S(o.length):[];return Er(o,function(v){y[++d]=g?Wt(c,v,u):No(v,c,u)}),y}),r1=ru(function(o,c,u){Yn(o,u,c)});function du(o,c){var u=te(o)?Ne:E_;return u(o,Q(c,3))}function i1(o,c,u,d){return o==null?[]:(te(c)||(c=c==null?[]:[c]),u=d?t:u,te(u)||(u=u==null?[]:[u]),S_(o,c,u))}var s1=ru(function(o,c,u){o[u?0:1].push(c)},function(){return[[],[]]});function o1(o,c,u){var d=te(o)?Gh:Ym,g=arguments.length<3;return d(o,Q(c,4),u,g,Er)}function a1(o,c,u){var d=te(o)?vS:Ym,g=arguments.length<3;return d(o,Q(c,4),u,g,g_)}function c1(o,c){var u=te(o)?yr:m_;return u(o,gu(Q(c,3)))}function u1(o){var c=te(o)?h_:tP;return c(o)}function l1(o,c,u){(u?Rt(o,c,u):c===t)?c=1:c=ie(c);var d=te(o)?xb:nP;return d(o,c)}function h1(o){var c=te(o)?Nb:iP;return c(o)}function d1(o){if(o==null)return 0;if(Ot(o))return _u(o)?os(o):o.length;var c=vt(o);return c==hn||c==dn?o.size:ud(o).length}function f1(o,c,u){var d=te(o)?zh:sP;return u&&Rt(o,c,u)&&(c=t),d(o,Q(c,3))}var p1=oe(function(o,c){if(o==null)return[];var u=c.length;return u>1&&Rt(o,c[0],c[1])?c=[]:u>2&&Rt(c[0],c[1],c[2])&&(c=[c[0]]),S_(o,ht(c,1),[])}),fu=jS||function(){return lt.Date.now()};function g1(o,c){if(typeof c!="function")throw new tn(a);return o=ie(o),function(){if(--o<1)return c.apply(this,arguments)}}function Iy(o,c,u){return c=u?t:c,c=o&&c==null?o.length:c,Jn(o,we,t,t,t,t,c)}function wy(o,c){var u;if(typeof c!="function")throw new tn(a);return o=ie(o),function(){return--o>0&&(u=c.apply(this,arguments)),o<=1&&(c=t),u}}var Nd=oe(function(o,c,u){var d=V;if(u.length){var g=Ir(u,ps(Nd));d|=de}return Jn(o,d,c,u,g)}),Ey=oe(function(o,c,u){var d=V|Y;if(u.length){var g=Ir(u,ps(Ey));d|=de}return Jn(c,d,o,u,g)});function Ty(o,c,u){c=u?t:c;var d=Jn(o,j,t,t,t,t,t,c);return d.placeholder=Ty.placeholder,d}function Ay(o,c,u){c=u?t:c;var d=Jn(o,ye,t,t,t,t,t,c);return d.placeholder=Ay.placeholder,d}function Ry(o,c,u){var d,g,y,v,w,T,C=0,D=!1,x=!1,U=!0;if(typeof o!="function")throw new tn(a);c=an(c)||0,Fe(u)&&(D=!!u.leading,x="maxWait"in u,y=x?et(an(u.maxWait)||0,c):y,U="trailing"in u?!!u.trailing:U);function G(je){var mn=d,nr=g;return d=g=t,C=je,v=o.apply(nr,mn),v}function J(je){return C=je,w=Fo(ce,c),D?G(je):v}function se(je){var mn=je-T,nr=je-C,Gy=c-mn;return x?yt(Gy,y-nr):Gy}function X(je){var mn=je-T,nr=je-C;return T===t||mn>=c||mn<0||x&&nr>=y}function ce(){var je=fu();if(X(je))return fe(je);w=Fo(ce,se(je))}function fe(je){return w=t,U&&d?G(je):(d=g=t,v)}function Ht(){w!==t&&O_(w),C=0,d=T=g=w=t}function St(){return w===t?v:fe(fu())}function jt(){var je=fu(),mn=X(je);if(d=arguments,g=this,T=je,mn){if(w===t)return J(T);if(x)return O_(w),w=Fo(ce,c),G(T)}return w===t&&(w=Fo(ce,c)),v}return jt.cancel=Ht,jt.flush=St,jt}var m1=oe(function(o,c){return p_(o,1,c)}),_1=oe(function(o,c,u){return p_(o,an(c)||0,u)});function y1(o){return Jn(o,Kn)}function pu(o,c){if(typeof o!="function"||c!=null&&typeof c!="function")throw new tn(a);var u=function(){var d=arguments,g=c?c.apply(this,d):d[0],y=u.cache;if(y.has(g))return y.get(g);var v=o.apply(this,d);return u.cache=y.set(g,v)||y,v};return u.cache=new(pu.Cache||Qn),u}pu.Cache=Qn;function gu(o){if(typeof o!="function")throw new tn(a);return function(){var c=arguments;switch(c.length){case 0:return!o.call(this);case 1:return!o.call(this,c[0]);case 2:return!o.call(this,c[0],c[1]);case 3:return!o.call(this,c[0],c[1],c[2])}return!o.apply(this,c)}}function v1(o){return wy(2,o)}var I1=oP(function(o,c){c=c.length==1&&te(c[0])?Ne(c[0],Gt(Q())):Ne(ht(c,1),Gt(Q()));var u=c.length;return oe(function(d){for(var g=-1,y=yt(d.length,u);++g<y;)d[g]=c[g].call(this,d[g]);return Wt(o,this,d)})}),Vd=oe(function(o,c){var u=Ir(c,ps(Vd));return Jn(o,de,t,c,u)}),Sy=oe(function(o,c){var u=Ir(c,ps(Sy));return Jn(o,me,t,c,u)}),w1=Xn(function(o,c){return Jn(o,Nt,t,t,t,c)});function E1(o,c){if(typeof o!="function")throw new tn(a);return c=c===t?c:ie(c),oe(o,c)}function T1(o,c){if(typeof o!="function")throw new tn(a);return c=c==null?0:et(ie(c),0),oe(function(u){var d=u[c],g=Rr(u,0,c);return d&&vr(g,d),Wt(o,this,g)})}function A1(o,c,u){var d=!0,g=!0;if(typeof o!="function")throw new tn(a);return Fe(u)&&(d="leading"in u?!!u.leading:d,g="trailing"in u?!!u.trailing:g),Ry(o,c,{leading:d,maxWait:c,trailing:g})}function R1(o){return Iy(o,1)}function S1(o,c){return Vd(yd(c),o)}function b1(){if(!arguments.length)return[];var o=arguments[0];return te(o)?o:[o]}function P1(o){return rn(o,A)}function C1(o,c){return c=typeof c=="function"?c:t,rn(o,A,c)}function D1(o){return rn(o,m|A)}function k1(o,c){return c=typeof c=="function"?c:t,rn(o,m|A,c)}function x1(o,c){return c==null||f_(o,c,nt(c))}function gn(o,c){return o===c||o!==o&&c!==c}var N1=au(od),V1=au(function(o,c){return o>=c}),pi=v_(function(){return arguments}())?v_:function(o){return Be(o)&&Ee.call(o,"callee")&&!s_.call(o,"callee")},te=S.isArray,O1=Bm?Gt(Bm):Wb;function Ot(o){return o!=null&&mu(o.length)&&!er(o)}function He(o){return Be(o)&&Ot(o)}function L1(o){return o===!0||o===!1||Be(o)&&At(o)==yo}var Sr=YS||zd,M1=qm?Gt(qm):Gb;function F1(o){return Be(o)&&o.nodeType===1&&!Uo(o)}function U1(o){if(o==null)return!0;if(Ot(o)&&(te(o)||typeof o=="string"||typeof o.splice=="function"||Sr(o)||gs(o)||pi(o)))return!o.length;var c=vt(o);if(c==hn||c==dn)return!o.size;if(Mo(o))return!ud(o).length;for(var u in o)if(Ee.call(o,u))return!1;return!0}function B1(o,c){return Vo(o,c)}function q1(o,c,u){u=typeof u=="function"?u:t;var d=u?u(o,c):t;return d===t?Vo(o,c,t,u):!!d}function Od(o){if(!Be(o))return!1;var c=At(o);return c==Pc||c==lR||typeof o.message=="string"&&typeof o.name=="string"&&!Uo(o)}function $1(o){return typeof o=="number"&&a_(o)}function er(o){if(!Fe(o))return!1;var c=At(o);return c==Cc||c==pm||c==uR||c==dR}function by(o){return typeof o=="number"&&o==ie(o)}function mu(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=_r}function Fe(o){var c=typeof o;return o!=null&&(c=="object"||c=="function")}function Be(o){return o!=null&&typeof o=="object"}var Py=$m?Gt($m):Kb;function W1(o,c){return o===c||cd(o,c,Rd(c))}function G1(o,c,u){return u=typeof u=="function"?u:t,cd(o,c,Rd(c),u)}function z1(o){return Cy(o)&&o!=+o}function K1(o){if(CP(o))throw new ee(s);return I_(o)}function H1(o){return o===null}function j1(o){return o==null}function Cy(o){return typeof o=="number"||Be(o)&&At(o)==Io}function Uo(o){if(!Be(o)||At(o)!=Hn)return!1;var c=Wc(o);if(c===null)return!0;var u=Ee.call(c,"constructor")&&c.constructor;return typeof u=="function"&&u instanceof u&&Uc.call(u)==GS}var Ld=Wm?Gt(Wm):Hb;function Q1(o){return by(o)&&o>=-_r&&o<=_r}var Dy=Gm?Gt(Gm):jb;function _u(o){return typeof o=="string"||!te(o)&&Be(o)&&At(o)==Eo}function Kt(o){return typeof o=="symbol"||Be(o)&&At(o)==Dc}var gs=zm?Gt(zm):Qb;function Y1(o){return o===t}function J1(o){return Be(o)&&vt(o)==To}function X1(o){return Be(o)&&At(o)==pR}var Z1=au(ld),eD=au(function(o,c){return o<=c});function ky(o){if(!o)return[];if(Ot(o))return _u(o)?fn(o):Vt(o);if(So&&o[So])return xS(o[So]());var c=vt(o),u=c==hn?Jh:c==dn?Lc:ms;return u(o)}function tr(o){if(!o)return o===0?o:0;if(o=an(o),o===si||o===-si){var c=o<0?-1:1;return c*sR}return o===o?o:0}function ie(o){var c=tr(o),u=c%1;return c===c?u?c-u:c:0}function xy(o){return o?li(ie(o),0,En):0}function an(o){if(typeof o=="number")return o;if(Kt(o))return Sc;if(Fe(o)){var c=typeof o.valueOf=="function"?o.valueOf():o;o=Fe(c)?c+"":c}if(typeof o!="string")return o===0?o:+o;o=Jm(o);var u=OR.test(o);return u||MR.test(o)?gS(o.slice(2),u?2:8):VR.test(o)?Sc:+o}function Ny(o){return An(o,Lt(o))}function tD(o){return o?li(ie(o),-_r,_r):o===0?o:0}function Ie(o){return o==null?"":zt(o)}var nD=ds(function(o,c){if(Mo(c)||Ot(c)){An(c,nt(c),o);return}for(var u in c)Ee.call(c,u)&&ko(o,u,c[u])}),Vy=ds(function(o,c){An(c,Lt(c),o)}),yu=ds(function(o,c,u,d){An(c,Lt(c),o,d)}),rD=ds(function(o,c,u,d){An(c,nt(c),o,d)}),iD=Xn(rd);function sD(o,c){var u=hs(o);return c==null?u:d_(u,c)}var oD=oe(function(o,c){o=Se(o);var u=-1,d=c.length,g=d>2?c[2]:t;for(g&&Rt(c[0],c[1],g)&&(d=1);++u<d;)for(var y=c[u],v=Lt(y),w=-1,T=v.length;++w<T;){var C=v[w],D=o[C];(D===t||gn(D,cs[C])&&!Ee.call(o,C))&&(o[C]=y[C])}return o}),aD=oe(function(o){return o.push(t,J_),Wt(Oy,t,o)});function cD(o,c){return Hm(o,Q(c,3),Tn)}function uD(o,c){return Hm(o,Q(c,3),sd)}function lD(o,c){return o==null?o:id(o,Q(c,3),Lt)}function hD(o,c){return o==null?o:__(o,Q(c,3),Lt)}function dD(o,c){return o&&Tn(o,Q(c,3))}function fD(o,c){return o&&sd(o,Q(c,3))}function pD(o){return o==null?[]:Zc(o,nt(o))}function gD(o){return o==null?[]:Zc(o,Lt(o))}function Md(o,c,u){var d=o==null?t:hi(o,c);return d===t?u:d}function mD(o,c){return o!=null&&ey(o,c,Ub)}function Fd(o,c){return o!=null&&ey(o,c,Bb)}var _D=K_(function(o,c,u){c!=null&&typeof c.toString!="function"&&(c=Bc.call(c)),o[c]=u},Bd(Mt)),yD=K_(function(o,c,u){c!=null&&typeof c.toString!="function"&&(c=Bc.call(c)),Ee.call(o,c)?o[c].push(u):o[c]=[u]},Q),vD=oe(No);function nt(o){return Ot(o)?l_(o):ud(o)}function Lt(o){return Ot(o)?l_(o,!0):Yb(o)}function ID(o,c){var u={};return c=Q(c,3),Tn(o,function(d,g,y){Yn(u,c(d,g,y),d)}),u}function wD(o,c){var u={};return c=Q(c,3),Tn(o,function(d,g,y){Yn(u,g,c(d,g,y))}),u}var ED=ds(function(o,c,u){eu(o,c,u)}),Oy=ds(function(o,c,u,d){eu(o,c,u,d)}),TD=Xn(function(o,c){var u={};if(o==null)return u;var d=!1;c=Ne(c,function(y){return y=Ar(y,o),d||(d=y.length>1),y}),An(o,Td(o),u),d&&(u=rn(u,m|I|A,_P));for(var g=c.length;g--;)gd(u,c[g]);return u});function AD(o,c){return Ly(o,gu(Q(c)))}var RD=Xn(function(o,c){return o==null?{}:Xb(o,c)});function Ly(o,c){if(o==null)return{};var u=Ne(Td(o),function(d){return[d]});return c=Q(c),b_(o,u,function(d,g){return c(d,g[0])})}function SD(o,c,u){c=Ar(c,o);var d=-1,g=c.length;for(g||(g=1,o=t);++d<g;){var y=o==null?t:o[Rn(c[d])];y===t&&(d=g,y=u),o=er(y)?y.call(o):y}return o}function bD(o,c,u){return o==null?o:Oo(o,c,u)}function PD(o,c,u,d){return d=typeof d=="function"?d:t,o==null?o:Oo(o,c,u,d)}var My=Q_(nt),Fy=Q_(Lt);function CD(o,c,u){var d=te(o),g=d||Sr(o)||gs(o);if(c=Q(c,4),u==null){var y=o&&o.constructor;g?u=d?new y:[]:Fe(o)?u=er(y)?hs(Wc(o)):{}:u={}}return(g?en:Tn)(o,function(v,w,T){return c(u,v,w,T)}),u}function DD(o,c){return o==null?!0:gd(o,c)}function kD(o,c,u){return o==null?o:x_(o,c,yd(u))}function xD(o,c,u,d){return d=typeof d=="function"?d:t,o==null?o:x_(o,c,yd(u),d)}function ms(o){return o==null?[]:Yh(o,nt(o))}function ND(o){return o==null?[]:Yh(o,Lt(o))}function VD(o,c,u){return u===t&&(u=c,c=t),u!==t&&(u=an(u),u=u===u?u:0),c!==t&&(c=an(c),c=c===c?c:0),li(an(o),c,u)}function OD(o,c,u){return c=tr(c),u===t?(u=c,c=0):u=tr(u),o=an(o),qb(o,c,u)}function LD(o,c,u){if(u&&typeof u!="boolean"&&Rt(o,c,u)&&(c=u=t),u===t&&(typeof c=="boolean"?(u=c,c=t):typeof o=="boolean"&&(u=o,o=t)),o===t&&c===t?(o=0,c=1):(o=tr(o),c===t?(c=o,o=0):c=tr(c)),o>c){var d=o;o=c,c=d}if(u||o%1||c%1){var g=c_();return yt(o+g*(c-o+pS("1e-"+((g+"").length-1))),c)}return dd(o,c)}var MD=fs(function(o,c,u){return c=c.toLowerCase(),o+(u?Uy(c):c)});function Uy(o){return Ud(Ie(o).toLowerCase())}function By(o){return o=Ie(o),o&&o.replace(UR,bS).replace(iS,"")}function FD(o,c,u){o=Ie(o),c=zt(c);var d=o.length;u=u===t?d:li(ie(u),0,d);var g=u;return u-=c.length,u>=0&&o.slice(u,g)==c}function UD(o){return o=Ie(o),o&&vR.test(o)?o.replace(_m,PS):o}function BD(o){return o=Ie(o),o&&RR.test(o)?o.replace(Vh,"\\$&"):o}var qD=fs(function(o,c,u){return o+(u?"-":"")+c.toLowerCase()}),$D=fs(function(o,c,u){return o+(u?" ":"")+c.toLowerCase()}),WD=W_("toLowerCase");function GD(o,c,u){o=Ie(o),c=ie(c);var d=c?os(o):0;if(!c||d>=c)return o;var g=(c-d)/2;return ou(Hc(g),u)+o+ou(Kc(g),u)}function zD(o,c,u){o=Ie(o),c=ie(c);var d=c?os(o):0;return c&&d<c?o+ou(c-d,u):o}function KD(o,c,u){o=Ie(o),c=ie(c);var d=c?os(o):0;return c&&d<c?ou(c-d,u)+o:o}function HD(o,c,u){return u||c==null?c=0:c&&(c=+c),eb(Ie(o).replace(Oh,""),c||0)}function jD(o,c,u){return(u?Rt(o,c,u):c===t)?c=1:c=ie(c),fd(Ie(o),c)}function QD(){var o=arguments,c=Ie(o[0]);return o.length<3?c:c.replace(o[1],o[2])}var YD=fs(function(o,c,u){return o+(u?"_":"")+c.toLowerCase()});function JD(o,c,u){return u&&typeof u!="number"&&Rt(o,c,u)&&(c=u=t),u=u===t?En:u>>>0,u?(o=Ie(o),o&&(typeof c=="string"||c!=null&&!Ld(c))&&(c=zt(c),!c&&ss(o))?Rr(fn(o),0,u):o.split(c,u)):[]}var XD=fs(function(o,c,u){return o+(u?" ":"")+Ud(c)});function ZD(o,c,u){return o=Ie(o),u=u==null?0:li(ie(u),0,o.length),c=zt(c),o.slice(u,u+c.length)==c}function ek(o,c,u){var d=_.templateSettings;u&&Rt(o,c,u)&&(c=t),o=Ie(o),c=yu({},c,d,Y_);var g=yu({},c.imports,d.imports,Y_),y=nt(g),v=Yh(g,y),w,T,C=0,D=c.interpolate||kc,x="__p += '",U=Xh((c.escape||kc).source+"|"+D.source+"|"+(D===ym?NR:kc).source+"|"+(c.evaluate||kc).source+"|$","g"),G="//# sourceURL="+(Ee.call(c,"sourceURL")?(c.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++uS+"]")+`
`;o.replace(U,function(X,ce,fe,Ht,St,jt){return fe||(fe=Ht),x+=o.slice(C,jt).replace(BR,CS),ce&&(w=!0,x+=`' +
__e(`+ce+`) +
'`),St&&(T=!0,x+=`';
`+St+`;
__p += '`),fe&&(x+=`' +
((__t = (`+fe+`)) == null ? '' : __t) +
'`),C=jt+X.length,X}),x+=`';
`;var J=Ee.call(c,"variable")&&c.variable;if(!J)x=`with (obj) {
`+x+`
}
`;else if(kR.test(J))throw new ee(l);x=(T?x.replace(gR,""):x).replace(mR,"$1").replace(_R,"$1;"),x="function("+(J||"obj")+`) {
`+(J?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+x+`return __p
}`;var se=$y(function(){return ve(y,G+"return "+x).apply(t,v)});if(se.source=x,Od(se))throw se;return se}function tk(o){return Ie(o).toLowerCase()}function nk(o){return Ie(o).toUpperCase()}function rk(o,c,u){if(o=Ie(o),o&&(u||c===t))return Jm(o);if(!o||!(c=zt(c)))return o;var d=fn(o),g=fn(c),y=Xm(d,g),v=Zm(d,g)+1;return Rr(d,y,v).join("")}function ik(o,c,u){if(o=Ie(o),o&&(u||c===t))return o.slice(0,t_(o)+1);if(!o||!(c=zt(c)))return o;var d=fn(o),g=Zm(d,fn(c))+1;return Rr(d,0,g).join("")}function sk(o,c,u){if(o=Ie(o),o&&(u||c===t))return o.replace(Oh,"");if(!o||!(c=zt(c)))return o;var d=fn(o),g=Xm(d,fn(c));return Rr(d,g).join("")}function ok(o,c){var u=es,d=eR;if(Fe(c)){var g="separator"in c?c.separator:g;u="length"in c?ie(c.length):u,d="omission"in c?zt(c.omission):d}o=Ie(o);var y=o.length;if(ss(o)){var v=fn(o);y=v.length}if(u>=y)return o;var w=u-os(d);if(w<1)return d;var T=v?Rr(v,0,w).join(""):o.slice(0,w);if(g===t)return T+d;if(v&&(w+=T.length-w),Ld(g)){if(o.slice(w).search(g)){var C,D=T;for(g.global||(g=Xh(g.source,Ie(vm.exec(g))+"g")),g.lastIndex=0;C=g.exec(D);)var x=C.index;T=T.slice(0,x===t?w:x)}}else if(o.indexOf(zt(g),w)!=w){var U=T.lastIndexOf(g);U>-1&&(T=T.slice(0,U))}return T+d}function ak(o){return o=Ie(o),o&&yR.test(o)?o.replace(mm,LS):o}var ck=fs(function(o,c,u){return o+(u?" ":"")+c.toUpperCase()}),Ud=W_("toUpperCase");function qy(o,c,u){return o=Ie(o),c=u?t:c,c===t?kS(o)?US(o):ES(o):o.match(c)||[]}var $y=oe(function(o,c){try{return Wt(o,t,c)}catch(u){return Od(u)?u:new ee(u)}}),uk=Xn(function(o,c){return en(c,function(u){u=Rn(u),Yn(o,u,Nd(o[u],o))}),o});function lk(o){var c=o==null?0:o.length,u=Q();return o=c?Ne(o,function(d){if(typeof d[1]!="function")throw new tn(a);return[u(d[0]),d[1]]}):[],oe(function(d){for(var g=-1;++g<c;){var y=o[g];if(Wt(y[0],this,d))return Wt(y[1],this,d)}})}function hk(o){return Lb(rn(o,m))}function Bd(o){return function(){return o}}function dk(o,c){return o==null||o!==o?c:o}var fk=z_(),pk=z_(!0);function Mt(o){return o}function qd(o){return w_(typeof o=="function"?o:rn(o,m))}function gk(o){return T_(rn(o,m))}function mk(o,c){return A_(o,rn(c,m))}var _k=oe(function(o,c){return function(u){return No(u,o,c)}}),yk=oe(function(o,c){return function(u){return No(o,u,c)}});function $d(o,c,u){var d=nt(c),g=Zc(c,d);u==null&&!(Fe(c)&&(g.length||!d.length))&&(u=c,c=o,o=this,g=Zc(c,nt(c)));var y=!(Fe(u)&&"chain"in u)||!!u.chain,v=er(o);return en(g,function(w){var T=c[w];o[w]=T,v&&(o.prototype[w]=function(){var C=this.__chain__;if(y||C){var D=o(this.__wrapped__),x=D.__actions__=Vt(this.__actions__);return x.push({func:T,args:arguments,thisArg:o}),D.__chain__=C,D}return T.apply(o,vr([this.value()],arguments))})}),o}function vk(){return lt._===this&&(lt._=zS),this}function Wd(){}function Ik(o){return o=ie(o),oe(function(c){return R_(c,o)})}var wk=Id(Ne),Ek=Id(Km),Tk=Id(zh);function Wy(o){return bd(o)?Kh(Rn(o)):Zb(o)}function Ak(o){return function(c){return o==null?t:hi(o,c)}}var Rk=H_(),Sk=H_(!0);function Gd(){return[]}function zd(){return!1}function bk(){return{}}function Pk(){return""}function Ck(){return!0}function Dk(o,c){if(o=ie(o),o<1||o>_r)return[];var u=En,d=yt(o,En);c=Q(c),o-=En;for(var g=Qh(d,c);++u<o;)c(u);return g}function kk(o){return te(o)?Ne(o,Rn):Kt(o)?[o]:Vt(uy(Ie(o)))}function xk(o){var c=++WS;return Ie(o)+c}var Nk=su(function(o,c){return o+c},0),Vk=wd("ceil"),Ok=su(function(o,c){return o/c},1),Lk=wd("floor");function Mk(o){return o&&o.length?Xc(o,Mt,od):t}function Fk(o,c){return o&&o.length?Xc(o,Q(c,2),od):t}function Uk(o){return Qm(o,Mt)}function Bk(o,c){return Qm(o,Q(c,2))}function qk(o){return o&&o.length?Xc(o,Mt,ld):t}function $k(o,c){return o&&o.length?Xc(o,Q(c,2),ld):t}var Wk=su(function(o,c){return o*c},1),Gk=wd("round"),zk=su(function(o,c){return o-c},0);function Kk(o){return o&&o.length?jh(o,Mt):0}function Hk(o,c){return o&&o.length?jh(o,Q(c,2)):0}return _.after=g1,_.ary=Iy,_.assign=nD,_.assignIn=Vy,_.assignInWith=yu,_.assignWith=rD,_.at=iD,_.before=wy,_.bind=Nd,_.bindAll=uk,_.bindKey=Ey,_.castArray=b1,_.chain=_y,_.chunk=LP,_.compact=MP,_.concat=FP,_.cond=lk,_.conforms=hk,_.constant=Bd,_.countBy=KC,_.create=sD,_.curry=Ty,_.curryRight=Ay,_.debounce=Ry,_.defaults=oD,_.defaultsDeep=aD,_.defer=m1,_.delay=_1,_.difference=UP,_.differenceBy=BP,_.differenceWith=qP,_.drop=$P,_.dropRight=WP,_.dropRightWhile=GP,_.dropWhile=zP,_.fill=KP,_.filter=jC,_.flatMap=JC,_.flatMapDeep=XC,_.flatMapDepth=ZC,_.flatten=fy,_.flattenDeep=HP,_.flattenDepth=jP,_.flip=y1,_.flow=fk,_.flowRight=pk,_.fromPairs=QP,_.functions=pD,_.functionsIn=gD,_.groupBy=e1,_.initial=JP,_.intersection=XP,_.intersectionBy=ZP,_.intersectionWith=eC,_.invert=_D,_.invertBy=yD,_.invokeMap=n1,_.iteratee=qd,_.keyBy=r1,_.keys=nt,_.keysIn=Lt,_.map=du,_.mapKeys=ID,_.mapValues=wD,_.matches=gk,_.matchesProperty=mk,_.memoize=pu,_.merge=ED,_.mergeWith=Oy,_.method=_k,_.methodOf=yk,_.mixin=$d,_.negate=gu,_.nthArg=Ik,_.omit=TD,_.omitBy=AD,_.once=v1,_.orderBy=i1,_.over=wk,_.overArgs=I1,_.overEvery=Ek,_.overSome=Tk,_.partial=Vd,_.partialRight=Sy,_.partition=s1,_.pick=RD,_.pickBy=Ly,_.property=Wy,_.propertyOf=Ak,_.pull=iC,_.pullAll=gy,_.pullAllBy=sC,_.pullAllWith=oC,_.pullAt=aC,_.range=Rk,_.rangeRight=Sk,_.rearg=w1,_.reject=c1,_.remove=cC,_.rest=E1,_.reverse=kd,_.sampleSize=l1,_.set=bD,_.setWith=PD,_.shuffle=h1,_.slice=uC,_.sortBy=p1,_.sortedUniq=mC,_.sortedUniqBy=_C,_.split=JD,_.spread=T1,_.tail=yC,_.take=vC,_.takeRight=IC,_.takeRightWhile=wC,_.takeWhile=EC,_.tap=MC,_.throttle=A1,_.thru=hu,_.toArray=ky,_.toPairs=My,_.toPairsIn=Fy,_.toPath=kk,_.toPlainObject=Ny,_.transform=CD,_.unary=R1,_.union=TC,_.unionBy=AC,_.unionWith=RC,_.uniq=SC,_.uniqBy=bC,_.uniqWith=PC,_.unset=DD,_.unzip=xd,_.unzipWith=my,_.update=kD,_.updateWith=xD,_.values=ms,_.valuesIn=ND,_.without=CC,_.words=qy,_.wrap=S1,_.xor=DC,_.xorBy=kC,_.xorWith=xC,_.zip=NC,_.zipObject=VC,_.zipObjectDeep=OC,_.zipWith=LC,_.entries=My,_.entriesIn=Fy,_.extend=Vy,_.extendWith=yu,$d(_,_),_.add=Nk,_.attempt=$y,_.camelCase=MD,_.capitalize=Uy,_.ceil=Vk,_.clamp=VD,_.clone=P1,_.cloneDeep=D1,_.cloneDeepWith=k1,_.cloneWith=C1,_.conformsTo=x1,_.deburr=By,_.defaultTo=dk,_.divide=Ok,_.endsWith=FD,_.eq=gn,_.escape=UD,_.escapeRegExp=BD,_.every=HC,_.find=QC,_.findIndex=hy,_.findKey=cD,_.findLast=YC,_.findLastIndex=dy,_.findLastKey=uD,_.floor=Lk,_.forEach=yy,_.forEachRight=vy,_.forIn=lD,_.forInRight=hD,_.forOwn=dD,_.forOwnRight=fD,_.get=Md,_.gt=N1,_.gte=V1,_.has=mD,_.hasIn=Fd,_.head=py,_.identity=Mt,_.includes=t1,_.indexOf=YP,_.inRange=OD,_.invoke=vD,_.isArguments=pi,_.isArray=te,_.isArrayBuffer=O1,_.isArrayLike=Ot,_.isArrayLikeObject=He,_.isBoolean=L1,_.isBuffer=Sr,_.isDate=M1,_.isElement=F1,_.isEmpty=U1,_.isEqual=B1,_.isEqualWith=q1,_.isError=Od,_.isFinite=$1,_.isFunction=er,_.isInteger=by,_.isLength=mu,_.isMap=Py,_.isMatch=W1,_.isMatchWith=G1,_.isNaN=z1,_.isNative=K1,_.isNil=j1,_.isNull=H1,_.isNumber=Cy,_.isObject=Fe,_.isObjectLike=Be,_.isPlainObject=Uo,_.isRegExp=Ld,_.isSafeInteger=Q1,_.isSet=Dy,_.isString=_u,_.isSymbol=Kt,_.isTypedArray=gs,_.isUndefined=Y1,_.isWeakMap=J1,_.isWeakSet=X1,_.join=tC,_.kebabCase=qD,_.last=on,_.lastIndexOf=nC,_.lowerCase=$D,_.lowerFirst=WD,_.lt=Z1,_.lte=eD,_.max=Mk,_.maxBy=Fk,_.mean=Uk,_.meanBy=Bk,_.min=qk,_.minBy=$k,_.stubArray=Gd,_.stubFalse=zd,_.stubObject=bk,_.stubString=Pk,_.stubTrue=Ck,_.multiply=Wk,_.nth=rC,_.noConflict=vk,_.noop=Wd,_.now=fu,_.pad=GD,_.padEnd=zD,_.padStart=KD,_.parseInt=HD,_.random=LD,_.reduce=o1,_.reduceRight=a1,_.repeat=jD,_.replace=QD,_.result=SD,_.round=Gk,_.runInContext=E,_.sample=u1,_.size=d1,_.snakeCase=YD,_.some=f1,_.sortedIndex=lC,_.sortedIndexBy=hC,_.sortedIndexOf=dC,_.sortedLastIndex=fC,_.sortedLastIndexBy=pC,_.sortedLastIndexOf=gC,_.startCase=XD,_.startsWith=ZD,_.subtract=zk,_.sum=Kk,_.sumBy=Hk,_.template=ek,_.times=Dk,_.toFinite=tr,_.toInteger=ie,_.toLength=xy,_.toLower=tk,_.toNumber=an,_.toSafeInteger=tD,_.toString=Ie,_.toUpper=nk,_.trim=rk,_.trimEnd=ik,_.trimStart=sk,_.truncate=ok,_.unescape=ak,_.uniqueId=xk,_.upperCase=ck,_.upperFirst=Ud,_.each=yy,_.eachRight=vy,_.first=py,$d(_,function(){var o={};return Tn(_,function(c,u){Ee.call(_.prototype,u)||(o[u]=c)}),o}(),{chain:!1}),_.VERSION=r,en(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){_[o].placeholder=_}),en(["drop","take"],function(o,c){le.prototype[o]=function(u){u=u===t?1:et(ie(u),0);var d=this.__filtered__&&!c?new le(this):this.clone();return d.__filtered__?d.__takeCount__=yt(u,d.__takeCount__):d.__views__.push({size:yt(u,En),type:o+(d.__dir__<0?"Right":"")}),d},le.prototype[o+"Right"]=function(u){return this.reverse()[o](u).reverse()}}),en(["filter","map","takeWhile"],function(o,c){var u=c+1,d=u==fm||u==iR;le.prototype[o]=function(g){var y=this.clone();return y.__iteratees__.push({iteratee:Q(g,3),type:u}),y.__filtered__=y.__filtered__||d,y}}),en(["head","last"],function(o,c){var u="take"+(c?"Right":"");le.prototype[o]=function(){return this[u](1).value()[0]}}),en(["initial","tail"],function(o,c){var u="drop"+(c?"":"Right");le.prototype[o]=function(){return this.__filtered__?new le(this):this[u](1)}}),le.prototype.compact=function(){return this.filter(Mt)},le.prototype.find=function(o){return this.filter(o).head()},le.prototype.findLast=function(o){return this.reverse().find(o)},le.prototype.invokeMap=oe(function(o,c){return typeof o=="function"?new le(this):this.map(function(u){return No(u,o,c)})}),le.prototype.reject=function(o){return this.filter(gu(Q(o)))},le.prototype.slice=function(o,c){o=ie(o);var u=this;return u.__filtered__&&(o>0||c<0)?new le(u):(o<0?u=u.takeRight(-o):o&&(u=u.drop(o)),c!==t&&(c=ie(c),u=c<0?u.dropRight(-c):u.take(c-o)),u)},le.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},le.prototype.toArray=function(){return this.take(En)},Tn(le.prototype,function(o,c){var u=/^(?:filter|find|map|reject)|While$/.test(c),d=/^(?:head|last)$/.test(c),g=_[d?"take"+(c=="last"?"Right":""):c],y=d||/^find/.test(c);g&&(_.prototype[c]=function(){var v=this.__wrapped__,w=d?[1]:arguments,T=v instanceof le,C=w[0],D=T||te(v),x=function(ce){var fe=g.apply(_,vr([ce],w));return d&&U?fe[0]:fe};D&&u&&typeof C=="function"&&C.length!=1&&(T=D=!1);var U=this.__chain__,G=!!this.__actions__.length,J=y&&!U,se=T&&!G;if(!y&&D){v=se?v:new le(this);var X=o.apply(v,w);return X.__actions__.push({func:hu,args:[x],thisArg:t}),new nn(X,U)}return J&&se?o.apply(this,w):(X=this.thru(x),J?d?X.value()[0]:X.value():X)})}),en(["pop","push","shift","sort","splice","unshift"],function(o){var c=Mc[o],u=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",d=/^(?:pop|shift)$/.test(o);_.prototype[o]=function(){var g=arguments;if(d&&!this.__chain__){var y=this.value();return c.apply(te(y)?y:[],g)}return this[u](function(v){return c.apply(te(v)?v:[],g)})}}),Tn(le.prototype,function(o,c){var u=_[c];if(u){var d=u.name+"";Ee.call(ls,d)||(ls[d]=[]),ls[d].push({name:c,func:u})}}),ls[iu(t,Y).name]=[{name:"wrapper",func:t}],le.prototype.clone=ab,le.prototype.reverse=cb,le.prototype.value=ub,_.prototype.at=FC,_.prototype.chain=UC,_.prototype.commit=BC,_.prototype.next=qC,_.prototype.plant=WC,_.prototype.reverse=GC,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=zC,_.prototype.first=_.prototype.head,So&&(_.prototype[So]=$C),_},as=BS();oi?((oi.exports=as)._=as,qh._=as):lt._=as}).call(ea)})(Y4,Xa);const Y0=Xa;function J4(){return Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)}const J0=document.querySelector(".search__wrapper"),sw=document.querySelector(".search__input"),El=document.querySelector(".filters__list"),fp=document.querySelector(".filters__category"),X4=Y0.debounce(t$,500);async function Z4(n){try{const e=await n.fetchFilters(),r=[...new Set(e.map(({filter:i})=>i))].map((i,s)=>{const a=i.toLowerCase().split(" ").join("-");return s===0?`<li id=${a} class="filters__item active">${i}</li>`:`<li id=${a} class="filters__item">${i}</li>`}).join("");El.insertAdjacentHTML("afterbegin",r),Yr()}catch(e){console.log("Error fetching filters:",e)}}function ow(n){const e=n.charAt(0).toUpperCase()+n.slice(1,n.length);fp.innerHTML=`<div>/</div>${e}`,fp.classList.add("active"),J0.classList.add("active")}function e$(){fp.classList.remove("active"),J0.classList.remove("active")}async function t$(n){const e=n.target.value.toLowerCase().trim();bn.keyword=e,Yr()}function n$(n){const e=n.target,t=n.target.id;e.classList.contains("active")&&(q0({filter:t,bodypart:"",keyword:"",muscles:"",equipment:""},De),Yr()),[...El.children].forEach(r=>{r.classList.remove("active")}),e.classList.add("active"),e$(),De.currentPage=1,Yr()}function r$(){if(De.endPoint!=1){const n=new Tl;Z4(n)}}sw&&sw.addEventListener("input",X4);El&&El.addEventListener("click",n$);function X0(n){document.querySelector(n).scrollIntoView({behavior:"smooth"})}window.addEventListener("resize",Y0.debounce(Yr,1e3));const i$=1440;let bn={filter:"Muscles",bodypart:"",keyword:"",muscles:"",equipment:""};const De={currentPage:1,endPoint:3},qn={cardsLinks:null,pageLinks:null,workoutLinks:null};async function Yr(){document.querySelector(".exercise-cards__section").offsetHeight;const e=new Tl,t=J4();let r,i;q0(bn,De),g4(),Q4(De.endPoint,t);try{switch(De.endPoint){case 1:p4(),YI(),r=await l4(De,t),Du(),ku(),console.log(r.currentData),a4(r.currentData),t<i$&&mf(De.currentPage,r.totalPages),_f(De.endPoint);break;case 2:if(f4(),JI(),X0(".exercises"),i=c4(De.currentPage,De.endPoint,e,bn,i,t),r=await HI(i),r.length===0)throw new Error("No data");Du(),ku(),o4(r),mf(De.currentPage,e.maxPages),_f(De.endPoint),c$();break;case 3:YI(),JI(),i=u4(De.currentPage,De.endPoint,e,bn,i,t),r=await HI(i),Du(),ku(),s4(r),mf(De.currentPage,e.maxPages),s$(),_f(De.endPoint);break}}catch(s){console.log("Error: ",s),Du(),ku(),De.endPoint===1?_4():y4(),m4()}}function s$(){qn.cardsLinks=document.querySelector(".js-cards"),qn.cardsLinks?qn.cardsLinks.addEventListener("click",Z0):console.error("Element with class 'js-cards' not found.")}function Z0(n){const e=v4(n);ow(e),ow(e),o$(e),e!=null&&(bn.filter==="Muscles"?(De.endPoint=2,bn.muscles=e):bn.filter==="Body%20parts"?(De.endPoint=2,bn.bodypart=e):bn.filter==="Equipment"&&(De.endPoint=2,bn.equipment=e)),qn.cardsLinks.removeEventListener("click",Z0),De.currentPage=1,Yr()}function o$(n){return n.includes(" ")?n.replace(" ","%20"):n}function _f(){qn.pageLinks=document.querySelector(".js-pages"),qn.pageLinks?qn.pageLinks.addEventListener("click",a$):console.error("Element with class 'js-pages' not found.")}function a$(n){const e=I4(n);console.log("clicked page:",e),X0(window.location.href.includes("/favorites")?".favorites":".exercises"),De.currentPage!=e&&e!=null&&(De.currentPage=+e,Yr())}function c$(){qn.workoutLinks=document.querySelector(".js-cards"),qn.workoutLinks?qn.workoutLinks.addEventListener("click",u$):console.error("Element with class 'js-cards' not found for workout.")}async function u$(n){const e=w4(n);if(!e)return;const t=new Tl;try{t.id=e;const r=await t.fetchExerciseById();if(Xa.isEmpty(r))throw new Error("Exercise not found!");r.isFavorite=await Us.idIsFavorite(e),j0(r)}catch(r){console.error(r)}}function l$(){window.location.href.includes("/favorite")?(De.endPoint=1,Yr()):r$()}l$();document.querySelectorAll(".header__nav");const h$=document.querySelectorAll("section"),d$=n=>{const e={rootMargin:"100px",threshold:.2},t=(i,s)=>{i.forEach(({isIntersecting:a,target:l})=>{a&&(l.classList.add("appear"),s.unobserve(l))})},r=new IntersectionObserver(t,e);n.forEach(i=>r.observe(i))};setTimeout(()=>{d$(h$)},250);export{Gi as d,hp as r,i4 as s};
