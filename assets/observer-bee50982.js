import{A as sc,i as ex}from"./index-466d5433.js";const Qy=document.getElementById("daily-quote"),Yy=document.getElementById("quote-author"),tx=new sc;function dw(){const n=new Date,e=n.getFullYear(),t=(n.getMonth()+1).toString().padStart(2,"0");return`${n.getDate().toString().padStart(2,"0")}/${t}/${e}`}async function nx(){try{const n=await tx.fetchQuote(),e=n.quote,t=n.author,r=dw();return localStorage.setItem("today",r),localStorage.setItem("quote",e),localStorage.setItem("author",t),{quote:e,author:t}}catch(n){console.error("Error fetching quote:",n.message)}}const Jy=localStorage.getItem("today"),rx=dw();if(!Jy||Jy!==rx)nx().then(({quote:n,author:e})=>{Qy.textContent=n,Yy.textContent=e});else{const n=localStorage.getItem("quote");n&&(Qy.textContent=n);const e=localStorage.getItem("author");e&&(Yy.textContent=e)}const fw=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},ix=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],l=n[t++],h=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},pw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,l=a?n[i+1]:0,h=i+2<n.length,f=h?n[i+2]:0,p=s>>2,m=(s&3)<<4|l>>4;let I=(l&15)<<2|f>>6,A=f&63;h||(A=64,a||(I=64)),r.push(t[p],t[m],t[I],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(fw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ix(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const f=i<n.length?t[n.charAt(i)]:64;++i;const m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||f==null||m==null)throw new sx;const I=s<<2|l>>4;if(r.push(I),f!==64){const A=l<<4&240|f>>2;if(r.push(A),m!==64){const L=f<<6&192|m;r.push(L)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class sx extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ox=function(n){const e=fw(n);return pw.encodeByteArray(e,!0)},Zu=function(n){return ox(n).replace(/\./g,"")},gw=function(n){try{return pw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function el(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!ax(t)||(n[t]=el(n[t],e[t]));return n}function ax(n){return n!=="__proto__"}function cx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const ux=()=>cx().__FIREBASE_DEFAULTS__,lx=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},hx=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&gw(n[1]);return e&&JSON.parse(e)},pp=()=>{try{return ux()||lx()||hx()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},mw=()=>{var n;return(n=pp())===null||n===void 0?void 0:n.config},dx=n=>{var e;return(e=pp())===null||e===void 0?void 0:e[`_${n}`]};class fx{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function px(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n),l="";return[Zu(JSON.stringify(t)),Zu(JSON.stringify(a)),l].join(".")}function Ue(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gx(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ue())}function gp(){var n;const e=(n=pp())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function mx(){return typeof self=="object"&&self.self===self}function _w(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function mp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yw(){const n=Ue();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function _x(){return!gp()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Aa(){try{return typeof indexedDB=="object"}catch{return!1}}function yx(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}const vx="FirebaseError";class xt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=vx,Object.setPrototypeOf(this,xt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qi.prototype.create)}}class Qi{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?Ix(s,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new xt(i,l,r)}}function Ix(n,e){return n.replace(wx,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const wx=/\{\$([^}]+)}/g;function Xy(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ex(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function yf(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(Zy(s)&&Zy(a)){if(!yf(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Zy(n){return n!==null&&typeof n=="object"}function uo(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ls(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function oa(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function vw(n,e){const t=new Tx(n,e);return t.subscribe.bind(t)}class Tx{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Ax(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Kd),i.error===void 0&&(i.error=Kd),i.complete===void 0&&(i.complete=Kd);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ax(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Kd(){}function H(n){return n&&n._delegate?n._delegate:n}class Gn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const yi="[DEFAULT]";class Rx{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new fx;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(bx(e))try{this.getOrInitializeService({instanceIdentifier:yi})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=yi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=yi){return this.instances.has(e)}getOptions(e=yi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&a.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Sx(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=yi){return this.component?this.component.multipleInstances?e:yi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Sx(n){return n===yi?void 0:n}function bx(n){return n.instantiationMode==="EAGER"}class Px{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Rx(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const _p=[];var ue;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ue||(ue={}));const Iw={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},Cx=ue.INFO,Dx={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},kx=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=Dx[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Cl{constructor(e){this.name=e,this._logLevel=Cx,this._logHandler=kx,this._userLogHandler=null,_p.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Iw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...e),this._logHandler(this,ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...e),this._logHandler(this,ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ue.INFO,...e),this._logHandler(this,ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ue.WARN,...e),this._logHandler(this,ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...e),this._logHandler(this,ue.ERROR,...e)}}function xx(n){_p.forEach(e=>{e.setLogLevel(n)})}function Nx(n,e){for(const t of _p){let r=null;e&&e.level&&(r=Iw[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...a)=>{const l=a.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");s>=(r??i.logLevel)&&n({level:ue[s].toLowerCase(),message:l,args:a,type:i.name})}}}const Vx=(n,e)=>e.some(t=>n instanceof t);let ev,tv;function Ox(){return ev||(ev=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Lx(){return tv||(tv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ww=new WeakMap,vf=new WeakMap,Ew=new WeakMap,Hd=new WeakMap,yp=new WeakMap;function Mx(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Fr(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&ww.set(t,n)}).catch(()=>{}),yp.set(e,n),e}function Fx(n){if(vf.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});vf.set(n,e)}let If={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return vf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ew.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Ux(n){If=n(If)}function Bx(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(jd(this),e,...t);return Ew.set(r,e.sort?e.sort():[e]),Fr(r)}:Lx().includes(n)?function(...e){return n.apply(jd(this),e),Fr(ww.get(this))}:function(...e){return Fr(n.apply(jd(this),e))}}function qx(n){return typeof n=="function"?Bx(n):(n instanceof IDBTransaction&&Fx(n),Vx(n,Ox())?new Proxy(n,If):n)}function Fr(n){if(n instanceof IDBRequest)return Mx(n);if(Hd.has(n))return Hd.get(n);const e=qx(n);return e!==n&&(Hd.set(n,e),yp.set(e,n)),e}const jd=n=>yp.get(n);function $x(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),l=Fr(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Fr(a.result),h.oldVersion,h.newVersion,Fr(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),l.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const Wx=["get","getKey","getAll","getAllKeys","count"],Gx=["put","add","delete","clear"],Qd=new Map;function nv(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Qd.get(e))return Qd.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=Gx.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Wx.includes(t)))return;const s=async function(a,...l){const h=this.transaction(a,i?"readwrite":"readonly");let f=h.store;return r&&(f=f.index(l.shift())),(await Promise.all([f[t](...l),i&&h.done]))[0]};return Qd.set(e,s),s}Ux(n=>({...n,get:(e,t,r)=>nv(e,t)||n.get(e,t,r),has:(e,t)=>!!nv(e,t)||n.has(e,t)}));class zx{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Kx(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Kx(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const wf="@firebase/app",rv="0.9.25";const Oi=new Cl("@firebase/app"),Hx="@firebase/app-compat",jx="@firebase/analytics-compat",Qx="@firebase/analytics",Yx="@firebase/app-check-compat",Jx="@firebase/app-check",Xx="@firebase/auth",Zx="@firebase/auth-compat",eN="@firebase/database",tN="@firebase/database-compat",nN="@firebase/functions",rN="@firebase/functions-compat",iN="@firebase/installations",sN="@firebase/installations-compat",oN="@firebase/messaging",aN="@firebase/messaging-compat",cN="@firebase/performance",uN="@firebase/performance-compat",lN="@firebase/remote-config",hN="@firebase/remote-config-compat",dN="@firebase/storage",fN="@firebase/storage-compat",pN="@firebase/firestore",gN="@firebase/firestore-compat",mN="firebase",_N="10.7.1";const Ur="[DEFAULT]",yN={[wf]:"fire-core",[Hx]:"fire-core-compat",[Qx]:"fire-analytics",[jx]:"fire-analytics-compat",[Jx]:"fire-app-check",[Yx]:"fire-app-check-compat",[Xx]:"fire-auth",[Zx]:"fire-auth-compat",[eN]:"fire-rtdb",[tN]:"fire-rtdb-compat",[nN]:"fire-fn",[rN]:"fire-fn-compat",[iN]:"fire-iid",[sN]:"fire-iid-compat",[oN]:"fire-fcm",[aN]:"fire-fcm-compat",[cN]:"fire-perf",[uN]:"fire-perf-compat",[lN]:"fire-rc",[hN]:"fire-rc-compat",[dN]:"fire-gcs",[fN]:"fire-gcs-compat",[pN]:"fire-fst",[gN]:"fire-fst-compat","fire-js":"fire-js",[mN]:"fire-js-all"};const Br=new Map,Ra=new Map;function tl(n,e){try{n.container.addComponent(e)}catch(t){Oi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Tw(n,e){n.container.addOrOverwriteComponent(e)}function qr(n){const e=n.name;if(Ra.has(e))return Oi.debug(`There were multiple attempts to register component ${e}.`),!1;Ra.set(e,n);for(const t of Br.values())tl(t,n);return!0}function Aw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function vN(n,e,t=Ur){Aw(n,e).clearInstance(t)}function IN(){Ra.clear()}const wN={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},cr=new Qi("app","Firebase",wN);let EN=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Gn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cr.create("app-deleted",{appName:this._name})}};const Zr=_N;function vp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Ur,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw cr.create("bad-app-name",{appName:String(i)});if(t||(t=mw()),!t)throw cr.create("no-options");const s=Br.get(i);if(s){if(yf(t,s.options)&&yf(r,s.config))return s;throw cr.create("duplicate-app",{appName:i})}const a=new Px(i);for(const h of Ra.values())a.addComponent(h);const l=new EN(t,r,a);return Br.set(i,l),l}function TN(n=Ur){const e=Br.get(n);if(!e&&n===Ur&&mw())return vp();if(!e)throw cr.create("no-app",{appName:n});return e}function AN(){return Array.from(Br.values())}async function Rw(n){const e=n.name;Br.has(e)&&(Br.delete(e),await Promise.all(n.container.getProviders().map(t=>t.delete())),n.isDeleted=!0)}function Bn(n,e,t){var r;let i=(r=yN[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Oi.warn(l.join(" "));return}qr(new Gn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function Sw(n,e){if(n!==null&&typeof n!="function")throw cr.create("invalid-log-argument");Nx(n,e)}function bw(n){xx(n)}const RN="firebase-heartbeat-database",SN=1,Sa="firebase-heartbeat-store";let Yd=null;function Pw(){return Yd||(Yd=$x(RN,SN,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Sa)}}}).catch(n=>{throw cr.create("idb-open",{originalErrorMessage:n.message})})),Yd}async function bN(n){try{return await(await Pw()).transaction(Sa).objectStore(Sa).get(Cw(n))}catch(e){if(e instanceof xt)Oi.warn(e.message);else{const t=cr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Oi.warn(t.message)}}}async function iv(n,e){try{const r=(await Pw()).transaction(Sa,"readwrite");await r.objectStore(Sa).put(e,Cw(n)),await r.done}catch(t){if(t instanceof xt)Oi.warn(t.message);else{const r=cr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Oi.warn(r.message)}}}function Cw(n){return`${n.name}!${n.options.appId}`}const PN=1024,CN=30*24*60*60*1e3;class DN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new xN(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=sv();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=CN}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=sv(),{heartbeatsToSend:r,unsentEntries:i}=kN(this._heartbeatsCache.heartbeats),s=Zu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function sv(){return new Date().toISOString().substring(0,10)}function kN(n,e=PN){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),ov(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),ov(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class xN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Aa()?yx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await bN(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return iv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return iv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ov(n){return Zu(JSON.stringify({version:2,heartbeats:n})).length}function NN(n){qr(new Gn("platform-logger",e=>new zx(e),"PRIVATE")),qr(new Gn("heartbeat",e=>new DN(e),"PRIVATE")),Bn(wf,rv,n),Bn(wf,rv,"esm2017"),Bn("fire-js","")}NN("");const VN=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:Zr,_DEFAULT_ENTRY_NAME:Ur,_addComponent:tl,_addOrOverwriteComponent:Tw,_apps:Br,_clearComponents:IN,_components:Ra,_getProvider:Aw,_registerComponent:qr,_removeServiceInstance:vN,deleteApp:Rw,getApp:TN,getApps:AN,initializeApp:vp,onLog:Sw,registerVersion:Bn,setLogLevel:bw,FirebaseError:xt},Symbol.toStringTag,{value:"Module"}));class ON{constructor(e,t){this._delegate=e,this.firebase=t,tl(e,new Gn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Rw(this._delegate)))}_getService(e,t=Ur){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=Ur){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){tl(this._delegate,e)}_addOrOverwriteComponent(e){Tw(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const LN={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},av=new Qi("app-compat","Firebase",LN);function MN(n){const e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Bn,setLogLevel:bw,onLog:Sw,apps:null,SDK_VERSION:Zr,INTERNAL:{registerComponent:l,removeApp:r,useAsService:h,modularAPIs:VN}};t.default=t,Object.defineProperty(t,"apps",{get:a});function r(f){delete e[f]}function i(f){if(f=f||Ur,!Xy(e,f))throw av.create("no-app",{appName:f});return e[f]}i.App=n;function s(f,p={}){const m=vp(f,p);if(Xy(e,m.name))return e[m.name];const I=new n(m,t);return e[m.name]=I,I}function a(){return Object.keys(e).map(f=>e[f])}function l(f){const p=f.name,m=p.replace("-compat","");if(qr(f)&&f.type==="PUBLIC"){const I=(A=i())=>{if(typeof A[m]!="function")throw av.create("invalid-app-argument",{appName:p});return A[m]()};f.serviceProps!==void 0&&el(I,f.serviceProps),t[m]=I,n.prototype[m]=function(...A){return this._getService.bind(this,p).apply(this,f.multipleInstances?A:[])}}return f.type==="PUBLIC"?t[m]:null}function h(f,p){return p==="serverAuth"?null:p}return t}function Dw(){const n=MN(ON);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:Dw,extendNamespace:e,createSubscribe:vw,ErrorFactory:Qi,deepExtend:el});function e(t){el(n,t)}return n}const FN=Dw();const cv=new Cl("@firebase/app-compat"),UN="@firebase/app-compat",BN="0.2.25";function qN(n){Bn(UN,BN,n)}if(mx()&&self.firebase!==void 0){cv.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&cv.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const $r=FN;qN();var $N="firebase",WN="10.7.1";$r.registerVersion($N,WN,"app-compat");function Ip(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}const Ho={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},ws={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function GN(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is incorrect, malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-password"]:"A non-empty password must be provided",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.",["missing-recaptcha-token"]:"The reCAPTCHA token is missing when sending request to the backend.",["invalid-recaptcha-token"]:"The reCAPTCHA token is invalid when sending request to the backend.",["invalid-recaptcha-action"]:"The reCAPTCHA action is invalid when sending request to the backend.",["recaptcha-not-enabled"]:"reCAPTCHA Enterprise integration is not enabled for this project.",["missing-client-type"]:"The reCAPTCHA client type is missing when sending request to the backend.",["missing-recaptcha-version"]:"The reCAPTCHA version is missing when sending request to the backend.",["invalid-req-type"]:"Invalid request parameters.",["invalid-recaptcha-version"]:"The reCAPTCHA version is invalid when sending request to the backend.",["unsupported-password-policy-schema-version"]:"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.",["password-does-not-meet-requirements"]:"The password does not meet the requirements."}}function kw(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const zN=GN,KN=kw,xw=new Qi("auth","Firebase",kw());const nl=new Cl("@firebase/auth");function HN(n,...e){nl.logLevel<=ue.WARN&&nl.warn(`Auth (${Zr}): ${n}`,...e)}function qu(n,...e){nl.logLevel<=ue.ERROR&&nl.error(`Auth (${Zr}): ${n}`,...e)}function vt(n,...e){throw wp(n,...e)}function _t(n,...e){return wp(n,...e)}function Nw(n,e,t){const r=Object.assign(Object.assign({},KN()),{[e]:t});return new Qi("auth","Firebase",r).create(e,{appName:n.name})}function lo(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&vt(n,"argument-error"),Nw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function wp(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return xw.create(n,...e)}function O(n,e,...t){if(!n)throw wp(e,...t)}function On(n){const e="INTERNAL ASSERTION FAILED: "+n;throw qu(e),new Error(e)}function wn(n,e){n||On(e)}function ba(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Ep(){return uv()==="http:"||uv()==="https:"}function uv(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function jN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ep()||_w()||"connection"in navigator)?navigator.onLine:!0}function QN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class oc{constructor(e,t){this.shortDelay=e,this.longDelay=t,wn(t>e,"Short delay should be less than long delay!"),this.isMobile=gx()||mp()}get(){return jN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Tp(n,e){wn(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Vw{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;On("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;On("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;On("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const YN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const JN=new oc(3e4,6e4);function He(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function je(n,e,t,r,i={}){return Ow(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const l=uo(Object.assign({key:n.config.apiKey},a)).slice(1),h=await n._getAdditionalHeaders();return h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode),Vw.fetch()(Lw(n,n.config.apiHost,t,l),Object.assign({method:e,headers:h,referrerPolicy:"no-referrer"},s))})}async function Ow(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},YN),e);try{const i=new ZN(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw aa(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const l=s.ok?a.errorMessage:a.error.message,[h,f]=l.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw aa(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw aa(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw aa(n,"user-disabled",a);const p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw Nw(n,p,f);vt(n,p)}}catch(i){if(i instanceof xt)throw i;vt(n,"network-request-failed",{message:String(i)})}}async function pr(n,e,t,r,i={}){const s=await je(n,e,t,r,i);return"mfaPendingCredential"in s&&vt(n,"multi-factor-auth-required",{_serverResponse:s}),s}function Lw(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?Tp(n.config,i):`${n.config.apiScheme}://${i}`}function XN(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ZN{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(_t(this.auth,"network-request-failed")),JN.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function aa(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=_t(n,e,r);return i.customData._tokenResponse=t,i}function lv(n){return n!==void 0&&n.getResponse!==void 0}function hv(n){return n!==void 0&&n.enterprise!==void 0}class eV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return XN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function tV(n){return(await je(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function nV(n,e){return je(n,"GET","/v2/recaptchaConfig",He(n,e))}async function rV(n,e){return je(n,"POST","/v1/accounts:delete",e)}async function iV(n,e){return je(n,"POST","/v1/accounts:update",e)}async function sV(n,e){return je(n,"POST","/v1/accounts:lookup",e)}function pa(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oV(n,e=!1){const t=H(n),r=await t.getIdToken(e),i=Dl(r);O(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:pa(Jd(i.auth_time)),issuedAtTime:pa(Jd(i.iat)),expirationTime:pa(Jd(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Jd(n){return Number(n)*1e3}function Dl(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return qu("JWT malformed, contained fewer than 3 sections"),null;try{const i=gw(t);return i?JSON.parse(i):(qu("Failed to decode base64 JWT payload"),null)}catch(i){return qu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function aV(n){const e=Dl(n);return O(e,"internal-error"),O(typeof e.exp<"u","internal-error"),O(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function hr(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof xt&&cV(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function cV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class uV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Mw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=pa(this.lastLoginAt),this.creationTime=pa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Pa(n){var e;const t=n.auth,r=await n.getIdToken(),i=await hr(n,sV(t,{idToken:r}));O(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?dV(s.providerUserInfo):[],l=hV(n.providerData,a),h=n.isAnonymous,f=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=h?f:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Mw(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)}async function lV(n){const e=H(n);await Pa(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hV(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function dV(n){return n.map(e=>{var{providerId:t}=e,r=Ip(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function fV(n,e){const t=await Ow(n,{},async()=>{const r=uo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=Lw(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",Vw.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function pV(n,e){return je(n,"POST","/v2/accounts:revokeToken",He(n,e))}class Ca{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){O(e.idToken,"internal-error"),O(typeof e.idToken<"u","internal-error"),O(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):aV(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return O(!this.accessToken||this.refreshToken,e,"user-token-expired"),!t&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await fV(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new Ca;return r&&(O(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(O(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(O(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ca,this.toJSON())}_performRefresh(){return On("not implemented")}}function Cr(n,e){O(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Di{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Ip(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new uV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Mw(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await hr(this,this.stsTokenManager.getToken(this.auth,e));return O(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return oV(this,e)}reload(){return lV(this)}_assign(e){this!==e&&(O(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Di(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){O(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Pa(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await hr(this,rV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,l,h,f,p;const m=(r=t.displayName)!==null&&r!==void 0?r:void 0,I=(i=t.email)!==null&&i!==void 0?i:void 0,A=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,L=(a=t.photoURL)!==null&&a!==void 0?a:void 0,M=(l=t.tenantId)!==null&&l!==void 0?l:void 0,V=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,Y=(f=t.createdAt)!==null&&f!==void 0?f:void 0,ae=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:j,emailVerified:ye,isAnonymous:de,providerData:me,stsTokenManager:we}=t;O(j&&we,e,"internal-error");const Ot=Ca.fromJSON(this.name,we);O(typeof j=="string",e,"internal-error"),Cr(m,e.name),Cr(I,e.name),O(typeof ye=="boolean",e,"internal-error"),O(typeof de=="boolean",e,"internal-error"),Cr(A,e.name),Cr(L,e.name),Cr(M,e.name),Cr(V,e.name),Cr(Y,e.name),Cr(ae,e.name);const jn=new Di({uid:j,auth:e,email:I,emailVerified:ye,displayName:m,isAnonymous:de,photoURL:L,phoneNumber:A,tenantId:M,stsTokenManager:Ot,createdAt:Y,lastLoginAt:ae});return me&&Array.isArray(me)&&(jn.providerData=me.map(is=>Object.assign({},is))),V&&(jn._redirectEventId=V),jn}static async _fromIdTokenResponse(e,t,r=!1){const i=new Ca;i.updateFromServerResponse(t);const s=new Di({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Pa(s),s}}const dv=new Map;function Xt(n){wn(n instanceof Function,"Expected a class definition");let e=dv.get(n);return e?(wn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,dv.set(n,e),e)}class Fw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Fw.type="NONE";const js=Fw;function ki(n,e,t){return`firebase:${n}:${e}:${t}`}class Fs{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=ki(this.userKey,i.apiKey,s),this.fullPersistenceKey=ki("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Di._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Fs(Xt(js),e,r);const i=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let s=i[0]||Xt(js);const a=ki(r,e.config.apiKey,e.name);let l=null;for(const f of t)try{const p=await f._get(a);if(p){const m=Di._fromJSON(e,p);f!==s&&(l=m),s=f;break}}catch{}const h=i.filter(f=>f._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new Fs(s,e,r):(s=h[0],l&&await s._set(a,l.toJSON()),await Promise.all(t.map(async f=>{if(f!==s)try{await f._remove(a)}catch{}})),new Fs(s,e,r))}}function fv(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(qw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Uw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($w(e))return"Blackberry";if(Ww(e))return"Webos";if(Ap(e))return"Safari";if((e.includes("chrome/")||Bw(e))&&!e.includes("edge/"))return"Chrome";if(ac(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Uw(n=Ue()){return/firefox\//i.test(n)}function Ap(n=Ue()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Bw(n=Ue()){return/crios\//i.test(n)}function qw(n=Ue()){return/iemobile/i.test(n)}function ac(n=Ue()){return/android/i.test(n)}function $w(n=Ue()){return/blackberry/i.test(n)}function Ww(n=Ue()){return/webos/i.test(n)}function ho(n=Ue()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function gV(n=Ue()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function mV(n=Ue()){var e;return ho(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _V(){return yw()&&document.documentMode===10}function Gw(n=Ue()){return ho(n)||ac(n)||Ww(n)||$w(n)||/windows phone/i.test(n)||qw(n)}function yV(){try{return!!(window&&window!==window.top)}catch{return!1}}function zw(n,e=[]){let t;switch(n){case"Browser":t=fv(Ue());break;case"Worker":t=`${fv(Ue())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Zr}/${r}`}class vV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,l)=>{try{const h=e(s);a(h)}catch(h){l(h)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}async function IV(n,e={}){return je(n,"GET","/v2/passwordPolicy",He(n,e))}const wV=6;class EV{constructor(e){var t,r,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:wV,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,l;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(l=h.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),h}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class TV{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pv(this),this.idTokenSubscription=new pv(this),this.beforeStateQueue=new vV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Xt(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Fs.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===l)&&(h!=null&&h.user)&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return O(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Pa(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=QN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?H(e):null;return t&&O(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&O(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Xt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await IV(this),t=new EV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Qi("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await pV(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Xt(e)||this._popupRedirectResolver;O(t,this,"argument-error"),this.redirectPersistenceManager=await Fs.create(this,[Xt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(O(l,this,"internal-error"),l.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{const h=e.addObserver(t);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return O(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&HN(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Ge(n){return H(n)}class pv{constructor(e){this.auth=e,this.observer=null,this.addObserver=vw(t=>this.observer=t)}get next(){return O(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function AV(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}function Rp(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=_t("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",AV().appendChild(r)})}function Kw(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const RV="https://www.google.com/recaptcha/enterprise.js?render=",SV="recaptcha-enterprise",bV="NO_RECAPTCHA";class PV{constructor(e){this.type=SV,this.auth=Ge(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,l)=>{nV(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const f=new eV(h);return s.tenantId==null?s._agentRecaptchaConfig=f:s._tenantRecaptchaConfigs[s.tenantId]=f,a(f.siteKey)}}).catch(h=>{l(h)})})}function i(s,a,l){const h=window.grecaptcha;hv(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(f=>{a(f)}).catch(()=>{a(bV)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(l=>{if(!t&&hv(window.grecaptcha))i(l,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}Rp(RV+l).then(()=>{i(l,s,a)}).catch(h=>{a(h)})}}).catch(l=>{a(l)})})}}async function gv(n,e,t,r=!1){const i=new PV(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Da(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await gv(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await gv(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)})}function CV(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Xt);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function DV(n,e,t){const r=Ge(n);O(r._canInitEmulator,r,"emulator-config-failed"),O(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=Hw(e),{host:a,port:l}=kV(e),h=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||xV()}function Hw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function kV(n){const e=Hw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:mv(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:mv(a)}}}function mv(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function xV(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class fo{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return On("not implemented")}_getIdTokenResponse(e){return On("not implemented")}_linkToIdToken(e,t){return On("not implemented")}_getReauthenticationResolver(e){return On("not implemented")}}async function jw(n,e){return je(n,"POST","/v1/accounts:resetPassword",He(n,e))}async function NV(n,e){return je(n,"POST","/v1/accounts:update",e)}async function VV(n,e){return je(n,"POST","/v1/accounts:signUp",e)}async function OV(n,e){return je(n,"POST","/v1/accounts:update",He(n,e))}async function LV(n,e){return pr(n,"POST","/v1/accounts:signInWithPassword",He(n,e))}async function kl(n,e){return je(n,"POST","/v1/accounts:sendOobCode",He(n,e))}async function MV(n,e){return kl(n,e)}async function FV(n,e){return kl(n,e)}async function UV(n,e){return kl(n,e)}async function BV(n,e){return kl(n,e)}async function qV(n,e){return pr(n,"POST","/v1/accounts:signInWithEmailLink",He(n,e))}async function $V(n,e){return pr(n,"POST","/v1/accounts:signInWithEmailLink",He(n,e))}class ka extends fo{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new ka(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new ka(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Da(e,t,"signInWithPassword",LV);case"emailLink":return qV(e,{email:this._email,oobCode:this._password});default:vt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Da(e,r,"signUpPassword",VV);case"emailLink":return $V(e,{idToken:t,email:this._email,oobCode:this._password});default:vt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ur(n,e){return pr(n,"POST","/v1/accounts:signInWithIdp",He(n,e))}const WV="http://localhost";class zn extends fo{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new zn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):vt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Ip(t,["providerId","signInMethod"]);if(!r||!i)return null;const a=new zn(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return ur(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ur(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ur(e,t)}buildRequest(){const e={requestUri:WV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=uo(t)}return e}}async function GV(n,e){return je(n,"POST","/v1/accounts:sendVerificationCode",He(n,e))}async function zV(n,e){return pr(n,"POST","/v1/accounts:signInWithPhoneNumber",He(n,e))}async function KV(n,e){const t=await pr(n,"POST","/v1/accounts:signInWithPhoneNumber",He(n,e));if(t.temporaryProof)throw aa(n,"account-exists-with-different-credential",t);return t}const HV={USER_NOT_FOUND:"user-not-found"};async function jV(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return pr(n,"POST","/v1/accounts:signInWithPhoneNumber",He(n,t),HV)}class xi extends fo{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new xi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new xi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return zV(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return KV(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return jV(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new xi({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}}function QV(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function YV(n){const e=Ls(oa(n)).link,t=e?Ls(oa(e)).deep_link_id:null,r=Ls(oa(n)).deep_link_id;return(r?Ls(oa(r)).link:null)||r||t||e||n}class xl{constructor(e){var t,r,i,s,a,l;const h=Ls(oa(e)),f=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,m=QV((i=h.mode)!==null&&i!==void 0?i:null);O(f&&p&&m,"argument-error"),this.apiKey=f,this.operation=m,this.code=p,this.continueUrl=(s=h.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(l=h.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=YV(e);try{return new xl(t)}catch{return null}}}class ei{constructor(){this.providerId=ei.PROVIDER_ID}static credential(e,t){return ka._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=xl.parseLink(t);return O(r,"argument-error"),ka._fromEmailAndCode(e,r.code,r.tenantId)}}ei.PROVIDER_ID="password";ei.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ei.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class gr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class po extends gr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Us extends po{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return O("providerId"in t&&"signInMethod"in t,"argument-error"),zn._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return O(e.idToken||e.accessToken,"argument-error"),zn._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Us.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Us.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:a,providerId:l}=e;if(!r&&!i&&!t&&!s||!l)return null;try{return new Us(l)._credential({idToken:t,accessToken:r,nonce:a,pendingToken:s})}catch{return null}}}class Dn extends po{constructor(){super("facebook.com")}static credential(e){return zn._fromParams({providerId:Dn.PROVIDER_ID,signInMethod:Dn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Dn.credentialFromTaggedObject(e)}static credentialFromError(e){return Dn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Dn.credential(e.oauthAccessToken)}catch{return null}}}Dn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Dn.PROVIDER_ID="facebook.com";class kn extends po{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return zn._fromParams({providerId:kn.PROVIDER_ID,signInMethod:kn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return kn.credentialFromTaggedObject(e)}static credentialFromError(e){return kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return kn.credential(t,r)}catch{return null}}}kn.GOOGLE_SIGN_IN_METHOD="google.com";kn.PROVIDER_ID="google.com";class xn extends po{constructor(){super("github.com")}static credential(e){return zn._fromParams({providerId:xn.PROVIDER_ID,signInMethod:xn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xn.credentialFromTaggedObject(e)}static credentialFromError(e){return xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xn.credential(e.oauthAccessToken)}catch{return null}}}xn.GITHUB_SIGN_IN_METHOD="github.com";xn.PROVIDER_ID="github.com";const JV="http://localhost";class Qs extends fo{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return ur(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ur(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ur(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new Qs(r,s)}static _create(e,t){return new Qs(e,t)}buildRequest(){return{requestUri:JV,returnSecureToken:!0,pendingToken:this.pendingToken}}}const XV="saml.";class rl extends gr{constructor(e){O(e.startsWith(XV),"argument-error"),super(e)}static credentialFromResult(e){return rl.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return rl.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Qs.fromJSON(e);return O(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Qs._create(r,t)}catch{return null}}}class Nn extends po{constructor(){super("twitter.com")}static credential(e,t){return zn._fromParams({providerId:Nn.PROVIDER_ID,signInMethod:Nn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Nn.credentialFromTaggedObject(e)}static credentialFromError(e){return Nn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Nn.credential(t,r)}catch{return null}}}Nn.TWITTER_SIGN_IN_METHOD="twitter.com";Nn.PROVIDER_ID="twitter.com";async function Qw(n,e){return pr(n,"POST","/v1/accounts:signUp",He(n,e))}class dn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Di._fromIdTokenResponse(e,r,i),a=_v(r);return new dn({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=_v(r);return new dn({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function _v(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function ZV(n){var e;const t=Ge(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new dn({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await Qw(t,{returnSecureToken:!0}),i=await dn._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(i.user),i}class il extends xt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,il.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new il(e,t,r,i)}}function Yw(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?il._fromErrorAndOperation(n,s,e,r):s})}function Jw(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}async function eO(n,e){const t=H(n);await Nl(!0,t,e);const{providerUserInfo:r}=await iV(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=Jw(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Sp(n,e,t=!1){const r=await hr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return dn._forOperation(n,"link",r)}async function Nl(n,e,t){await Pa(e);const r=Jw(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";O(r.has(t)===n,e.auth,i)}async function Xw(n,e,t=!1){const{auth:r}=n,i="reauthenticate";try{const s=await hr(n,Yw(r,i,e,n),t);O(s.idToken,r,"internal-error");const a=Dl(s.idToken);O(a,r,"internal-error");const{sub:l}=a;return O(n.uid===l,r,"user-mismatch"),dn._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&vt(r,"user-mismatch"),s}}async function Zw(n,e,t=!1){const r="signIn",i=await Yw(n,r,e),s=await dn._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function Vl(n,e){return Zw(Ge(n),e)}async function eE(n,e){const t=H(n);return await Nl(!1,t,e.providerId),Sp(t,e)}async function tE(n,e){return Xw(H(n),e)}async function tO(n,e){return pr(n,"POST","/v1/accounts:signInWithCustomToken",He(n,e))}async function nO(n,e){const t=Ge(n),r=await tO(t,{token:e,returnSecureToken:!0}),i=await dn._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}class cc{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?bp._fromServerResponse(e,t):"totpInfo"in t?Pp._fromServerResponse(e,t):vt(e,"internal-error")}}class bp extends cc{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new bp(t)}}class Pp extends cc{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Pp(t)}}function Ol(n,e,t){var r;O(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),O(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(O(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(O(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function Cp(n){const e=Ge(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function rO(n,e,t){const r=Ge(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Ol(r,i,t),await Da(r,i,"getOobCode",FV)}async function iO(n,e,t){await jw(H(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Cp(n),r})}async function sO(n,e){await OV(H(n),{oobCode:e})}async function nE(n,e){const t=H(n),r=await jw(t,{oobCode:e}),i=r.requestType;switch(O(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":O(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":O(r.mfaInfo,t,"internal-error");default:O(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=cc._fromServerResponse(Ge(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function oO(n,e){const{data:t}=await nE(H(n),e);return t.email}async function aO(n,e,t){const r=Ge(n),a=await Da(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Qw).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&Cp(n),h}),l=await dn._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function cO(n,e,t){return Vl(H(n),ei.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Cp(n),r})}async function uO(n,e,t){const r=Ge(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(a,l){O(l.handleCodeInApp,r,"argument-error"),l&&Ol(r,a,l)}s(i,t),await Da(r,i,"getOobCode",UV)}function lO(n,e){const t=xl.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function hO(n,e,t){const r=H(n),i=ei.credentialWithLink(e,t||ba());return O(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Vl(r,i)}async function dO(n,e){return je(n,"POST","/v1/accounts:createAuthUri",He(n,e))}async function fO(n,e){const t=Ep()?ba():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await dO(H(n),r);return i||[]}async function pO(n,e){const t=H(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Ol(t.auth,i,e);const{email:s}=await MV(t.auth,i);s!==n.email&&await n.reload()}async function gO(n,e,t){const r=H(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Ol(r.auth,s,t);const{email:a}=await BV(r.auth,s);a!==n.email&&await n.reload()}async function mO(n,e){return je(n,"POST","/v1/accounts:update",e)}async function _O(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=H(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},a=await hr(r,mO(r.auth,s));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const l=r.providerData.find(({providerId:h})=>h==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function yO(n,e){return rE(H(n),e,null)}function vO(n,e){return rE(H(n),null,e)}async function rE(n,e,t){const{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);const a=await hr(n,NV(r,s));await n._updateTokensIfNecessary(a,!0)}function IO(n){var e,t;if(!n)return null;const{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const a=(t=(e=Dl(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(a){const l=a!=="anonymous"&&a!=="custom"?a:null;return new Bs(s,l)}}if(!r)return null;switch(r){case"facebook.com":return new wO(s,i);case"github.com":return new EO(s,i);case"google.com":return new TO(s,i);case"twitter.com":return new AO(s,i,n.screenName||null);case"custom":case"anonymous":return new Bs(s,null);default:return new Bs(s,r,i)}}class Bs{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class iE extends Bs{constructor(e,t,r,i){super(e,t,r),this.username=i}}class wO extends Bs{constructor(e,t){super(e,"facebook.com",t)}}class EO extends iE{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class TO extends Bs{constructor(e,t){super(e,"google.com",t)}}class AO extends iE{constructor(e,t,r){super(e,"twitter.com",t,r)}}function RO(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:IO(t)}class Ri{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new Ri("enroll",e,t)}static _fromMfaPendingCredential(e){return new Ri("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return Ri._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Ri._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Dp{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Ge(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(l=>cc._fromServerResponse(r,l));O(i.mfaPendingCredential,r,"internal-error");const a=Ri._fromMfaPendingCredential(i.mfaPendingCredential);return new Dp(a,s,async l=>{const h=await l._process(r,a);delete i.mfaInfo,delete i.mfaPendingCredential;const f=Object.assign(Object.assign({},i),{idToken:h.idToken,refreshToken:h.refreshToken});switch(t.operationType){case"signIn":const p=await dn._fromIdTokenResponse(r,t.operationType,f);return await r._updateCurrentUser(p.user),p;case"reauthenticate":return O(t.user,r,"internal-error"),dn._forOperation(t.user,t.operationType,f);default:vt(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function SO(n,e){var t;const r=H(n),i=e;return O(e.customData.operationType,r,"argument-error"),O((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),Dp._fromError(r,i)}function bO(n,e){return je(n,"POST","/v2/accounts/mfaEnrollment:start",He(n,e))}function PO(n,e){return je(n,"POST","/v2/accounts/mfaEnrollment:finalize",He(n,e))}function CO(n,e){return je(n,"POST","/v2/accounts/mfaEnrollment:withdraw",He(n,e))}class kp{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>cc._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new kp(e)}async getSession(){return Ri._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),s=await hr(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await hr(this.user,CO(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Xd=new WeakMap;function DO(n){const e=H(n);return Xd.has(e)||Xd.set(e,kp._fromUser(e)),Xd.get(e)}const sl="__sak";class sE{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(sl,"1"),this.storage.removeItem(sl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}function kO(){const n=Ue();return Ap(n)||ho(n)}const xO=1e3,NO=10;class oE extends sE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=kO()&&yV(),this.fallbackToPolling=Gw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,l,h)=>{this.notifyListeners(a,h)});return}const r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(r);if(e.newValue!==a)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);_V()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,NO):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},xO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}oE.type="LOCAL";const xp=oE;class aE extends sE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}aE.type="SESSION";const Li=aE;function VO(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Ll{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Ll(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(a).map(async f=>f(t.origin,s)),h=await VO(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ll.receivers=[];function uc(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class OO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((l,h)=>{const f=uc("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(m){const I=m;if(I.data.eventId===f)switch(I.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(I.data.response);break;default:clearTimeout(p),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function et(){return window}function LO(n){et().location.href=n}function Np(){return typeof et().WorkerGlobalScope<"u"&&typeof et().importScripts=="function"}async function MO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function FO(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function UO(){return Np()?self:null}const cE="firebaseLocalStorageDb",BO=1,ol="firebaseLocalStorage",uE="fbase_key";class lc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ml(n,e){return n.transaction([ol],e?"readwrite":"readonly").objectStore(ol)}function qO(){const n=indexedDB.deleteDatabase(cE);return new lc(n).toPromise()}function Ef(){const n=indexedDB.open(cE,BO);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(ol,{keyPath:uE})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(ol)?e(r):(r.close(),await qO(),e(await Ef()))})})}async function yv(n,e,t){const r=Ml(n,!0).put({[uE]:e,value:t});return new lc(r).toPromise()}async function $O(n,e){const t=Ml(n,!1).get(e),r=await new lc(t).toPromise();return r===void 0?null:r.value}function vv(n,e){const t=Ml(n,!0).delete(e);return new lc(t).toPromise()}const WO=800,GO=3;class lE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ef(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>GO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Np()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ll._getInstance(UO()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await MO(),!this.activeServiceWorker)return;this.sender=new OO(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||FO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ef();return await yv(e,sl,"1"),await vv(e,sl),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>yv(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>$O(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>vv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Ml(i,!1).getAll();return new lc(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),WO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}lE.type="LOCAL";const xa=lE;function zO(n,e){return je(n,"POST","/v2/accounts/mfaSignIn:start",He(n,e))}function KO(n,e){return je(n,"POST","/v2/accounts/mfaSignIn:finalize",He(n,e))}const HO=500,jO=6e4,Su=1e12;class QO{constructor(e){this.auth=e,this.counter=Su,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new YO(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||Su;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||Su;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||Su;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class YO{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;O(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=JO(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},jO)},HO))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function JO(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const Zd=Kw("rcb"),XO=new oc(3e4,6e4),ZO="https://www.google.com/recaptcha/api.js?";class eL{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=et().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return O(tL(t),e,"argument-error"),this.shouldResolveImmediately(t)&&lv(et().grecaptcha)?Promise.resolve(et().grecaptcha):new Promise((r,i)=>{const s=et().setTimeout(()=>{i(_t(e,"network-request-failed"))},XO.get());et()[Zd]=()=>{et().clearTimeout(s),delete et()[Zd];const l=et().grecaptcha;if(!l||!lv(l)){i(_t(e,"internal-error"));return}const h=l.render;l.render=(f,p)=>{const m=h(f,p);return this.counter++,m},this.hostLanguage=t,r(l)};const a=`${ZO}?${uo({onload:Zd,render:"explicit",hl:t})}`;Rp(a).catch(()=>{clearTimeout(s),i(_t(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=et().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function tL(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class nL{async load(e){return new QO(e)}clearedOneInstance(){}}const hE="recaptcha",rL={theme:"light",type:"image"};let iL=class{constructor(e,t,r=Object.assign({},rL)){this.parameters=r,this.type=hE,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ge(e),this.isInvisible=this.parameters.size==="invisible",O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;O(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new nL:new eL,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const s=a=>{a&&(this.tokenChangeListeners.delete(s),i(a))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){O(!this.parameters.sitekey,this.auth,"argument-error"),O(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=et()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){O(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){O(Ep()&&!Np(),this.auth,"internal-error"),await sL(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await tV(this.auth);O(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return O(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function sL(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}class Vp{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=xi._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function oL(n,e,t){const r=Ge(n),i=await Fl(r,e,H(t));return new Vp(i,s=>Vl(r,s))}async function aL(n,e,t){const r=H(n);await Nl(!1,r,"phone");const i=await Fl(r.auth,e,H(t));return new Vp(i,s=>eE(r,s))}async function cL(n,e,t){const r=H(n),i=await Fl(r.auth,e,H(t));return new Vp(i,s=>tE(r,s))}async function Fl(n,e,t){var r;const i=await t.verify();try{O(typeof i=="string",n,"argument-error"),O(t.type===hE,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const a=s.session;if("phoneNumber"in s)return O(a.type==="enroll",n,"internal-error"),(await bO(n,{idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{O(a.type==="signin",n,"internal-error");const l=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return O(l,n,"missing-multi-factor-info"),(await zO(n,{mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:a}=await GV(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return a}}finally{t._reset()}}async function uL(n,e){await Sp(H(n),e)}let qn=class{constructor(e){this.providerId=qn.PROVIDER_ID,this.auth=Ge(e)}verifyPhoneNumber(e,t){return Fl(this.auth,e,H(t))}static credential(e,t){return xi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return qn.credentialFromTaggedObject(t)}static credentialFromError(e){return qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?xi._fromTokenResponse(t,r):null}};qn.PROVIDER_ID="phone";qn.PHONE_SIGN_IN_METHOD="phone";function Yi(n,e){return e?Xt(e):(O(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Op extends fo{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ur(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ur(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ur(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function lL(n){return Zw(n.auth,new Op(n),n.bypassAuthState)}function hL(n){const{auth:e,user:t}=n;return O(t,e,"internal-error"),Xw(t,new Op(n),n.bypassAuthState)}async function dL(n){const{auth:e,user:t}=n;return O(t,e,"internal-error"),Sp(t,new Op(n),n.bypassAuthState)}class dE{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:l}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(h))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return lL;case"linkViaPopup":case"linkViaRedirect":return dL;case"reauthViaPopup":case"reauthViaRedirect":return hL;default:vt(this.auth,"internal-error")}}resolve(e){wn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const fL=new oc(2e3,1e4);async function pL(n,e,t){const r=Ge(n);lo(n,e,gr);const i=Yi(r,t);return new sr(r,"signInViaPopup",e,i).executeNotNull()}async function gL(n,e,t){const r=H(n);lo(r.auth,e,gr);const i=Yi(r.auth,t);return new sr(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function mL(n,e,t){const r=H(n);lo(r.auth,e,gr);const i=Yi(r.auth,t);return new sr(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class sr extends dE{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,sr.currentPopupAction&&sr.currentPopupAction.cancel(),sr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return O(e,this.auth,"internal-error"),e}async onExecution(){wn(this.filter.length===1,"Popup operations only handle one event");const e=uc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_t(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_t(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,sr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_t(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,fL.get())};e()}}sr.currentPopupAction=null;const _L="pendingRedirect",ga=new Map;class yL extends dE{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=ga.get(this.auth._key());if(!e){try{const r=await vL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}ga.set(this.auth._key(),e)}return this.bypassAuthState||ga.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function vL(n,e){const t=pE(e),r=fE(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function Lp(n,e){return fE(n)._set(pE(e),"true")}function IL(){ga.clear()}function Mp(n,e){ga.set(n._key(),e)}function fE(n){return Xt(n._redirectPersistence)}function pE(n){return ki(_L,n.config.apiKey,n.name)}function wL(n,e,t){return EL(n,e,t)}async function EL(n,e,t){const r=Ge(n);lo(n,e,gr),await r._initializationPromise;const i=Yi(r,t);return await Lp(i,r),i._openRedirect(r,e,"signInViaRedirect")}function TL(n,e,t){return AL(n,e,t)}async function AL(n,e,t){const r=H(n);lo(r.auth,e,gr),await r.auth._initializationPromise;const i=Yi(r.auth,t);await Lp(i,r.auth);const s=await gE(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function RL(n,e,t){return SL(n,e,t)}async function SL(n,e,t){const r=H(n);lo(r.auth,e,gr),await r.auth._initializationPromise;const i=Yi(r.auth,t);await Nl(!1,r,e.providerId),await Lp(i,r.auth);const s=await gE(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function bL(n,e){return await Ge(n)._initializationPromise,Ul(n,e,!1)}async function Ul(n,e,t=!1){const r=Ge(n),i=Yi(r,e),a=await new yL(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}async function gE(n){const e=uc(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}const PL=10*60*1e3;class mE{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!CL(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!_E(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(_t(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=PL&&this.cachedEventUids.clear(),this.cachedEventUids.has(Iv(e))}saveEventToCache(e){this.cachedEventUids.add(Iv(e)),this.lastProcessedEventTime=Date.now()}}function Iv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function _E({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function CL(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _E(n);default:return!1}}async function yE(n,e={}){return je(n,"GET","/v1/projects",e)}const DL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,kL=/^https?/;async function xL(n){if(n.config.emulator)return;const{authorizedDomains:e}=await yE(n);for(const t of e)try{if(NL(t))return}catch{}vt(n,"unauthorized-domain")}function NL(n){const e=ba(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!kL.test(t))return!1;if(DL.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const VL=new oc(3e4,6e4);function wv(){const n=et().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function OL(n){return new Promise((e,t)=>{var r,i,s;function a(){wv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wv(),t(_t(n,"network-request-failed"))},timeout:VL.get()})}if(!((i=(r=et().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=et().gapi)===null||s===void 0)&&s.load)a();else{const l=Kw("iframefcb");return et()[l]=()=>{gapi.load?a():t(_t(n,"network-request-failed"))},Rp(`https://apis.google.com/js/api.js?onload=${l}`).catch(h=>t(h))}}).catch(e=>{throw $u=null,e})}let $u=null;function LL(n){return $u=$u||OL(n),$u}const ML=new oc(5e3,15e3),FL="__/auth/iframe",UL="emulator/auth/iframe",BL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $L(n){const e=n.config;O(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Tp(e,UL):`https://${n.config.authDomain}/${FL}`,r={apiKey:e.apiKey,appName:n.name,v:Zr},i=qL.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${uo(r).slice(1)}`}async function WL(n){const e=await LL(n),t=et().gapi;return O(t,n,"internal-error"),e.open({where:document.body,url:$L(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:BL,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=_t(n,"network-request-failed"),l=et().setTimeout(()=>{s(a)},ML.get());function h(){et().clearTimeout(l),i(r)}r.ping(h).then(h,()=>{s(a)})}))}const GL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},zL=500,KL=600,HL="_blank",jL="http://localhost";class Ev{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function QL(n,e,t,r=zL,i=KL){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const h=Object.assign(Object.assign({},GL),{width:r.toString(),height:i.toString(),top:s,left:a}),f=Ue().toLowerCase();t&&(l=Bw(f)?HL:t),Uw(f)&&(e=e||jL,h.scrollbars="yes");const p=Object.entries(h).reduce((I,[A,L])=>`${I}${A}=${L},`,"");if(mV(f)&&l!=="_self")return YL(e||"",l),new Ev(null);const m=window.open(e||"",l,p);O(m,n,"popup-blocked");try{m.focus()}catch{}return new Ev(m)}function YL(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const JL="__/auth/handler",XL="emulator/auth/handler",ZL=encodeURIComponent("fac");async function Tf(n,e,t,r,i,s){O(n.config.authDomain,n,"auth-domain-config-required"),O(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Zr,eventId:i};if(e instanceof gr){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Ex(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries(s||{}))a[p]=m}if(e instanceof po){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);const l=a;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const h=await n._getAppCheckToken(),f=h?`#${ZL}=${encodeURIComponent(h)}`:"";return`${eM(n)}?${uo(l).slice(1)}${f}`}function eM({config:n}){return n.emulator?Tp(n,XL):`https://${n.authDomain}/${JL}`}const ef="webStorageSupport";class tM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Li,this._completeRedirectFn=Ul,this._overrideRedirectResult=Mp}async _openPopup(e,t,r,i){var s;wn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Tf(e,t,r,ba(),i);return QL(e,a,uc())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await Tf(e,t,r,ba(),i);return LO(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(wn(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await WL(e),r=new mE(e);return t.register("authEvent",i=>(O(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ef,{type:ef},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[ef];a!==void 0&&t(!!a),vt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=xL(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Gw()||Ap()||ho()}}const nM=tM;class rM{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return On("unexpected MultiFactorSessionType")}}}class Fp extends rM{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Fp(e)}_finalizeEnroll(e,t,r){return PO(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return KO(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class vE{constructor(){}static assertion(e){return Fp._fromCredential(e)}}vE.FACTOR_ID="phone";var Tv="@firebase/auth",Av="1.5.1";class iM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){O(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function sM(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function oM(n){qr(new Gn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;O(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zw(n)},f=new TV(r,i,s,h);return CV(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),qr(new Gn("auth-internal",e=>{const t=Ge(e.getProvider("auth").getImmediate());return(r=>new iM(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Bn(Tv,Av,sM(n)),Bn(Tv,Av,"esm2017")}const aM=5*60;dx("authIdTokenMaxAge");oM("Browser");function Mi(){return window}const cM=2e3;async function uM(n,e,t){var r;const{BuildInfo:i}=Mi();wn(e.sessionId,"AuthEvent did not contain a session ID");const s=await pM(e.sessionId),a={};return ho()?a.ibi=i.packageName:ac()?a.apn=i.packageName:vt(n,"operation-not-supported-in-this-environment"),i.displayName&&(a.appDisplayName=i.displayName),a.sessionId=s,Tf(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,a)}async function lM(n){const{BuildInfo:e}=Mi(),t={};ho()?t.iosBundleId=e.packageName:ac()?t.androidPackageName=e.packageName:vt(n,"operation-not-supported-in-this-environment"),await yE(n,t)}function hM(n){const{cordova:e}=Mi();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,gV()?"_blank":"_system","location=yes"),t(i)})})}async function dM(n,e,t){const{cordova:r}=Mi();let i=()=>{};try{await new Promise((s,a)=>{let l=null;function h(){var m;s();const I=(m=r.plugins.browsertab)===null||m===void 0?void 0:m.close;typeof I=="function"&&I(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function f(){l||(l=window.setTimeout(()=>{a(_t(n,"redirect-cancelled-by-user"))},cM))}function p(){(document==null?void 0:document.visibilityState)==="visible"&&f()}e.addPassiveListener(h),document.addEventListener("resume",f,!1),ac()&&document.addEventListener("visibilitychange",p,!1),i=()=>{e.removePassiveListener(h),document.removeEventListener("resume",f,!1),document.removeEventListener("visibilitychange",p,!1),l&&window.clearTimeout(l)}})}finally{i()}}function fM(n){var e,t,r,i,s,a,l,h,f,p;const m=Mi();O(typeof((e=m==null?void 0:m.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),O(typeof((t=m==null?void 0:m.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),O(typeof((s=(i=(r=m==null?void 0:m.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((h=(l=(a=m==null?void 0:m.cordova)===null||a===void 0?void 0:a.plugins)===null||l===void 0?void 0:l.browsertab)===null||h===void 0?void 0:h.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((p=(f=m==null?void 0:m.cordova)===null||f===void 0?void 0:f.InAppBrowser)===null||p===void 0?void 0:p.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function pM(n){const e=gM(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function gM(n){if(wn(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}const mM=20;class _M extends mE{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function yM(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:wM(),postBody:null,tenantId:n.tenantId,error:_t(n,"no-auth-event")}}function vM(n,e){return Af()._set(Rf(n),e)}async function Rv(n){const e=await Af()._get(Rf(n));return e&&await Af()._remove(Rf(n)),e}function IM(n,e){var t,r;const i=TM(e);if(i.includes("/__/auth/callback")){const s=Wu(i),a=s.firebaseError?EM(decodeURIComponent(s.firebaseError)):null,l=(r=(t=a==null?void 0:a.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],h=l?_t(l):null;return h?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:h,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function wM(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<mM;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function Af(){return Xt(xp)}function Rf(n){return ki("authEvent",n.config.apiKey,n.name)}function EM(n){try{return JSON.parse(n)}catch{return null}}function TM(n){const e=Wu(n),t=e.link?decodeURIComponent(e.link):void 0,r=Wu(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Wu(i).link||i||r||t||n}function Wu(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return Ls(t.join("?"))}const AM=500;class RM{constructor(){this._redirectPersistence=Li,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Ul,this._overrideRedirectResult=Mp}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new _M(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){vt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){fM(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),IL(),await this._originValidation(e);const a=yM(e,r,i);await vM(e,a);const l=await uM(e,a,t),h=await hM(l);return dM(e,s,h)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=lM(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Mi(),a=setTimeout(async()=>{await Rv(e),t.onEvent(Sv())},AM),l=async p=>{clearTimeout(a);const m=await Rv(e);let I=null;m&&(p!=null&&p.url)&&(I=IM(m,p.url)),t.onEvent(I||Sv())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,l);const h=i,f=`${s.packageName.toLowerCase()}://`;Mi().handleOpenURL=async p=>{if(p.toLowerCase().startsWith(f)&&l({url:p}),typeof h=="function")try{h(p)}catch(m){console.error(m)}}}}const SM=RM;function Sv(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:_t("no-auth-event")}}function bM(n,e){Ge(n)._logFramework(e)}var PM="@firebase/auth-compat",CM="0.5.1";const DM=1e3;function ma(){var n;return((n=self==null?void 0:self.location)===null||n===void 0?void 0:n.protocol)||null}function kM(){return ma()==="http:"||ma()==="https:"}function IE(n=Ue()){return!!((ma()==="file:"||ma()==="ionic:"||ma()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function xM(){return mp()||gp()}function NM(){return yw()&&(document==null?void 0:document.documentMode)===11}function VM(n=Ue()){return/Edge\/\d+/.test(n)}function OM(n=Ue()){return NM()||VM(n)}function wE(){try{const n=self.localStorage,e=uc();if(n)return n.setItem(e,"1"),n.removeItem(e),OM()?Aa():!0}catch{return Up()&&Aa()}return!1}function Up(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function tf(){return(kM()||_w()||IE())&&!xM()&&wE()&&!Up()}function EE(){return IE()&&typeof document<"u"}async function LM(){return EE()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},DM);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function MM(){return typeof window<"u"?window:null}const Jt={LOCAL:"local",NONE:"none",SESSION:"session"},jo=O,TE="persistence";function FM(n,e){if(jo(Object.values(Jt).includes(e),n,"invalid-persistence-type"),mp()){jo(e!==Jt.SESSION,n,"unsupported-persistence-type");return}if(gp()){jo(e===Jt.NONE,n,"unsupported-persistence-type");return}if(Up()){jo(e===Jt.NONE||e===Jt.LOCAL&&Aa(),n,"unsupported-persistence-type");return}jo(e===Jt.NONE||wE(),n,"unsupported-persistence-type")}async function Sf(n){await n._initializationPromise;const e=AE(),t=ki(TE,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())}function UM(n,e){const t=AE();if(!t)return[];const r=ki(TE,n,e);switch(t.getItem(r)){case Jt.NONE:return[js];case Jt.LOCAL:return[xa,Li];case Jt.SESSION:return[Li];default:return[]}}function AE(){var n;try{return((n=MM())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}const BM=O;class Or{constructor(){this.browserResolver=Xt(nM),this.cordovaResolver=Xt(SM),this.underlyingResolver=null,this._redirectPersistence=Li,this._completeRedirectFn=Ul,this._overrideRedirectResult=Mp}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return EE()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return BM(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await LM();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function RE(n){return n.unwrap()}function qM(n){return n.wrapped()}function $M(n){return SE(n)}function WM(n,e){var t;const r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new GM(n,SO(n,e))}else if(r){const i=SE(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function SE(n){const{_tokenResponse:e}=n instanceof xt?n.customData:n;if(!e)return null;if(!(n instanceof xt)&&"temporaryProof"in e&&"phoneNumber"in e)return qn.credentialFromResult(n);const t=e.providerId;if(!t||t===Ho.PASSWORD)return null;let r;switch(t){case Ho.GOOGLE:r=kn;break;case Ho.FACEBOOK:r=Dn;break;case Ho.GITHUB:r=xn;break;case Ho.TWITTER:r=Nn;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:h}=e;return!s&&!a&&!i&&!l?null:l?t.startsWith("saml.")?Qs._create(t,l):zn._fromParams({providerId:t,signInMethod:t,pendingToken:l,idToken:i,accessToken:s}):new Us(t).credential({idToken:i,accessToken:s,rawNonce:h})}return n instanceof xt?r.credentialFromError(n):r.credentialFromResult(n)}function Bt(n,e){return e.catch(t=>{throw t instanceof xt&&WM(n,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:$M(t),additionalUserInfo:RO(t),user:Lr.getOrCreate(i)}})}async function bf(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>Bt(n,t.confirm(r))}}class GM{constructor(e,t){this.resolver=t,this.auth=qM(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Bt(RE(this.auth),this.resolver.resolveSignIn(e))}}let Lr=class{constructor(e){this._delegate=e,this.multiFactor=DO(e)}static getOrCreate(e){return Lr.USER_MAP.has(e)||Lr.USER_MAP.set(e,new Lr(e)),Lr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Bt(this.auth,eE(this._delegate,e))}async linkWithPhoneNumber(e,t){return bf(this.auth,aL(this._delegate,e,t))}async linkWithPopup(e){return Bt(this.auth,mL(this._delegate,e,Or))}async linkWithRedirect(e){return await Sf(Ge(this.auth)),RL(this._delegate,e,Or)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Bt(this.auth,tE(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return bf(this.auth,cL(this._delegate,e,t))}reauthenticateWithPopup(e){return Bt(this.auth,gL(this._delegate,e,Or))}async reauthenticateWithRedirect(e){return await Sf(Ge(this.auth)),TL(this._delegate,e,Or)}sendEmailVerification(e){return pO(this._delegate,e)}async unlink(e){return await eO(this._delegate,e),this}updateEmail(e){return yO(this._delegate,e)}updatePassword(e){return vO(this._delegate,e)}updatePhoneNumber(e){return uL(this._delegate,e)}updateProfile(e){return _O(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return gO(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Lr.USER_MAP=new WeakMap;const Qo=O;class Pf{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Qo(r,"invalid-api-key",{appName:e.name}),Qo(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?Or:void 0;this._delegate=t.initialize({options:{persistence:zM(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(zN),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Lr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){DV(this._delegate,e,t)}applyActionCode(e){return sO(this._delegate,e)}checkActionCode(e){return nE(this._delegate,e)}confirmPasswordReset(e,t){return iO(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Bt(this._delegate,aO(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return fO(this._delegate,e)}isSignInWithEmailLink(e){return lO(this._delegate,e)}async getRedirectResult(){Qo(tf(),this._delegate,"operation-not-supported-in-this-environment");const e=await bL(this._delegate,Or);return e?Bt(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){bM(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:s,complete:a}=bv(e,t,r);return this._delegate.onAuthStateChanged(i,s,a)}onIdTokenChanged(e,t,r){const{next:i,error:s,complete:a}=bv(e,t,r);return this._delegate.onIdTokenChanged(i,s,a)}sendSignInLinkToEmail(e,t){return uO(this._delegate,e,t)}sendPasswordResetEmail(e,t){return rO(this._delegate,e,t||void 0)}async setPersistence(e){FM(this._delegate,e);let t;switch(e){case Jt.SESSION:t=Li;break;case Jt.LOCAL:t=await Xt(xa)._isAvailable()?xa:xp;break;case Jt.NONE:t=js;break;default:return vt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Bt(this._delegate,ZV(this._delegate))}signInWithCredential(e){return Bt(this._delegate,Vl(this._delegate,e))}signInWithCustomToken(e){return Bt(this._delegate,nO(this._delegate,e))}signInWithEmailAndPassword(e,t){return Bt(this._delegate,cO(this._delegate,e,t))}signInWithEmailLink(e,t){return Bt(this._delegate,hO(this._delegate,e,t))}signInWithPhoneNumber(e,t){return bf(this._delegate,oL(this._delegate,e,t))}async signInWithPopup(e){return Qo(tf(),this._delegate,"operation-not-supported-in-this-environment"),Bt(this._delegate,pL(this._delegate,e,Or))}async signInWithRedirect(e){return Qo(tf(),this._delegate,"operation-not-supported-in-this-environment"),await Sf(this._delegate),wL(this._delegate,e,Or)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return oO(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Pf.Persistence=Jt;function bv(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const i=r;return{next:a=>i(a&&Lr.getOrCreate(a)),error:e,complete:t}}function zM(n,e){const t=UM(n,e);if(typeof self<"u"&&!t.includes(xa)&&t.push(xa),typeof window<"u")for(const r of[xp,Li])t.includes(r)||t.push(r);return t.includes(js)||t.push(js),t}class Bp{constructor(){this.providerId="phone",this._delegate=new qn(RE($r.auth()))}static credential(e,t){return qn.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}Bp.PHONE_SIGN_IN_METHOD=qn.PHONE_SIGN_IN_METHOD;Bp.PROVIDER_ID=qn.PROVIDER_ID;const KM=O;class HM{constructor(e,t,r=$r.app()){var i;KM((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new iL(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const jM="auth-compat";function QM(n){n.INTERNAL.registerComponent(new Gn(jM,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Pf(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ws.EMAIL_SIGNIN,PASSWORD_RESET:ws.PASSWORD_RESET,RECOVER_EMAIL:ws.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:ws.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:ws.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:ws.VERIFY_EMAIL}},EmailAuthProvider:ei,FacebookAuthProvider:Dn,GithubAuthProvider:xn,GoogleAuthProvider:kn,OAuthProvider:Us,SAMLAuthProvider:rl,PhoneAuthProvider:Bp,PhoneMultiFactorGenerator:vE,RecaptchaVerifier:HM,TwitterAuthProvider:Nn,Auth:Pf,AuthCredential:fo,Error:xt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(PM,CM)}QM($r);var YM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},q,qp=qp||{},Z=YM||self;function Bl(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function hc(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function JM(n){return Object.prototype.hasOwnProperty.call(n,nf)&&n[nf]||(n[nf]=++XM)}var nf="closure_uid_"+(1e9*Math.random()>>>0),XM=0;function ZM(n,e,t){return n.call.apply(n.bind,arguments)}function eF(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function Tt(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Tt=ZM:Tt=eF,Tt.apply(null,arguments)}function bu(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ut(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var a=Array(arguments.length-2),l=2;l<arguments.length;l++)a[l-2]=arguments[l];return e.prototype[i].apply(r,a)}}function ti(){this.s=this.s,this.o=this.o}var tF=0;ti.prototype.s=!1;ti.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),tF!=0)&&JM(this)};ti.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const bE=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function $p(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Pv(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Bl(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let a=0;a<s;a++)n[i+a]=r[a]}else n.push(r)}}function At(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}At.prototype.h=function(){this.defaultPrevented=!0};var nF=function(){if(!Z.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const t=()=>{};Z.addEventListener("test",t,e),Z.removeEventListener("test",t,e)}catch{}return n}();function Na(n){return/^[\s\xa0]*$/.test(n)}function ql(){var n=Z.navigator;return n&&(n=n.userAgent)?n:""}function Vn(n){return ql().indexOf(n)!=-1}function Wp(n){return Wp[" "](n),n}Wp[" "]=function(){};function rF(n,e){var t=QF;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}var iF=Vn("Opera"),Ys=Vn("Trident")||Vn("MSIE"),PE=Vn("Edge"),Cf=PE||Ys,CE=Vn("Gecko")&&!(ql().toLowerCase().indexOf("webkit")!=-1&&!Vn("Edge"))&&!(Vn("Trident")||Vn("MSIE"))&&!Vn("Edge"),sF=ql().toLowerCase().indexOf("webkit")!=-1&&!Vn("Edge");function DE(){var n=Z.document;return n?n.documentMode:void 0}var Df;e:{var rf="",sf=function(){var n=ql();if(CE)return/rv:([^\);]+)(\)|;)/.exec(n);if(PE)return/Edge\/([\d\.]+)/.exec(n);if(Ys)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(sF)return/WebKit\/(\S+)/.exec(n);if(iF)return/(?:Version)[ \/]?(\S+)/.exec(n)}();if(sf&&(rf=sf?sf[1]:""),Ys){var of=DE();if(of!=null&&of>parseFloat(rf)){Df=String(of);break e}}Df=rf}var kf;if(Z.document&&Ys){var Cv=DE();kf=Cv||parseInt(Df,10)||void 0}else kf=void 0;var oF=kf;function Va(n,e){if(At.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(CE){e:{try{Wp(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:aF[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Va.$.h.call(this)}}ut(Va,At);var aF={2:"touch",3:"pen",4:"mouse"};Va.prototype.h=function(){Va.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var dc="closure_listenable_"+(1e6*Math.random()|0),cF=0;function uF(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++cF,this.fa=this.ia=!1}function $l(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function Gp(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function lF(n,e){for(const t in n)e.call(void 0,n[t],t,n)}function kE(n){const e={};for(const t in n)e[t]=n[t];return e}const Dv="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function xE(n,e){let t,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(t in r)n[t]=r[t];for(let s=0;s<Dv.length;s++)t=Dv[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Wl(n){this.src=n,this.g={},this.h=0}Wl.prototype.add=function(n,e,t,r,i){var s=n.toString();n=this.g[s],n||(n=this.g[s]=[],this.h++);var a=Nf(n,e,r,i);return-1<a?(e=n[a],t||(e.ia=!1)):(e=new uF(e,this.src,s,!!r,i),e.ia=t,n.push(e)),e};function xf(n,e){var t=e.type;if(t in n.g){var r=n.g[t],i=bE(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&($l(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function Nf(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}var zp="closure_lm_"+(1e6*Math.random()|0),af={};function NE(n,e,t,r,i){if(r&&r.once)return OE(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)NE(n,e[s],t,r,i);return null}return t=jp(t),n&&n[dc]?n.O(e,t,hc(r)?!!r.capture:!!r,i):VE(n,e,t,!1,r,i)}function VE(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var a=hc(i)?!!i.capture:!!i,l=Hp(n);if(l||(n[zp]=l=new Wl(n)),t=l.add(e,t,r,a,s),t.proxy)return t;if(r=hF(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)nF||(i=a),i===void 0&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(ME(e.toString()),r);else if(n.addListener&&n.removeListener)n.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return t}function hF(){function n(t){return e.call(n.src,n.listener,t)}const e=dF;return n}function OE(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)OE(n,e[s],t,r,i);return null}return t=jp(t),n&&n[dc]?n.P(e,t,hc(r)?!!r.capture:!!r,i):VE(n,e,t,!0,r,i)}function LE(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)LE(n,e[s],t,r,i);else r=hc(r)?!!r.capture:!!r,t=jp(t),n&&n[dc]?(n=n.i,e=String(e).toString(),e in n.g&&(s=n.g[e],t=Nf(s,t,r,i),-1<t&&($l(s[t]),Array.prototype.splice.call(s,t,1),s.length==0&&(delete n.g[e],n.h--)))):n&&(n=Hp(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Nf(e,t,r,i)),(t=-1<n?e[n]:null)&&Kp(t))}function Kp(n){if(typeof n!="number"&&n&&!n.fa){var e=n.src;if(e&&e[dc])xf(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(ME(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Hp(e))?(xf(t,n),t.h==0&&(t.src=null,e[zp]=null)):$l(n)}}}function ME(n){return n in af?af[n]:af[n]="on"+n}function dF(n,e){if(n.fa)n=!0;else{e=new Va(e,this);var t=n.listener,r=n.la||n.src;n.ia&&Kp(n),n=t.call(r,e)}return n}function Hp(n){return n=n[zp],n instanceof Wl?n:null}var cf="__closure_events_fn_"+(1e9*Math.random()>>>0);function jp(n){return typeof n=="function"?n:(n[cf]||(n[cf]=function(e){return n.handleEvent(e)}),n[cf])}function ct(){ti.call(this),this.i=new Wl(this),this.S=this,this.J=null}ut(ct,ti);ct.prototype[dc]=!0;ct.prototype.removeEventListener=function(n,e,t,r){LE(this,n,e,t,r)};function yt(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,typeof e=="string")e=new At(e,n);else if(e instanceof At)e.target=e.target||n;else{var i=e;e=new At(r,n),xE(e,i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var a=e.g=t[s];i=Pu(a,r,!0,e)&&i}if(a=e.g=n,i=Pu(a,r,!0,e)&&i,i=Pu(a,r,!1,e)&&i,t)for(s=0;s<t.length;s++)a=e.g=t[s],i=Pu(a,r,!1,e)&&i}ct.prototype.N=function(){if(ct.$.N.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)$l(t[r]);delete n.g[e],n.h--}}this.J=null};ct.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)};ct.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};function Pu(n,e,t,r){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==t){var l=a.listener,h=a.la||a.src;a.ia&&xf(n.i,a),i=l.call(h,r)!==!1&&i}}return i&&!r.defaultPrevented}var Qp=Z.JSON.stringify;class fF{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function pF(){var n=Yp;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}class gF{constructor(){this.h=this.g=null}add(e,t){const r=FE.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}}var FE=new fF(()=>new mF,n=>n.reset());class mF{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function _F(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function yF(n){Z.setTimeout(()=>{throw n},0)}let Oa,La=!1,Yp=new gF,UE=()=>{const n=Z.Promise.resolve(void 0);Oa=()=>{n.then(vF)}};var vF=()=>{for(var n;n=pF();){try{n.h.call(n.g)}catch(t){yF(t)}var e=FE;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}La=!1};function Gl(n,e){ct.call(this),this.h=n||1,this.g=e||Z,this.j=Tt(this.qb,this),this.l=Date.now()}ut(Gl,ct);q=Gl.prototype;q.ga=!1;q.T=null;q.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),yt(this,"tick"),this.ga&&(Jp(this),this.start()))}};q.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Jp(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}q.N=function(){Gl.$.N.call(this),Jp(this),delete this.g};function Xp(n,e,t){if(typeof n=="function")t&&(n=Tt(n,t));else if(n&&typeof n.handleEvent=="function")n=Tt(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Z.setTimeout(n,e||0)}function BE(n){n.g=Xp(()=>{n.g=null,n.i&&(n.i=!1,BE(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}class IF extends ti{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:BE(this)}N(){super.N(),this.g&&(Z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ma(n){ti.call(this),this.h=n,this.g={}}ut(Ma,ti);var kv=[];function qE(n,e,t,r){Array.isArray(t)||(t&&(kv[0]=t.toString()),t=kv);for(var i=0;i<t.length;i++){var s=NE(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function $E(n){Gp(n.g,function(e,t){this.g.hasOwnProperty(t)&&Kp(e)},n),n.g={}}Ma.prototype.N=function(){Ma.$.N.call(this),$E(this)};Ma.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function zl(){this.g=!0}zl.prototype.Ea=function(){this.g=!1};function wF(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var a="",l=s.split("&"),h=0;h<l.length;h++){var f=l[h].split("=");if(1<f.length){var p=f[0];f=f[1];var m=p.split("_");a=2<=m.length&&m[1]=="type"?a+(p+"="+f+"&"):a+(p+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+t+`
`+a})}function EF(n,e,t,r,i,s,a){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+t+`
`+s+" "+a})}function Ms(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+AF(n,t)+(r?" "+r:"")})}function TF(n,e){n.info(function(){return"TIMEOUT: "+e})}zl.prototype.info=function(){};function AF(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return Qp(t)}catch{return e}}var Ji={},xv=null;function Kl(){return xv=xv||new ct}Ji.Ta="serverreachability";function WE(n){At.call(this,Ji.Ta,n)}ut(WE,At);function Fa(n){const e=Kl();yt(e,new WE(e))}Ji.STAT_EVENT="statevent";function GE(n,e){At.call(this,Ji.STAT_EVENT,n),this.stat=e}ut(GE,At);function kt(n){const e=Kl();yt(e,new GE(e,n))}Ji.Ua="timingevent";function zE(n,e){At.call(this,Ji.Ua,n),this.size=e}ut(zE,At);function fc(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return Z.setTimeout(function(){n()},e)}var Hl={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},KE={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Zp(){}Zp.prototype.h=null;function Nv(n){return n.h||(n.h=n.i())}function HE(){}var pc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function eg(){At.call(this,"d")}ut(eg,At);function tg(){At.call(this,"c")}ut(tg,At);var Vf;function jl(){}ut(jl,Zp);jl.prototype.g=function(){return new XMLHttpRequest};jl.prototype.i=function(){return{}};Vf=new jl;function gc(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new Ma(this),this.P=RF,n=Cf?125:void 0,this.V=new Gl(n),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new jE}function jE(){this.i=null,this.g="",this.h=!1}var RF=45e3,QE={},Of={};q=gc.prototype;q.setTimeout=function(n){this.P=n};function Lf(n,e,t){n.L=1,n.A=Yl(dr(e)),n.u=t,n.S=!0,YE(n,null)}function YE(n,e){n.G=Date.now(),mc(n),n.B=dr(n.A);var t=n.B,r=n.W;Array.isArray(r)||(r=[String(r)]),iT(t.i,"t",r),n.o=0,t=n.l.J,n.h=new jE,n.g=RT(n.l,t?e:null,!n.u),0<n.O&&(n.M=new IF(Tt(n.Pa,n,n.g),n.O)),qE(n.U,n.g,"readystatechange",n.nb),e=n.I?kE(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),Fa(),wF(n.j,n.v,n.B,n.m,n.W,n.u)}q.nb=function(n){n=n.target;const e=this.M;e&&Ln(n)==3?e.l():this.Pa(n)};q.Pa=function(n){try{if(n==this.g)e:{const p=Ln(this.g);var e=this.g.Ia();const m=this.g.da();if(!(3>p)&&(p!=3||Cf||this.g&&(this.h.h||this.g.ja()||Mv(this.g)))){this.J||p!=4||e==7||(e==8||0>=m?Fa(3):Fa(2)),Ql(this);var t=this.g.da();this.ca=t;t:if(JE(this)){var r=Mv(this.g);n="";var i=r.length,s=Ln(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Si(this),_a(this);var a="";break t}this.h.i=new Z.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=n,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=t==200,EF(this.j,this.v,this.B,this.m,this.W,p,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var l,h=this.g;if((l=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Na(l)){var f=l;break t}}f=null}if(t=f)Ms(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Mf(this,t);else{this.i=!1,this.s=3,kt(12),Si(this),_a(this);break e}}this.S?(XE(this,p,a),Cf&&this.i&&p==3&&(qE(this.U,this.V,"tick",this.mb),this.V.start())):(Ms(this.j,this.m,a,null),Mf(this,a)),p==4&&Si(this),this.i&&!this.J&&(p==4?wT(this.l,this):(this.i=!1,mc(this)))}else KF(this.g),t==400&&0<a.indexOf("Unknown SID")?(this.s=3,kt(12)):(this.s=0,kt(13)),Si(this),_a(this)}}}catch{}finally{}};function JE(n){return n.g?n.v=="GET"&&n.L!=2&&n.l.Ha:!1}function XE(n,e,t){let r=!0,i;for(;!n.J&&n.o<t.length;)if(i=SF(n,t),i==Of){e==4&&(n.s=4,kt(14),r=!1),Ms(n.j,n.m,null,"[Incomplete Response]");break}else if(i==QE){n.s=4,kt(15),Ms(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}else Ms(n.j,n.m,i,null),Mf(n,i);JE(n)&&n.o!=0&&(n.h.g=n.h.g.slice(n.o),n.o=0),e!=4||t.length!=0||n.h.h||(n.s=1,kt(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,e=n.l,e.g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),ag(e),e.M=!0,kt(11))):(Ms(n.j,n.m,t,"[Invalid Chunked Response]"),Si(n),_a(n))}q.mb=function(){if(this.g){var n=Ln(this.g),e=this.g.ja();this.o<e.length&&(Ql(this),XE(this,n,e),this.i&&n!=4&&mc(this))}};function SF(n,e){var t=n.o,r=e.indexOf(`
`,t);return r==-1?Of:(t=Number(e.substring(t,r)),isNaN(t)?QE:(r+=1,r+t>e.length?Of:(e=e.slice(r,r+t),n.o=r+t,e)))}q.cancel=function(){this.J=!0,Si(this)};function mc(n){n.Y=Date.now()+n.P,ZE(n,n.P)}function ZE(n,e){if(n.C!=null)throw Error("WatchDog timer not null");n.C=fc(Tt(n.lb,n),e)}function Ql(n){n.C&&(Z.clearTimeout(n.C),n.C=null)}q.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(TF(this.j,this.B),this.L!=2&&(Fa(),kt(17)),Si(this),this.s=2,_a(this)):ZE(this,this.Y-n)};function _a(n){n.l.H==0||n.J||wT(n.l,n)}function Si(n){Ql(n);var e=n.M;e&&typeof e.sa=="function"&&e.sa(),n.M=null,Jp(n.V),$E(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function Mf(n,e){try{var t=n.l;if(t.H!=0&&(t.g==n||Ff(t.i,n))){if(!n.K&&Ff(t.i,n)&&t.H==3){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<n.G)ul(t),eh(t);else break e;og(t),kt(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&t.A==0&&!t.v&&(t.v=fc(Tt(t.ib,t),6e3));if(1>=aT(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else bi(t,11)}else if((n.K||t.g==n)&&ul(t),!Na(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let f=i[e];if(t.V=f[0],f=f[1],t.H==2)if(f[0]=="c"){t.K=f[1],t.pa=f[2];const p=f[3];p!=null&&(t.ra=p,t.l.info("VER="+t.ra));const m=f[4];m!=null&&(t.Ga=m,t.l.info("SVER="+t.Ga));const I=f[5];I!=null&&typeof I=="number"&&0<I&&(r=1.5*I,t.L=r,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const A=n.g;if(A){const L=A.g?A.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(L){var s=r.i;s.g||L.indexOf("spdy")==-1&&L.indexOf("quic")==-1&&L.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(ng(s,s.h),s.h=null))}if(r.F){const M=A.g?A.g.getResponseHeader("X-HTTP-Session-Id"):null;M&&(r.Da=M,ke(r.I,r.F,M))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms")),r=t;var a=n;if(r.wa=AT(r,r.J?r.pa:null,r.Y),a.K){cT(r.i,a);var l=a,h=r.L;h&&l.setTimeout(h),l.C&&(Ql(l),mc(l)),r.g=a}else vT(r);0<t.j.length&&th(t)}else f[0]!="stop"&&f[0]!="close"||bi(t,7);else t.H==3&&(f[0]=="stop"||f[0]=="close"?f[0]=="stop"?bi(t,7):sg(t):f[0]!="noop"&&t.h&&t.h.Aa(f),t.A=0)}}Fa(4)}catch{}}function bF(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(Bl(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}e=[],t=0;for(r in n)e[t++]=n[r];return e}function PF(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(Bl(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}function eT(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(Bl(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=PF(n),r=bF(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}var tT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function CF(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ni(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Ni){this.h=n.h,al(this,n.j),this.s=n.s,this.g=n.g,cl(this,n.m),this.l=n.l;var e=n.i,t=new Ua;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Vv(this,t),this.o=n.o}else n&&(e=String(n).match(tT))?(this.h=!1,al(this,e[1]||"",!0),this.s=ca(e[2]||""),this.g=ca(e[3]||"",!0),cl(this,e[4]),this.l=ca(e[5]||"",!0),Vv(this,e[6]||"",!0),this.o=ca(e[7]||"")):(this.h=!1,this.i=new Ua(null,this.h))}Ni.prototype.toString=function(){var n=[],e=this.j;e&&n.push(ua(e,Ov,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(ua(e,Ov,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(ua(t,t.charAt(0)=="/"?xF:kF,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",ua(t,VF)),n.join("")};function dr(n){return new Ni(n)}function al(n,e,t){n.j=t?ca(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function cl(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Vv(n,e,t){e instanceof Ua?(n.i=e,OF(n.i,n.h)):(t||(e=ua(e,NF)),n.i=new Ua(e,n.h))}function ke(n,e,t){n.i.set(e,t)}function Yl(n){return ke(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function ca(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function ua(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,DF),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function DF(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var Ov=/[#\/\?@]/g,kF=/[#\?:]/g,xF=/[#\?]/g,NF=/[#\?@]/g,VF=/#/g;function Ua(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function ni(n){n.g||(n.g=new Map,n.h=0,n.i&&CF(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}q=Ua.prototype;q.add=function(n,e){ni(this),this.i=null,n=go(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function nT(n,e){ni(n),e=go(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function rT(n,e){return ni(n),e=go(n,e),n.g.has(e)}q.forEach=function(n,e){ni(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)};q.ta=function(){ni(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t};q.Z=function(n){ni(this);let e=[];if(typeof n=="string")rT(this,n)&&(e=e.concat(this.g.get(go(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};q.set=function(n,e){return ni(this),this.i=null,n=go(this,n),rT(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};q.get=function(n,e){return n?(n=this.Z(n),0<n.length?String(n[0]):e):e};function iT(n,e,t){nT(n,e),0<t.length&&(n.i=null,n.g.set(go(n,e),$p(t)),n.h+=t.length)}q.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;a[r]!==""&&(i+="="+encodeURIComponent(String(a[r]))),n.push(i)}}return this.i=n.join("&")};function go(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function OF(n,e){e&&!n.j&&(ni(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(nT(this,r),iT(this,i,t))},n)),n.j=e}var LF=class{constructor(n,e){this.g=n,this.map=e}};function sT(n){this.l=n||MF,Z.PerformanceNavigationTiming?(n=Z.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(Z.g&&Z.g.Ka&&Z.g.Ka()&&Z.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var MF=10;function oT(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function aT(n){return n.h?1:n.g?n.g.size:0}function Ff(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function ng(n,e){n.g?n.g.add(e):n.h=e}function cT(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}sT.prototype.cancel=function(){if(this.i=uT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function uT(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return $p(n.i)}var FF=class{stringify(n){return Z.JSON.stringify(n,void 0)}parse(n){return Z.JSON.parse(n,void 0)}};function UF(){this.g=new FF}function BF(n,e,t){const r=t||"";try{eT(n,function(i,s){let a=i;hc(i)&&(a=Qp(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function qF(n,e){const t=new zl;if(Z.Image){const r=new Image;r.onload=bu(Cu,t,r,"TestLoadImage: loaded",!0,e),r.onerror=bu(Cu,t,r,"TestLoadImage: error",!1,e),r.onabort=bu(Cu,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=bu(Cu,t,r,"TestLoadImage: timeout",!1,e),Z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}function Cu(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Jl(n){this.l=n.ec||null,this.j=n.ob||!1}ut(Jl,Zp);Jl.prototype.g=function(){return new Xl(this.l,this.j)};Jl.prototype.i=function(n){return function(){return n}}({});function Xl(n,e){ct.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=rg,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ut(Xl,ct);var rg=0;q=Xl.prototype;q.open=function(n,e){if(this.readyState!=rg)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Ba(this)};q.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||Z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};q.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,_c(this)),this.readyState=rg};q.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Ba(this)),this.g&&(this.readyState=3,Ba(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Z.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;lT(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function lT(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}q.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?_c(this):Ba(this),this.readyState==3&&lT(this)}};q.Za=function(n){this.g&&(this.response=this.responseText=n,_c(this))};q.Ya=function(n){this.g&&(this.response=n,_c(this))};q.ka=function(){this.g&&_c(this)};function _c(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Ba(n)}q.setRequestHeader=function(n,e){this.v.append(n,e)};q.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};q.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function Ba(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(Xl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var $F=Z.JSON.parse;function ze(n){ct.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=hT,this.L=this.M=!1}ut(ze,ct);var hT="",WF=/^https?$/i,GF=["POST","PUT"];q=ze.prototype;q.Oa=function(n){this.M=n};q.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Vf.g(),this.C=this.u?Nv(this.u):Nv(Vf),this.g.onreadystatechange=Tt(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){Lv(this,s);return}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())t.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(t.keys()).find(s=>s.toLowerCase()=="content-type"),i=Z.FormData&&n instanceof Z.FormData,!(0<=bE(GF,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of t)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{pT(this),0<this.B&&((this.L=zF(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Tt(this.ua,this)):this.A=Xp(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){Lv(this,s)}};function zF(n){return Ys&&typeof n.timeout=="number"&&n.ontimeout!==void 0}q.ua=function(){typeof qp<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,yt(this,"timeout"),this.abort(8))};function Lv(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,dT(n),Zl(n)}function dT(n){n.F||(n.F=!0,yt(n,"complete"),yt(n,"error"))}q.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,yt(this,"complete"),yt(this,"abort"),Zl(this))};q.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Zl(this,!0)),ze.$.N.call(this)};q.La=function(){this.s||(this.G||this.v||this.l?fT(this):this.kb())};q.kb=function(){fT(this)};function fT(n){if(n.h&&typeof qp<"u"&&(!n.C[1]||Ln(n)!=4||n.da()!=2)){if(n.v&&Ln(n)==4)Xp(n.La,0,n);else if(yt(n,"readystatechange"),Ln(n)==4){n.h=!1;try{const a=n.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=a===0){var i=String(n.I).match(tT)[1]||null;!i&&Z.self&&Z.self.location&&(i=Z.self.location.protocol.slice(0,-1)),r=!WF.test(i?i.toLowerCase():"")}t=r}if(t)yt(n,"complete"),yt(n,"success");else{n.m=6;try{var s=2<Ln(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",dT(n)}}finally{Zl(n)}}}}function Zl(n,e){if(n.g){pT(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||yt(n,"ready");try{t.onreadystatechange=r}catch{}}}function pT(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(Z.clearTimeout(n.A),n.A=null)}q.isActive=function(){return!!this.g};function Ln(n){return n.g?n.g.readyState:0}q.da=function(){try{return 2<Ln(this)?this.g.status:-1}catch{return-1}};q.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};q.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),$F(e)}};function Mv(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case hT:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function KF(n){const e={};n=(n.g&&2<=Ln(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<n.length;r++){if(Na(n[r]))continue;var t=_F(n[r]);const i=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}lF(e,function(r){return r.join(", ")})}q.Ia=function(){return this.m};q.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function gT(n){let e="";return Gp(n,function(t,r){e+=r,e+=":",e+=t,e+=`\r
`}),e}function ig(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=gT(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):ke(n,e,t))}function Yo(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function mT(n){this.Ga=0,this.j=[],this.l=new zl,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Yo("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Yo("baseRetryDelayMs",5e3,n),this.hb=Yo("retryDelaySeedMs",1e4,n),this.eb=Yo("forwardChannelMaxRetries",2,n),this.xa=Yo("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new sT(n&&n.concurrentRequestLimit),this.Ja=new UF,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}q=mT.prototype;q.ra=8;q.H=1;function sg(n){if(_T(n),n.H==3){var e=n.W++,t=dr(n.I);if(ke(t,"SID",n.K),ke(t,"RID",e),ke(t,"TYPE","terminate"),yc(n,t),e=new gc(n,n.l,e),e.L=2,e.A=Yl(dr(t)),t=!1,Z.navigator&&Z.navigator.sendBeacon)try{t=Z.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&Z.Image&&(new Image().src=e.A,t=!0),t||(e.g=RT(e.l,null),e.g.ha(e.A)),e.G=Date.now(),mc(e)}TT(n)}function eh(n){n.g&&(ag(n),n.g.cancel(),n.g=null)}function _T(n){eh(n),n.u&&(Z.clearTimeout(n.u),n.u=null),ul(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&Z.clearTimeout(n.m),n.m=null)}function th(n){if(!oT(n.i)&&!n.m){n.m=!0;var e=n.Na;Oa||UE(),La||(Oa(),La=!0),Yp.add(e,n),n.C=0}}function HF(n,e){return aT(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=e.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=fc(Tt(n.Na,n,e),ET(n,n.C)),n.C++,!0)}q.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new gc(this,this.l,n);let s=this.s;if(this.U&&(s?(s=kE(s),xE(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var r=this.j[t];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=yT(this,i,e),t=dr(this.I),ke(t,"RID",n),ke(t,"CVER",22),this.F&&ke(t,"X-HTTP-Session-Id",this.F),yc(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(gT(s)))+"&"+e:this.o&&ig(t,this.o,s)),ng(this.i,i),this.bb&&ke(t,"TYPE","init"),this.P?(ke(t,"$req",e),ke(t,"SID","null"),i.aa=!0,Lf(i,t,null)):Lf(i,t,e),this.H=2}}else this.H==3&&(n?Fv(this,n):this.j.length==0||oT(this.i)||Fv(this))};function Fv(n,e){var t;e?t=e.m:t=n.W++;const r=dr(n.I);ke(r,"SID",n.K),ke(r,"RID",t),ke(r,"AID",n.V),yc(n,r),n.o&&n.s&&ig(r,n.o,n.s),t=new gc(n,n.l,t,n.C+1),n.o===null&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=yT(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),ng(n.i,t),Lf(t,r,e)}function yc(n,e){n.na&&Gp(n.na,function(t,r){ke(e,r,t)}),n.h&&eT({},function(t,r){ke(e,r,t)})}function yT(n,e,t){t=Math.min(n.j.length,t);var r=n.h?Tt(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const a=["count="+t];s==-1?0<t?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let l=!0;for(let h=0;h<t;h++){let f=i[h].g;const p=i[h].map;if(f-=s,0>f)s=Math.max(0,i[h].g-100),l=!1;else try{BF(p,a,"req"+f+"_")}catch{r&&r(p)}}if(l){r=a.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function vT(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Oa||UE(),La||(Oa(),La=!0),Yp.add(e,n),n.A=0}}function og(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=fc(Tt(n.Ma,n),ET(n,n.A)),n.A++,!0)}q.Ma=function(){if(this.u=null,IT(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=fc(Tt(this.jb,this),n)}};q.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,kt(10),eh(this),IT(this))};function ag(n){n.B!=null&&(Z.clearTimeout(n.B),n.B=null)}function IT(n){n.g=new gc(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var e=dr(n.wa);ke(e,"RID","rpc"),ke(e,"SID",n.K),ke(e,"AID",n.V),ke(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&ke(e,"TO",n.qa),ke(e,"TYPE","xmlhttp"),yc(n,e),n.o&&n.s&&ig(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=Yl(dr(e)),t.u=null,t.S=!0,YE(t,n)}q.ib=function(){this.v!=null&&(this.v=null,eh(this),og(this),kt(19))};function ul(n){n.v!=null&&(Z.clearTimeout(n.v),n.v=null)}function wT(n,e){var t=null;if(n.g==e){ul(n),ag(n),n.g=null;var r=2}else if(Ff(n.i,e))t=e.F,cT(n.i,e),r=1;else return;if(n.H!=0){if(e.i)if(r==1){t=e.u?e.u.length:0,e=Date.now()-e.G;var i=n.C;r=Kl(),yt(r,new zE(r,t)),th(n)}else vT(n);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&HF(n,e)||r==2&&og(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:bi(n,5);break;case 4:bi(n,10);break;case 3:bi(n,6);break;default:bi(n,2)}}}function ET(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function bi(n,e){if(n.l.info("Error code "+e),e==2){var t=null;n.h&&(t=null);var r=Tt(n.pb,n);t||(t=new Ni("//www.google.com/images/cleardot.gif"),Z.location&&Z.location.protocol=="http"||al(t,"https"),Yl(t)),qF(t.toString(),r)}else kt(2);n.H=0,n.h&&n.h.za(e),TT(n),_T(n)}q.pb=function(n){n?(this.l.info("Successfully pinged google.com"),kt(2)):(this.l.info("Failed to ping google.com"),kt(1))};function TT(n){if(n.H=0,n.ma=[],n.h){const e=uT(n.i);(e.length!=0||n.j.length!=0)&&(Pv(n.ma,e),Pv(n.ma,n.j),n.i.i.length=0,$p(n.j),n.j.length=0),n.h.ya()}}function AT(n,e,t){var r=t instanceof Ni?dr(t):new Ni(t);if(r.g!="")e&&(r.g=e+"."+r.g),cl(r,r.m);else{var i=Z.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Ni(null);r&&al(s,r),e&&(s.g=e),i&&cl(s,i),t&&(s.l=t),r=s}return t=n.F,e=n.Da,t&&e&&ke(r,t,e),ke(r,"VER",n.ra),yc(n,r),r}function RT(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n.Ha&&!n.va?new ze(new Jl({ob:t})):new ze(n.va),e.Oa(n.J),e}q.isActive=function(){return!!this.h&&this.h.isActive(this)};function ST(){}q=ST.prototype;q.Ba=function(){};q.Aa=function(){};q.za=function(){};q.ya=function(){};q.isActive=function(){return!0};q.Va=function(){};function ll(){if(Ys&&!(10<=Number(oF)))throw Error("Environmental error: no available transport.")}ll.prototype.g=function(n,e){return new Zt(n,e)};function Zt(n,e){ct.call(this),this.g=new mT(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Na(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Na(e)&&(this.g.F=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new mo(this)}ut(Zt,ct);Zt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;kt(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=AT(n,null,n.Y),th(n)};Zt.prototype.close=function(){sg(this.g)};Zt.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=Qp(n),n=t);e.j.push(new LF(e.fb++,n)),e.H==3&&th(e)};Zt.prototype.N=function(){this.g.h=null,delete this.j,sg(this.g),delete this.g,Zt.$.N.call(this)};function bT(n){eg.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}ut(bT,eg);function PT(){tg.call(this),this.status=1}ut(PT,tg);function mo(n){this.g=n}ut(mo,ST);mo.prototype.Ba=function(){yt(this.g,"a")};mo.prototype.Aa=function(n){yt(this.g,new bT(n))};mo.prototype.za=function(n){yt(this.g,new PT)};mo.prototype.ya=function(){yt(this.g,"b")};function jF(){this.blockSize=-1}function En(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ut(En,jF);En.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function uf(n,e,t){t||(t=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=n.g[0],t=n.g[1],i=n.g[2];var s=n.g[3],a=e+(s^t&(i^s))+r[0]+3614090360&4294967295;e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[1]+3905402710&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[3]+3250441966&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[4]+4118548399&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[5]+1200080426&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[7]+4249261313&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[8]+1770035416&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[9]+2336552879&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[11]+2304563134&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[12]+1804603682&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[13]+4254626195&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[15]+1236535329&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(i^s&(t^i))+r[1]+4129170786&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[6]+3225465664&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[0]+3921069994&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[5]+3593408605&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[10]+38016083&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[4]+3889429448&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[9]+568446438&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[14]+3275163606&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[8]+1163531501&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[13]+2850285829&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[2]+4243563512&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[12]+2368359562&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(t^i^s)+r[5]+4294588738&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[8]+2272392833&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[14]+4259657740&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[1]+2763975236&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[4]+1272893353&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[10]+3200236656&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[13]+681279174&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[0]+3936430074&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[6]+76029189&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[9]+3654602809&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[12]+3873151461&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[2]+3299628645&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(i^(t|~s))+r[0]+4096336452&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[7]+1126891415&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[5]+4237533241&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[12]+1700485571&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[3]+2399980690&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[1]+2240044497&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[8]+1873313359&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[15]+4264355552&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[13]+1309151649&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[4]+4149444226&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[11]+3174756917&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}En.prototype.j=function(n,e){e===void 0&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=t;)uf(this,n,s),s+=this.blockSize;if(typeof n=="string"){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){uf(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){uf(this,r),i=0;break}}this.h=i,this.i+=e};En.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=t&255,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};function Ae(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=n[i]|0;r&&s==e||(t[i]=s,r=!1)}this.g=t}var QF={};function cg(n){return-128<=n&&128>n?rF(n,function(e){return new Ae([e|0],0>e?-1:0)}):new Ae([n|0],0>n?-1:0)}function Mn(n){if(isNaN(n)||!isFinite(n))return qs;if(0>n)return gt(Mn(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=Uf;return new Ae(e,0)}function CT(n,e){if(n.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(n.charAt(0)=="-")return gt(CT(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Mn(Math.pow(e,8)),r=qs,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),a=parseInt(n.substring(i,i+s),e);8>s?(s=Mn(Math.pow(e,s)),r=r.R(s).add(Mn(a))):(r=r.R(t),r=r.add(Mn(a)))}return r}var Uf=4294967296,qs=cg(0),Bf=cg(1),Uv=cg(16777216);q=Ae.prototype;q.ea=function(){if(ln(this))return-gt(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:Uf+r)*e,e*=Uf}return n};q.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(or(this))return"0";if(ln(this))return"-"+gt(this).toString(n);for(var e=Mn(Math.pow(n,6)),t=this,r="";;){var i=dl(t,e).g;t=hl(t,i.R(e));var s=((0<t.g.length?t.g[0]:t.h)>>>0).toString(n);if(t=i,or(t))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};q.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function or(n){if(n.h!=0)return!1;for(var e=0;e<n.g.length;e++)if(n.g[e]!=0)return!1;return!0}function ln(n){return n.h==-1}q.X=function(n){return n=hl(this,n),ln(n)?-1:or(n)?0:1};function gt(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new Ae(t,~n.h).add(Bf)}q.abs=function(){return ln(this)?gt(this):this};q.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(n.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=a>>>16,s&=65535,a&=65535,t[i]=a<<16|s}return new Ae(t,t[t.length-1]&-2147483648?-1:0)};function hl(n,e){return n.add(gt(e))}q.R=function(n){if(or(this)||or(n))return qs;if(ln(this))return ln(n)?gt(this).R(gt(n)):gt(gt(this).R(n));if(ln(n))return gt(this.R(gt(n)));if(0>this.X(Uv)&&0>n.X(Uv))return Mn(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,a=this.D(r)&65535,l=n.D(i)>>>16,h=n.D(i)&65535;t[2*r+2*i]+=a*h,Du(t,2*r+2*i),t[2*r+2*i+1]+=s*h,Du(t,2*r+2*i+1),t[2*r+2*i+1]+=a*l,Du(t,2*r+2*i+1),t[2*r+2*i+2]+=s*l,Du(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new Ae(t,0)};function Du(n,e){for(;(n[e]&65535)!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function Jo(n,e){this.g=n,this.h=e}function dl(n,e){if(or(e))throw Error("division by zero");if(or(n))return new Jo(qs,qs);if(ln(n))return e=dl(gt(n),e),new Jo(gt(e.g),gt(e.h));if(ln(e))return e=dl(n,gt(e)),new Jo(gt(e.g),e.h);if(30<n.g.length){if(ln(n)||ln(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Bf,r=e;0>=r.X(n);)t=Bv(t),r=Bv(r);var i=Es(t,1),s=Es(r,1);for(r=Es(r,2),t=Es(t,2);!or(r);){var a=s.add(r);0>=a.X(n)&&(i=i.add(t),s=a),r=Es(r,1),t=Es(t,1)}return e=hl(n,i.R(e)),new Jo(i,e)}for(i=qs;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=Math.ceil(Math.log(t)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Mn(t),a=s.R(e);ln(a)||0<a.X(n);)t-=r,s=Mn(t),a=s.R(e);or(s)&&(s=Bf),i=i.add(s),n=hl(n,a)}return new Jo(i,n)}q.gb=function(n){return dl(this,n).h};q.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new Ae(t,this.h&n.h)};q.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new Ae(t,this.h|n.h)};q.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new Ae(t,this.h^n.h)};function Bv(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new Ae(t,n.h)}function Es(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new Ae(i,n.h)}ll.prototype.createWebChannel=ll.prototype.g;Zt.prototype.send=Zt.prototype.u;Zt.prototype.open=Zt.prototype.m;Zt.prototype.close=Zt.prototype.close;Hl.NO_ERROR=0;Hl.TIMEOUT=8;Hl.HTTP_ERROR=6;KE.COMPLETE="complete";HE.EventType=pc;pc.OPEN="a";pc.CLOSE="b";pc.ERROR="c";pc.MESSAGE="d";ct.prototype.listen=ct.prototype.O;ze.prototype.listenOnce=ze.prototype.P;ze.prototype.getLastError=ze.prototype.Sa;ze.prototype.getLastErrorCode=ze.prototype.Ia;ze.prototype.getStatus=ze.prototype.da;ze.prototype.getResponseJson=ze.prototype.Wa;ze.prototype.getResponseText=ze.prototype.ja;ze.prototype.send=ze.prototype.ha;ze.prototype.setWithCredentials=ze.prototype.Oa;En.prototype.digest=En.prototype.l;En.prototype.reset=En.prototype.reset;En.prototype.update=En.prototype.j;Ae.prototype.add=Ae.prototype.add;Ae.prototype.multiply=Ae.prototype.R;Ae.prototype.modulo=Ae.prototype.gb;Ae.prototype.compare=Ae.prototype.X;Ae.prototype.toNumber=Ae.prototype.ea;Ae.prototype.toString=Ae.prototype.toString;Ae.prototype.getBits=Ae.prototype.D;Ae.fromNumber=Mn;Ae.fromString=CT;var YF=function(){return new ll},JF=function(){return Kl()},lf=Hl,XF=KE,ZF=Ji,qv={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ku=HE,e2=ze,t2=En,$s=Ae;const $v="@firebase/firestore";class ot{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ot.UNAUTHENTICATED=new ot(null),ot.GOOGLE_CREDENTIALS=new ot("google-credentials-uid"),ot.FIRST_PARTY=new ot("first-party-uid"),ot.MOCK_USER=new ot("mock-user");let _o="10.7.0";const Wr=new Cl("@firebase/firestore");function Cs(){return Wr.logLevel}function n2(n){Wr.setLogLevel(n)}function N(n,...e){if(Wr.logLevel<=ue.DEBUG){const t=e.map(ug);Wr.debug(`Firestore (${_o}): ${n}`,...t)}}function Je(n,...e){if(Wr.logLevel<=ue.ERROR){const t=e.map(ug);Wr.error(`Firestore (${_o}): ${n}`,...t)}}function Tn(n,...e){if(Wr.logLevel<=ue.WARN){const t=e.map(ug);Wr.warn(`Firestore (${_o}): ${n}`,...t)}}function ug(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function $(n="Unexpected state"){const e=`FIRESTORE (${_o}) INTERNAL ASSERTION FAILED: `+n;throw Je(e),new Error(e)}function z(n,e){n||$()}function r2(n,e){n||$()}function B(n,e){return n}const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends xt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class at{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class DT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class i2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ot.UNAUTHENTICATED))}shutdown(){}}class s2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class o2{constructor(e){this.t=e,this.currentUser=ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let s=new at;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new at,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=s;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},l=h=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?l(h):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new at)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(z(typeof r.accessToken=="string"),new DT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return z(e===null||typeof e=="string"),new ot(e)}}class a2{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ot.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class c2{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new a2(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class u2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class l2{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{s.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,N("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(z(typeof t.token=="string"),this.R=t.token,new u2(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function h2(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class kT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=h2(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function ne(n,e){return n<e?-1:n>e?1:0}function Js(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function xT(n){return n+"\0"}class Le{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new k(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Le.fromMillis(Date.now())}static fromDate(e){return Le.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Le(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class K{constructor(e){this.timestamp=e}static fromTimestamp(e){return new K(e)}static min(){return new K(new Le(0,0))}static max(){return new K(new Le(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class qa{constructor(e,t,r){t===void 0?t=0:t>e.length&&$(),r===void 0?r=e.length-t:r>e.length-t&&$(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return qa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qa?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ge extends qa{construct(e,t,r){return new ge(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new k(b.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new ge(t)}static emptyPath(){return new ge([])}}const d2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ve extends qa{construct(e,t,r){return new Ve(e,t,r)}static isValidIdentifier(e){return d2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ve.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ve(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new k(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new k(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new k(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(s(),i++)}if(s(),a)throw new k(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ve(t)}static emptyPath(){return new Ve([])}}class F{constructor(e){this.path=e}static fromPath(e){return new F(ge.fromString(e))}static fromName(e){return new F(ge.fromString(e).popFirst(5))}static empty(){return new F(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ge.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new ge(e.slice()))}}class fl{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function qf(n){return n.fields.find(e=>e.kind===2)}function vi(n){return n.fields.filter(e=>e.kind!==2)}fl.UNKNOWN_ID=-1;class Gu{constructor(e,t){this.fieldPath=e,this.kind=t}}class $a{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new $a(0,en.min())}}function NT(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new Le(t+1,0):new Le(t,r));return new en(i,F.empty(),e)}function VT(n){return new en(n.readTime,n.key,-1)}class en{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new en(K.min(),F.empty(),-1)}static max(){return new en(K.max(),F.empty(),-1)}}function lg(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:ne(n.largestBatchId,e.largestBatchId))}const OT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class LT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function ri(n){if(n.code!==b.FAILED_PRECONDITION||n.message!==OT)throw n;N("LocalStore","Unexpectedly lost primary lease")}class R{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new R((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof R?t:R.resolve(t)}catch(t){return R.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):R.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):R.reject(t)}static resolve(e){return new R((t,r)=>{t(e)})}static reject(e){return new R((t,r)=>{r(e)})}static waitFor(e){return new R((t,r)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&t()},h=>r(h))}),a=!0,s===i&&t()})}static or(e){let t=R.resolve(!1);for(const r of e)t=t.next(i=>i?R.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new R((r,i)=>{const s=e.length,a=new Array(s);let l=0;for(let h=0;h<s;h++){const f=h;t(e[f]).next(p=>{a[f]=p,++l,l===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new R((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}class nh{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new at,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ya(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=hg(r.target.error);this.V.reject(new ya(e,i))}}static open(e,t,r,i){try{return new nh(t,e.transaction(i,r))}catch(s){throw new ya(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(N("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new p2(t)}}class In{constructor(e,t,r){this.name=e,this.version=t,this.p=r,In.S(Ue())===12.2&&Je("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return N("SimpleDb","Removing database:",e),Ii(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Aa())return!1;if(In.C())return!0;const e=Ue(),t=In.S(e),r=0<t&&t<10,i=In.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async O(e){return this.db||(N("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new ya(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new k(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new k(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new ya(e,a))},i.onupgradeneeded=s=>{N("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.p.N(a,i.transaction,s.oldVersion,this.version).next(()=>{N("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.O(e);const l=nh.open(this.db,e,s?"readonly":"readwrite",r),h=i(l).next(f=>(l.g(),f)).catch(f=>(l.abort(f),R.reject(f))).toPromise();return h.catch(()=>{}),await l.m,h}catch(l){const h=l,f=h.name!=="FirebaseError"&&a<3;if(N("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),this.close(),!f)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}class f2{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Ii(this.k.delete())}}class ya extends k{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ii(n){return n.name==="IndexedDbTransactionError"}class p2{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(N("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(N("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ii(r)}add(e){return N("SimpleDb","ADD",this.store.name,e,e),Ii(this.store.add(e))}get(e){return Ii(this.store.get(e)).next(t=>(t===void 0&&(t=null),N("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return N("SimpleDb","DELETE",this.store.name,e),Ii(this.store.delete(e))}count(){return N("SimpleDb","COUNT",this.store.name),Ii(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.G(i,(a,l)=>{s.push(l)}).next(()=>s)}{const i=this.store.getAll(r.range);return new R((s,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{s(l.target.result)}})}}j(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new R((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}H(e,t){N("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.J=!1;const i=this.cursor(r);return this.G(i,(s,a,l)=>l.delete())}Y(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Z(e){const t=this.cursor({});return new R((r,i)=>{t.onerror=s=>{const a=hg(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(l=>{l?a.continue():r()}):r()}})}G(e,t){const r=[];return new R((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const l=a.target.result;if(!l)return void i();const h=new f2(l),f=t(l.primaryKey,l.value,h);if(f instanceof R){const p=f.catch(m=>(h.done(),R.reject(m)));r.push(p)}h.isDone?i():h.$===null?l.continue():l.continue(h.$)}}).next(()=>R.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ii(n){return new R((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=hg(r.target.error);t(i)}})}let Wv=!1;function hg(n){const e=In.S(Ue());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Wv||(Wv=!0,setTimeout(()=>{throw r},0)),r}}return n}class g2{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){N("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{N("IndexBackiller",`Documents written: ${await this.X.te()}`)}catch(t){ii(t)?N("IndexBackiller","Ignoring IndexedDB error during index backfill: ",t):await ri(t)}await this.ee(6e4)})}}class m2{constructor(e,t){this.localStore=e,this.persistence=t}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ne(t,e))}ne(e,t){const r=new Set;let i=t,s=!0;return R.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return N("IndexBackiller",`Processing collection: ${a}`),this.re(e,a,i).next(l=>{i-=l,r.add(a)});s=!1})).next(()=>t-i)}re(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ie(i,s)).next(l=>(N("IndexBackiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>a.size)}))}ie(e,t){let r=e;return t.changes.forEach((i,s)=>{const a=VT(s);lg(a,r)>0&&(r=a)}),new en(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class $t{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.se(r),this.oe=r=>t.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}$t._e=-1;function vc(n){return n==null}function Wa(n){return n===0&&1/n==-1/0}function MT(n){return typeof n=="number"&&Number.isInteger(n)&&!Wa(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Nt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Gv(e)),e=_2(n.get(t),e);return Gv(e)}function _2(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function Gv(n){return n+""}function Fn(n){const e=n.length;if(z(e>=2),e===2)return z(n.charAt(0)===""&&n.charAt(1)===""),ge.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf("",s);switch((a<0||a>t)&&$(),n.charAt(a+1)){case"":const l=n.substring(s,a);let h;i.length===0?h=l:(i+=l,h=i,i=""),r.push(h);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:$()}s=a+2}return new ge(r)}const zv=["userId","batchId"];function zu(n,e){return[n,Nt(e)]}function FT(n,e,t){return[n,Nt(e),t]}const y2={},v2=["prefixPath","collectionGroup","readTime","documentId"],I2=["prefixPath","collectionGroup","documentId"],w2=["collectionGroup","readTime","prefixPath","documentId"],E2=["canonicalId","targetId"],T2=["targetId","path"],A2=["path","targetId"],R2=["collectionId","parent"],S2=["indexId","uid"],b2=["uid","sequenceNumber"],P2=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],C2=["indexId","uid","orderedDocumentKey"],D2=["userId","collectionPath","documentId"],k2=["userId","collectionPath","largestBatchId"],x2=["userId","collectionGroup","largestBatchId"],UT=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],N2=[...UT,"documentOverlays"],BT=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],qT=BT,V2=[...qT,"indexConfiguration","indexState","indexEntries"];class $f extends LT{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function lt(n,e){const t=B(n);return In.M(t.ae,e)}function Kv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Xi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function $T(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Pe{constructor(e,t){this.comparator=e,this.root=t||pt.EMPTY}insert(e,t){return new Pe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pt.BLACK,null,null))}remove(e){return new Pe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xu(this.root,e,this.comparator,!1)}getReverseIterator(){return new xu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xu(this.root,e,this.comparator,!0)}}class xu{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pt{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??pt.RED,this.left=i??pt.EMPTY,this.right=s??pt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new pt(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return pt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return pt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $();const e=this.left.check();if(e!==this.right.check())throw $();return e+(this.isRed()?0:1)}}pt.EMPTY=null,pt.RED=!0,pt.BLACK=!1;pt.EMPTY=new class{constructor(){this.size=0}get key(){throw $()}get value(){throw $()}get color(){throw $()}get left(){throw $()}get right(){throw $()}copy(e,t,r,i,s){return this}insert(e,t,r){return new pt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Re{constructor(e){this.comparator=e,this.data=new Pe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Hv(this.data.getIterator())}getIteratorFrom(e){return new Hv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Re(this.comparator);return t.data=e,t}}class Hv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ts(n){return n.hasNext()?n.getNext():void 0}class Wt{constructor(e){this.fields=e,e.sort(Ve.comparator)}static empty(){return new Wt([])}unionWith(e){let t=new Re(Ve.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Wt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Js(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class WT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function O2(){return typeof atob<"u"}class rt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new WT("Invalid base64 string: "+s):s}}(e);return new rt(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new rt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rt.EMPTY_BYTE_STRING=new rt("");const L2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gr(n){if(z(!!n),typeof n=="string"){let e=0;const t=L2.exec(n);if(z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$e(n.seconds),nanos:$e(n.nanos)}}function $e(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function zr(n){return typeof n=="string"?rt.fromBase64String(n):rt.fromUint8Array(n)}function rh(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function dg(n){const e=n.mapValue.fields.__previous_value__;return rh(e)?dg(e):e}function Ga(n){const e=Gr(n.mapValue.fields.__local_write_time__.timestampValue);return new Le(e.seconds,e.nanos)}class M2{constructor(e,t,r,i,s,a,l,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=f}}class Kr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Kr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Kr&&e.projectId===this.projectId&&e.database===this.database}}const Mr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ku={nullValue:"NULL_VALUE"};function Fi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?rh(n)?4:GT(n)?9007199254740991:10:$()}function Kn(n,e){if(n===e)return!0;const t=Fi(n);if(t!==Fi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ga(n).isEqual(Ga(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Gr(i.timestampValue),l=Gr(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return zr(i.bytesValue).isEqual(zr(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return $e(i.geoPointValue.latitude)===$e(s.geoPointValue.latitude)&&$e(i.geoPointValue.longitude)===$e(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return $e(i.integerValue)===$e(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=$e(i.doubleValue),l=$e(s.doubleValue);return a===l?Wa(a)===Wa(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return Js(n.arrayValue.values||[],e.arrayValue.values||[],Kn);case 10:return function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(Kv(a)!==Kv(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(l[h]===void 0||!Kn(a[h],l[h])))return!1;return!0}(n,e);default:return $()}}function za(n,e){return(n.values||[]).find(t=>Kn(t,e))!==void 0}function Hr(n,e){if(n===e)return 0;const t=Fi(n),r=Fi(e);if(t!==r)return ne(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ne(n.booleanValue,e.booleanValue);case 2:return function(s,a){const l=$e(s.integerValue||s.doubleValue),h=$e(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return jv(n.timestampValue,e.timestampValue);case 4:return jv(Ga(n),Ga(e));case 5:return ne(n.stringValue,e.stringValue);case 6:return function(s,a){const l=zr(s),h=zr(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),h=a.split("/");for(let f=0;f<l.length&&f<h.length;f++){const p=ne(l[f],h[f]);if(p!==0)return p}return ne(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){const l=ne($e(s.latitude),$e(a.latitude));return l!==0?l:ne($e(s.longitude),$e(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,a){const l=s.values||[],h=a.values||[];for(let f=0;f<l.length&&f<h.length;++f){const p=Hr(l[f],h[f]);if(p)return p}return ne(l.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===Mr.mapValue&&a===Mr.mapValue)return 0;if(s===Mr.mapValue)return 1;if(a===Mr.mapValue)return-1;const l=s.fields||{},h=Object.keys(l),f=a.fields||{},p=Object.keys(f);h.sort(),p.sort();for(let m=0;m<h.length&&m<p.length;++m){const I=ne(h[m],p[m]);if(I!==0)return I;const A=Hr(l[h[m]],f[p[m]]);if(A!==0)return A}return ne(h.length,p.length)}(n.mapValue,e.mapValue);default:throw $()}}function jv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ne(n,e);const t=Gr(n),r=Gr(e),i=ne(t.seconds,r.seconds);return i!==0?i:ne(t.nanos,r.nanos)}function Xs(n){return Wf(n)}function Wf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Gr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return zr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return F.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Wf(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${Wf(t.fields[a])}`;return i+"}"}(n.mapValue):$()}function Ui(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Gf(n){return!!n&&"integerValue"in n}function Ka(n){return!!n&&"arrayValue"in n}function Qv(n){return!!n&&"nullValue"in n}function Yv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Hu(n){return!!n&&"mapValue"in n}function va(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Xi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=va(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=va(n.arrayValue.values[t]);return e}return Object.assign({},n)}function GT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function F2(n){return"nullValue"in n?Ku:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ui(Kr.empty(),F.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:$()}function U2(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ui(Kr.empty(),F.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Mr:$()}function Jv(n,e){const t=Hr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Xv(n,e){const t=Hr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class mt{constructor(e){this.value=e}static empty(){return new mt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Hu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=va(t)}setAll(e){let t=Ve.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!t.isImmediateParentOf(l)){const h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=l.popLast()}a?r[l.lastSegment()]=va(a):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Hu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Kn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Hu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Xi(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new mt(va(this.value))}}function zT(n){const e=[];return Xi(n.fields,(t,r)=>{const i=new Ve([t]);if(Hu(r)){const s=zT(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Wt(e)}class xe{constructor(e,t,r,i,s,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new xe(e,0,K.min(),K.min(),K.min(),mt.empty(),0)}static newFoundDocument(e,t,r,i){return new xe(e,1,t,K.min(),r,i,0)}static newNoDocument(e,t){return new xe(e,2,t,K.min(),K.min(),mt.empty(),0)}static newUnknownDocument(e,t){return new xe(e,3,t,K.min(),K.min(),mt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=mt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=mt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class jr{constructor(e,t){this.position=e,this.inclusive=t}}function Zv(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=Hr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function eI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Kn(n.position[t],e.position[t]))return!1;return!0}class Ha{constructor(e,t="asc"){this.field=e,this.dir=t}}function B2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class KT{}class he extends KT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new q2(e,t,r):t==="array-contains"?new G2(e,r):t==="in"?new XT(e,r):t==="not-in"?new z2(e,r):t==="array-contains-any"?new K2(e,r):new he(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new $2(e,r):new W2(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Hr(t,this.value)):t!==null&&Fi(this.value)===Fi(t)&&this.matchesComparison(Hr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Te extends KT{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Te(e,t)}matches(e){return Zs(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Zs(n){return n.op==="and"}function zf(n){return n.op==="or"}function fg(n){return HT(n)&&Zs(n)}function HT(n){for(const e of n.filters)if(e instanceof Te)return!1;return!0}function Kf(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+Xs(n.value);if(fg(n))return n.filters.map(e=>Kf(e)).join(",");{const e=n.filters.map(t=>Kf(t)).join(",");return`${n.op}(${e})`}}function jT(n,e){return n instanceof he?function(r,i){return i instanceof he&&r.op===i.op&&r.field.isEqual(i.field)&&Kn(r.value,i.value)}(n,e):n instanceof Te?function(r,i){return i instanceof Te&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,l)=>s&&jT(a,i.filters[l]),!0):!1}(n,e):void $()}function QT(n,e){const t=n.filters.concat(e);return Te.create(t,n.op)}function YT(n){return n instanceof he?function(t){return`${t.field.canonicalString()} ${t.op} ${Xs(t.value)}`}(n):n instanceof Te?function(t){return t.op.toString()+" {"+t.getFilters().map(YT).join(" ,")+"}"}(n):"Filter"}class q2 extends he{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){const t=F.comparator(e.key,this.key);return this.matchesComparison(t)}}class $2 extends he{constructor(e,t){super(e,"in",t),this.keys=JT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class W2 extends he{constructor(e,t){super(e,"not-in",t),this.keys=JT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function JT(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>F.fromName(r.referenceValue))}class G2 extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ka(t)&&za(t.arrayValue,this.value)}}class XT extends he{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&za(this.value.arrayValue,t)}}class z2 extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(za(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!za(this.value.arrayValue,t)}}class K2 extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ka(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>za(this.value.arrayValue,r))}}class H2{constructor(e,t=null,r=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.ce=null}}function Hf(n,e=null,t=[],r=[],i=null,s=null,a=null){return new H2(n,e,t,r,i,s,a)}function Bi(n){const e=B(n);if(e.ce===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Kf(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),vc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Xs(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Xs(r)).join(",")),e.ce=t}return e.ce}function Ic(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!B2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!jT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!eI(n.startAt,e.startAt)&&eI(n.endAt,e.endAt)}function pl(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function gl(n,e){return n.filters.filter(t=>t instanceof he&&t.field.isEqual(e))}function tI(n,e,t){let r=Ku,i=!0;for(const s of gl(n,e)){let a=Ku,l=!0;switch(s.op){case"<":case"<=":a=F2(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,l=!1;break;case"!=":case"not-in":a=Ku}Jv({value:r,inclusive:i},{value:a,inclusive:l})<0&&(r=a,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Jv({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function nI(n,e,t){let r=Mr,i=!0;for(const s of gl(n,e)){let a=Mr,l=!0;switch(s.op){case">=":case">":a=U2(s.value),l=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,l=!1;break;case"!=":case"not-in":a=Mr}Xv({value:r,inclusive:i},{value:a,inclusive:l})>0&&(r=a,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Xv({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class mr{constructor(e,t=null,r=[],i=[],s=null,a="F",l=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=h,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function ZT(n,e,t,r,i,s,a,l){return new mr(n,e,t,r,i,s,a,l)}function yo(n){return new mr(n)}function rI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function pg(n){return n.collectionGroup!==null}function Ws(n){const e=B(n);if(e.le===null){e.le=[];const t=new Set;for(const s of e.explicitOrderBy)e.le.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Re(Ve.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.le.push(new Ha(s,r))}),t.has(Ve.keyField().canonicalString())||e.le.push(new Ha(Ve.keyField(),r))}return e.le}function Vt(n){const e=B(n);return e.he||(e.he=j2(e,Ws(n))),e.he}function j2(n,e){if(n.limitType==="F")return Hf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ha(i.field,s)});const t=n.endAt?new jr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new jr(n.startAt.position,n.startAt.inclusive):null;return Hf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function jf(n,e){const t=n.filters.concat([e]);return new mr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ml(n,e,t){return new mr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function wc(n,e){return Ic(Vt(n),Vt(e))&&n.limitType===e.limitType}function eA(n){return`${Bi(Vt(n))}|lt:${n.limitType}`}function Ds(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>YT(i)).join(", ")}]`),vc(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Xs(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Xs(i)).join(",")),`Target(${r})`}(Vt(n))}; limitType=${n.limitType})`}function Ec(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):F.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Ws(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,l,h){const f=Zv(a,l,h);return a.inclusive?f<=0:f<0}(r.startAt,Ws(r),i)||r.endAt&&!function(a,l,h){const f=Zv(a,l,h);return a.inclusive?f>=0:f>0}(r.endAt,Ws(r),i))}(n,e)}function tA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function nA(n){return(e,t)=>{let r=!1;for(const i of Ws(n)){const s=Q2(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Q2(n,e,t){const r=n.field.isKeyField()?F.comparator(e.key,t.key):function(s,a,l){const h=a.data.field(s),f=l.data.field(s);return h!==null&&f!==null?Hr(h,f):$()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return $()}}class si{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Xi(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return $T(this.inner)}size(){return this.innerSize}}const Y2=new Pe(F.comparator);function Gt(){return Y2}const rA=new Pe(F.comparator);function la(...n){let e=rA;for(const t of n)e=e.insert(t.key,t);return e}function iA(n){let e=rA;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Un(){return Ia()}function sA(){return Ia()}function Ia(){return new si(n=>n.toString(),(n,e)=>n.isEqual(e))}const J2=new Pe(F.comparator),X2=new Re(F.comparator);function re(...n){let e=X2;for(const t of n)e=e.add(t);return e}const Z2=new Re(ne);function gg(){return Z2}function oA(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wa(e)?"-0":e}}function aA(n){return{integerValue:""+n}}function cA(n,e){return MT(e)?aA(e):oA(n,e)}class ih{constructor(){this._=void 0}}function eU(n,e,t){return n instanceof eo?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&rh(s)&&(s=dg(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof qi?lA(n,e):n instanceof $i?hA(n,e):function(i,s){const a=uA(i,s),l=iI(a)+iI(i.Ie);return Gf(a)&&Gf(i.Ie)?aA(l):oA(i.serializer,l)}(n,e)}function tU(n,e,t){return n instanceof qi?lA(n,e):n instanceof $i?hA(n,e):t}function uA(n,e){return n instanceof to?function(r){return Gf(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class eo extends ih{}class qi extends ih{constructor(e){super(),this.elements=e}}function lA(n,e){const t=dA(e);for(const r of n.elements)t.some(i=>Kn(i,r))||t.push(r);return{arrayValue:{values:t}}}class $i extends ih{constructor(e){super(),this.elements=e}}function hA(n,e){let t=dA(e);for(const r of n.elements)t=t.filter(i=>!Kn(i,r));return{arrayValue:{values:t}}}class to extends ih{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function iI(n){return $e(n.integerValue||n.doubleValue)}function dA(n){return Ka(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Tc{constructor(e,t){this.field=e,this.transform=t}}function nU(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof qi&&i instanceof qi||r instanceof $i&&i instanceof $i?Js(r.elements,i.elements,Kn):r instanceof to&&i instanceof to?Kn(r.Ie,i.Ie):r instanceof eo&&i instanceof eo}(n.transform,e.transform)}class rU{constructor(e,t){this.version=e,this.transformResults=t}}class Oe{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Oe}static exists(e){return new Oe(void 0,e)}static updateTime(e){return new Oe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ju(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class sh{}function fA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Io(n.key,Oe.none()):new vo(n.key,n.data,Oe.none());{const t=n.data,r=mt.empty();let i=new Re(Ve.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new _r(n.key,r,new Wt(i.toArray()),Oe.none())}}function iU(n,e,t){n instanceof vo?function(i,s,a){const l=i.value.clone(),h=oI(i.fieldTransforms,s,a.transformResults);l.setAll(h),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof _r?function(i,s,a){if(!ju(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=oI(i.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(pA(i)),h.setAll(l),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function wa(n,e,t,r){return n instanceof vo?function(s,a,l,h){if(!ju(s.precondition,a))return l;const f=s.value.clone(),p=aI(s.fieldTransforms,h,a);return f.setAll(p),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof _r?function(s,a,l,h){if(!ju(s.precondition,a))return l;const f=aI(s.fieldTransforms,h,a),p=a.data;return p.setAll(pA(s)),p.setAll(f),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,a,l){return ju(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(n,e,t)}function sU(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=uA(r.transform,i||null);s!=null&&(t===null&&(t=mt.empty()),t.set(r.field,s))}return t||null}function sI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Js(r,i,(s,a)=>nU(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class vo extends sh{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class _r extends sh{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function pA(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function oI(n,e,t){const r=new Map;z(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,l=e.data.field(s.field);r.set(s.field,tU(a,l,t[i]))}return r}function aI(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,eU(s,a,e))}return r}class Io extends sh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mg extends sh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class _g{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&iU(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=wa(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=wa(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=sA();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=t.has(i.key)?null:l;const h=fA(a,l);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),re())}isEqual(e){return this.batchId===e.batchId&&Js(this.mutations,e.mutations,(t,r)=>sI(t,r))&&Js(this.baseMutations,e.baseMutations,(t,r)=>sI(t,r))}}class yg{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){z(e.mutations.length===r.length);let i=function(){return J2}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new yg(e,t,r,i)}}class vg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class oU{constructor(e,t){this.count=e,this.unchangedNames=t}}var Ze,pe;function gA(n){switch(n){default:return $();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function mA(n){if(n===void 0)return Je("GRPC error has no .code"),b.UNKNOWN;switch(n){case Ze.OK:return b.OK;case Ze.CANCELLED:return b.CANCELLED;case Ze.UNKNOWN:return b.UNKNOWN;case Ze.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Ze.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Ze.INTERNAL:return b.INTERNAL;case Ze.UNAVAILABLE:return b.UNAVAILABLE;case Ze.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Ze.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Ze.NOT_FOUND:return b.NOT_FOUND;case Ze.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Ze.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Ze.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Ze.ABORTED:return b.ABORTED;case Ze.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Ze.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Ze.DATA_LOSS:return b.DATA_LOSS;default:return $()}}(pe=Ze||(Ze={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";function _A(){return new TextEncoder}const aU=new $s([4294967295,4294967295],0);function cI(n){const e=_A().encode(n),t=new t2;return t.update(e),new Uint8Array(t.digest())}function uI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new $s([t,r],0),new $s([i,s],0)]}class Ig{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ha(`Invalid padding: ${t}`);if(r<0)throw new ha(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ha(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ha(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=$s.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply($s.fromNumber(r)));return i.compare(aU)===1&&(i=new $s([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const t=cI(e),[r,i]=uI(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);if(!this.Ae(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Ig(s,i,t);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Te===0)return;const t=cI(e),[r,i]=uI(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);this.Re(a)}}Re(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ha extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ac{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Rc.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ac(K.min(),i,new Pe(ne),Gt(),re())}}class Rc{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Rc(r,t,re(),re(),re())}}class Qu{constructor(e,t,r,i){this.Ve=e,this.removedTargetIds=t,this.key=r,this.me=i}}class yA{constructor(e,t){this.targetId=e,this.fe=t}}class vA{constructor(e,t,r=rt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class lI{constructor(){this.ge=0,this.pe=dI(),this.ye=rt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=re(),t=re(),r=re();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:$()}}),new Rc(this.ye,this.we,e,t,r)}Fe(){this.Se=!1,this.pe=dI()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,z(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class cU{constructor(e){this.Le=e,this.ke=new Map,this.qe=Gt(),this.Qe=hI(),this.Ke=new Pe(ne)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(t);break;case 3:this.je(t)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.Ce(e.resumeToken));break;default:$()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){const t=e.targetId,r=e.fe.count,i=this.Ye(t);if(i){const s=i.target;if(pl(s))if(r===0){const a=new F(s.path);this.We(t,a,xe.newNoDocument(a,K.min()))}else z(r===1);else{const a=this.Ze(t);if(a!==r){const l=this.Xe(e),h=l?this.et(l,e,a):1;if(h!==0){this.He(t);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,f)}}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,l;try{a=zr(r).toUint8Array()}catch(h){if(h instanceof WT)return Tn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{l=new Ig(a,i,s)}catch(h){return Tn(h instanceof ha?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return l.Te===0?null:l}et(e,t,r){return t.fe.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const a=this.Le.nt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.We(t,s,null),i++)}),i}it(e){const t=new Map;this.ke.forEach((s,a)=>{const l=this.Ye(a);if(l){if(s.current&&pl(l.target)){const h=new F(l.target.path);this.qe.get(h)!==null||this.st(a,h)||this.We(a,h,xe.newNoDocument(h,e))}s.De&&(t.set(a,s.ve()),s.Fe())}});let r=re();this.Qe.forEach((s,a)=>{let l=!0;a.forEachWhile(h=>{const f=this.Ye(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(e));const i=new Ac(e,t,this.Ke,this.qe,r);return this.qe=Gt(),this.Qe=hI(),this.Ke=new Pe(ne),i}Ue(e,t){if(!this.je(e))return;const r=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,r),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,t)?i.Me(t,1):i.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),r&&(this.qe=this.qe.insert(t,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new lI,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new Re(ne),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=this.Ye(e)!==null;return t||N("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new lI),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function hI(){return new Pe(F.comparator)}function dI(){return new Pe(F.comparator)}const uU=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),lU=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),hU=(()=>({and:"AND",or:"OR"}))();class dU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Qf(n,e){return n.useProto3Json||vc(e)?e:{value:e}}function no(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function IA(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function fU(n,e){return no(n,e.toTimestamp())}function Xe(n){return z(!!n),K.fromTimestamp(function(t){const r=Gr(t);return new Le(r.seconds,r.nanos)}(n))}function wg(n,e){return function(r){return new ge(["projects",r.projectId,"databases",r.database])}(n).child("documents").child(e).canonicalString()}function wA(n){const e=ge.fromString(n);return z(DA(e)),e}function ja(n,e){return wg(n.databaseId,e.path)}function $n(n,e){const t=wA(e);if(t.get(1)!==n.databaseId.projectId)throw new k(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new k(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(TA(t))}function Yf(n,e){return wg(n.databaseId,e)}function EA(n){const e=wA(n);return e.length===4?ge.emptyPath():TA(e)}function Qa(n){return new ge(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function TA(n){return z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function fI(n,e,t){return{name:ja(n,e),fields:t.value.mapValue.fields}}function AA(n,e,t){const r=$n(n,e.name),i=Xe(e.updateTime),s=e.createTime?Xe(e.createTime):K.min(),a=new mt({mapValue:{fields:e.fields}}),l=xe.newFoundDocument(r,i,s,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function pU(n,e){return"found"in e?function(r,i){z(!!i.found),i.found.name,i.found.updateTime;const s=$n(r,i.found.name),a=Xe(i.found.updateTime),l=i.found.createTime?Xe(i.found.createTime):K.min(),h=new mt({mapValue:{fields:i.found.fields}});return xe.newFoundDocument(s,a,l,h)}(n,e):"missing"in e?function(r,i){z(!!i.missing),z(!!i.readTime);const s=$n(r,i.missing),a=Xe(i.readTime);return xe.newNoDocument(s,a)}(n,e):$()}function gU(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:$()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(f,p){return f.useProto3Json?(z(p===void 0||typeof p=="string"),rt.fromBase64String(p||"")):(z(p===void 0||p instanceof Uint8Array),rt.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(f){const p=f.code===void 0?b.UNKNOWN:mA(f.code);return new k(p,f.message||"")}(a);t=new vA(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=$n(n,r.document.name),s=Xe(r.document.updateTime),a=r.document.createTime?Xe(r.document.createTime):K.min(),l=new mt({mapValue:{fields:r.document.fields}}),h=xe.newFoundDocument(i,s,a,l),f=r.targetIds||[],p=r.removedTargetIds||[];t=new Qu(f,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=$n(n,r.document),s=r.readTime?Xe(r.readTime):K.min(),a=xe.newNoDocument(i,s),l=r.removedTargetIds||[];t=new Qu([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=$n(n,r.document),s=r.removedTargetIds||[];t=new Qu([],s,i,null)}else{if(!("filter"in e))return $();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new oU(i,s),l=r.targetId;t=new yA(l,a)}}return t}function Ya(n,e){let t;if(e instanceof vo)t={update:fI(n,e.key,e.value)};else if(e instanceof Io)t={delete:ja(n,e.key)};else if(e instanceof _r)t={update:fI(n,e.key,e.data),updateMask:wU(e.fieldMask)};else{if(!(e instanceof mg))return $();t={verify:ja(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const l=a.transform;if(l instanceof eo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof qi)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof $i)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof to)return{fieldPath:a.field.canonicalString(),increment:l.Ie};throw $()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:fU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:$()}(n,e.precondition)),t}function Jf(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Oe.updateTime(Xe(s.updateTime)):s.exists!==void 0?Oe.exists(s.exists):Oe.none()}(e.currentDocument):Oe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;if("setToServerValue"in l)z(l.setToServerValue==="REQUEST_TIME"),h=new eo;else if("appendMissingElements"in l){const p=l.appendMissingElements.values||[];h=new qi(p)}else if("removeAllFromArray"in l){const p=l.removeAllFromArray.values||[];h=new $i(p)}else"increment"in l?h=new to(a,l.increment):$();const f=Ve.fromServerFormat(l.fieldPath);return new Tc(f,h)}(n,i)):[];if(e.update){e.update.name;const i=$n(n,e.update.name),s=new mt({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(h){const f=h.fieldPaths||[];return new Wt(f.map(p=>Ve.fromServerFormat(p)))}(e.updateMask);return new _r(i,s,a,t,r)}return new vo(i,s,t,r)}if(e.delete){const i=$n(n,e.delete);return new Io(i,t)}if(e.verify){const i=$n(n,e.verify);return new mg(i,t)}return $()}function mU(n,e){return n&&n.length>0?(z(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?Xe(i.updateTime):Xe(s);return a.isEqual(K.min())&&(a=Xe(s)),new rU(a,i.transformResults||[])}(t,e))):[]}function RA(n,e){return{documents:[Yf(n,e.path)]}}function SA(n,e){const t={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(t.parent=Yf(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Yf(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(h){if(h.length!==0)return CA(Te.create(h,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(h){if(h.length!==0)return h.map(f=>function(m){return{field:ks(m.field),direction:yU(m.dir)}}(f))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=Qf(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),t}function bA(n){let e=EA(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){z(r===1);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){const I=PA(m);return I instanceof Te&&fg(I)?I.getFilters():[I]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(I=>function(L){return new Ha(xs(L.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(L.direction))}(I))}(t.orderBy));let l=null;t.limit&&(l=function(m){let I;return I=typeof m=="object"?m.value:m,vc(I)?null:I}(t.limit));let h=null;t.startAt&&(h=function(m){const I=!!m.before,A=m.values||[];return new jr(A,I)}(t.startAt));let f=null;return t.endAt&&(f=function(m){const I=!m.before,A=m.values||[];return new jr(A,I)}(t.endAt)),ZT(e,i,a,s,l,"F",h,f)}function _U(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function PA(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=xs(t.unaryFilter.field);return he.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=xs(t.unaryFilter.field);return he.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=xs(t.unaryFilter.field);return he.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=xs(t.unaryFilter.field);return he.create(a,"!=",{nullValue:"NULL_VALUE"});default:return $()}}(n):n.fieldFilter!==void 0?function(t){return he.create(xs(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Te.create(t.compositeFilter.filters.map(r=>PA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $()}}(t.compositeFilter.op))}(n):$()}function yU(n){return uU[n]}function vU(n){return lU[n]}function IU(n){return hU[n]}function ks(n){return{fieldPath:n.canonicalString()}}function xs(n){return Ve.fromServerFormat(n.fieldPath)}function CA(n){return n instanceof he?function(t){if(t.op==="=="){if(Yv(t.value))return{unaryFilter:{field:ks(t.field),op:"IS_NAN"}};if(Qv(t.value))return{unaryFilter:{field:ks(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Yv(t.value))return{unaryFilter:{field:ks(t.field),op:"IS_NOT_NAN"}};if(Qv(t.value))return{unaryFilter:{field:ks(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ks(t.field),op:vU(t.op),value:t.value}}}(n):n instanceof Te?function(t){const r=t.getFilters().map(i=>CA(i));return r.length===1?r[0]:{compositeFilter:{op:IU(t.op),filters:r}}}(n):$()}function wU(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function DA(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class ar{constructor(e,t,r,i,s=K.min(),a=K.min(),l=rt.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(e){return new ar(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ar(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class kA{constructor(e){this.ut=e}}function EU(n,e){let t;if(e.document)t=AA(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=F.fromSegments(e.noDocument.path),i=Gi(e.noDocument.readTime);t=xe.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return $();{const r=F.fromSegments(e.unknownDocument.path),i=Gi(e.unknownDocument.version);t=xe.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Le(i[0],i[1]);return K.fromTimestamp(s)}(e.readTime)),t}function pI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:_l(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,a){return{name:ja(s,a.key),fields:a.data.value.mapValue.fields,updateTime:no(s,a.version.toTimestamp()),createTime:no(s,a.createTime.toTimestamp())}}(n.ut,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Wi(e.version)};else{if(!e.isUnknownDocument())return $();r.unknownDocument={path:t.path.toArray(),version:Wi(e.version)}}return r}function _l(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Wi(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Gi(n){const e=new Le(n.seconds,n.nanoseconds);return K.fromTimestamp(e)}function wi(n,e){const t=(e.baseMutations||[]).map(s=>Jf(n.ut,s));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];a.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Jf(n.ut,s)),i=Le.fromMillis(e.localWriteTimeMs);return new _g(e.batchId,i,t,r)}function da(n){const e=Gi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Gi(n.lastLimboFreeSnapshotVersion):K.min();let r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return z(s.documents.length===1),Vt(yo(EA(s.documents[0])))}(n.query):function(s){return Vt(bA(s))}(n.query),new ar(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,rt.fromBase64String(n.resumeToken))}function xA(n,e){const t=Wi(e.snapshotVersion),r=Wi(e.lastLimboFreeSnapshotVersion);let i;i=pl(e.target)?RA(n.ut,e.target):SA(n.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Bi(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Eg(n){const e=bA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ml(e,e.limit,"L"):e}function hf(n,e){return new vg(e.largestBatchId,Jf(n.ut,e.overlayMutation))}function gI(n,e){const t=e.path.lastSegment();return[n,Nt(e.path.popLast()),t]}function mI(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Wi(r.readTime),documentKey:Nt(r.documentKey.path),largestBatchId:r.largestBatchId}}class TU{getBundleMetadata(e,t){return _I(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Gi(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return _I(e).put(function(i){return{bundleId:i.id,createTime:Wi(Xe(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return yI(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:Eg(s.bundledQuery),readTime:Gi(s.readTime)}}(r)})}saveNamedQuery(e,t){return yI(e).put(function(i){return{name:i.name,readTime:Wi(Xe(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function _I(n){return lt(n,"bundles")}function yI(n){return lt(n,"namedQueries")}class oh{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){const r=t.uid||"";return new oh(e,r)}getOverlay(e,t){return Xo(e).get(gI(this.userId,t)).next(r=>r?hf(this.serializer,r):null)}getOverlays(e,t){const r=Un();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,a)=>{const l=new vg(t,a);i.push(this.lt(e,l))}),R.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(a=>i.add(Nt(a.getCollectionPath())));const s=[];return i.forEach(a=>{const l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(Xo(e).H("collectionPathOverlayIndex",l))}),R.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Un(),s=Nt(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Xo(e).W("collectionPathOverlayIndex",a).next(l=>{for(const h of l){const f=hf(this.serializer,h);i.set(f.getKey(),f)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Un();let a;const l=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Xo(e).Y({index:"collectionGroupOverlayIndex",range:l},(h,f,p)=>{const m=hf(this.serializer,f);s.size()<i||m.largestBatchId===a?(s.set(m.getKey(),m),a=m.largestBatchId):p.done()}).next(()=>s)}lt(e,t){return Xo(e).put(function(i,s,a){const[l,h,f]=gI(s,a.mutation.key);return{userId:s,collectionPath:h,documentId:f,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Ya(i.ut,a.mutation)}}(this.serializer,this.userId,t))}}function Xo(n){return lt(n,"documentOverlays")}class Ei{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et($e(e.integerValue));else if("doubleValue"in e){const r=$e(e.doubleValue);isNaN(r)?this.Tt(t,13):(this.Tt(t,15),Wa(r)?t.Et(0):t.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(t,20),typeof r=="string"?t.dt(r):(t.dt(`${r.seconds||""}`),t.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(zr(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(t,45),t.Et(r.latitude||0),t.Et(r.longitude||0)}else"mapValue"in e?GT(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):$()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const r=e.fields||{};this.Tt(t,55);for(const i of Object.keys(r))this.At(i,t),this.Pt(r[i],t)}yt(e,t){const r=e.values||[];this.Tt(t,50);for(const i of r)this.Pt(i,t)}ft(e,t){this.Tt(t,37),F.fromName(e).path.forEach(r=>{this.Tt(t,60),this.wt(r,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}Ei.St=new Ei;function AU(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function vI(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const a=AU(255&r[s]);if(i+=a,a!==8)break}return i}(n);return Math.ceil(e/8)}class RU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Dt(r.value),r=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=t.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const t=this.Bt(e),r=vI(t);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}kt(e){const t=this.Bt(e),r=vI(t);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Dt(e){const t=255&e;t===0?(this.Qt(0),this.Qt(255)):t===255?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;t===0?(this.$t(0),this.$t(255)):t===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class SU{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class bU{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class Zo{constructor(){this.Wt=new RU,this.Gt=new SU(this.Wt),this.zt=new bU(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class Ti{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ti(this.indexId,this.documentKey,this.arrayValue,r)}}function Dr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=II(n.arrayValue,e.arrayValue),t!==0?t:(t=II(n.directionalValue,e.directionalValue),t!==0?t:F.comparator(n.documentKey,e.documentKey)))}function II(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}class wI{constructor(e){this.Jt=new Re((t,r)=>Ve.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const r=t;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(z(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=qf(e);if(t!==void 0&&!this.tn(t))return!1;const r=vi(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const l=this.Jt.getIterator().getNext();if(!i.has(l.field.canonicalString())){const h=r[s];if(!this.nn(l,h)||!this.rn(this.Yt[a++],h))return!1}++s}for(;s<r.length;++s){const l=r[s];if(a>=this.Yt.length||!this.rn(this.Yt[a++],l))return!1}return!0}sn(){if(this.Xt)return null;let e=new Re(Ve.comparator);const t=[];for(const r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Gu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Gu(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Gu(r.field,r.dir==="asc"?0:1)));return new fl(fl.UNKNOWN_ID,this.collectionId,t,$a.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function NA(n){var e,t;if(z(n instanceof he||n instanceof Te),n instanceof he){if(n instanceof XT){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>he.create(n.field,"==",s)))||[];return Te.create(i,"or")}return n}const r=n.filters.map(i=>NA(i));return Te.create(r,n.op)}function PU(n){if(n.getFilters().length===0)return[];const e=ep(NA(n));return z(VA(e)),Xf(e)||Zf(e)?[e]:e.getFilters()}function Xf(n){return n instanceof he}function Zf(n){return n instanceof Te&&fg(n)}function VA(n){return Xf(n)||Zf(n)||function(t){if(t instanceof Te&&zf(t)){for(const r of t.getFilters())if(!Xf(r)&&!Zf(r))return!1;return!0}return!1}(n)}function ep(n){if(z(n instanceof he||n instanceof Te),n instanceof he)return n;if(n.filters.length===1)return ep(n.filters[0]);const e=n.filters.map(r=>ep(r));let t=Te.create(e,n.op);return t=yl(t),VA(t)?t:(z(t instanceof Te),z(Zs(t)),z(t.filters.length>1),t.filters.reduce((r,i)=>Tg(r,i)))}function Tg(n,e){let t;return z(n instanceof he||n instanceof Te),z(e instanceof he||e instanceof Te),t=n instanceof he?e instanceof he?function(i,s){return Te.create([i,s],"and")}(n,e):EI(n,e):e instanceof he?EI(e,n):function(i,s){if(z(i.filters.length>0&&s.filters.length>0),Zs(i)&&Zs(s))return QT(i,s.getFilters());const a=zf(i)?i:s,l=zf(i)?s:i,h=a.filters.map(f=>Tg(f,l));return Te.create(h,"or")}(n,e),yl(t)}function EI(n,e){if(Zs(e))return QT(e,n.getFilters());{const t=e.filters.map(r=>Tg(n,r));return Te.create(t,"or")}}function yl(n){if(z(n instanceof he||n instanceof Te),n instanceof he)return n;const e=n.getFilters();if(e.length===1)return yl(e[0]);if(HT(n))return n;const t=e.map(i=>yl(i)),r=[];return t.forEach(i=>{i instanceof he?r.push(i):i instanceof Te&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Te.create(r,n.op)}class CU{constructor(){this.on=new Ag}addToCollectionParentIndex(e,t){return this.on.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(en.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(en.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}}class Ag{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Re(ge.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Re(ge.comparator)).toArray()}}const Nu=new Uint8Array(0);class DU{constructor(e,t){this.user=e,this.databaseId=t,this._n=new Ag,this.an=new si(r=>Bi(r),(r,i)=>Ic(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:r,parent:Nt(i)};return TI(e).put(s)}return R.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[xT(t),""],!1,!0);return TI(e).W(i).next(s=>{for(const a of s){if(a.collectionId!==t)break;r.push(Fn(a.parent))}return r})}addFieldIndex(e,t){const r=ea(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=Rs(e);return s.next(l=>{a.put(mI(l,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=ea(e),i=Rs(e),s=As(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=ea(e),r=As(e),i=Rs(e);return t.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,t){return R.forEach(this.un(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new wI(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=As(e);let i=!0;const s=new Map;return R.forEach(this.un(t),a=>this.cn(e,a).next(l=>{i&&(i=!!l),s.set(a,l)})).next(()=>{if(i){let a=re();const l=[];return R.forEach(s,(h,f)=>{N("IndexedDbIndexManager",`Using index ${function(j){return`id=${j.indexId}|cg=${j.collectionGroup}|f=${j.fields.map(ye=>`${ye.fieldPath}:${ye.kind}`).join(",")}`}(h)} to execute ${Bi(t)}`);const p=function(j,ye){const de=qf(ye);if(de===void 0)return null;for(const me of gl(j,de.fieldPath))switch(me.op){case"array-contains-any":return me.value.arrayValue.values||[];case"array-contains":return[me.value]}return null}(f,h),m=function(j,ye){const de=new Map;for(const me of vi(ye))for(const we of gl(j,me.fieldPath))switch(we.op){case"==":case"in":de.set(me.fieldPath.canonicalString(),we.value);break;case"not-in":case"!=":return de.set(me.fieldPath.canonicalString(),we.value),Array.from(de.values())}return null}(f,h),I=function(j,ye){const de=[];let me=!0;for(const we of vi(ye)){const Ot=we.kind===0?tI(j,we.fieldPath,j.startAt):nI(j,we.fieldPath,j.startAt);de.push(Ot.value),me&&(me=Ot.inclusive)}return new jr(de,me)}(f,h),A=function(j,ye){const de=[];let me=!0;for(const we of vi(ye)){const Ot=we.kind===0?nI(j,we.fieldPath,j.endAt):tI(j,we.fieldPath,j.endAt);de.push(Ot.value),me&&(me=Ot.inclusive)}return new jr(de,me)}(f,h),L=this.ln(h,f,I),M=this.ln(h,f,A),V=this.hn(h,f,m),Y=this.Pn(h.indexId,p,L,I.inclusive,M,A.inclusive,V);return R.forEach(Y,ae=>r.j(ae,t.limit).next(j=>{j.forEach(ye=>{const de=F.fromSegments(ye.documentKey);a.has(de)||(a=a.add(de),l.push(de))})}))}).next(()=>l)}return R.resolve(null)})}un(e){let t=this.an.get(e);return t||(e.filters.length===0?t=[e]:t=PU(Te.create(e.filters,"and")).map(r=>Hf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,r,i,s,a,l){const h=(t!=null?t.length:1)*Math.max(r.length,s.length),f=h/(t!=null?t.length:1),p=[];for(let m=0;m<h;++m){const I=t?this.In(t[m/f]):Nu,A=this.Tn(e,I,r[m%f],i),L=this.En(e,I,s[m%f],a),M=l.map(V=>this.Tn(e,I,V,!0));p.push(...this.createRange(A,L,M))}return p}Tn(e,t,r,i){const s=new Ti(e,F.empty(),t,r);return i?s:s.Ht()}En(e,t,r,i){const s=new Ti(e,F.empty(),t,r);return i?s.Ht():s}cn(e,t){const r=new wI(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const l of s)r.en(l)&&(!a||l.fields.length>a.fields.length)&&(a=l);return a})}getIndexType(e,t){let r=2;const i=this.un(t);return R.forEach(i,s=>this.cn(e,s).next(a=>{a?r!==0&&a.fields.length<function(h){let f=new Re(Ve.comparator),p=!1;for(const m of h.filters)for(const I of m.getFlattenedFilters())I.field.isKeyField()||(I.op==="array-contains"||I.op==="array-contains-any"?p=!0:f=f.add(I.field));for(const m of h.orderBy)m.field.isKeyField()||(f=f.add(m.field));return f.size+(p?1:0)}(s)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(t)&&i.length>1&&r===2?1:r)}dn(e,t){const r=new Zo;for(const i of vi(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.jt(i.kind);Ei.St.ht(s,a)}return r.Ut()}In(e){const t=new Zo;return Ei.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const r=new Zo;return Ei.St.ht(Ui(this.databaseId,t),r.jt(function(s){const a=vi(s);return a.length===0?0:a[a.length-1].kind}(e))),r.Ut()}hn(e,t,r){if(r===null)return[];let i=[];i.push(new Zo);let s=0;for(const a of vi(e)){const l=r[s++];for(const h of i)if(this.Rn(t,a.fieldPath)&&Ka(l))i=this.Vn(i,a,l);else{const f=h.jt(a.kind);Ei.St.ht(l,f)}}return this.mn(i)}ln(e,t,r){return this.hn(e,t,r.position)}mn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ut();return t}Vn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const l of i){const h=new Zo;h.seed(l.Ut()),Ei.St.ht(a,h.jt(t.kind)),s.push(h)}return s}Rn(e,t){return!!e.filters.find(r=>r instanceof he&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=ea(e),i=Rs(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(s=>{const a=[];return R.forEach(s,l=>i.get([l.indexId,this.uid]).next(h=>{a.push(function(p,m){const I=m?new $a(m.sequenceNumber,new en(Gi(m.readTime),new F(Fn(m.documentKey)),m.largestBatchId)):$a.empty(),A=p.fields.map(([L,M])=>new Gu(Ve.fromServerFormat(L),M));return new fl(p.indexId,p.collectionGroup,A,I)}(l,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ne(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=ea(e),s=Rs(e);return this.fn(e).next(a=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(l=>R.forEach(l,h=>s.put(mI(h.indexId,this.user,a,r)))))}updateIndexEntries(e,t){const r=new Map;return R.forEach(t,(i,s)=>{const a=r.get(i.collectionGroup);return(a?R.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(r.set(i.collectionGroup,l),R.forEach(l,h=>this.gn(e,i,h).next(f=>{const p=this.pn(s,h);return f.isEqual(p)?R.resolve():this.yn(e,s,h,f,p)}))))})}wn(e,t,r,i){return As(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,r,i){return As(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,t.key),t.key.path.toArray()])}gn(e,t,r){const i=As(e);let s=new Re(Dr);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,t)])},(a,l)=>{s=s.add(new Ti(r.indexId,t,l.arrayValue,l.directionalValue))}).next(()=>s)}pn(e,t){let r=new Re(Dr);const i=this.dn(t,e);if(i==null)return r;const s=qf(t);if(s!=null){const a=e.data.field(s.fieldPath);if(Ka(a))for(const l of a.arrayValue.values||[])r=r.add(new Ti(t.indexId,e.key,this.In(l),i))}else r=r.add(new Ti(t.indexId,e.key,Nu,i));return r}yn(e,t,r,i,s){N("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(h,f,p,m,I){const A=h.getIterator(),L=f.getIterator();let M=Ts(A),V=Ts(L);for(;M||V;){let Y=!1,ae=!1;if(M&&V){const j=p(M,V);j<0?ae=!0:j>0&&(Y=!0)}else M!=null?ae=!0:Y=!0;Y?(m(V),V=Ts(L)):ae?(I(M),M=Ts(A)):(M=Ts(A),V=Ts(L))}}(i,s,Dr,l=>{a.push(this.wn(e,t,r,l))},l=>{a.push(this.Sn(e,t,r,l))}),R.waitFor(a)}fn(e){let t=1;return Rs(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((a,l)=>Dr(a,l)).filter((a,l,h)=>!l||Dr(a,h[l-1])!==0);const i=[];i.push(e);for(const a of r){const l=Dr(a,e),h=Dr(a,t);if(l===0)i[0]=e.Ht();else if(l>0&&h<0)i.push(a),i.push(a.Ht());else if(h>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.bn(i[a],i[a+1]))return[];const l=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Nu,[]],h=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Nu,[]];s.push(IDBKeyRange.bound(l,h))}return s}bn(e,t){return Dr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(AI)}getMinOffset(e,t){return R.mapArray(this.un(t),r=>this.cn(e,r).next(i=>i||$())).next(AI)}}function TI(n){return lt(n,"collectionParents")}function As(n){return lt(n,"indexEntries")}function ea(n){return lt(n,"indexConfiguration")}function Rs(n){return lt(n,"indexState")}function AI(n){z(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;lg(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new en(e.readTime,e.documentKey,t)}const RI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class qt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new qt(e,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function OA(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let l=0;const h=r.Y({range:a},(p,m,I)=>(l++,I.delete()));s.push(h.next(()=>{z(l===1)}));const f=[];for(const p of t.mutations){const m=FT(e,p.key.path,t.batchId);s.push(i.delete(m)),f.push(p.key)}return R.waitFor(s).next(()=>f)}function vl(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw $();e=n.noDocument}return JSON.stringify(e).length}qt.DEFAULT_COLLECTION_PERCENTILE=10,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qt.DEFAULT=new qt(41943040,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qt.DISABLED=new qt(-1,0,0);class ah{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,t,r,i){z(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new ah(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return kr(e).Y({index:"userMutationsIndex",range:r},(i,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Ns(e),a=kr(e);return a.add({}).next(l=>{z(typeof l=="number");const h=new _g(l,t,r,i),f=function(A,L,M){const V=M.baseMutations.map(ae=>Ya(A.ut,ae)),Y=M.mutations.map(ae=>Ya(A.ut,ae));return{userId:L,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:V,mutations:Y}}(this.serializer,this.userId,h),p=[];let m=new Re((I,A)=>ne(I.canonicalString(),A.canonicalString()));for(const I of i){const A=FT(this.userId,I.key.path,l);m=m.add(I.key.path.popLast()),p.push(a.put(f)),p.push(s.put(A,y2))}return m.forEach(I=>{p.push(this.indexManager.addToCollectionParentIndex(e,I))}),e.addOnCommittedListener(()=>{this.Dn[l]=h.keys()}),R.waitFor(p).next(()=>h)})}lookupMutationBatch(e,t){return kr(e).get(t).next(r=>r?(z(r.userId===this.userId),wi(this.serializer,r)):null)}Cn(e,t){return this.Dn[t]?R.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Dn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return kr(e).Y({index:"userMutationsIndex",range:i},(a,l,h)=>{l.userId===this.userId&&(z(l.batchId>=r),s=wi(this.serializer,l)),h.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return kr(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(i,s,a)=>{r=s.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return kr(e).W("userMutationsIndex",t).next(r=>r.map(i=>wi(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=zu(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Ns(e).Y({range:i},(a,l,h)=>{const[f,p,m]=a,I=Fn(p);if(f===this.userId&&t.path.isEqual(I))return kr(e).get(m).next(A=>{if(!A)throw $();z(A.userId===this.userId),s.push(wi(this.serializer,A))});h.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(ne);const i=[];return t.forEach(s=>{const a=zu(this.userId,s.path),l=IDBKeyRange.lowerBound(a),h=Ns(e).Y({range:l},(f,p,m)=>{const[I,A,L]=f,M=Fn(A);I===this.userId&&s.path.isEqual(M)?r=r.add(L):m.done()});i.push(h)}),R.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=zu(this.userId,r),a=IDBKeyRange.lowerBound(s);let l=new Re(ne);return Ns(e).Y({range:a},(h,f,p)=>{const[m,I,A]=h,L=Fn(I);m===this.userId&&r.isPrefixOf(L)?L.length===i&&(l=l.add(A)):p.done()}).next(()=>this.vn(e,l))}vn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(kr(e).get(s).next(a=>{if(a===null)throw $();z(a.userId===this.userId),r.push(wi(this.serializer,a))}))}),R.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return OA(e.ae,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),R.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return R.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return Ns(e).Y({range:r},(s,a,l)=>{if(s[0]===this.userId){const h=Fn(s[1]);i.push(h)}else l.done()}).next(()=>{z(i.length===0)})})}containsKey(e,t){return LA(e,this.userId,t)}Mn(e){return MA(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function LA(n,e,t){const r=zu(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Ns(n).Y({range:s,J:!0},(l,h,f)=>{const[p,m,I]=l;p===e&&m===i&&(a=!0),f.done()}).next(()=>a)}function kr(n){return lt(n,"mutations")}function Ns(n){return lt(n,"documentMutations")}function MA(n){return lt(n,"mutationQueues")}class zi{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new zi(0)}static Nn(){return new zi(-1)}}class kU{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const r=new zi(t.highestTargetId);return t.highestTargetId=r.next(),this.Ln(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>K.fromTimestamp(new Le(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Ln(e,i)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(t,r),this.Ln(e,r))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ss(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(z(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Ss(e).Y((a,l)=>{const h=da(l);h.sequenceNumber<=t&&r.get(h.targetId)===null&&(i++,s.push(this.removeTargetData(e,h)))}).next(()=>R.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Ss(e).Y((r,i)=>{const s=da(i);t(s)})}Bn(e){return SI(e).get("targetGlobalKey").next(t=>(z(t!==null),t))}Ln(e,t){return SI(e).put("targetGlobalKey",t)}kn(e,t){return Ss(e).put(xA(this.serializer,t))}qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Bi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Ss(e).Y({range:i,index:"queryTargetsIndex"},(a,l,h)=>{const f=da(l);Ic(t,f.target)&&(s=f,h.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=Nr(e);return t.forEach(a=>{const l=Nt(a.path);i.push(s.put({targetId:r,path:l})),i.push(this.referenceDelegate.addReference(e,r,a))}),R.waitFor(i)}removeMatchingKeys(e,t,r){const i=Nr(e);return R.forEach(t,s=>{const a=Nt(s.path);return R.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=Nr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Nr(e);let s=re();return i.Y({range:r,J:!0},(a,l,h)=>{const f=Fn(a[1]),p=new F(f);s=s.add(p)}).next(()=>s)}containsKey(e,t){const r=Nt(t.path),i=IDBKeyRange.bound([r],[xT(r)],!1,!0);let s=0;return Nr(e).Y({index:"documentTargetsIndex",J:!0,range:i},([a,l],h,f)=>{a!==0&&(s++,f.done())}).next(()=>s>0)}_t(e,t){return Ss(e).get(t).next(r=>r?da(r):null)}}function Ss(n){return lt(n,"targets")}function SI(n){return lt(n,"targetGlobal")}function Nr(n){return lt(n,"targetDocuments")}function bI([n,e],[t,r]){const i=ne(n,t);return i===0?ne(e,r):i}class xU{constructor(e){this.Qn=e,this.buffer=new Re(bI),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();bI(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class NU{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){N("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ii(t)?N("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await ri(t)}await this.Gn(3e5)})}}class VU{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve($t._e);const r=new xU(t);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(N("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(RI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(N("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),RI):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let r,i,s,a,l,h,f;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(N("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,a=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,t))).next(m=>(s=m,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(f=Date.now(),Cs()<=ue.DEBUG&&N("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${s} targets in `+(h-l)+`ms
	Removed ${m} documents in `+(f-h)+`ms
Total Duration: ${f-p}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function OU(n,e){return new VU(n,e)}class LU{constructor(e,t){this.db=e,this.garbageCollector=OU(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Yn(e){let t=0;return this.Hn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(r,i)=>t(i))}addReference(e,t,r){return Vu(e,r)}removeReference(e,t,r){return Vu(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Vu(e,t)}Xn(e,t){return function(i,s){let a=!1;return MA(i).Z(l=>LA(i,l,s).next(h=>(h&&(a=!0),R.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(a,l)=>{if(l<=t){const h=this.Xn(e,a).next(f=>{if(!f)return s++,r.getEntry(e,a).next(()=>(r.removeEntry(a,K.min()),Nr(e).delete(function(m){return[0,Nt(m.path)]}(a))))});i.push(h)}}).next(()=>R.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Vu(e,t)}Zn(e,t){const r=Nr(e);let i,s=$t._e;return r.Y({index:"documentTargetsIndex"},([a,l],{path:h,sequenceNumber:f})=>{a===0?(s!==$t._e&&t(new F(Fn(i)),s),s=f,i=h):s=$t._e}).next(()=>{s!==$t._e&&t(new F(Fn(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Vu(n,e){return Nr(n).put(function(r,i){return{targetId:0,path:Nt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}class FA{constructor(){this.changes=new si(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class MU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return _i(e).put(r)}removeEntry(e,t,r){return _i(e).delete(function(s,a){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],_l(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.er(e,r)))}getEntry(e,t){let r=xe.newInvalidDocument(t);return _i(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ta(t))},(i,s)=>{r=this.tr(t,s)}).next(()=>r)}nr(e,t){let r={size:0,document:xe.newInvalidDocument(t)};return _i(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ta(t))},(i,s)=>{r={document:this.tr(t,s),size:vl(s)}}).next(()=>r)}getEntries(e,t){let r=Gt();return this.rr(e,t,(i,s)=>{const a=this.tr(i,s);r=r.insert(i,a)}).next(()=>r)}ir(e,t){let r=Gt(),i=new Pe(F.comparator);return this.rr(e,t,(s,a)=>{const l=this.tr(s,a);r=r.insert(s,l),i=i.insert(s,vl(a))}).next(()=>({documents:r,sr:i}))}rr(e,t,r){if(t.isEmpty())return R.resolve();let i=new Re(DI);t.forEach(h=>i=i.add(h));const s=IDBKeyRange.bound(ta(i.first()),ta(i.last())),a=i.getIterator();let l=a.getNext();return _i(e).Y({index:"documentKeyIndex",range:s},(h,f,p)=>{const m=F.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;l&&DI(l,m)<0;)r(l,null),l=a.getNext();l&&l.isEqual(m)&&(r(l,f),l=a.hasNext()?a.getNext():null),l?p.U(ta(l)):p.done()}).next(()=>{for(;l;)r(l,null),l=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,l=[a.popLast().toArray(),a.lastSegment(),_l(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return _i(e).W(IDBKeyRange.bound(l,h,!0)).next(f=>{s==null||s.incrementDocumentReadCount(f.length);let p=Gt();for(const m of f){const I=this.tr(F.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);I.isFoundDocument()&&(Ec(t,I)||i.has(I.key))&&(p=p.insert(I.key,I))}return p})}getAllFromCollectionGroup(e,t,r,i){let s=Gt();const a=CI(t,r),l=CI(t,en.max());return _i(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,l,!0)},(h,f,p)=>{const m=this.tr(F.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(m.key,m),s.size===i&&p.done()}).next(()=>s)}newChangeBuffer(e){return new FU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return PI(e).get("remoteDocumentGlobalKey").next(t=>(z(!!t),t))}er(e,t){return PI(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const r=EU(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(K.min())))return r}return xe.newInvalidDocument(e)}}function UA(n){return new MU(n)}class FU extends FA{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new si(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Re((s,a)=>ne(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const l=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,l.readTime)),a.isValidDocument()){const h=pI(this._r.serializer,a);i=i.add(s.path.popLast());const f=vl(h);r+=f-l.size,t.push(this._r.addEntry(e,s,h))}else if(r-=l.size,this.trackRemovals){const h=pI(this._r.serializer,a.convertToNoDocument(K.min()));t.push(this._r.addEntry(e,s,h))}}),i.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,r)),R.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(r=>(this.ar.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:r,sr:i})=>(i.forEach((s,a)=>{this.ar.set(s,{size:a,readTime:r.get(s).readTime})}),r))}}function PI(n){return lt(n,"remoteDocumentGlobal")}function _i(n){return lt(n,"remoteDocumentsV14")}function ta(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function CI(n,e){const t=e.documentKey.path.toArray();return[n,_l(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function DI(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ne(t[s],r[s]),i)return i;return i=ne(t.length,r.length),i||(i=ne(t[t.length-2],r[r.length-2]),i||ne(t[t.length-1],r[r.length-1]))}class UU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class BA{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&wa(r.mutation,i,Wt.empty(),Le.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,t,r=re()){const i=Un();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=la();return s.forEach((l,h)=>{a=a.insert(l,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=Un();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,re()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{t.set(a,l)})})}computeViews(e,t,r,i){let s=Gt();const a=Ia(),l=function(){return Ia()}();return t.forEach((h,f)=>{const p=r.get(f.key);i.has(f.key)&&(p===void 0||p.mutation instanceof _r)?s=s.insert(f.key,f):p!==void 0?(a.set(f.key,p.mutation.getFieldMask()),wa(p.mutation,f,p.mutation.getFieldMask(),Le.now())):a.set(f.key,Wt.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((f,p)=>a.set(f,p)),t.forEach((f,p)=>{var m;return l.set(f,new UU(p,(m=a.get(f))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,t){const r=Ia();let i=new Pe((a,l)=>a-l),s=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const l of a)l.keys().forEach(h=>{const f=t.get(h);if(f===null)return;let p=r.get(h)||Wt.empty();p=l.applyToLocalView(f,p),r.set(h,p);const m=(i.get(l.batchId)||re()).add(h);i=i.insert(l.batchId,m)})}).next(()=>{const a=[],l=i.getReverseIterator();for(;l.hasNext();){const h=l.getNext(),f=h.key,p=h.value,m=sA();p.forEach(I=>{if(!s.has(I)){const A=fA(t.get(I),r.get(I));A!==null&&m.set(I,A),s=s.add(I)}}),a.push(this.documentOverlayCache.saveOverlays(e,f,m))}return R.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):pg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):R.resolve(Un());let l=-1,h=s;return a.next(f=>R.forEach(f,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(p)?R.resolve():this.remoteDocumentCache.getEntry(e,p).next(I=>{h=h.insert(p,I)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,h,f,re())).next(p=>({batchId:l,changes:iA(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=la();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=la();return this.indexManager.getCollectionParents(e,s).next(l=>R.forEach(l,h=>{const f=function(m,I){return new mr(I,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next(p=>{p.forEach((m,I)=>{a=a.insert(m,I)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((h,f)=>{const p=f.getKey();a.get(p)===null&&(a=a.insert(p,xe.newInvalidDocument(p)))});let l=la();return a.forEach((h,f)=>{const p=s.get(h);p!==void 0&&wa(p.mutation,f,Wt.empty(),Le.now()),Ec(t,f)&&(l=l.insert(h,f))}),l})}}class BU{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return R.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Xe(i.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,function(i){return{name:i.name,query:Eg(i.bundledQuery),readTime:Xe(i.readTime)}}(t)),R.resolve()}}class qU{constructor(){this.overlays=new Pe(F.comparator),this.lr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Un();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.lt(e,t,s)}),R.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){const i=Un(),s=t.length+1,a=new F(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const h=l.getNext().value,f=h.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Pe((f,p)=>f-p);const a=this.overlays.getIterator();for(;a.hasNext();){const f=a.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let p=s.get(f.largestBatchId);p===null&&(p=Un(),s=s.insert(f.largestBatchId,p)),p.set(f.getKey(),f)}}const l=Un(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((f,p)=>l.set(f,p)),!(l.size()>=i)););return R.resolve(l)}lt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new vg(t,r));let s=this.lr.get(t);s===void 0&&(s=re(),this.lr.set(t,s)),this.lr.set(t,s.add(r.key))}}class Rg{constructor(){this.hr=new Re(st.Pr),this.Ir=new Re(st.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const r=new st(e,t);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.dr(new st(e,t))}Ar(e,t){e.forEach(r=>this.removeReference(r,t))}Rr(e){const t=new F(new ge([])),r=new st(t,e),i=new st(t,e+1),s=[];return this.Ir.forEachInRange([r,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new F(new ge([])),r=new st(t,e),i=new st(t,e+1);let s=re();return this.Ir.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new st(e,0),r=this.hr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class st{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return F.comparator(e.key,t.key)||ne(e.gr,t.gr)}static Tr(e,t){return ne(e.gr,t.gr)||F.comparator(e.key,t.key)}}class $U{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new Re(st.Pr)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new _g(s,t,r,i);this.mutationQueue.push(a);for(const l of i)this.yr=this.yr.add(new st(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Sr(r),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new st(t,0),i=new st(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],a=>{const l=this.wr(a.gr);s.push(l)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(ne);return t.forEach(i=>{const s=new st(i,0),a=new st(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],l=>{r=r.add(l.gr)})}),R.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;F.isDocumentKey(s)||(s=s.child(""));const a=new st(new F(s),0);let l=new Re(ne);return this.yr.forEachWhile(h=>{const f=h.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(l=l.add(h.gr)),!0)},a),R.resolve(this.br(l))}br(e){const t=[];return e.forEach(r=>{const i=this.wr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){z(this.Dr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return R.forEach(t.mutations,i=>{const s=new st(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,t){const r=new st(t,0),i=this.yr.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class WU{constructor(e){this.Cr=e,this.docs=function(){return new Pe(F.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Cr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():xe.newInvalidDocument(t))}getEntries(e,t){let r=Gt();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():xe.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Gt();const a=t.path,l=new F(a.child("")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){const{key:f,value:{document:p}}=h.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||lg(VT(p),r)<=0||(i.has(p.key)||Ec(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,t,r,i){$()}vr(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new GU(this)}getSize(e){return R.resolve(this.size)}}class GU extends FA{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class zU{constructor(e){this.persistence=e,this.Fr=new si(t=>Bi(t),Ic),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Mr=0,this.Or=new Rg,this.targetCount=0,this.Nr=zi.On()}forEachTarget(e,t){return this.Fr.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Mr&&(this.Mr=t),R.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new zi(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.kn(t),R.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Fr.forEach((a,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){const r=this.Fr.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.Or.Er(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.Or.Ar(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),R.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Or.mr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.Or.containsKey(t))}}class qA{constructor(e,t){this.Br={},this.overlays={},this.Lr=new $t(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new zU(this),this.indexManager=new CU,this.remoteDocumentCache=function(i){return new WU(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new kA(t),this.Kr=new BU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new qU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new $U(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,r){N("MemoryPersistence","Starting transaction:",e);const i=new KU(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,t){return R.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class KU extends LT{constructor(e){super(),this.currentSequenceNumber=e}}class ch{constructor(e){this.persistence=e,this.Gr=new Rg,this.zr=null}static jr(e){return new ch(e)}get Hr(){if(this.zr)return this.zr;throw $()}addReference(e,t,r){return this.Gr.addReference(r,t),this.Hr.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Gr.removeReference(r,t),this.Hr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Hr,r=>{const i=F.fromPath(r);return this.Jr(e,i).next(s=>{s||t.removeEntry(i,K.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(r=>{r?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return R.or([()=>R.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class HU{constructor(e){this.serializer=e}N(e,t,r,i){const s=new nh("createOrUpgrade",t);r<1&&i>=1&&(function(h){h.createObjectStore("owner")}(e),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",zv,{unique:!0}),h.createObjectStore("documentMutations")}(e),kI(e),function(h){h.createObjectStore("remoteDocuments")}(e));let a=R.resolve();return r<3&&i>=3&&(r!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),kI(e)),a=a.next(()=>function(h){const f=h.store("targetGlobal"),p={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:K.min().toTimestamp(),targetCount:0};return f.put("targetGlobalKey",p)}(s))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(h,f){return f.store("mutations").W().next(p=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",zv,{unique:!0});const m=f.store("mutations"),I=p.map(A=>m.put(A));return R.waitFor(I)})}(e,s))),a=a.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.Zr(s))),r<6&&i>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(a=a.next(()=>this.ei(s))),r<8&&i>=8&&(a=a.next(()=>this.ti(e,s))),r<9&&i>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.ni(s))),r<11&&i>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(h){const f=h.createObjectStore("documentOverlays",{keyPath:D2});f.createIndex("collectionPathOverlayIndex",k2,{unique:!1}),f.createIndex("collectionGroupOverlayIndex",x2,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(h){const f=h.createObjectStore("remoteDocumentsV14",{keyPath:v2});f.createIndex("documentKeyIndex",I2),f.createIndex("collectionGroupIndex",w2)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ii(e,s))),r<15&&i>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:S2}).createIndex("sequenceNumberIndex",b2,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:P2}).createIndex("documentKeyIndex",C2,{unique:!1})}(e))),a}Xr(e){let t=0;return e.store("remoteDocuments").Y((r,i)=>{t+=vl(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>R.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next(l=>R.forEach(l,h=>{z(h.userId===s.userId);const f=wi(this.serializer,h);return OA(e,s.userId,f).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((a,l)=>{const h=new ge(a),f=function(m){return[0,Nt(m)]}(h);s.push(t.get(f).next(p=>p?R.resolve():(m=>t.put({targetId:0,path:Nt(m),sequenceNumber:i.highestListenSequenceNumber}))(h)))}).next(()=>R.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:R2});const r=t.store("collectionParents"),i=new Ag,s=a=>{if(i.add(a)){const l=a.lastSegment(),h=a.popLast();return r.put({collectionId:l,parent:Nt(h)})}};return t.store("remoteDocuments").Y({J:!0},(a,l)=>{const h=new ge(a);return s(h.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([a,l,h],f)=>{const p=Fn(l);return s(p.popLast())}))}ni(e){const t=e.store("targets");return t.Y((r,i)=>{const s=da(i),a=xA(this.serializer,s);return t.put(a)})}ri(e,t){const r=t.store("remoteDocuments"),i=[];return r.Y((s,a)=>{const l=t.store("remoteDocumentsV14"),h=function(m){return m.document?new F(ge.fromString(m.document.name).popFirst(5)):m.noDocument?F.fromSegments(m.noDocument.path):m.unknownDocument?F.fromSegments(m.unknownDocument.path):$()}(a).path.toArray(),f={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(l.put(f))}).next(()=>R.waitFor(i))}ii(e,t){const r=t.store("mutations"),i=UA(this.serializer),s=new qA(ch.jr,this.serializer.ut);return r.W().next(a=>{const l=new Map;return a.forEach(h=>{var f;let p=(f=l.get(h.userId))!==null&&f!==void 0?f:re();wi(this.serializer,h).keys().forEach(m=>p=p.add(m)),l.set(h.userId,p)}),R.forEach(l,(h,f)=>{const p=new ot(f),m=oh.ct(this.serializer,p),I=s.getIndexManager(p),A=ah.ct(p,this.serializer,I,s.referenceDelegate);return new BA(i,A,m,I).recalculateAndSaveOverlaysForDocumentKeys(new $f(t,$t._e),h).next()})})}}function kI(n){n.createObjectStore("targetDocuments",{keyPath:T2}).createIndex("documentTargetsIndex",A2,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",E2,{unique:!0}),n.createObjectStore("targetGlobal")}const df="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Sg{constructor(e,t,r,i,s,a,l,h,f,p,m=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.si=s,this.window=a,this.document=l,this.oi=f,this._i=p,this.ai=m,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=I=>Promise.resolve(),!Sg.D())throw new k(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new LU(this,i),this.Ii=t+"main",this.serializer=new kA(h),this.Ti=new In(this.Ii,this.ai,new HU(this.serializer)),this.qr=new kU(this.referenceDelegate,this.serializer),this.remoteDocumentCache=UA(this.serializer),this.Kr=new TU,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,p===!1&&Je("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(b.FAILED_PRECONDITION,df);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new $t(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.di()}))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ou(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if(ii(e))return N("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return N("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return na(e).get("owner").next(t=>R.resolve(this.wi(t)))}Si(e){return Ou(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=lt(t,"clientMetadata");return r.W().next(i=>{const s=this.Ci(i,18e5),a=i.filter(l=>s.indexOf(l)===-1);return R.forEach(a,l=>r.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ei)for(const t of e)this.Ei.removeItem(this.vi(t.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?R.resolve(!0):na(e).get("owner").next(t=>{if(t!==null&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new k(b.FAILED_PRECONDITION,df);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ou(e).W().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||a&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&N("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new $f(e,$t._e);return this.pi(t).next(()=>this.Si(t))}),this.Ti.close(),this.Ni()}Ci(e,t){return e.filter(r=>this.Di(r.updateTimeMs,t)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Ou(e).W().next(t=>this.Ci(t,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return ah.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new DU(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return oh.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,r){N("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(h){return h===15?V2:h===14?qT:h===13?BT:h===12?N2:h===11?UT:void $()}(this.ai);let a;return this.Ti.runTransaction(e,i,s,l=>(a=new $f(l,this.Lr?this.Lr.next():$t._e),t==="readwrite-primary"?this.fi(a).next(h=>!!h||this.gi(a)).next(h=>{if(!h)throw Je(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new k(b.FAILED_PRECONDITION,OT);return r(a)}).next(h=>this.yi(a).next(()=>h)):this.Li(a).next(()=>r(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Li(e){return na(e).get("owner").next(t=>{if(t!==null&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new k(b.FAILED_PRECONDITION,df)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return na(e).put("owner",t)}static D(){return In.D()}pi(e){const t=na(e);return t.get("owner").next(r=>this.wi(r)?(N("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):R.resolve())}Di(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Je(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;_x()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const r=((t=this.Ei)===null||t===void 0?void 0:t.getItem(this.vi(e)))!==null;return N("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Je("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){Je("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function na(n){return lt(n,"owner")}function Ou(n){return lt(n,"clientMetadata")}function bg(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Pg{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ki=r,this.qi=i}static Qi(e,t){let r=re(),i=re();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Pg(e,t.fromCache,r,i)}}class jU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class $A{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.zi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new jU;return this.Hi(e,t,a).next(l=>{if(s.result=l,this.$i)return this.Ji(e,t,a,l.size)})}).next(()=>s.result)}Ji(e,t,r,i){return r.documentReadCount<this.Ui?(Cs()<=ue.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",Ds(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),R.resolve()):(Cs()<=ue.DEBUG&&N("QueryEngine","Query:",Ds(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(Cs()<=ue.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",Ds(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vt(t))):R.resolve())}zi(e,t){if(rI(t))return R.resolve(null);let r=Vt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=ml(t,null,"F"),r=Vt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=re(...s);return this.Gi.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(h=>{const f=this.Yi(t,l);return this.Zi(t,f,a,h.readTime)?this.zi(e,ml(t,null,"F")):this.Xi(e,f,t,h)}))})))}ji(e,t,r,i){return rI(t)||i.isEqual(K.min())?R.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const a=this.Yi(t,s);return this.Zi(t,a,r,i)?R.resolve(null):(Cs()<=ue.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ds(t)),this.Xi(e,a,t,NT(i,-1)).next(l=>l))})}Yi(e,t){let r=new Re(nA(e));return t.forEach((i,s)=>{Ec(e,s)&&(r=r.add(s))}),r}Zi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,t,r){return Cs()<=ue.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",Ds(t)),this.Gi.getDocumentsMatchingQuery(e,t,en.min(),r)}Xi(e,t,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}class QU{constructor(e,t,r,i){this.persistence=e,this.es=t,this.serializer=i,this.ts=new Pe(ne),this.ns=new si(s=>Bi(s),Ic),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new BA(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function WA(n,e,t,r){return new QU(n,e,t,r)}async function GA(n,e){const t=B(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.os(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],l=[];let h=re();for(const f of i){a.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}for(const f of s){l.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(f=>({_s:f,removedBatchIds:a,addedBatchIds:l}))})})}function YU(n,e){const t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(l,h,f,p){const m=f.batch,I=m.keys();let A=R.resolve();return I.forEach(L=>{A=A.next(()=>p.getEntry(h,L)).next(M=>{const V=f.docVersions.get(L);z(V!==null),M.version.compareTo(V)<0&&(m.applyToRemoteDocument(M,f),M.isValidDocument()&&(M.setReadTime(f.commitVersion),p.addEntry(M)))})}),A.next(()=>l.mutationQueue.removeMutationBatch(h,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=re();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(h=h.add(l.batch.mutations[f].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function zA(n){const e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function JU(n,e){const t=B(n),r=e.snapshotVersion;let i=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.ss.newChangeBuffer({trackRemovals:!0});i=t.ts;const l=[];e.targetChanges.forEach((p,m)=>{const I=i.get(m);if(!I)return;l.push(t.qr.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.qr.addMatchingKeys(s,p.addedDocuments,m)));let A=I.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?A=A.withResumeToken(rt.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):p.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(p.resumeToken,r)),i=i.insert(m,A),function(M,V,Y){return M.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0}(I,A,p)&&l.push(t.qr.updateTargetData(s,A))});let h=Gt(),f=re();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(KA(s,a,e.documentUpdates).next(p=>{h=p.us,f=p.cs})),!r.isEqual(K.min())){const p=t.qr.getLastRemoteSnapshotVersion(s).next(m=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(p)}return R.waitFor(l).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,h,f)).next(()=>h)}).then(s=>(t.ts=i,s))}function KA(n,e,t){let r=re(),i=re();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Gt();return t.forEach((l,h)=>{const f=s.get(l);h.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(l)),h.isNoDocument()&&h.version.isEqual(K.min())?(e.removeEntry(l,h.readTime),a=a.insert(l,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(h),a=a.insert(l,h)):N("LocalStore","Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",h.version)}),{us:a,cs:i}})}function XU(n,e){const t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ro(n,e){const t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.qr.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):t.qr.allocateTargetId(r).next(a=>(i=new ar(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ts=t.ts.insert(r.targetId,r),t.ns.set(e,r.targetId)),r})}async function io(n,e,t){const r=B(n),i=r.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!ii(a))throw a;N("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}function Il(n,e,t){const r=B(n);let i=K.min(),s=re();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,f,p){const m=B(h),I=m.ns.get(p);return I!==void 0?R.resolve(m.ts.get(I)):m.qr.getTargetData(f,p)}(r,a,Vt(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(a,l.targetId).next(h=>{s=h})}).next(()=>r.es.getDocumentsMatchingQuery(a,e,t?i:K.min(),t?s:re())).next(l=>(QA(r,tA(e),l),{documents:l,ls:s})))}function HA(n,e){const t=B(n),r=B(t.qr),i=t.ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(a=>a?a.target:null))}function jA(n,e){const t=B(n),r=t.rs.get(e)||K.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ss.getAllFromCollectionGroup(i,e,NT(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(QA(t,e,i),i))}function QA(n,e,t){let r=n.rs.get(e)||K.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.rs.set(e,r)}async function ZU(n,e,t,r){const i=B(n);let s=re(),a=Gt();for(const f of t){const p=e.hs(f.metadata.name);f.document&&(s=s.add(p));const m=e.Ps(f);m.setReadTime(e.Is(f.metadata.readTime)),a=a.insert(p,m)}const l=i.ss.newChangeBuffer({trackRemovals:!0}),h=await ro(i,function(p){return Vt(yo(ge.fromString(`__bundle__/docs/${p}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",f=>KA(f,l,a).next(p=>(l.apply(f),p)).next(p=>i.qr.removeMatchingKeysForTargetId(f,h.targetId).next(()=>i.qr.addMatchingKeys(f,s,h.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(f,p.us,p.cs)).next(()=>p.us)))}async function eB(n,e,t=re()){const r=await ro(n,Vt(Eg(e.bundledQuery))),i=B(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const a=Xe(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return i.Kr.saveNamedQuery(s,e);const l=r.withResumeToken(rt.EMPTY_BYTE_STRING,a);return i.ts=i.ts.insert(l.targetId,l),i.qr.updateTargetData(s,l).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,t,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}function xI(n,e){return`firestore_clients_${n}_${e}`}function NI(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function ff(n,e){return`firestore_targets_${n}_${e}`}class wl{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ts(e,t,r){const i=JSON.parse(r);let s,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new k(i.error.code,i.error.message))),a?new wl(e,t,i.state,s):(Je("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ea{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ts(e,t){const r=JSON.parse(t);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new k(r.error.code,r.error.message))),s?new Ea(e,r.state,i):(Je("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class El{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=gg();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=MT(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return i?new El(e,s):(Je("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Cg{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Cg(t.clientId,t.onlineState):(Je("SharedClientState",`Failed to parse online state: ${e}`),null)}}class tp{constructor(){this.activeTargetIds=gg()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pf{constructor(e,t,r,i,s){this.window=e,this.si=t,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Pe(ne),this.started=!1,this.ps=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=xI(this.persistenceKey,this.Rs),this.ws=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new tp),this.Ss=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.Cs=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.vs=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const r of e){if(r===this.Rs)continue;const i=this.getItem(xI(this.persistenceKey,r));if(i){const s=El.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();const t=this.storage.getItem(this.Cs);if(t){const r=this.Ms(t);r&&this.xs(r)}for(const r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,r){this.Ns(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(ff(this.persistenceKey,e));if(r){const i=Ea.Ts(e,r);i&&(t=i.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(ff(this.persistenceKey,e))}updateQueryState(e,t,r){this.ks(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return N("SharedClientState","READ",e,t),t}setItem(e,t){N("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){N("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const t=e;if(t.storageArea===this.storage){if(N("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ys)return void Je("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Ss.test(t.key)){if(t.newValue==null){const r=this.Ks(t.key);return this.$s(r,null)}{const r=this.Us(t.key,t.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(t.key)){if(t.newValue!==null){const r=this.Ws(t.key,t.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){const r=this.zs(t.key,t.newValue);if(r)return this.js(r)}}else if(t.key===this.Cs){if(t.newValue!==null){const r=this.Ms(t.newValue);if(r)return this.xs(r)}}else if(t.key===this.ws){const r=function(s){let a=$t._e;if(s!=null)try{const l=JSON.parse(s);z(typeof l=="number"),a=l}catch(l){Je("SharedClientState","Failed to read sequence number from WebStorage",l)}return a}(t.newValue);r!==$t._e&&this.sequenceNumberHandler(r)}else if(t.key===this.vs){const r=this.Hs(t.newValue);await Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(t)})}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,r){const i=new wl(this.currentUser,e,t,r),s=NI(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const t=NI(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){const t={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(t))}ks(e,t,r){const i=ff(this.persistenceKey,e),s=new Ea(e,t,r);this.setItem(i,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const r=this.Ks(e);return El.Ts(r,t)}Ws(e,t){const r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return wl.Ts(new ot(s),i,t)}zs(e,t){const r=this.Ds.exec(e),i=Number(r[1]);return Ea.Ts(i,t)}Ms(e){return Cg.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);N("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const r=t?this.gs.insert(e,t):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),a=[],l=[];return s.forEach(h=>{i.has(h)||a.push(h)}),i.forEach(h=>{s.has(h)||l.push(h)}),this.syncEngine.Xs(a,l).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=gg();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class YA{constructor(){this.eo=new tp,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,r){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new tp,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class tB{ro(e){}shutdown(){}}class VI{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){N("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){N("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Lu=null;function gf(){return Lu===null?Lu=function(){return 268435456+Math.round(2147483648*Math.random())}():Lu++,"0x"+Lu.toString(16)}const nB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class rB{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const Et="WebChannelConnection";class iB extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+t.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(t,r,i,s,a){const l=gf(),h=this.So(t,r);N("RestConnection",`Sending RPC '${t}' ${l}:`,h,i);const f={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(f,s,a),this.Do(t,h,f,i).then(p=>(N("RestConnection",`Received RPC '${t}' ${l}: `,p),p),p=>{throw Tn("RestConnection",`RPC '${t}' ${l} failed with error: `,p,"url: ",h,"request:",i),p})}Co(t,r,i,s,a,l){return this.wo(t,r,i,s,a)}bo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+_o}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}So(t,r){const i=nB[t];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,r,i){const s=gf();return new Promise((a,l)=>{const h=new e2;h.setWithCredentials(!0),h.listenOnce(XF.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case lf.NO_ERROR:const p=h.getResponseJson();N(Et,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case lf.TIMEOUT:N(Et,`RPC '${e}' ${s} timed out`),l(new k(b.DEADLINE_EXCEEDED,"Request time out"));break;case lf.HTTP_ERROR:const m=h.getStatus();if(N(Et,`RPC '${e}' ${s} failed with status:`,m,"response text:",h.getResponseText()),m>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);const A=I==null?void 0:I.error;if(A&&A.status&&A.message){const L=function(V){const Y=V.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(Y)>=0?Y:b.UNKNOWN}(A.status);l(new k(L,A.message))}else l(new k(b.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new k(b.UNAVAILABLE,"Connection failed."));break;default:$()}}finally{N(Et,`RPC '${e}' ${s} completed.`)}});const f=JSON.stringify(i);N(Et,`RPC '${e}' ${s} sending request:`,i),h.send(t,"POST",f,r,15)})}vo(e,t,r){const i=gf(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=YF(),l=JF(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.bo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const p=s.join("");N(Et,`Creating RPC '${e}' stream ${i}: ${p}`,h);const m=a.createWebChannel(p,h);let I=!1,A=!1;const L=new rB({co:V=>{A?N(Et,`Not sending because RPC '${e}' stream ${i} is closed:`,V):(I||(N(Et,`Opening RPC '${e}' stream ${i} transport.`),m.open(),I=!0),N(Et,`RPC '${e}' stream ${i} sending:`,V),m.send(V))},lo:()=>m.close()}),M=(V,Y,ae)=>{V.listen(Y,j=>{try{ae(j)}catch(ye){setTimeout(()=>{throw ye},0)}})};return M(m,ku.EventType.OPEN,()=>{A||N(Et,`RPC '${e}' stream ${i} transport opened.`)}),M(m,ku.EventType.CLOSE,()=>{A||(A=!0,N(Et,`RPC '${e}' stream ${i} transport closed`),L.Ro())}),M(m,ku.EventType.ERROR,V=>{A||(A=!0,Tn(Et,`RPC '${e}' stream ${i} transport errored:`,V),L.Ro(new k(b.UNAVAILABLE,"The operation could not be completed")))}),M(m,ku.EventType.MESSAGE,V=>{var Y;if(!A){const ae=V.data[0];z(!!ae);const j=ae,ye=j.error||((Y=j[0])===null||Y===void 0?void 0:Y.error);if(ye){N(Et,`RPC '${e}' stream ${i} received error:`,ye);const de=ye.status;let me=function(jn){const is=Ze[jn];if(is!==void 0)return mA(is)}(de),we=ye.message;me===void 0&&(me=b.INTERNAL,we="Unknown error status: "+de+" with message "+ye.message),A=!0,L.Ro(new k(me,we)),m.close()}else N(Et,`RPC '${e}' stream ${i} received:`,ae),L.Vo(ae)}}),M(l,ZF.STAT_EVENT,V=>{V.stat===qv.PROXY?N(Et,`RPC '${e}' stream ${i} detected buffering proxy`):V.stat===qv.NOPROXY&&N(Et,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{L.Ao()},0),L}}function JA(){return typeof window<"u"?window:null}function Yu(){return typeof document<"u"?document:null}function Sc(n){return new dU(n,!0)}class Dg{constructor(e,t,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=t,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,t-r);i>0&&N("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class XA{constructor(e,t,r,i,s,a,l,h){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new Dg(e,t)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,t){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(Je(t.toString()),Je("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):t&&t.code===b.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(t)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===t&&this.s_(r,i)},r=>{e(()=>{const i=new k(b.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,t){const r=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return N("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(N("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sB extends XA{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=gU(this.serializer,e),r=function(s){if(!("targetChange"in s))return K.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?K.min():a.readTime?Xe(a.readTime):K.min()}(e);return this.listener.a_(t,r)}u_(e){const t={};t.database=Qa(this.serializer),t.addTarget=function(s,a){let l;const h=a.target;if(l=pl(h)?{documents:RA(s,h)}:{query:SA(s,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=IA(s,a.resumeToken);const f=Qf(s,a.expectedCount);f!==null&&(l.expectedCount=f)}else if(a.snapshotVersion.compareTo(K.min())>0){l.readTime=no(s,a.snapshotVersion.toTimestamp());const f=Qf(s,a.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,e);const r=_U(this.serializer,e);r&&(t.labels=r),this.e_(t)}c_(e){const t={};t.database=Qa(this.serializer),t.removeTarget=e,this.e_(t)}}class oB extends XA{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=mU(e.writeResults,e.commitTime),r=Xe(e.commitTime);return this.listener.I_(r,t)}return z(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=Qa(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Ya(this.serializer,r))};this.e_(t)}}class aB extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new k(b.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,t,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new k(b.UNKNOWN,i.toString())})}Co(e,t,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,t,r,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(b.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class cB{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(Je(t),this.f_=!1):N("OnlineStateTracker",t)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}class uB{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget(async()=>{oi(this)&&(N("RemoteStore","Restarting streams for network reachability change."),await async function(h){const f=B(h);f.C_.add(4),await wo(f),f.M_.set("Unknown"),f.C_.delete(4),await bc(f)}(this))})}),this.M_=new cB(r,i)}}async function bc(n){if(oi(n))for(const e of n.v_)await e(!0)}async function wo(n){for(const e of n.v_)await e(!1)}function uh(n,e){const t=B(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),Ng(t)?xg(t):To(t).Ho()&&kg(t,e))}function Ja(n,e){const t=B(n),r=To(t);t.D_.delete(e),r.Ho()&&ZA(t,e),t.D_.size===0&&(r.Ho()?r.Zo():oi(t)&&t.M_.set("Unknown"))}function kg(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}To(n).u_(e)}function ZA(n,e){n.x_.Oe(e),To(n).c_(e)}function xg(n){n.x_=new cU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),To(n).start(),n.M_.g_()}function Ng(n){return oi(n)&&!To(n).jo()&&n.D_.size>0}function oi(n){return B(n).C_.size===0}function e0(n){n.x_=void 0}async function lB(n){n.D_.forEach((e,t)=>{kg(n,e)})}async function hB(n,e){e0(n),Ng(n)?(n.M_.w_(e),xg(n)):n.M_.set("Unknown")}async function dB(n,e,t){if(n.M_.set("Online"),e instanceof vA&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const l of s.targetIds)i.D_.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.D_.delete(l),i.x_.removeTarget(l))}(n,e)}catch(r){N("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Tl(n,r)}else if(e instanceof Qu?n.x_.$e(e):e instanceof yA?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(K.min()))try{const r=await zA(n.localStore);t.compareTo(r)>=0&&await function(s,a){const l=s.x_.it(a);return l.targetChanges.forEach((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const p=s.D_.get(f);p&&s.D_.set(f,p.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach((h,f)=>{const p=s.D_.get(h);if(!p)return;s.D_.set(h,p.withResumeToken(rt.EMPTY_BYTE_STRING,p.snapshotVersion)),ZA(s,h);const m=new ar(p.target,h,f,p.sequenceNumber);kg(s,m)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(r){N("RemoteStore","Failed to raise snapshot:",r),await Tl(n,r)}}async function Tl(n,e,t){if(!ii(e))throw e;n.C_.add(1),await wo(n),n.M_.set("Offline"),t||(t=()=>zA(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{N("RemoteStore","Retrying IndexedDB access"),await t(),n.C_.delete(1),await bc(n)})}function t0(n,e){return e().catch(t=>Tl(n,t,e))}async function Eo(n){const e=B(n),t=Qr(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;fB(e);)try{const i=await XU(e.localStore,r);if(i===null){e.b_.length===0&&t.Zo();break}r=i.batchId,pB(e,i)}catch(i){await Tl(e,i)}n0(e)&&r0(e)}function fB(n){return oi(n)&&n.b_.length<10}function pB(n,e){n.b_.push(e);const t=Qr(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function n0(n){return oi(n)&&!Qr(n).jo()&&n.b_.length>0}function r0(n){Qr(n).start()}async function gB(n){Qr(n).E_()}async function mB(n){const e=Qr(n);for(const t of n.b_)e.P_(t.mutations)}async function _B(n,e,t){const r=n.b_.shift(),i=yg.from(r,e,t);await t0(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Eo(n)}async function yB(n,e){e&&Qr(n).h_&&await async function(r,i){if(function(a){return gA(a)&&a!==b.ABORTED}(i.code)){const s=r.b_.shift();Qr(r).Yo(),await t0(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Eo(r)}}(n,e),n0(n)&&r0(n)}async function OI(n,e){const t=B(n);t.asyncQueue.verifyOperationInProgress(),N("RemoteStore","RemoteStore received new credentials");const r=oi(t);t.C_.add(3),await wo(t),r&&t.M_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),await bc(t)}async function np(n,e){const t=B(n);e?(t.C_.delete(2),await bc(t)):e||(t.C_.add(2),await wo(t),t.M_.set("Unknown"))}function To(n){return n.O_||(n.O_=function(t,r,i){const s=B(t);return s.A_(),new sB(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:lB.bind(null,n),Io:hB.bind(null,n),a_:dB.bind(null,n)}),n.v_.push(async e=>{e?(n.O_.Yo(),Ng(n)?xg(n):n.M_.set("Unknown")):(await n.O_.stop(),e0(n))})),n.O_}function Qr(n){return n.N_||(n.N_=function(t,r,i){const s=B(t);return s.A_(),new oB(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:gB.bind(null,n),Io:yB.bind(null,n),T_:mB.bind(null,n),I_:_B.bind(null,n)}),n.v_.push(async e=>{e?(n.N_.Yo(),await Eo(n)):(await n.N_.stop(),n.b_.length>0&&(N("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))})),n.N_}class Vg{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new at,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,l=new Vg(e,t,a,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ao(n,e){if(Je("AsyncQueue",`${e}: ${n}`),ii(n))return new k(b.UNAVAILABLE,`${e}: ${n}`);throw n}class Gs{constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=la(),this.sortedSet=new Pe(this.comparator)}static emptySet(e){return new Gs(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Gs)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Gs;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class LI{constructor(){this.B_=new Pe(F.comparator)}track(e){const t=e.doc.key,r=this.B_.get(t);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(t,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(t):e.type===1&&r.type===2?this.B_=this.B_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):$():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,r)=>{e.push(r)}),e}}class so{constructor(e,t,r,i,s,a,l,h,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new so(e,t,Gs.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class vB{constructor(){this.k_=void 0,this.listeners=[]}}class IB{constructor(){this.queries=new si(e=>eA(e),wc),this.onlineState="Unknown",this.q_=new Set}}async function Og(n,e){const t=B(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new vB),i)try{s.k_=await t.onListen(r)}catch(a){const l=Ao(a,`Initialization of query '${Ds(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,s),s.listeners.push(e),e.Q_(t.onlineState),s.k_&&e.K_(s.k_)&&Mg(t)}async function Lg(n,e){const t=B(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return t.queries.delete(r),t.onUnlisten(r)}function wB(n,e){const t=B(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const l of a.listeners)l.K_(i)&&(r=!0);a.k_=i}}r&&Mg(t)}function EB(n,e,t){const r=B(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function Mg(n){n.q_.forEach(e=>{e.next()})}class Fg{constructor(e,t,r){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new so(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){if(!e.fromCache)return!0;const r=t!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const t=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}H_(e){e=so.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class TB{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class MI{constructor(e){this.serializer=e}hs(e){return $n(this.serializer,e)}Ps(e){return e.metadata.exists?AA(this.serializer,e.document,!1):xe.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return Xe(e)}}class AB{constructor(e,t,r){this.X_=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=i0(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const r=ge.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,r=new MI(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const a of i.metadata.queries){const l=(t.get(a)||re()).add(s);t.set(a,l)}}return t}async complete(){const e=await ZU(this.localStore,new MI(this.serializer),this.documents,this.X_.id),t=this.ta(this.documents);for(const r of this.queries)await eB(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,na:this.collectionGroups,ra:e}}}function i0(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class s0{constructor(e){this.key=e}}class o0{constructor(e){this.key=e}}class a0{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=re(),this.mutatedKeys=re(),this._a=nA(e),this.aa=new Gs(this._a)}get ua(){return this.ia}ca(e,t){const r=t?t.la:new LI,i=t?t.aa:this.aa;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,l=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{const I=i.get(p),A=Ec(this.query,m)?m:null,L=!!I&&this.mutatedKeys.has(I.key),M=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let V=!1;I&&A?I.data.isEqual(A.data)?L!==M&&(r.track({type:3,doc:A}),V=!0):this.ha(I,A)||(r.track({type:2,doc:A}),V=!0,(h&&this._a(A,h)>0||f&&this._a(A,f)<0)&&(l=!0)):!I&&A?(r.track({type:0,doc:A}),V=!0):I&&!A&&(r.track({type:1,doc:I}),V=!0,(h||f)&&(l=!0)),V&&(A?(a=a.add(A),s=M?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{aa:a,la:r,Zi:l,mutatedKeys:s}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const a=e.la.L_();a.sort((p,m)=>function(A,L){const M=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $()}};return M(A)-M(L)}(p.type,m.type)||this._a(p.doc,m.doc)),this.Pa(r),i=i!=null&&i;const l=t&&!i?this.Ia():[],h=this.oa.size===0&&this.current&&!i?1:0,f=h!==this.sa;return this.sa=h,a.length!==0||f?{snapshot:new so(this.query,e.aa,s,a,e.mutatedKeys,h===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:l}:{Ta:l}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new LI,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=re(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const t=[];return e.forEach(r=>{this.oa.has(r)||t.push(new o0(r))}),this.oa.forEach(r=>{e.has(r)||t.push(new s0(r))}),t}da(e){this.ia=e.ls,this.oa=re();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return so.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class RB{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class SB{constructor(e){this.key=e,this.Ra=!1}}class bB{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new si(l=>eA(l),wc),this.fa=new Map,this.ga=new Set,this.pa=new Pe(F.comparator),this.ya=new Map,this.wa=new Rg,this.Sa={},this.ba=new Map,this.Da=zi.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function PB(n,e){const t=Wg(n);let r,i;const s=t.ma.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const a=await ro(t.localStore,Vt(e)),l=t.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=await Ug(t,e,r,l==="current",a.resumeToken),t.isPrimaryClient&&uh(t.remoteStore,a)}return i}async function Ug(n,e,t,r,i){n.va=(m,I,A)=>async function(M,V,Y,ae){let j=V.view.ca(Y);j.Zi&&(j=await Il(M.localStore,V.query,!1).then(({documents:we})=>V.view.ca(we,j)));const ye=ae&&ae.targetChanges.get(V.targetId),de=ae&&ae.targetMismatches.get(V.targetId)!=null,me=V.view.applyChanges(j,M.isPrimaryClient,ye,de);return rp(M,V.targetId,me.Ta),me.snapshot}(n,m,I,A);const s=await Il(n.localStore,e,!0),a=new a0(e,s.ls),l=a.ca(s.documents),h=Rc.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),f=a.applyChanges(l,n.isPrimaryClient,h);rp(n,t,f.Ta);const p=new RB(e,t,a);return n.ma.set(e,p),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),f.snapshot}async function CB(n,e){const t=B(n),r=t.ma.get(e),i=t.fa.get(r.targetId);if(i.length>1)return t.fa.set(r.targetId,i.filter(s=>!wc(s,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||await io(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Ja(t.remoteStore,r.targetId),oo(t,r.targetId)}).catch(ri)):(oo(t,r.targetId),await io(t.localStore,r.targetId,!0))}async function DB(n,e,t){const r=Gg(n);try{const i=await function(a,l){const h=B(a),f=Le.now(),p=l.reduce((A,L)=>A.add(L.key),re());let m,I;return h.persistence.runTransaction("Locally write mutations","readwrite",A=>{let L=Gt(),M=re();return h.ss.getEntries(A,p).next(V=>{L=V,L.forEach((Y,ae)=>{ae.isValidDocument()||(M=M.add(Y))})}).next(()=>h.localDocuments.getOverlayedDocuments(A,L)).next(V=>{m=V;const Y=[];for(const ae of l){const j=sU(ae,m.get(ae.key).overlayedDocument);j!=null&&Y.push(new _r(ae.key,j,zT(j.value.mapValue),Oe.exists(!0)))}return h.mutationQueue.addMutationBatch(A,f,Y,l)}).next(V=>{I=V;const Y=V.applyToLocalDocumentSet(m,M);return h.documentOverlayCache.saveOverlays(A,V.batchId,Y)})}).then(()=>({batchId:I.batchId,changes:iA(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let f=a.Sa[a.currentUser.toKey()];f||(f=new Pe(ne)),f=f.insert(l,h),a.Sa[a.currentUser.toKey()]=f}(r,i.batchId,t),await yr(r,i.changes),await Eo(r.remoteStore)}catch(i){const s=Ao(i,"Failed to persist write");t.reject(s)}}async function c0(n,e){const t=B(n);try{const r=await JU(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.ya.get(s);a&&(z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?z(a.Ra):i.removedDocuments.size>0&&(z(a.Ra),a.Ra=!1))}),await yr(t,r,e)}catch(r){await ri(r)}}function FI(n,e,t){const r=B(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.ma.forEach((s,a)=>{const l=a.view.Q_(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){const h=B(a);h.onlineState=l;let f=!1;h.queries.forEach((p,m)=>{for(const I of m.listeners)I.Q_(l)&&(f=!0)}),f&&Mg(h)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function kB(n,e,t){const r=B(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ya.get(e),s=i&&i.key;if(s){let a=new Pe(F.comparator);a=a.insert(s,xe.newNoDocument(s,K.min()));const l=re().add(s),h=new Ac(K.min(),new Map,new Pe(ne),a,l);await c0(r,h),r.pa=r.pa.remove(s),r.ya.delete(e),$g(r)}else await io(r.localStore,e,!1).then(()=>oo(r,e,t)).catch(ri)}async function xB(n,e){const t=B(n),r=e.batch.batchId;try{const i=await YU(t.localStore,e);qg(t,r,null),Bg(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await yr(t,i)}catch(i){await ri(i)}}async function NB(n,e,t){const r=B(n);try{const i=await function(a,l){const h=B(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let p;return h.mutationQueue.lookupMutationBatch(f,l).next(m=>(z(m!==null),p=m.keys(),h.mutationQueue.removeMutationBatch(f,m))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,p,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,p)).next(()=>h.localDocuments.getDocuments(f,p))})}(r.localStore,e);qg(r,e,t),Bg(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await yr(r,i)}catch(i){await ri(i)}}async function VB(n,e){const t=B(n);oi(t.remoteStore)||N("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(a){const l=B(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(r===-1)return void e.resolve();const i=t.ba.get(r)||[];i.push(e),t.ba.set(r,i)}catch(r){const i=Ao(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Bg(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function qg(n,e,t){const r=B(n);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function oo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.fa.get(e))n.ma.delete(r),t&&n.Va.Fa(r,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(r=>{n.wa.containsKey(r)||u0(n,r)})}function u0(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);t!==null&&(Ja(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),$g(n))}function rp(n,e,t){for(const r of t)r instanceof s0?(n.wa.addReference(r.key,e),OB(n,r)):r instanceof o0?(N("SyncEngine","Document no longer in limbo: "+r.key),n.wa.removeReference(r.key,e),n.wa.containsKey(r.key)||u0(n,r.key)):$()}function OB(n,e){const t=e.key,r=t.path.canonicalString();n.pa.get(t)||n.ga.has(r)||(N("SyncEngine","New document in limbo: "+t),n.ga.add(r),$g(n))}function $g(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new F(ge.fromString(e)),r=n.Da.next();n.ya.set(r,new SB(t)),n.pa=n.pa.insert(t,r),uh(n.remoteStore,new ar(Vt(yo(t.path)),r,"TargetPurposeLimboResolution",$t._e))}}async function yr(n,e,t){const r=B(n),i=[],s=[],a=[];r.ma.isEmpty()||(r.ma.forEach((l,h)=>{a.push(r.va(h,e,t).then(f=>{if((f||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(h.targetId,f!=null&&f.fromCache?"not-current":"current"),f){i.push(f);const p=Pg.Qi(h.targetId,f);s.push(p)}}))}),await Promise.all(a),r.Va.a_(i),await async function(h,f){const p=B(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>R.forEach(f,I=>R.forEach(I.ki,A=>p.persistence.referenceDelegate.addReference(m,I.targetId,A)).next(()=>R.forEach(I.qi,A=>p.persistence.referenceDelegate.removeReference(m,I.targetId,A)))))}catch(m){if(!ii(m))throw m;N("LocalStore","Failed to update sequence numbers: "+m)}for(const m of f){const I=m.targetId;if(!m.fromCache){const A=p.ts.get(I),L=A.snapshotVersion,M=A.withLastLimboFreeSnapshotVersion(L);p.ts=p.ts.insert(I,M)}}}(r.localStore,s))}async function LB(n,e){const t=B(n);if(!t.currentUser.isEqual(e)){N("SyncEngine","User change. New user:",e.toKey());const r=await GA(t.localStore,e);t.currentUser=e,function(s,a){s.ba.forEach(l=>{l.forEach(h=>{h.reject(new k(b.CANCELLED,a))})}),s.ba.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await yr(t,r._s)}}function MB(n,e){const t=B(n),r=t.ya.get(e);if(r&&r.Ra)return re().add(r.key);{let i=re();const s=t.fa.get(e);if(!s)return i;for(const a of s){const l=t.ma.get(a);i=i.unionWith(l.view.ua)}return i}}async function FB(n,e){const t=B(n),r=await Il(t.localStore,e.query,!0),i=e.view.da(r);return t.isPrimaryClient&&rp(t,e.targetId,i.Ta),i}async function UB(n,e){const t=B(n);return jA(t.localStore,e).then(r=>yr(t,r))}async function BB(n,e,t,r){const i=B(n),s=await function(l,h){const f=B(l),p=B(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",m=>p.Cn(m,h).next(I=>I?f.localDocuments.getDocuments(m,I):R.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await Eo(i.remoteStore):t==="acknowledged"||t==="rejected"?(qg(i,e,r||null),Bg(i,e),function(l,h){B(B(l).mutationQueue).Fn(h)}(i.localStore,e)):$(),await yr(i,s)):N("SyncEngine","Cannot apply mutation batch with id: "+e)}async function qB(n,e){const t=B(n);if(Wg(t),Gg(t),e===!0&&t.Ca!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await UI(t,r.toArray());t.Ca=!0,await np(t.remoteStore,!0);for(const s of i)uh(t.remoteStore,s)}else if(e===!1&&t.Ca!==!1){const r=[];let i=Promise.resolve();t.fa.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(oo(t,a),io(t.localStore,a,!0))),Ja(t.remoteStore,a)}),await i,await UI(t,r),function(a){const l=B(a);l.ya.forEach((h,f)=>{Ja(l.remoteStore,f)}),l.wa.Vr(),l.ya=new Map,l.pa=new Pe(F.comparator)}(t),t.Ca=!1,await np(t.remoteStore,!1)}}async function UI(n,e,t){const r=B(n),i=[],s=[];for(const a of e){let l;const h=r.fa.get(a);if(h&&h.length!==0){l=await ro(r.localStore,Vt(h[0]));for(const f of h){const p=r.ma.get(f),m=await FB(r,p);m.snapshot&&s.push(m.snapshot)}}else{const f=await HA(r.localStore,a);l=await ro(r.localStore,f),await Ug(r,l0(f),a,!1,l.resumeToken)}i.push(l)}return r.Va.a_(s),i}function l0(n){return ZT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function $B(n){return function(t){return B(B(t).persistence).Bi()}(B(n).localStore)}async function WB(n,e,t,r){const i=B(n);if(i.Ca)return void N("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=await jA(i.localStore,tA(s[0])),l=Ac.createSynthesizedRemoteEventForCurrentChange(e,t==="current",rt.EMPTY_BYTE_STRING);await yr(i,a,l);break}case"rejected":await io(i.localStore,e,!0),oo(i,e,r);break;default:$()}}async function GB(n,e,t){const r=Wg(n);if(r.Ca){for(const i of e){if(r.fa.has(i)){N("SyncEngine","Adding an already active target "+i);continue}const s=await HA(r.localStore,i),a=await ro(r.localStore,s);await Ug(r,l0(s),a.targetId,!1,a.resumeToken),uh(r.remoteStore,a)}for(const i of t)r.fa.has(i)&&await io(r.localStore,i,!1).then(()=>{Ja(r.remoteStore,i),oo(r,i)}).catch(ri)}}function Wg(n){const e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=c0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=MB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=kB.bind(null,e),e.Va.a_=wB.bind(null,e.eventManager),e.Va.Fa=EB.bind(null,e.eventManager),e}function Gg(n){const e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NB.bind(null,e),e}function zB(n,e,t){const r=B(n);(async function(s,a,l){try{const h=await a.getMetadata();if(await function(A,L){const M=B(A),V=Xe(L.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",Y=>M.Kr.getBundleMetadata(Y,L.id)).then(Y=>!!Y&&Y.createTime.compareTo(V)>=0)}(s.localStore,h))return await a.close(),l._completeWith(function(A){return{taskState:"Success",documentsLoaded:A.totalDocuments,bytesLoaded:A.totalBytes,totalDocuments:A.totalDocuments,totalBytes:A.totalBytes}}(h)),Promise.resolve(new Set);l._updateProgress(i0(h));const f=new AB(h,s.localStore,a.serializer);let p=await a.Ma();for(;p;){const I=await f.ea(p);I&&l._updateProgress(I),p=await a.Ma()}const m=await f.complete();return await yr(s,m.ra,void 0),await function(A,L){const M=B(A);return M.persistence.runTransaction("Save bundle","readwrite",V=>M.Kr.saveBundleMetadata(V,L))}(s.localStore,h),l._completeWith(m.progress),Promise.resolve(m.na)}catch(h){return Tn("SyncEngine",`Loading bundle failed with ${h}`),l._failWith(h),Promise.resolve(new Set)}})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class ip{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Sc(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return WA(this.persistence,new $A,e.initialUser,this.serializer)}createPersistence(e){return new qA(ch.jr,this.serializer)}createSharedClientState(e){return new YA}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class h0 extends ip{constructor(e,t,r){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xa.initialize(this,e),await Gg(this.xa.syncEngine),await Eo(this.xa.remoteStore),await this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return WA(this.persistence,new $A,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new NU(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new m2(t,this.persistence);return new g2(e.asyncQueue,r)}createPersistence(e){const t=bg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?qt.withCacheSize(this.cacheSizeBytes):qt.DEFAULT;return new Sg(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,JA(),Yu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new YA}}class KB extends h0{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xa.syncEngine;this.sharedClientState instanceof pf&&(this.sharedClientState.syncEngine={Ys:BB.bind(null,t),Zs:WB.bind(null,t),Xs:GB.bind(null,t),Bi:$B.bind(null,t),Js:UB.bind(null,t)},await this.sharedClientState.start()),await this.persistence.mi(async r=>{await qB(this.xa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const t=JA();if(!pf.D(t))throw new k(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=bg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new pf(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class zg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>FI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=LB.bind(null,this.syncEngine),await np(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new IB}()}createDatastore(e){const t=Sc(e.databaseInfo.databaseId),r=function(s){return new iB(s)}(e.databaseInfo);return function(s,a,l,h){return new aB(s,a,l,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,a,l){return new uB(r,i,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,t=>FI(this.syncEngine,t,0),function(){return VI.D()?new VI:new tB}())}createSyncEngine(e,t){return function(i,s,a,l,h,f,p){const m=new bB(i,s,a,l,h,f);return p&&(m.Ca=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(t){const r=B(t);N("RemoteStore","RemoteStore shutting down."),r.C_.add(5),await wo(r),r.F_.shutdown(),r.M_.set("Unknown")}(this.remoteStore)}}function BI(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class lh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):Je("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class HB{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new at,this.buffer=new Uint8Array,this.La=function(){return new TextDecoder("utf-8")}(),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}async getMetadata(){return this.metadata.promise}async Ma(){return await this.getMetadata(),this.ka()}async ka(){const e=await this.qa();if(e===null)return null;const t=this.La.decode(e),r=Number(t);isNaN(r)&&this.Qa(`length string (${t}) is not valid number`);const i=await this.Ka(r);return new TB(JSON.parse(i),e.length+r)}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async qa(){for(;this.$a()<0&&!await this.Ua(););if(this.buffer.length===0)return null;const e=this.$a();e<0&&this.Qa("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Ka(e){for(;this.buffer.length<e;)await this.Ua()&&this.Qa("Reached the end of bundle when more is expected.");const t=this.La.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ua(){const e=await this.Ba.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class jB{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new k(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(i,s){const a=B(i),l=Qa(a.serializer)+"/documents",h={documents:s.map(I=>ja(a.serializer,I))},f=await a.Co("BatchGetDocuments",l,h,s.length),p=new Map;f.forEach(I=>{const A=pU(a.serializer,I);p.set(A.key.toString(),A)});const m=[];return s.forEach(I=>{const A=p.get(I.toString());z(!!A),m.push(A)}),m}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Io(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=F.fromPath(r);this.mutations.push(new mg(i,this.precondition(i)))}),await async function(r,i){const s=B(r),a=Qa(s.serializer)+"/documents",l={writes:i.map(h=>Ya(s.serializer,h))};await s.wo("Commit",a,l)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw $();t=K.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new k(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(K.min())?Oe.exists(!1):Oe.updateTime(t):Oe.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(K.min()))throw new k(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Oe.updateTime(t)}return Oe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class QB{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new Dg(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko(async()=>{const e=new jB(this.datastore),t=this.za(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ja(i)}))}).catch(r=>{this.ja(r)})})}za(e){try{const t=this.updateFunction(e);return!vc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!gA(t)}return!1}}class YB{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ot.UNAUTHENTICATED,this.clientId=kT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{N("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(N("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new at;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Ao(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ju(n,e){n.asyncQueue.verifyOperationInProgress(),N("FirestoreClient","Initializing OfflineComponentProvider");const t=await n.getConfiguration();await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await GA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function sp(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Kg(n);N("FirestoreClient","Initializing OnlineComponentProvider");const r=await n.getConfiguration();await e.initialize(t,r),n.setCredentialChangeListener(i=>OI(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>OI(e.remoteStore,s)),n._onlineComponents=e}function d0(n){return n.name==="FirebaseError"?n.code===b.FAILED_PRECONDITION||n.code===b.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function Kg(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){N("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ju(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!d0(t))throw t;Tn("Error using user provided cache. Falling back to memory cache: "+t),await Ju(n,new ip)}}else N("FirestoreClient","Using default OfflineComponentProvider"),await Ju(n,new ip);return n._offlineComponents}async function hh(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(N("FirestoreClient","Using user provided OnlineComponentProvider"),await sp(n,n._uninitializedComponentsProvider._online)):(N("FirestoreClient","Using default OnlineComponentProvider"),await sp(n,new zg))),n._onlineComponents}function f0(n){return Kg(n).then(e=>e.persistence)}function Hg(n){return Kg(n).then(e=>e.localStore)}function p0(n){return hh(n).then(e=>e.remoteStore)}function jg(n){return hh(n).then(e=>e.syncEngine)}function JB(n){return hh(n).then(e=>e.datastore)}async function ao(n){const e=await hh(n),t=e.eventManager;return t.onListen=PB.bind(null,e.syncEngine),t.onUnlisten=CB.bind(null,e.syncEngine),t}function XB(n){return n.asyncQueue.enqueue(async()=>{const e=await f0(n),t=await p0(n);return e.setNetworkEnabled(!0),function(i){const s=B(i);return s.C_.delete(0),bc(s)}(t)})}function ZB(n){return n.asyncQueue.enqueue(async()=>{const e=await f0(n),t=await p0(n);return e.setNetworkEnabled(!1),async function(i){const s=B(i);s.C_.add(0),await wo(s),s.M_.set("Offline")}(t)})}function eq(n,e){const t=new at;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await function(f,p){const m=B(f);return m.persistence.runTransaction("read document","readonly",I=>m.localDocuments.getDocument(I,p))}(i,s);l.isFoundDocument()?a.resolve(l):l.isNoDocument()?a.resolve(null):a.reject(new k(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const h=Ao(l,`Failed to get document '${s} from cache`);a.reject(h)}}(await Hg(n),e,t)),t.promise}function g0(n,e,t={}){const r=new at;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const p=new lh({next:I=>{a.enqueueAndForget(()=>Lg(s,m));const A=I.docs.has(l);!A&&I.fromCache?f.reject(new k(b.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&I.fromCache&&h&&h.source==="server"?f.reject(new k(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(I)},error:I=>f.reject(I)}),m=new Fg(yo(l.path),p,{includeMetadataChanges:!0,J_:!0});return Og(s,m)}(await ao(n),n.asyncQueue,e,t,r)),r.promise}function tq(n,e){const t=new at;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await Il(i,s,!0),h=new a0(s,l.ls),f=h.ca(l.documents),p=h.applyChanges(f,!1);a.resolve(p.snapshot)}catch(l){const h=Ao(l,`Failed to execute query '${s} against cache`);a.reject(h)}}(await Hg(n),e,t)),t.promise}function m0(n,e,t={}){const r=new at;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const p=new lh({next:I=>{a.enqueueAndForget(()=>Lg(s,m)),I.fromCache&&h.source==="server"?f.reject(new k(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(I)},error:I=>f.reject(I)}),m=new Fg(l,p,{includeMetadataChanges:!0,J_:!0});return Og(s,m)}(await ao(n),n.asyncQueue,e,t,r)),r.promise}function nq(n,e){const t=new lh(e);return n.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).q_.add(s),s.next()}(await ao(n),t)),()=>{t.Na(),n.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).q_.delete(s)}(await ao(n),t))}}function rq(n,e,t,r){const i=function(a,l){let h;return h=typeof a=="string"?_A().encode(a):a,function(p,m){return new HB(p,m)}(function(p,m){if(p instanceof Uint8Array)return BI(p,m);if(p instanceof ArrayBuffer)return BI(new Uint8Array(p),m);if(p instanceof ReadableStream)return p.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),l)}(t,Sc(e));n.asyncQueue.enqueueAndForget(async()=>{zB(await jg(n),i,r)})}function iq(n,e){return n.asyncQueue.enqueue(async()=>function(r,i){const s=B(r);return s.persistence.runTransaction("Get named query","readonly",a=>s.Kr.getNamedQuery(a,i))}(await Hg(n),e))}function _0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const qI=new Map;function Qg(n,e,t){if(!t)throw new k(b.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function y0(n,e,t,r){if(e===!0&&r===!0)throw new k(b.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function $I(n){if(!F.isDocumentKey(n))throw new k(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function WI(n){if(F.isDocumentKey(n))throw new k(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function dh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$()}function _e(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new k(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=dh(n);throw new k(b.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function v0(n,e){if(e<=0)throw new k(b.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class GI{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new k(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}y0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_0((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new k(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new k(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new k(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Pc{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new GI({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new k(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new k(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new GI(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new i2;switch(r.type){case"firstParty":return new c2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new k(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=qI.get(t);r&&(N("ComponentProvider","Removing Datastore"),qI.delete(t),r.terminate())}(this),Promise.resolve()}}function sq(n,e,t,r={}){var i;const s=(n=_e(n,Pc))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Tn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let l,h;if(typeof r.mockUserToken=="string")l=r.mockUserToken,h=ot.MOCK_USER;else{l=px(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new k(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ot(f)}n._authCredentials=new s2(new DT(l,h))}}let Rt=class{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Rt(this.firestore,e,this._query)}},Me=class{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Me(this.firestore,e,this._key)}},lr=class extends Rt{constructor(e,t,r){super(e,t,yo(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new F(e))}withConverter(e){return new lr(this.firestore,e,this._path)}};function I0(n,e,...t){if(n=H(n),Qg("collection","path",e),n instanceof Pc){const r=ge.fromString(e,...t);return WI(r),new lr(n,null,r)}{if(!(n instanceof Me||n instanceof lr))throw new k(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ge.fromString(e,...t));return WI(r),new lr(n.firestore,null,r)}}function oq(n,e){if(n=_e(n,Pc),Qg("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(b.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Rt(n,null,function(r){return new mr(ge.emptyPath(),r)}(e))}function Xa(n,e,...t){if(n=H(n),arguments.length===1&&(e=kT.newId()),Qg("doc","path",e),n instanceof Pc){const r=ge.fromString(e,...t);return $I(r),new Me(n,null,new F(r))}{if(!(n instanceof Me||n instanceof lr))throw new k(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ge.fromString(e,...t));return $I(r),new Me(n.firestore,n instanceof lr?n.converter:null,new F(r))}}function w0(n,e){return n=H(n),e=H(e),(n instanceof Me||n instanceof lr)&&(e instanceof Me||e instanceof lr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function E0(n,e){return n=H(n),e=H(e),n instanceof Rt&&e instanceof Rt&&n.firestore===e.firestore&&wc(n._query,e._query)&&n.converter===e.converter}class aq{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new Dg(this,"async_queue_retry"),this.iu=()=>{const t=Yu();t&&N("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=Yu();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=Yu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new at;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!ii(e))throw e;N("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;const i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw Je("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=t,t}enqueueAfterDelay(e,t,r){this.su(),this.ru.indexOf(e)>-1&&(t=0);const i=Vg.createAndSchedule(this,e,t,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&$()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function op(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class cq{constructor(){this._progressObserver={},this._taskCompletionResolver=new at,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const uq=-1;let Ke=class extends Pc{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new aq}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||T0(this),this._firestoreClient.terminate()}};function ht(n){return n._firestoreClient||T0(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function T0(n){var e,t,r;const i=n._freezeSettings(),s=function(l,h,f,p){return new M2(l,h,f,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,_0(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new YB(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function lq(n,e){R0(n=_e(n,Ke));const t=ht(n);if(t._uninitializedComponentsProvider)throw new k(b.FAILED_PRECONDITION,"SDK cache is already specified.");Tn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new zg;return A0(t,i,new h0(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function hq(n){R0(n=_e(n,Ke));const e=ht(n);if(e._uninitializedComponentsProvider)throw new k(b.FAILED_PRECONDITION,"SDK cache is already specified.");Tn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new zg;return A0(e,r,new KB(r,t.cacheSizeBytes))}function A0(n,e,t){const r=new at;return n.asyncQueue.enqueue(async()=>{try{await Ju(n,t),await sp(n,e),r.resolve()}catch(i){const s=i;if(!d0(s))throw s;Tn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function dq(n){if(n._initialized&&!n._terminated)throw new k(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new at;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!In.D())return Promise.resolve();const i=r+"main";await In.delete(i)}(bg(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function fq(n){return function(t){const r=new at;return t.asyncQueue.enqueueAndForget(async()=>VB(await jg(t),r)),r.promise}(ht(n=_e(n,Ke)))}function pq(n){return XB(ht(n=_e(n,Ke)))}function gq(n){return ZB(ht(n=_e(n,Ke)))}function mq(n,e){const t=ht(n=_e(n,Ke)),r=new cq;return rq(t,n._databaseId,e,r),r}function _q(n,e){return iq(ht(n=_e(n,Ke)),e).then(t=>t?new Rt(n,null,t.query):null)}function R0(n){if(n._initialized||n._terminated)throw new k(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Hn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Hn(rt.fromBase64String(e))}catch(t){throw new k(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Hn(rt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}let Yr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new k(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let Zi=class{constructor(e){this._methodName=e}};class fh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new k(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}}const yq=/^__.*__$/;class vq{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new _r(e,this.data,this.fieldMask,t,this.fieldTransforms):new vo(e,this.data,t,this.fieldTransforms)}}class S0{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new _r(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function b0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $()}}class ph{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new ph(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return Al(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(b0(this.Iu)&&yq.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class Iq{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Sc(e)}pu(e,t,r,i=!1){return new ph({Iu:e,methodName:t,gu:r,path:Ve.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function es(n){const e=n._freezeSettings(),t=Sc(n._databaseId);return new Iq(n._databaseId,!!e.ignoreUndefinedProperties,t)}function gh(n,e,t,r,i,s={}){const a=n.pu(s.merge||s.mergeFields?2:0,e,t,i);Zg("Data must be an object, but it was:",a,r);const l=D0(r,a);let h,f;if(s.merge)h=new Wt(a.fieldMask),f=a.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const I=ap(e,m,t);if(!a.contains(I))throw new k(b.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);x0(p,I)||p.push(I)}h=new Wt(p),f=a.fieldTransforms.filter(m=>h.covers(m.field))}else h=null,f=a.fieldTransforms;return new vq(new mt(l),h,f)}class Cc extends Zi{_toFieldTransform(e){if(e.Iu!==2)throw e.Iu===1?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cc}}function P0(n,e,t){return new ph({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Yg extends Zi{_toFieldTransform(e){return new Tc(e.path,new eo)}isEqual(e){return e instanceof Yg}}class wq extends Zi{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=P0(this,e,!0),r=this.yu.map(s=>ts(s,t)),i=new qi(r);return new Tc(e.path,i)}isEqual(e){return this===e}}class Eq extends Zi{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=P0(this,e,!0),r=this.yu.map(s=>ts(s,t)),i=new $i(r);return new Tc(e.path,i)}isEqual(e){return this===e}}class Tq extends Zi{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new to(e.serializer,cA(e.serializer,this.wu));return new Tc(e.path,t)}isEqual(e){return this===e}}function Jg(n,e,t,r){const i=n.pu(1,e,t);Zg("Data must be an object, but it was:",i,r);const s=[],a=mt.empty();Xi(r,(h,f)=>{const p=em(e,h,t);f=H(f);const m=i.Ru(p);if(f instanceof Cc)s.push(p);else{const I=ts(f,m);I!=null&&(s.push(p),a.set(p,I))}});const l=new Wt(s);return new S0(a,l,i.fieldTransforms)}function Xg(n,e,t,r,i,s){const a=n.pu(1,e,t),l=[ap(e,r,t)],h=[i];if(s.length%2!=0)throw new k(b.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<s.length;I+=2)l.push(ap(e,s[I])),h.push(s[I+1]);const f=[],p=mt.empty();for(let I=l.length-1;I>=0;--I)if(!x0(f,l[I])){const A=l[I];let L=h[I];L=H(L);const M=a.Ru(A);if(L instanceof Cc)f.push(A);else{const V=ts(L,M);V!=null&&(f.push(A),p.set(A,V))}}const m=new Wt(f);return new S0(p,m,a.fieldTransforms)}function C0(n,e,t,r=!1){return ts(t,n.pu(r?4:3,e))}function ts(n,e){if(k0(n=H(n)))return Zg("Unsupported field value:",e,n),D0(n,e);if(n instanceof Zi)return function(r,i){if(!b0(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const l of r){let h=ts(l,i.Vu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=H(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return cA(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Le.fromDate(r);return{timestampValue:no(i.serializer,s)}}if(r instanceof Le){const s=new Le(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:no(i.serializer,s)}}if(r instanceof fh)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Hn)return{bytesValue:IA(i.serializer,r._byteString)};if(r instanceof Me){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:wg(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${dh(r)}`)}(n,e)}function D0(n,e){const t={};return $T(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xi(n,(r,i)=>{const s=ts(i,e.Eu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function k0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Le||n instanceof fh||n instanceof Hn||n instanceof Me||n instanceof Zi)}function Zg(n,e,t){if(!k0(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=dh(t);throw r==="an object"?e.mu(n+" a custom object"):e.mu(n+" "+r)}}function ap(n,e,t){if((e=H(e))instanceof Yr)return e._internalPath;if(typeof e=="string")return em(n,e);throw Al("Field path arguments must be of type string or ",n,!1,void 0,t)}const Aq=new RegExp("[~\\*/\\[\\]]");function em(n,e,t){if(e.search(Aq)>=0)throw Al(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Yr(...e.split("."))._internalPath}catch{throw Al(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Al(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new k(b.INVALID_ARGUMENT,l+n+h)}function x0(n,e){return n.some(t=>t.isEqual(e))}class Za{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Rq(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(mh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Rq extends Za{data(){return super.data()}}function mh(n,e){return typeof e=="string"?em(n,e):e instanceof Yr?e._internalPath:e._delegate._internalPath}function N0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new k(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class tm{}class Dc extends tm{}function xr(n,e,...t){let r=[];e instanceof tm&&r.push(e),r=r.concat(t),function(s){const a=s.filter(h=>h instanceof nm).length,l=s.filter(h=>h instanceof _h).length;if(a>1||a>0&&l>0)throw new k(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class _h extends Dc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new _h(e,t,r)}_apply(e){const t=this._parse(e);return O0(e._query,t),new Rt(e.firestore,e.converter,jf(e._query,t))}_parse(e){const t=es(e.firestore);return function(s,a,l,h,f,p,m){let I;if(f.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new k(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){KI(m,p);const A=[];for(const L of m)A.push(zI(h,s,L));I={arrayValue:{values:A}}}else I=zI(h,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||KI(m,p),I=C0(l,a,m,p==="in"||p==="not-in");return he.create(f,p,I)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Sq(n,e,t){const r=e,i=mh("where",n);return _h._create(i,r,t)}class nm extends tm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new nm(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Te.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i;const l=s.getFlattenedFilters();for(const h of l)O0(a,h),a=jf(a,h)}(e._query,t),new Rt(e.firestore,e.converter,jf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class rm extends Dc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new rm(e,t)}_apply(e){const t=function(i,s,a){if(i.startAt!==null)throw new k(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new k(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ha(s,a)}(e._query,this._field,this._direction);return new Rt(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new mr(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function bq(n,e="asc"){const t=e,r=mh("orderBy",n);return rm._create(r,t)}class yh extends Dc{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new yh(e,t,r)}_apply(e){return new Rt(e.firestore,e.converter,ml(e._query,this._limit,this._limitType))}}function Pq(n){return v0("limit",n),yh._create("limit",n,"F")}function Cq(n){return v0("limitToLast",n),yh._create("limitToLast",n,"L")}class vh extends Dc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new vh(e,t,r)}_apply(e){const t=V0(e,this.type,this._docOrFields,this._inclusive);return new Rt(e.firestore,e.converter,function(i,s){return new mr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}}function Dq(...n){return vh._create("startAt",n,!0)}function kq(...n){return vh._create("startAfter",n,!1)}class Ih extends Dc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Ih(e,t,r)}_apply(e){const t=V0(e,this.type,this._docOrFields,this._inclusive);return new Rt(e.firestore,e.converter,function(i,s){return new mr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}}function xq(...n){return Ih._create("endBefore",n,!1)}function Nq(...n){return Ih._create("endAt",n,!0)}function V0(n,e,t,r){if(t[0]=H(t[0]),t[0]instanceof Za)return function(s,a,l,h,f){if(!h)throw new k(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const p=[];for(const m of Ws(s))if(m.field.isKeyField())p.push(Ui(a,h.key));else{const I=h.data.field(m.field);if(rh(I))throw new k(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+m.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(I===null){const A=m.field.canonicalString();throw new k(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${A}' (used as the orderBy) does not exist.`)}p.push(I)}return new jr(p,f)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=es(n.firestore);return function(a,l,h,f,p,m){const I=a.explicitOrderBy;if(p.length>I.length)throw new k(b.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const A=[];for(let L=0;L<p.length;L++){const M=p[L];if(I[L].field.isKeyField()){if(typeof M!="string")throw new k(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof M}`);if(!pg(a)&&M.indexOf("/")!==-1)throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${M}' contains a slash.`);const V=a.path.child(ge.fromString(M));if(!F.isDocumentKey(V))throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${V}' is not because it contains an odd number of segments.`);const Y=new F(V);A.push(Ui(l,Y))}else{const V=C0(h,f,M);A.push(V)}}return new jr(A,m)}(n._query,n.firestore._databaseId,i,e,t,r)}}function zI(n,e,t){if(typeof(t=H(t))=="string"){if(t==="")throw new k(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pg(e)&&t.indexOf("/")!==-1)throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ge.fromString(t));if(!F.isDocumentKey(r))throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ui(n,new F(r))}if(t instanceof Me)return Ui(n,t._key);throw new k(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${dh(t)}.`)}function KI(n,e){if(!Array.isArray(n)||n.length===0)throw new k(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function O0(n,e){const t=function(i,s){for(const a of i)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new k(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new k(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class im{convertValue(e,t="none"){switch(Fi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $e(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw $()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Xi(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new fh($e(e.latitude),$e(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=dg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ga(e));default:return null}}convertTimestamp(e){const t=Gr(e);return new Le(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ge.fromString(e);z(DA(r));const i=new Kr(r.get(1),r.get(3)),s=new F(r.popFirst(5));return i.isEqual(t)||Je(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function wh(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Vq extends im{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}}class Pi{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let fr=class extends Za{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ta(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(mh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Ta=class extends fr{data(e={}){return super.data(e)}},Jr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Pi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Ta(this._firestore,this._userDataWriter,r.key,r,new Pi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new k(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{const h=new Ta(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Pi(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const h=new Ta(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Pi(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,p=-1;return l.type!==0&&(f=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:Oq(l.type),doc:h,oldIndex:f,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Oq(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $()}}function L0(n,e){return n instanceof fr&&e instanceof fr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Jr&&e instanceof Jr&&n._firestore===e._firestore&&E0(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function M0(n){n=_e(n,Me);const e=_e(n.firestore,Ke);return g0(ht(e),n._key).then(t=>sm(e,n,t))}class ns extends im{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}}function Lq(n){n=_e(n,Me);const e=_e(n.firestore,Ke),t=ht(e),r=new ns(e);return eq(t,n._key).then(i=>new fr(e,r,n._key,i,new Pi(i!==null&&i.hasLocalMutations,!0),n.converter))}function Mq(n){n=_e(n,Me);const e=_e(n.firestore,Ke);return g0(ht(e),n._key,{source:"server"}).then(t=>sm(e,n,t))}function Fq(n){n=_e(n,Rt);const e=_e(n.firestore,Ke),t=ht(e),r=new ns(e);return N0(n._query),m0(t,n._query).then(i=>new Jr(e,r,n,i))}function Uq(n){n=_e(n,Rt);const e=_e(n.firestore,Ke),t=ht(e),r=new ns(e);return tq(t,n._query).then(i=>new Jr(e,r,n,i))}function Bq(n){n=_e(n,Rt);const e=_e(n.firestore,Ke),t=ht(e),r=new ns(e);return m0(t,n._query,{source:"server"}).then(i=>new Jr(e,r,n,i))}function HI(n,e,t){n=_e(n,Me);const r=_e(n.firestore,Ke),i=wh(n.converter,e,t);return kc(r,[gh(es(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Oe.none())])}function jI(n,e,t,...r){n=_e(n,Me);const i=_e(n.firestore,Ke),s=es(i);let a;return a=typeof(e=H(e))=="string"||e instanceof Yr?Xg(s,"updateDoc",n._key,e,t,r):Jg(s,"updateDoc",n._key,e),kc(i,[a.toMutation(n._key,Oe.exists(!0))])}function qq(n){return kc(_e(n.firestore,Ke),[new Io(n._key,Oe.none())])}function $q(n,e){const t=_e(n.firestore,Ke),r=Xa(n),i=wh(n.converter,e);return kc(t,[gh(es(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Oe.exists(!1))]).then(()=>r)}function F0(n,...e){var t,r,i;n=H(n);let s={includeMetadataChanges:!1},a=0;typeof e[a]!="object"||op(e[a])||(s=e[a],a++);const l={includeMetadataChanges:s.includeMetadataChanges};if(op(e[a])){const m=e[a];e[a]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[a+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[a+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let h,f,p;if(n instanceof Me)f=_e(n.firestore,Ke),p=yo(n._key.path),h={next:m=>{e[a]&&e[a](sm(f,n,m))},error:e[a+1],complete:e[a+2]};else{const m=_e(n,Rt);f=_e(m.firestore,Ke),p=m._query;const I=new ns(f);h={next:A=>{e[a]&&e[a](new Jr(f,I,m,A))},error:e[a+1],complete:e[a+2]},N0(n._query)}return function(I,A,L,M){const V=new lh(M),Y=new Fg(A,V,L);return I.asyncQueue.enqueueAndForget(async()=>Og(await ao(I),Y)),()=>{V.Na(),I.asyncQueue.enqueueAndForget(async()=>Lg(await ao(I),Y))}}(ht(f),p,l,h)}function Wq(n,e){return nq(ht(n=_e(n,Ke)),op(e)?e:{next:e})}function kc(n,e){return function(r,i){const s=new at;return r.asyncQueue.enqueueAndForget(async()=>DB(await jg(r),i,s)),s.promise}(ht(n),e)}function sm(n,e,t){const r=t.docs.get(e._key),i=new ns(n);return new fr(n,i,e._key,r,new Pi(t.hasPendingWrites,t.fromCache),e.converter)}const Gq={maxAttempts:5};let zq=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=es(e)}set(e,t,r){this._verifyNotCommitted();const i=Vr(e,this._firestore),s=wh(i.converter,t,r),a=gh(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(a.toMutation(i._key,Oe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=Vr(e,this._firestore);let a;return a=typeof(t=H(t))=="string"||t instanceof Yr?Xg(this._dataReader,"WriteBatch.update",s._key,t,r,i):Jg(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Oe.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Vr(e,this._firestore);return this._mutations=this._mutations.concat(new Io(t._key,Oe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Vr(n,e){if((n=H(n)).firestore!==e)throw new k(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}let Kq=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=es(t)}get(t){const r=Vr(t,this._firestore),i=new Vq(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return $();const a=s[0];if(a.isFoundDocument())return new Za(this._firestore,i,a.key,a,r.converter);if(a.isNoDocument())return new Za(this._firestore,i,r._key,null,r.converter);throw $()})}set(t,r,i){const s=Vr(t,this._firestore),a=wh(s.converter,r,i),l=gh(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(t,r,i,...s){const a=Vr(t,this._firestore);let l;return l=typeof(r=H(r))=="string"||r instanceof Yr?Xg(this._dataReader,"Transaction.update",a._key,r,i,s):Jg(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,l),this}delete(t){const r=Vr(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Vr(e,this._firestore),r=new ns(this._firestore);return super.get(e).then(i=>new fr(this._firestore,r,t._key,i._document,new Pi(!1,!1),t.converter))}};function Hq(n,e,t){n=_e(n,Ke);const r=Object.assign(Object.assign({},Gq),t);return function(s){if(s.maxAttempts<1)throw new k(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,a,l){const h=new at;return s.asyncQueue.enqueueAndForget(async()=>{const f=await JB(s);new QB(s.asyncQueue,f,l,a,h).run()}),h.promise}(ht(n),i=>e(new Kq(n,i)),r)}function jq(){return new Cc("deleteField")}function Qq(){return new Yg("serverTimestamp")}function Yq(...n){return new wq("arrayUnion",n)}function Jq(...n){return new Eq("arrayRemove",n)}function Xq(n){return new Tq("increment",n)}(function(e,t=!0){(function(i){_o=i})(Zr),qr(new Gn("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),l=new Ke(new o2(r.getProvider("auth-internal")),new l2(r.getProvider("app-check-internal")),function(f,p){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new k(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Kr(f.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Bn($v,"4.4.0",e),Bn($v,"4.4.0","esm2017")})();const Zq="@firebase/firestore-compat",e4="0.3.23";function om(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function QI(){if(typeof Uint8Array>"u")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function YI(){if(!O2())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}class ec{constructor(e){this._delegate=e}static fromBase64String(e){return YI(),new ec(Hn.fromBase64String(e))}static fromUint8Array(e){return QI(),new ec(Hn.fromUint8Array(e))}toBase64(){return YI(),this._delegate.toBase64()}toUint8Array(){return QI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function cp(n){return t4(n,["next","error","complete"])}function t4(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class n4{enableIndexedDbPersistence(e,t){return lq(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return hq(e._delegate)}clearIndexedDbPersistence(e){return dq(e._delegate)}}class U0{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Kr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Tn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){sq(this._delegate,e,t,r)}enableNetwork(){return pq(this._delegate)}disableNetwork(){return gq(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,y0("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return fq(this._delegate)}onSnapshotsInSync(e){return Wq(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new co(this,I0(this._delegate,e))}catch(t){throw Dt(t,"collection()","Firestore.collection()")}}doc(e){try{return new hn(this,Xa(this._delegate,e))}catch(t){throw Dt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ct(this,oq(this._delegate,e))}catch(t){throw Dt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Hq(this._delegate,t=>e(new B0(this,t)))}batch(){return ht(this._delegate),new q0(new zq(this._delegate,e=>kc(this._delegate,e)))}loadBundle(e){return mq(this._delegate,e)}namedQuery(e){return _q(this._delegate,e).then(t=>t?new Ct(this,t):null)}}class Eh extends im{constructor(e){super(),this.firestore=e}convertBytes(e){return new ec(new Hn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return hn.forKey(t,this.firestore,null)}}function r4(n){n2(n)}class B0{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Eh(e)}get(e){const t=Ci(e);return this._delegate.get(t).then(r=>new tc(this._firestore,new fr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Ci(e);return r?(om("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Ci(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Ci(e);return this._delegate.delete(t),this}}class q0{constructor(e){this._delegate=e}set(e,t,r){const i=Ci(e);return r?(om("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Ci(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Ci(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Ki{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Ta(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new nc(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Ki.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new Ki(e,new Eh(e),t),i.set(t,s)),s}}Ki.INSTANCES=new WeakMap;class hn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Eh(e)}static forPath(e,t,r){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new hn(t,new Me(t._delegate,r,new F(e)))}static forKey(e,t,r){return new hn(t,new Me(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new co(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new co(this.firestore,I0(this._delegate,e))}catch(t){throw Dt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=H(e),e instanceof Me?w0(this._delegate,e):!1}set(e,t){t=om("DocumentReference.set",t);try{return t?HI(this._delegate,e,t):HI(this._delegate,e)}catch(r){throw Dt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?jI(this._delegate,e):jI(this._delegate,e,t,...r)}catch(i){throw Dt(i,"updateDoc()","DocumentReference.update()")}}delete(){return qq(this._delegate)}onSnapshot(...e){const t=$0(e),r=W0(e,i=>new tc(this.firestore,new fr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return F0(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=Lq(this._delegate):(e==null?void 0:e.source)==="server"?t=Mq(this._delegate):t=M0(this._delegate),t.then(r=>new tc(this.firestore,new fr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new hn(this.firestore,e?this._delegate.withConverter(Ki.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Dt(n,e,t){return n.message=n.message.replace(e,t),n}function $0(n){for(const e of n)if(typeof e=="object"&&!cp(e))return e;return{}}function W0(n,e){var t,r;let i;return cp(n[0])?i=n[0]:cp(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class tc{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new hn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return L0(this._delegate,e._delegate)}}class nc extends tc{data(e){const t=this._delegate.data(e);return this._delegate._converter||r2(t!==void 0),t}}class Ct{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Eh(e)}where(e,t,r){try{return new Ct(this.firestore,xr(this._delegate,Sq(e,t,r)))}catch(i){throw Dt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Ct(this.firestore,xr(this._delegate,bq(e,t)))}catch(r){throw Dt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ct(this.firestore,xr(this._delegate,Pq(e)))}catch(t){throw Dt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Ct(this.firestore,xr(this._delegate,Cq(e)))}catch(t){throw Dt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ct(this.firestore,xr(this._delegate,Dq(...e)))}catch(t){throw Dt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ct(this.firestore,xr(this._delegate,kq(...e)))}catch(t){throw Dt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ct(this.firestore,xr(this._delegate,xq(...e)))}catch(t){throw Dt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ct(this.firestore,xr(this._delegate,Nq(...e)))}catch(t){throw Dt(t,"endAt()","Query.endAt()")}}isEqual(e){return E0(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=Uq(this._delegate):(e==null?void 0:e.source)==="server"?t=Bq(this._delegate):t=Fq(this._delegate),t.then(r=>new up(this.firestore,new Jr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=$0(e),r=W0(e,i=>new up(this.firestore,new Jr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return F0(this._delegate,t,r)}withConverter(e){return new Ct(this.firestore,e?this._delegate.withConverter(Ki.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class i4{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new nc(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class up{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ct(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new nc(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new i4(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new nc(this._firestore,r))})}isEqual(e){return L0(this._delegate,e._delegate)}}class co extends Ct{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new hn(this.firestore,e):null}doc(e){try{return e===void 0?new hn(this.firestore,Xa(this._delegate)):new hn(this.firestore,Xa(this._delegate,e))}catch(t){throw Dt(t,"doc()","CollectionReference.doc()")}}add(e){return $q(this._delegate,e).then(t=>new hn(this.firestore,t))}isEqual(e){return w0(this._delegate,e._delegate)}withConverter(e){return new co(this.firestore,e?this._delegate.withConverter(Ki.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ci(n){return _e(n,Me)}class am{constructor(...e){this._delegate=new Yr(...e)}static documentId(){return new am(Ve.keyField().canonicalString())}isEqual(e){return e=H(e),e instanceof Yr?this._delegate._internalPath.isEqual(e._internalPath):!1}}class Ai{constructor(e){this._delegate=e}static serverTimestamp(){const e=Qq();return e._methodName="FieldValue.serverTimestamp",new Ai(e)}static delete(){const e=jq();return e._methodName="FieldValue.delete",new Ai(e)}static arrayUnion(...e){const t=Yq(...e);return t._methodName="FieldValue.arrayUnion",new Ai(t)}static arrayRemove(...e){const t=Jq(...e);return t._methodName="FieldValue.arrayRemove",new Ai(t)}static increment(e){const t=Xq(e);return t._methodName="FieldValue.increment",new Ai(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const s4={Firestore:U0,GeoPoint:fh,Timestamp:Le,Blob:ec,Transaction:B0,WriteBatch:q0,DocumentReference:hn,DocumentSnapshot:tc,Query:Ct,QueryDocumentSnapshot:nc,QuerySnapshot:up,CollectionReference:co,FieldPath:am,FieldValue:Ai,setLogLevel:r4,CACHE_SIZE_UNLIMITED:uq};function o4(n,e){n.INTERNAL.registerComponent(new Gn("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},s4)))}function a4(n){o4(n,(e,t)=>new U0(e,t,new n4)),n.registerVersion(Zq,e4)}a4($r);const c4={apiKey:"AIzaSyCfFGZC07caKFCARPJmMU-qsuAW8jLIu3E",authDomain:"project-fitness-07.firebaseapp.com",projectId:"project-fitness-07",storageBucket:"project-fitness-07.appspot.com",messagingSenderId:"607206642972",appId:"1:607206642972:web:ea1d5c525a976b668cd6d9"},Hi=$r.initializeApp(c4);async function u4({email:n,password:e,name:t}){await Hi.auth().createUserWithEmailAndPassword(n,e),await(await Hi.auth().currentUser).updateProfile({displayName:t})}async function l4({email:n,password:e}){try{await Hi.auth().signInWithEmailAndPassword(n,e)}catch(t){console.log(t.message)}}async function h4(){await Hi.auth().signOut()}const ra={fs:$r.firestore(),getCurrentUserID:async function(){return new Promise((n,e)=>{Hi.auth().onAuthStateChanged(t=>{t?n(t.uid):e("User not authenticated")})})},addData:async function(n,e){const t=await this.getCurrentUserID();this.fs.collection("users").doc(t).set({[n]:e},{merge:!0}).then(()=>!0).catch(r=>(console.error("Error writing document: ",r),!1))},removeData:async function(n){const e=await this.getCurrentUserID();this.fs.collection("users").doc(e).update({[n]:$r.firestore.FieldValue.delete()},{merge:!0}).then(()=>!0).catch(t=>(console.error("Error writing document: ",t),!1))},getData:async function(){const n=await this.getCurrentUserID(),e=Xa(this.fs,"users",n),t=await M0(e);if(t.exists())return t.data();console.error("No such document")}};function Vs(n,e){let t="";for(let r=0;r<n;r+=1)e.classList.contains("workout-cards__wrapper")||e.classList.contains("favorite-cards__wrapper")?t+=`
      <li class='workouts__skeleton-loader'>
        <div class='svg-container'>
          <svg
            role="img"
            width="100%"
            height="135"
            aria-labelledby="loading-aria"
            viewBox="0 0 405 141"
            preserveAspectRatio="none"
          >
            <title id="loading-aria">Loading...</title>
            <rect
              x="0"
              y="0"
              width="100%"
              height="100%"
              clip-path="url(#clip-path)"
              style='fill: url("#fill");'
            ></rect>
            <defs>
              <clipPath id="clip-path">
                  <rect x="9" y="5" rx="10" ry="10" width="81" height="19" />
                  <rect x="107" y="5" rx="3" ry="3" width="19" height="18" />
                  <circle cx="28" cy="67" r="19" />
                  <rect x="311" y="7" rx="4" ry="4" width="58" height="20" />
                  <rect x="381" y="18" rx="0" ry="0" width="40" height="0" />
                  <rect x="74" y="54" rx="0" ry="0" width="192" height="25" />
                  <rect x="6" y="108" rx="0" ry="0" width="123" height="28" />
                  <rect x="164" y="109" rx="0" ry="0" width="122" height="26" />
                  <rect x="314" y="109" rx="0" ry="0" width="77" height="27" />
                  <rect x="379" y="8" rx="7" ry="7" width="19" height="19" />
              </clipPath>
              <linearGradient id="fill">
                <stop
                  offset="0.599964"
                  stop-color="#ecebeb"
                  stop-opacity="1"
                >
                  <animate
                    attributeName="offset"
                    values="-2; -2; 1"
                    keyTimes="0; 0.25; 1"
                    dur="2s"
                    repeatCount="indefinite"
                  ></animate>
                </stop>
                <stop
                  offset="1.59996"
                  stop-color="#ffffff"
                  stop-opacity="1"
                >
                  <animate
                    attributeName="offset"
                    values="-1; -1; 2"
                    keyTimes="0; 0.25; 1"
                    dur="2s"
                    repeatCount="indefinite"
                  ></animate>
                </stop>
                <stop
                  offset="2.59996"
                  stop-color="#ecebeb"
                  stop-opacity="1"
                >
                  <animate
                    attributeName="offset"
                    values="0; 0; 3"
                    keyTimes="0; 0.25; 1"
                    dur="2s"
                    repeatCount="indefinite"
                  ></animate>
                </stop>
              </linearGradient>
            </defs>
          </svg>
        </div>
      </li>
      `:t+=`
      <li class='exercises__skeleton-loader'>
        <div class='card'>
          <div class='cover-image-skeleton'></div>
        </div>
      </li>
      `;return t}function Os(n,e){n.innerHTML=e}const zs=document.querySelector(".js-cards"),Ks="/project-fitness-07/";function d4(n){const e=n.map(({filter:t,name:r,imgURL:i})=>`
        <li class="exercise-cards__gallery-link js-card" data-card-name="${r}">
            <div class="exercise-cards__gallery-card">

                <img class="exercise-cards__gallery-image"  src="${i}" alt="${t+"-"+r}" loading="lazy" />
                <div class="exercise-cards__gallery-info">
                    <h3 class="exercise-cards__head3-name">${r}</h3>
                    <p class="exercise-cards__parag-filter">${t}</p>
                </div>
            </div>
        </li>
        `).join("");zs.insertAdjacentHTML("beforeend",e)}function f4(n){const e=n.map(({_id:t,bodyPart:r,name:i,target:s,burnedCalories:a,time:l,rating:h})=>`
        <li class="workout-cards__gallery-link js-workout-card" data-id="${t}">
            <div class="workout-cards__gallery-card" >
                <div class="workout-cards__first-line-wrapper">
                    <p class="workout-cards__parag-workout">Workout</p>
                    <p class="workout-cards__parag-rating">${Math.round(h*10)/10}</p>
                    <svg class="workout-cards__icon-star">
                        <use href="${Ks}images/icons-sprite.svg#icon-star"></use>
                    </svg>
                    <p class="workout-cards__parag-start">Start</p>
                    <svg class="workout-cards__icon-arrow-up">
                        <use href="${Ks}images/icons-sprite.svg#icon-arrow-up"></use>
                    </svg>
                </div>
                <div class="workout-cards__second-line-wrapper">
                    <div class="workout-cards__wrapper-icon-running-stick">
                        <svg class="workout-cards__icon-running-stick">
                            <use href="${Ks}images/icons-sprite.svg#icon-running-stick"></use>
                        </svg>
                    </div>
                    <h3 class="workout-cards__head3-name">${i}</h3>
                </div>
                <div class="workout-cards__third-line-wrapper">
                  <ul class="workout-cards__list-info">
                    <li class="workout-cards__list-point">
                      <p class="workout-cards__parag-burned-calories">Burned calories:</p>
                      <p class="workout-cards__parag-burned-calories-result">${a} / ${l} min<p>
                    </li>
                    <li class="workout-cards__list-point">
                      <p class="workout-cards__parag-body-part">Body part:</p>
                      <p class="workout-cards__parag-body-part-result">${r}<p>
                    </li>
                    <li class="workout-cards__list-point">
                      <p class="workout-cards__parag-target">Target:</p>
                      <p class="workout-cards__parag-target-result">${s}<p>
                    </li>
                  </ul>
                </div>
            </div>
          </li>
        `).join("");zs.insertAdjacentHTML("beforeend",e)}function p4(n){const e=n.length;Os(zs,Vs(e,zs));const t=n.map(({_id:r,bodyPart:i,name:s,target:a,burnedCalories:l,time:h})=>`
        <li class="favorite-cards__gallery-link" data-id="${r}">
            <div class="favorite-cards__gallery-card">
                <div class="favorite-cards__first-line-wrapper">
                    <p class="favorite-cards__parag-workout">Workout</p>
                    <svg class="favorite-cards__icon-trash">
                        <use href="${Ks}images/icons-sprite.svg#icon-trash"></use>
                    </svg>
                    <p class="favorite-cards__parag-start">Start</p>
                    <svg class="favorite-cards__icon-arrow-up">
                        <use href="${Ks}images/icons-sprite.svg#icon-arrow-up"></use>
                    </svg>
                </div>
                <div class="favorite-cards__second-line-wrapper">
                    <div class="workout-cards__wrapper-icon-running-stick">
                      <svg class="favorite-cards__icon-running-stick">
                          <use href="${Ks}images/icons-sprite.svg#icon-running-stick"></use>
                      </svg>
                    </div>
                    <h3 class="favorite-cards__head3-name">${s}</h3>
                </div>
                <div class="favorite-cards__third-line-wrapper">
                  <ul class="favorite-cards__list-info">
                    <li class="favorite-cards__list-point">
                      <p class="favorite-cards__parag-burned-calories">Burned calories:</p>
                      <p class="favorite-cards__parag-burned-calories-result">${l} / ${h} min<p>
                    </li>
                    <li class="favorite-cards__list-point">
                      <p class="favorite-cards__parag-body-part">Body part:</p>
                      <p class="favorite-cards__parag-body-part-result">${i}<p>
                    </li>
                    <li class="favorite-cards__list-point">
                      <p class="favorite-cards__parag-target">Target:</p>
                      <p class="favorite-cards__parag-target-result">${a}<p>
                    </li>
                  </ul>
                </div>
            </div>
          </li>
        `).join("");zs.innerHTML=t}function Mu(){zs.innerHTML=""}const Vi={add:function(n,e){return new Promise((t,r)=>{try{ra.addData(n,e),t(!0)}catch{r(!1)}})},get:function(){return new Promise(async(n,e)=>{try{const t=await ra.getData();n(Object.values(t))}catch{e([])}})},idIsFavorite:async function(n){try{return(await this.get()).some(t=>t._id===n)}catch{return!1}},getObjectById:async function(n){try{const t=(await this.get()).find(r=>r._id===n)||null;return t?{...t,isFavorite:!0}:null}catch{return null}},addAndGet:async function(n,e){return new Promise(async(t,r)=>{try{await ra.addData(n,e),setTimeout(async()=>{const i=await ra.getData();t(Object.values(i))},200)}catch{r([])}})},remove:async function(n){return new Promise((e,t)=>{try{ra.removeData(n),e(!0)}catch{t(!1)}})}},Pn=document.querySelector(".js-cards");function G0(n,e){if(e>=768)return n!=3?(Os(Pn,Vs(10,Pn)),10):(Os(Pn,Vs(12,Pn)),12);if(e<768){if(n===1)return Os(Pn,Vs(8,Pn)),8;if(n===2||n===1)return Os(Pn,Vs(8,Pn)),8}return Os(Pn,Vs(9,Pn)),9}function z0(n){const e={filter:"Body%20parts",bodypart:"",keyword:"",muscles:"",equipment:""};for(const t in n)if(n.hasOwnProperty(t)&&n[t]!==e[t])return!0;return!1}function g4(n,e,t,r,i,s){return z0(r)?(t.bodyPart=r.bodypart,t.searchQuery=r.keyword,t.muscles=r.muscles,t.equipment=r.equipment,i=Rl(n,e,t,s).fetchFilteredExercises()):i=Rl(n,e,t,s).fetchExercise(),i}function m4(n,e,t,r,i,s){return z0(r)&&(t.filter=r.filter),i=Rl(n,e,t,s).fetchMuscles(),i}function Rl(n,e,t,r){const i=G0(e,r);return t.pageCounter=n,t.limit=i,t}function JI(n){return n.then(e=>e).catch(e=>{throw console.error("Error in getData:",e),e})}function K0(n,e){const t=document.querySelector(".filters__list .active");if(t){const r=t.id.includes("-")?(t.id.charAt(0).toUpperCase()+t.id.slice(1)).replace("-","%20"):t.id.charAt(0).toUpperCase()+t.id.slice(1);if(r!=n.filter||n.filter===""){n.filter=r;for(const i in n)i!=="filter"&&(n[i]="");e.currentPage=1,e.endPoint=3}}}async function _4({currentPage:n,endPoint:e},t){let r;const i=G0(e,t),s=localStorage.getItem("favoriteData"),a=localStorage.getItem("isDataOld"),l=a?JSON.parse(a):[];if(l||l.length===1)try{const h=await Vi.get();r=XI(h,i),localStorage.setItem("favoriteData",JSON.stringify(h)),s&&localStorage.setItem("isDataOld",JSON.stringify(!1));const f=ZI(n,r);return{totalPages:r.totalPages,currentData:f}}catch(h){console.log("Favorite data error: ",h)}else{const h=s?JSON.parse(s):[],f=XI(h,i),p=ZI(n,f);return{totalPages:f.totalPages,currentData:p}}}function XI(n,e){const t=n.length;if(t<=e)return{totalPages:1,slicedData:n};if(t>e){const r=Math.ceil(t/e);let i=[];for(let s=0;s<r;s++){const a=s*e,l=(s+1)*e;i.push(n.slice(a,l))}return{totalPages:r,slicedData:i}}}function ZI(n,{totalPages:e,slicedData:t}){return e===1?t:t[n-1]}const qe={exerciseWrapper:"js-cards",workoutWrapper:"workout-cards__wrapper",favoriteWrapper:"favorite-cards__wrapper",visuallyHidden:"visually-hidden",emptyParag:"exercise-cards__parag-empty",emptyWrapper:"exercise-cards__wrapper-empty"},ew={stringHome:`
                <p class="exercise-cards__parag-empty">
                    Sorry, but we don't have anything for you with such filter. Please try another search
                </p>`,stringFavorite:`<p class="exercise-cards__parag-empty">
                        It appears that you haven't added any exercises to your favorites yet. To get started, you can add exercises
                        that you
                        like to your favorites for easier access in the future.
                    </p>`};function tw(n,e){const t=document.querySelector("."+e);t?t.innerHTML=n:console.log(e+" do not exist")}function Fu(n,e){const t=document.querySelector("."+e);t?t.classList.add(n):console.log(e+" do not exist")}function bs(n,e){const t=document.querySelector("."+e);t?t.classList.remove(n):console.log(e+" do not exist")}const lp=document.querySelector(".js-pages");function mf(n,e){const t=[];if(e>1){for(let i=n-3;i<=n+3;i++)if(i>0&&i<=e){const s=i===n?"exercise-cards__wrapper-page exercise-cards__current-page":"exercise-cards__wrapper-page js-pages";t.push(`
                    <div class="${s}">
                        <a class="exercise-cards__page js-page" data-page="${i}" href="">
                            ${i}
                        </a>
                    </div>
                `)}lp.innerHTML="";for(const i of t)lp.insertAdjacentHTML("beforeend",i)}}function Uu(){lp.innerHTML=""}function y4(n){n.preventDefault();const{target:e}=n;if(e.classList.contains("js-cards"))return;const t=e.closest(".js-card");if(t)return t.dataset.cardName;console.log("Can not read name",t)}function v4(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-page")?e.closest(".js-page").dataset.page:void 0}function I4(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-cards")?void 0:e.closest(".js-workout-card").dataset.id}const w4=async function(n){const{_id:e}=n;try{if(await Vi.idIsFavorite(e)){const r=await Vi.remove(e);return console.log(`Object with _id ${e} removed from favorites.`),localStorage.setItem("isDataOld",JSON.stringify(!0)),!1}else{localStorage.setItem("isDataOld",JSON.stringify(!0));const r=await Vi.add(e,n);return console.log(`Object with _id ${e} added to favorites.`),r}}catch(t){return console.error(t),!1}},E4=n=>typeof n!="string"?n:n.split(" ").filter(e=>e).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),nw=n=>typeof n!="string"?n:n.charAt(0).toUpperCase()+n.slice(1),T4=n=>typeof n!="string"?n:n.replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase(),A4=n=>{const e=getComputedStyle(document.documentElement).getPropertyValue("--rating-color-inactive"),t=getComputedStyle(document.documentElement).getPropertyValue("--rating-color-active");return`
<!-- DEFINE SVGs -->
<svg height="0" width="0">
  <defs>
    <!-- DEFINE ONE STAR -->
    <symbol viewBox="0 0 32 32" id="iconstar">
      <path
        d="M13.826 3.262c.684-2.106 3.663-2.106 4.348 0l1.932 5.945a2.285 2.285 0 0 0 2.174 1.579h6.251c2.214 0 3.135 2.833 1.344 4.135l-5.057 3.674a2.286 2.286 0 0 0-.83 2.556l1.931 5.945c.684 2.106-1.726 3.857-3.517 2.555l-5.057-3.674a2.286 2.286 0 0 0-2.687 0l-5.057 3.674c-1.791 1.302-4.202-.45-3.517-2.555l1.932-5.945a2.287 2.287 0 0 0-.83-2.556l-5.057-3.674c-1.791-1.302-.871-4.135 1.344-4.135h6.251c.99 0 1.868-.638 2.174-1.579l1.932-5.945z" />
    </symbol>
    <!-- DEFINE PATTERN FOR EMPTY STARS -->
    <pattern id="stars-empty" patternUnits="userSpaceOnUse" width="24" height="24">
      <use x="0" y="0" xlink:href="#iconstar" fill="${e}" height="24" width="24"/>
    </pattern>
    <!-- DEFINE PATTERN FOR FULL STARS -->
    <pattern id="stars-full" patternUnits="userSpaceOnUse" width="24" height="24">
      <use x="0" y="0" xlink:href="#iconstar" fill="${t}" height="24" width="24"/>
    </pattern>
  </defs>
</svg>

<!-- INSERT STARS -->
<svg height="24" viewBox="0 0 120 24" width="120">
  <rect fill="url(#stars-empty)" x="0" y="0" height="24" width="120"/>
  <rect fill="url(#stars-full)" x="0" y="0" height="24" width="${n}%"/>
</svg>
`},R4="/project-fitness-07/",vn={exercise:{},ratingText:"Rating",iconStar:`${R4}images/icons-sprite.svg#icon-star`,ratingMax:5,closeKeyBoardBtn:"Escape",beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null},cm=document.querySelector("form.modal-form"),Sl=document.querySelector(".rating-modal-window"),S4=document.querySelector(".rating-modal-window .x-button");document.querySelector(".modal-email-validate");const b4=()=>{const n=[];for(let e=0;e<vn.ratingMax;e++){let t=vn.ratingMax-e;n.push(`
        <input type="radio" class="visually-hidden" id="star${t}" name="rating" value="${t}">
        <label class="rating-star" for="star${t}">
            <svg class="rating-star-icon">
                <use href=${vn.iconStar} />
            </svg>
        </label>
        `)}return`
    <div class="rating-wrapper">
        <p class="rating-text">${vn.ratingText}</p>
        <div class="rating-stars">
            ${n.join("")}
            <p class="rating-count">0.0</p>
        </div>
    </div>
    `},H0=n=>{n.key===vn.closeKeyBoardBtn&&Th()},j0=n=>{um.forEach(e=>{delete e.dataset.dataChecked}),n.target.dataset.dataChecked="checked",lm.innerHTML=n.target.value},P4=()=>{lm.innerHTML="0.0"};cm.insertAdjacentHTML("afterbegin",b4());const um=document.querySelectorAll(".rating-stars input"),lm=document.querySelector(".rating-count"),Th=()=>{vn.afterClose&&vn.afterClose(vn.exercise),um.forEach(n=>{n.removeEventListener("change",j0)}),Sl.classList.remove("open"),document.body.style.overflow="visible",document.removeEventListener("keydown",H0),vn.afterClose&&vn.afterClose(),lm.innerHTML="0.0",cm.reset()},C4=()=>{Sl.classList.add("open"),document.body.style.overflow="hidden",document.addEventListener("keydown",H0),um.forEach(n=>{n.addEventListener("change",j0)})};S4.addEventListener("click",Th);cm.addEventListener("reset",P4);Sl.addEventListener("click",n=>{n.target===Sl&&Th()});const hp={modalConfig:vn,openRatingModal:C4,closeRatingModal:Th},Q0=document.querySelector(".backdrop");function Y0(n){Q0.classList.add("open"),n.classList.add("open")}function J0(n){Q0.classList.remove("open"),n.classList.remove("open")}const Hs={name:document.querySelector(".js__auth-modal__name__message"),email:document.querySelector(".js__auth-modal__email__message"),password:document.querySelector(".js__auth-modal__password__message")},D4=document.querySelector(".backdrop"),hm=document.querySelector(".header__auth_btn"),dm=document.querySelector(".authModal__content"),X0=document.querySelector(".authModal__content .x-button"),We=document.querySelector(".authForm"),rw=document.querySelector(".action__text"),fa=document.querySelector(".action__button"),iw=document.querySelector(".authForm__fieldset.username"),sw=document.querySelector(".authForm__title"),ow=document.querySelectorAll(".header__nav-authorized"),aw=document.querySelectorAll(".header__nav__item.auth"),bl=document.querySelectorAll(".header__logout_btn");let Xu=!0;const xc=()=>{J0(dm),X0.removeEventListener("click",xc),hm.addEventListener("click",Ah),document.body.style.overflow="visible"},Ah=()=>{Y0(dm),X0.addEventListener("click",xc),hm.removeEventListener("click",Ah),document.body.style.overflow="hidden"},dp=()=>{We.reset()},k4=async n=>{if(n.preventDefault(),!We.elements.name.value||We.elements.name.value.length<3){Hs.name.classList.remove("hidden");return}if(!We.elements.email.value||!ex(We.elements.email.value)){Hs.email.classList.remove("hidden");return}if(!We.elements.password.value||We.elements.password.value.length<6){Hs.password.classList.remove("hidden");return}const e=[...We.elements].reduce((t,r)=>(r.name&&(t[r.name]=r.value),t),{});Xu&&await u4(e),await l4(e),dp(),We.elements.regSubmitBtn.disabled=!0,xc()},x4=()=>{Xu?(fa.textContent="Registration",iw.classList.add("hidden"),fa.setAttribute("data-action","log_in"),sw.textContent="Log in",rw.textContent="Don't have an account?",dp(),Xu=!1):(fa.textContent="Log in",fa.setAttribute("data-action","reg"),iw.classList.remove("hidden"),sw.textContent="Registration",rw.textContent="Already have an account?",dp(),Xu=!0),We.elements.name.toggleAttribute("required")},N4=async()=>{await Hi.auth().onAuthStateChanged(n=>{n?(aw.forEach(e=>{e.classList.add("hidden")}),bl.forEach(e=>{e.classList.add("visible")}),ow.forEach(e=>{e.classList.add("visible")})):(aw.forEach(e=>{e.classList.remove("hidden")}),bl.forEach(e=>{e.classList.remove("visible")}),ow.forEach(e=>{e.classList.remove("visible")}))})},V4=async()=>{await h4(),bl.forEach(n=>{n.classList.add("hidden")}),window.location.pathname="/project-fitness-07/"};hm.addEventListener("click",Ah);We.addEventListener("submit",k4);fa.addEventListener("click",x4);bl.forEach(n=>{n.addEventListener("click",V4)});document.addEventListener("keydown",n=>{n.key==="Escape"&&xc()});D4.addEventListener("click",n=>{n.target===dm&&xc()});N4();We.elements.name.addEventListener("focus",O4);function O4(){Hs.name.classList.add("hidden")}We.elements.email.addEventListener("focus",L4);function L4(){Hs.email.classList.add("hidden")}We.elements.password.addEventListener("focus",M4);function M4(){Hs.password.classList.add("hidden")}We.elements.name.addEventListener("input",fm);We.elements.email.addEventListener("input",fm);We.elements.password.addEventListener("input",fm);function fm(){We.elements.name.value&&We.elements.email.value&&We.elements.password.value?We.elements.regSubmitBtn.disabled=!1:We.elements.regSubmitBtn.disabled=!0}const cw=document.querySelector(".js-cards");async function F4({target:n}){if(n.classList.contains("favorite-cards__icon-trash")){U4(n);return}const e=n.closest("li").dataset.id;if(!e)return;const t=new sc;try{t.id=e;const r=await t.fetchExerciseById();if(!r)throw new Error("Exercise not found!");gm(r)}catch(r){console.error(r)}}async function U4(n){const e=n.closest("li"),t=e.dataset.id;e.closest("li").remove(),Vi.remove(t),localStorage.setItem("isDataOld",JSON.stringify(!0))}function B4({_id:n}){document.querySelector('.favorite-cards__gallery-link[data-id="'+n+'"]').closest("li").remove(),localStorage.setItem("isDataOld",JSON.stringify(!0))}cw?cw.addEventListener("click",F4):console.error("Element with class 'js-cards' not found for workout.");const uw=document.querySelector(".backdrop"),rs=document.querySelector(".modalExercise"),Z0=rs.querySelector(".x-button"),lw=rs.querySelector(".modalExercise__img-wrapper"),ia=rs.querySelector(".exercise-content"),Ps=rs.querySelector(".button-box"),q4="/project-fitness-07/",$4=5;let W4,rc={};const G4=n=>{const{gifUrl:e,name:t,rating:r,_id:i,isFavorite:s,description:a}=n,l=K4(n);rc=n,rs.setAttribute("data-id",i),lw.innerHTML="",lw.insertAdjacentHTML("afterbegin",Q4(e,t)),ia.innerHTML="",ia.insertAdjacentHTML("beforeend",H4(t)),ia.insertAdjacentHTML("beforeend",j4(r)),ia.insertAdjacentHTML("beforeend",Y4(l)),ia.insertAdjacentHTML("beforeend",J4(a)),tR(s),hp.modalConfig.afterClose=z4,document.querySelector(".js-give-rating").addEventListener("click",eR)},eR=n=>{ji(),hp.modalConfig.exercise=rc,hp.openRatingModal()},z4=()=>{document.querySelector(".js-give-rating").removeEventListener("click",eR),gm(rc)},K4=n=>({bodyPart:n.bodyPart,equipment:n.equipment,rating:n.rating,burnedCalories:n.burnedCalories,time:n.time,popular:n.popularity}),tR=(n=!1)=>{Ps.innerHTML="",n?Ps.insertAdjacentHTML("beforeend",Z4()):Ps.insertAdjacentHTML("beforeend",X4()),Ps.insertAdjacentHTML("beforeend",e$());const e=Ps.querySelector(".js-toggle-favorite");Ps.querySelector(".js-give-rating"),e.addEventListener("click",nR)},H4=n=>`
    <h3 class="title">${E4(n)}</h3>
  `,j4=n=>{const e=[],t=Math.round(n*10)/10;e.push(`<li class="rating__item value">${t}</li>`);const r=Math.round(n/$4*100);return e.push(`<li ${A4(r)}</li>`),`<ul class="rating">${e.join("")}</ul>`},Q4=(n,e)=>`
    <img src="${n}" alt="${e}"/>
  `,Y4=({burnedCalories:n,time:e,...t})=>{const r=[];for(const[i,s]of Object.entries(t)){const a=T4(i),l=nw(a),h=nw(s);r.push(`
      <li class="exercise_details-item">
        <p class="detail-name">${l}</p>
        <p class="detail-value">${h}</p>
      </li>
    `)}return r.push(`
      <li class="exercise_details-item">
        <p class="detail-name">Burned Calories</p>
        <p class="detail-value">${n}/${e} min</p>
      </li>
  `),`<ul class="exercise_details">${r.join("")}</ul>`},J4=n=>`
    <p class="exercise_description">${n}</p>
  `,X4=()=>pm({text:"Add to favorites",iconId:"icon-heart",className:"js-toggle-favorite"}),Z4=()=>pm({text:"Remove from favorites",iconId:"icon-trash",className:"js-toggle-favorite"}),e$=()=>pm({text:"Give a rating",className:"js-give-rating ghost"}),pm=({text:n,iconId:e,className:t=""})=>{let r;return e&&(r=`
      <svg class="btn-icon">
        <use href=${q4}images/icons-sprite.svg#${e} />
      </svg>
    `),`
    <button id="js-toggle-favorite" type="button" class="button ${t}">
      <span>${n}</span>
      ${e?r:""}
    </button>
  `},ji=()=>{J0(rs),Z0.removeEventListener("click",ji),document.body.style.overflow="visible";const n="js-toggle-favorite";try{document.getElementById(n).removeEventListener("click",W4)}catch{console.error(`${n} not found!`)}},gm=async n=>{const{_id:e}=n;n.isFavorite=await Vi.idIsFavorite(e),G4(n),Y0(rs),Z0.addEventListener("click",ji),document.body.style.overflow="hidden"},nR=async n=>{if(!Hi.auth().currentUser){ji(),Ah();return}const{target:t}=n;try{window.location.pathname.includes("favorites")&&(ji(),B4(rc));const r=await w4(rc);t.removeEventListener("click",nR),tR(r)}catch(r){console.error(r)}};document.addEventListener("keydown",n=>{n.key==="Escape"&&ji()});uw.addEventListener("click",n=>{n.target===uw&&ji()});const Bu=document.querySelector(".exercise-cards__wrapper");function t$(n,e){e>=375&&e<768&&n===2?Bu.style.height="1268px":e>1440&&n===1?Bu.style.height="487px":e>768&&n===2?Bu.style.height="833px":Bu.style.height=""}var sa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ic={},n$={get exports(){return ic},set exports(n){ic=n}};(function(n,e){(function(){var t,r="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",l="Invalid `variable` option passed into `_.template`",h="__lodash_hash_undefined__",f=500,p="__lodash_placeholder__",m=1,I=2,A=4,L=1,M=2,V=1,Y=2,ae=4,j=8,ye=16,de=32,me=64,we=128,Ot=256,jn=512,is=30,oR="...",aR=800,cR=16,_m=1,uR=2,lR=3,ai=1/0,vr=9007199254740991,hR=17976931348623157e292,Nc=0/0,An=4294967295,dR=An-1,fR=An>>>1,pR=[["ary",we],["bind",V],["bindKey",Y],["curry",j],["curryRight",ye],["flip",jn],["partial",de],["partialRight",me],["rearg",Ot]],ss="[object Arguments]",Vc="[object Array]",gR="[object AsyncFunction]",Ro="[object Boolean]",So="[object Date]",mR="[object DOMException]",Oc="[object Error]",Lc="[object Function]",ym="[object GeneratorFunction]",fn="[object Map]",bo="[object Number]",_R="[object Null]",Qn="[object Object]",vm="[object Promise]",yR="[object Proxy]",Po="[object RegExp]",pn="[object Set]",Co="[object String]",Mc="[object Symbol]",vR="[object Undefined]",Do="[object WeakMap]",IR="[object WeakSet]",ko="[object ArrayBuffer]",os="[object DataView]",Rh="[object Float32Array]",Sh="[object Float64Array]",bh="[object Int8Array]",Ph="[object Int16Array]",Ch="[object Int32Array]",Dh="[object Uint8Array]",kh="[object Uint8ClampedArray]",xh="[object Uint16Array]",Nh="[object Uint32Array]",wR=/\b__p \+= '';/g,ER=/\b(__p \+=) '' \+/g,TR=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Im=/&(?:amp|lt|gt|quot|#39);/g,wm=/[&<>"']/g,AR=RegExp(Im.source),RR=RegExp(wm.source),SR=/<%-([\s\S]+?)%>/g,bR=/<%([\s\S]+?)%>/g,Em=/<%=([\s\S]+?)%>/g,PR=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,CR=/^\w*$/,DR=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Vh=/[\\^$.*+?()[\]{}|]/g,kR=RegExp(Vh.source),Oh=/^\s+/,xR=/\s/,NR=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,VR=/\{\n\/\* \[wrapped with (.+)\] \*/,OR=/,? & /,LR=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,MR=/[()=,{}\[\]\/\s]/,FR=/\\(\\)?/g,UR=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Tm=/\w*$/,BR=/^[-+]0x[0-9a-f]+$/i,qR=/^0b[01]+$/i,$R=/^\[object .+?Constructor\]$/,WR=/^0o[0-7]+$/i,GR=/^(?:0|[1-9]\d*)$/,zR=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Fc=/($^)/,KR=/['\n\r\u2028\u2029\\]/g,Uc="\\ud800-\\udfff",HR="\\u0300-\\u036f",jR="\\ufe20-\\ufe2f",QR="\\u20d0-\\u20ff",Am=HR+jR+QR,Rm="\\u2700-\\u27bf",Sm="a-z\\xdf-\\xf6\\xf8-\\xff",YR="\\xac\\xb1\\xd7\\xf7",JR="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",XR="\\u2000-\\u206f",ZR=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",bm="A-Z\\xc0-\\xd6\\xd8-\\xde",Pm="\\ufe0e\\ufe0f",Cm=YR+JR+XR+ZR,Lh="[']",eS="["+Uc+"]",Dm="["+Cm+"]",Bc="["+Am+"]",km="\\d+",tS="["+Rm+"]",xm="["+Sm+"]",Nm="[^"+Uc+Cm+km+Rm+Sm+bm+"]",Mh="\\ud83c[\\udffb-\\udfff]",nS="(?:"+Bc+"|"+Mh+")",Vm="[^"+Uc+"]",Fh="(?:\\ud83c[\\udde6-\\uddff]){2}",Uh="[\\ud800-\\udbff][\\udc00-\\udfff]",as="["+bm+"]",Om="\\u200d",Lm="(?:"+xm+"|"+Nm+")",rS="(?:"+as+"|"+Nm+")",Mm="(?:"+Lh+"(?:d|ll|m|re|s|t|ve))?",Fm="(?:"+Lh+"(?:D|LL|M|RE|S|T|VE))?",Um=nS+"?",Bm="["+Pm+"]?",iS="(?:"+Om+"(?:"+[Vm,Fh,Uh].join("|")+")"+Bm+Um+")*",sS="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",oS="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",qm=Bm+Um+iS,aS="(?:"+[tS,Fh,Uh].join("|")+")"+qm,cS="(?:"+[Vm+Bc+"?",Bc,Fh,Uh,eS].join("|")+")",uS=RegExp(Lh,"g"),lS=RegExp(Bc,"g"),Bh=RegExp(Mh+"(?="+Mh+")|"+cS+qm,"g"),hS=RegExp([as+"?"+xm+"+"+Mm+"(?="+[Dm,as,"$"].join("|")+")",rS+"+"+Fm+"(?="+[Dm,as+Lm,"$"].join("|")+")",as+"?"+Lm+"+"+Mm,as+"+"+Fm,oS,sS,km,aS].join("|"),"g"),dS=RegExp("["+Om+Uc+Am+Pm+"]"),fS=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,pS=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],gS=-1,Ce={};Ce[Rh]=Ce[Sh]=Ce[bh]=Ce[Ph]=Ce[Ch]=Ce[Dh]=Ce[kh]=Ce[xh]=Ce[Nh]=!0,Ce[ss]=Ce[Vc]=Ce[ko]=Ce[Ro]=Ce[os]=Ce[So]=Ce[Oc]=Ce[Lc]=Ce[fn]=Ce[bo]=Ce[Qn]=Ce[Po]=Ce[pn]=Ce[Co]=Ce[Do]=!1;var be={};be[ss]=be[Vc]=be[ko]=be[os]=be[Ro]=be[So]=be[Rh]=be[Sh]=be[bh]=be[Ph]=be[Ch]=be[fn]=be[bo]=be[Qn]=be[Po]=be[pn]=be[Co]=be[Mc]=be[Dh]=be[kh]=be[xh]=be[Nh]=!0,be[Oc]=be[Lc]=be[Do]=!1;var mS={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},_S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},yS={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},vS={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},IS=parseFloat,wS=parseInt,$m=typeof sa=="object"&&sa&&sa.Object===Object&&sa,ES=typeof self=="object"&&self&&self.Object===Object&&self,dt=$m||ES||Function("return this")(),qh=e&&!e.nodeType&&e,ci=qh&&!0&&n&&!n.nodeType&&n,Wm=ci&&ci.exports===qh,$h=Wm&&$m.process,tn=function(){try{var E=ci&&ci.require&&ci.require("util").types;return E||$h&&$h.binding&&$h.binding("util")}catch{}}(),Gm=tn&&tn.isArrayBuffer,zm=tn&&tn.isDate,Km=tn&&tn.isMap,Hm=tn&&tn.isRegExp,jm=tn&&tn.isSet,Qm=tn&&tn.isTypedArray;function zt(E,P,S){switch(S.length){case 0:return E.call(P);case 1:return E.call(P,S[0]);case 2:return E.call(P,S[0],S[1]);case 3:return E.call(P,S[0],S[1],S[2])}return E.apply(P,S)}function TS(E,P,S,W){for(var ee=-1,ve=E==null?0:E.length;++ee<ve;){var tt=E[ee];P(W,tt,S(tt),E)}return W}function nn(E,P){for(var S=-1,W=E==null?0:E.length;++S<W&&P(E[S],S,E)!==!1;);return E}function AS(E,P){for(var S=E==null?0:E.length;S--&&P(E[S],S,E)!==!1;);return E}function Ym(E,P){for(var S=-1,W=E==null?0:E.length;++S<W;)if(!P(E[S],S,E))return!1;return!0}function Ir(E,P){for(var S=-1,W=E==null?0:E.length,ee=0,ve=[];++S<W;){var tt=E[S];P(tt,S,E)&&(ve[ee++]=tt)}return ve}function qc(E,P){var S=E==null?0:E.length;return!!S&&cs(E,P,0)>-1}function Wh(E,P,S){for(var W=-1,ee=E==null?0:E.length;++W<ee;)if(S(P,E[W]))return!0;return!1}function Ne(E,P){for(var S=-1,W=E==null?0:E.length,ee=Array(W);++S<W;)ee[S]=P(E[S],S,E);return ee}function wr(E,P){for(var S=-1,W=P.length,ee=E.length;++S<W;)E[ee+S]=P[S];return E}function Gh(E,P,S,W){var ee=-1,ve=E==null?0:E.length;for(W&&ve&&(S=E[++ee]);++ee<ve;)S=P(S,E[ee],ee,E);return S}function RS(E,P,S,W){var ee=E==null?0:E.length;for(W&&ee&&(S=E[--ee]);ee--;)S=P(S,E[ee],ee,E);return S}function zh(E,P){for(var S=-1,W=E==null?0:E.length;++S<W;)if(P(E[S],S,E))return!0;return!1}var SS=Kh("length");function bS(E){return E.split("")}function PS(E){return E.match(LR)||[]}function Jm(E,P,S){var W;return S(E,function(ee,ve,tt){if(P(ee,ve,tt))return W=ve,!1}),W}function $c(E,P,S,W){for(var ee=E.length,ve=S+(W?1:-1);W?ve--:++ve<ee;)if(P(E[ve],ve,E))return ve;return-1}function cs(E,P,S){return P===P?BS(E,P,S):$c(E,Xm,S)}function CS(E,P,S,W){for(var ee=S-1,ve=E.length;++ee<ve;)if(W(E[ee],P))return ee;return-1}function Xm(E){return E!==E}function Zm(E,P){var S=E==null?0:E.length;return S?jh(E,P)/S:Nc}function Kh(E){return function(P){return P==null?t:P[E]}}function Hh(E){return function(P){return E==null?t:E[P]}}function e_(E,P,S,W,ee){return ee(E,function(ve,tt,Se){S=W?(W=!1,ve):P(S,ve,tt,Se)}),S}function DS(E,P){var S=E.length;for(E.sort(P);S--;)E[S]=E[S].value;return E}function jh(E,P){for(var S,W=-1,ee=E.length;++W<ee;){var ve=P(E[W]);ve!==t&&(S=S===t?ve:S+ve)}return S}function Qh(E,P){for(var S=-1,W=Array(E);++S<E;)W[S]=P(S);return W}function kS(E,P){return Ne(P,function(S){return[S,E[S]]})}function t_(E){return E&&E.slice(0,s_(E)+1).replace(Oh,"")}function Kt(E){return function(P){return E(P)}}function Yh(E,P){return Ne(P,function(S){return E[S]})}function xo(E,P){return E.has(P)}function n_(E,P){for(var S=-1,W=E.length;++S<W&&cs(P,E[S],0)>-1;);return S}function r_(E,P){for(var S=E.length;S--&&cs(P,E[S],0)>-1;);return S}function xS(E,P){for(var S=E.length,W=0;S--;)E[S]===P&&++W;return W}var NS=Hh(mS),VS=Hh(_S);function OS(E){return"\\"+vS[E]}function LS(E,P){return E==null?t:E[P]}function us(E){return dS.test(E)}function MS(E){return fS.test(E)}function FS(E){for(var P,S=[];!(P=E.next()).done;)S.push(P.value);return S}function Jh(E){var P=-1,S=Array(E.size);return E.forEach(function(W,ee){S[++P]=[ee,W]}),S}function i_(E,P){return function(S){return E(P(S))}}function Er(E,P){for(var S=-1,W=E.length,ee=0,ve=[];++S<W;){var tt=E[S];(tt===P||tt===p)&&(E[S]=p,ve[ee++]=S)}return ve}function Wc(E){var P=-1,S=Array(E.size);return E.forEach(function(W){S[++P]=W}),S}function US(E){var P=-1,S=Array(E.size);return E.forEach(function(W){S[++P]=[W,W]}),S}function BS(E,P,S){for(var W=S-1,ee=E.length;++W<ee;)if(E[W]===P)return W;return-1}function qS(E,P,S){for(var W=S+1;W--;)if(E[W]===P)return W;return W}function ls(E){return us(E)?WS(E):SS(E)}function gn(E){return us(E)?GS(E):bS(E)}function s_(E){for(var P=E.length;P--&&xR.test(E.charAt(P)););return P}var $S=Hh(yS);function WS(E){for(var P=Bh.lastIndex=0;Bh.test(E);)++P;return P}function GS(E){return E.match(Bh)||[]}function zS(E){return E.match(hS)||[]}var KS=function E(P){P=P==null?dt:hs.defaults(dt.Object(),P,hs.pick(dt,pS));var S=P.Array,W=P.Date,ee=P.Error,ve=P.Function,tt=P.Math,Se=P.Object,Xh=P.RegExp,HS=P.String,rn=P.TypeError,Gc=S.prototype,jS=ve.prototype,ds=Se.prototype,zc=P["__core-js_shared__"],Kc=jS.toString,Ee=ds.hasOwnProperty,QS=0,o_=function(){var o=/[^.]+$/.exec(zc&&zc.keys&&zc.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Hc=ds.toString,YS=Kc.call(Se),JS=dt._,XS=Xh("^"+Kc.call(Ee).replace(Vh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),jc=Wm?P.Buffer:t,Tr=P.Symbol,Qc=P.Uint8Array,a_=jc?jc.allocUnsafe:t,Yc=i_(Se.getPrototypeOf,Se),c_=Se.create,u_=ds.propertyIsEnumerable,Jc=Gc.splice,l_=Tr?Tr.isConcatSpreadable:t,No=Tr?Tr.iterator:t,ui=Tr?Tr.toStringTag:t,Xc=function(){try{var o=pi(Se,"defineProperty");return o({},"",{}),o}catch{}}(),ZS=P.clearTimeout!==dt.clearTimeout&&P.clearTimeout,eb=W&&W.now!==dt.Date.now&&W.now,tb=P.setTimeout!==dt.setTimeout&&P.setTimeout,Zc=tt.ceil,eu=tt.floor,Zh=Se.getOwnPropertySymbols,nb=jc?jc.isBuffer:t,h_=P.isFinite,rb=Gc.join,ib=i_(Se.keys,Se),nt=tt.max,It=tt.min,sb=W.now,ob=P.parseInt,d_=tt.random,ab=Gc.reverse,ed=pi(P,"DataView"),Vo=pi(P,"Map"),td=pi(P,"Promise"),fs=pi(P,"Set"),Oo=pi(P,"WeakMap"),Lo=pi(Se,"create"),tu=Oo&&new Oo,ps={},cb=gi(ed),ub=gi(Vo),lb=gi(td),hb=gi(fs),db=gi(Oo),nu=Tr?Tr.prototype:t,Mo=nu?nu.valueOf:t,f_=nu?nu.toString:t;function _(o){if(Be(o)&&!te(o)&&!(o instanceof le)){if(o instanceof sn)return o;if(Ee.call(o,"__wrapped__"))return py(o)}return new sn(o)}var gs=function(){function o(){}return function(c){if(!Fe(c))return{};if(c_)return c_(c);o.prototype=c;var u=new o;return o.prototype=t,u}}();function ru(){}function sn(o,c){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!c,this.__index__=0,this.__values__=t}_.templateSettings={escape:SR,evaluate:bR,interpolate:Em,variable:"",imports:{_}},_.prototype=ru.prototype,_.prototype.constructor=_,sn.prototype=gs(ru.prototype),sn.prototype.constructor=sn;function le(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=An,this.__views__=[]}function fb(){var o=new le(this.__wrapped__);return o.__actions__=Lt(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=Lt(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=Lt(this.__views__),o}function pb(){if(this.__filtered__){var o=new le(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function gb(){var o=this.__wrapped__.value(),c=this.__dir__,u=te(o),d=c<0,g=u?o.length:0,y=bP(0,g,this.__views__),v=y.start,w=y.end,T=w-v,C=d?w:v-1,D=this.__iteratees__,x=D.length,U=0,G=It(T,this.__takeCount__);if(!u||!d&&g==T&&G==T)return M_(o,this.__actions__);var J=[];e:for(;T--&&U<G;){C+=c;for(var se=-1,X=o[C];++se<x;){var ce=D[se],fe=ce.iteratee,Qt=ce.type,Pt=fe(X);if(Qt==uR)X=Pt;else if(!Pt){if(Qt==_m)continue e;break e}}J[U++]=X}return J}le.prototype=gs(ru.prototype),le.prototype.constructor=le;function li(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var d=o[c];this.set(d[0],d[1])}}function mb(){this.__data__=Lo?Lo(null):{},this.size=0}function _b(o){var c=this.has(o)&&delete this.__data__[o];return this.size-=c?1:0,c}function yb(o){var c=this.__data__;if(Lo){var u=c[o];return u===h?t:u}return Ee.call(c,o)?c[o]:t}function vb(o){var c=this.__data__;return Lo?c[o]!==t:Ee.call(c,o)}function Ib(o,c){var u=this.__data__;return this.size+=this.has(o)?0:1,u[o]=Lo&&c===t?h:c,this}li.prototype.clear=mb,li.prototype.delete=_b,li.prototype.get=yb,li.prototype.has=vb,li.prototype.set=Ib;function Yn(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var d=o[c];this.set(d[0],d[1])}}function wb(){this.__data__=[],this.size=0}function Eb(o){var c=this.__data__,u=iu(c,o);if(u<0)return!1;var d=c.length-1;return u==d?c.pop():Jc.call(c,u,1),--this.size,!0}function Tb(o){var c=this.__data__,u=iu(c,o);return u<0?t:c[u][1]}function Ab(o){return iu(this.__data__,o)>-1}function Rb(o,c){var u=this.__data__,d=iu(u,o);return d<0?(++this.size,u.push([o,c])):u[d][1]=c,this}Yn.prototype.clear=wb,Yn.prototype.delete=Eb,Yn.prototype.get=Tb,Yn.prototype.has=Ab,Yn.prototype.set=Rb;function Jn(o){var c=-1,u=o==null?0:o.length;for(this.clear();++c<u;){var d=o[c];this.set(d[0],d[1])}}function Sb(){this.size=0,this.__data__={hash:new li,map:new(Vo||Yn),string:new li}}function bb(o){var c=mu(this,o).delete(o);return this.size-=c?1:0,c}function Pb(o){return mu(this,o).get(o)}function Cb(o){return mu(this,o).has(o)}function Db(o,c){var u=mu(this,o),d=u.size;return u.set(o,c),this.size+=u.size==d?0:1,this}Jn.prototype.clear=Sb,Jn.prototype.delete=bb,Jn.prototype.get=Pb,Jn.prototype.has=Cb,Jn.prototype.set=Db;function hi(o){var c=-1,u=o==null?0:o.length;for(this.__data__=new Jn;++c<u;)this.add(o[c])}function kb(o){return this.__data__.set(o,h),this}function xb(o){return this.__data__.has(o)}hi.prototype.add=hi.prototype.push=kb,hi.prototype.has=xb;function mn(o){var c=this.__data__=new Yn(o);this.size=c.size}function Nb(){this.__data__=new Yn,this.size=0}function Vb(o){var c=this.__data__,u=c.delete(o);return this.size=c.size,u}function Ob(o){return this.__data__.get(o)}function Lb(o){return this.__data__.has(o)}function Mb(o,c){var u=this.__data__;if(u instanceof Yn){var d=u.__data__;if(!Vo||d.length<i-1)return d.push([o,c]),this.size=++u.size,this;u=this.__data__=new Jn(d)}return u.set(o,c),this.size=u.size,this}mn.prototype.clear=Nb,mn.prototype.delete=Vb,mn.prototype.get=Ob,mn.prototype.has=Lb,mn.prototype.set=Mb;function p_(o,c){var u=te(o),d=!u&&mi(o),g=!u&&!d&&Pr(o),y=!u&&!d&&!g&&vs(o),v=u||d||g||y,w=v?Qh(o.length,HS):[],T=w.length;for(var C in o)(c||Ee.call(o,C))&&!(v&&(C=="length"||g&&(C=="offset"||C=="parent")||y&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||tr(C,T)))&&w.push(C);return w}function g_(o){var c=o.length;return c?o[dd(0,c-1)]:t}function Fb(o,c){return _u(Lt(o),di(c,0,o.length))}function Ub(o){return _u(Lt(o))}function nd(o,c,u){(u!==t&&!_n(o[c],u)||u===t&&!(c in o))&&Xn(o,c,u)}function Fo(o,c,u){var d=o[c];(!(Ee.call(o,c)&&_n(d,u))||u===t&&!(c in o))&&Xn(o,c,u)}function iu(o,c){for(var u=o.length;u--;)if(_n(o[u][0],c))return u;return-1}function Bb(o,c,u,d){return Ar(o,function(g,y,v){c(d,g,u(g),v)}),d}function m_(o,c){return o&&Sn(c,it(c),o)}function qb(o,c){return o&&Sn(c,Ft(c),o)}function Xn(o,c,u){c=="__proto__"&&Xc?Xc(o,c,{configurable:!0,enumerable:!0,value:u,writable:!0}):o[c]=u}function rd(o,c){for(var u=-1,d=c.length,g=S(d),y=o==null;++u<d;)g[u]=y?t:Md(o,c[u]);return g}function di(o,c,u){return o===o&&(u!==t&&(o=o<=u?o:u),c!==t&&(o=o>=c?o:c)),o}function on(o,c,u,d,g,y){var v,w=c&m,T=c&I,C=c&A;if(u&&(v=g?u(o,d,g,y):u(o)),v!==t)return v;if(!Fe(o))return o;var D=te(o);if(D){if(v=CP(o),!w)return Lt(o,v)}else{var x=wt(o),U=x==Lc||x==ym;if(Pr(o))return B_(o,w);if(x==Qn||x==ss||U&&!g){if(v=T||U?{}:sy(o),!w)return T?yP(o,qb(v,o)):_P(o,m_(v,o))}else{if(!be[x])return g?o:{};v=DP(o,x,w)}}y||(y=new mn);var G=y.get(o);if(G)return G;y.set(o,v),Vy(o)?o.forEach(function(X){v.add(on(X,c,u,X,o,y))}):xy(o)&&o.forEach(function(X,ce){v.set(ce,on(X,c,u,ce,o,y))});var J=C?T?Td:Ed:T?Ft:it,se=D?t:J(o);return nn(se||o,function(X,ce){se&&(ce=X,X=o[ce]),Fo(v,ce,on(X,c,u,ce,o,y))}),v}function $b(o){var c=it(o);return function(u){return __(u,o,c)}}function __(o,c,u){var d=u.length;if(o==null)return!d;for(o=Se(o);d--;){var g=u[d],y=c[g],v=o[g];if(v===t&&!(g in o)||!y(v))return!1}return!0}function y_(o,c,u){if(typeof o!="function")throw new rn(a);return zo(function(){o.apply(t,u)},c)}function Uo(o,c,u,d){var g=-1,y=qc,v=!0,w=o.length,T=[],C=c.length;if(!w)return T;u&&(c=Ne(c,Kt(u))),d?(y=Wh,v=!1):c.length>=i&&(y=xo,v=!1,c=new hi(c));e:for(;++g<w;){var D=o[g],x=u==null?D:u(D);if(D=d||D!==0?D:0,v&&x===x){for(var U=C;U--;)if(c[U]===x)continue e;T.push(D)}else y(c,x,d)||T.push(D)}return T}var Ar=z_(Rn),v_=z_(sd,!0);function Wb(o,c){var u=!0;return Ar(o,function(d,g,y){return u=!!c(d,g,y),u}),u}function su(o,c,u){for(var d=-1,g=o.length;++d<g;){var y=o[d],v=c(y);if(v!=null&&(w===t?v===v&&!jt(v):u(v,w)))var w=v,T=y}return T}function Gb(o,c,u,d){var g=o.length;for(u=ie(u),u<0&&(u=-u>g?0:g+u),d=d===t||d>g?g:ie(d),d<0&&(d+=g),d=u>d?0:Ly(d);u<d;)o[u++]=c;return o}function I_(o,c){var u=[];return Ar(o,function(d,g,y){c(d,g,y)&&u.push(d)}),u}function ft(o,c,u,d,g){var y=-1,v=o.length;for(u||(u=xP),g||(g=[]);++y<v;){var w=o[y];c>0&&u(w)?c>1?ft(w,c-1,u,d,g):wr(g,w):d||(g[g.length]=w)}return g}var id=K_(),w_=K_(!0);function Rn(o,c){return o&&id(o,c,it)}function sd(o,c){return o&&w_(o,c,it)}function ou(o,c){return Ir(c,function(u){return nr(o[u])})}function fi(o,c){c=Sr(c,o);for(var u=0,d=c.length;o!=null&&u<d;)o=o[bn(c[u++])];return u&&u==d?o:t}function E_(o,c,u){var d=c(o);return te(o)?d:wr(d,u(o))}function St(o){return o==null?o===t?vR:_R:ui&&ui in Se(o)?SP(o):UP(o)}function od(o,c){return o>c}function zb(o,c){return o!=null&&Ee.call(o,c)}function Kb(o,c){return o!=null&&c in Se(o)}function Hb(o,c,u){return o>=It(c,u)&&o<nt(c,u)}function ad(o,c,u){for(var d=u?Wh:qc,g=o[0].length,y=o.length,v=y,w=S(y),T=1/0,C=[];v--;){var D=o[v];v&&c&&(D=Ne(D,Kt(c))),T=It(D.length,T),w[v]=!u&&(c||g>=120&&D.length>=120)?new hi(v&&D):t}D=o[0];var x=-1,U=w[0];e:for(;++x<g&&C.length<T;){var G=D[x],J=c?c(G):G;if(G=u||G!==0?G:0,!(U?xo(U,J):d(C,J,u))){for(v=y;--v;){var se=w[v];if(!(se?xo(se,J):d(o[v],J,u)))continue e}U&&U.push(J),C.push(G)}}return C}function jb(o,c,u,d){return Rn(o,function(g,y,v){c(d,u(g),y,v)}),d}function Bo(o,c,u){c=Sr(c,o),o=uy(o,c);var d=o==null?o:o[bn(cn(c))];return d==null?t:zt(d,o,u)}function T_(o){return Be(o)&&St(o)==ss}function Qb(o){return Be(o)&&St(o)==ko}function Yb(o){return Be(o)&&St(o)==So}function qo(o,c,u,d,g){return o===c?!0:o==null||c==null||!Be(o)&&!Be(c)?o!==o&&c!==c:Jb(o,c,u,d,qo,g)}function Jb(o,c,u,d,g,y){var v=te(o),w=te(c),T=v?Vc:wt(o),C=w?Vc:wt(c);T=T==ss?Qn:T,C=C==ss?Qn:C;var D=T==Qn,x=C==Qn,U=T==C;if(U&&Pr(o)){if(!Pr(c))return!1;v=!0,D=!1}if(U&&!D)return y||(y=new mn),v||vs(o)?ny(o,c,u,d,g,y):AP(o,c,T,u,d,g,y);if(!(u&L)){var G=D&&Ee.call(o,"__wrapped__"),J=x&&Ee.call(c,"__wrapped__");if(G||J){var se=G?o.value():o,X=J?c.value():c;return y||(y=new mn),g(se,X,u,d,y)}}return U?(y||(y=new mn),RP(o,c,u,d,g,y)):!1}function Xb(o){return Be(o)&&wt(o)==fn}function cd(o,c,u,d){var g=u.length,y=g,v=!d;if(o==null)return!y;for(o=Se(o);g--;){var w=u[g];if(v&&w[2]?w[1]!==o[w[0]]:!(w[0]in o))return!1}for(;++g<y;){w=u[g];var T=w[0],C=o[T],D=w[1];if(v&&w[2]){if(C===t&&!(T in o))return!1}else{var x=new mn;if(d)var U=d(C,D,T,o,c,x);if(!(U===t?qo(D,C,L|M,d,x):U))return!1}}return!0}function A_(o){if(!Fe(o)||VP(o))return!1;var c=nr(o)?XS:$R;return c.test(gi(o))}function Zb(o){return Be(o)&&St(o)==Po}function eP(o){return Be(o)&&wt(o)==pn}function tP(o){return Be(o)&&Tu(o.length)&&!!Ce[St(o)]}function R_(o){return typeof o=="function"?o:o==null?Ut:typeof o=="object"?te(o)?P_(o[0],o[1]):b_(o):Hy(o)}function ud(o){if(!Go(o))return ib(o);var c=[];for(var u in Se(o))Ee.call(o,u)&&u!="constructor"&&c.push(u);return c}function nP(o){if(!Fe(o))return FP(o);var c=Go(o),u=[];for(var d in o)d=="constructor"&&(c||!Ee.call(o,d))||u.push(d);return u}function ld(o,c){return o<c}function S_(o,c){var u=-1,d=Mt(o)?S(o.length):[];return Ar(o,function(g,y,v){d[++u]=c(g,y,v)}),d}function b_(o){var c=Rd(o);return c.length==1&&c[0][2]?ay(c[0][0],c[0][1]):function(u){return u===o||cd(u,o,c)}}function P_(o,c){return bd(o)&&oy(c)?ay(bn(o),c):function(u){var d=Md(u,o);return d===t&&d===c?Fd(u,o):qo(c,d,L|M)}}function au(o,c,u,d,g){o!==c&&id(c,function(y,v){if(g||(g=new mn),Fe(y))rP(o,c,v,u,au,d,g);else{var w=d?d(Cd(o,v),y,v+"",o,c,g):t;w===t&&(w=y),nd(o,v,w)}},Ft)}function rP(o,c,u,d,g,y,v){var w=Cd(o,u),T=Cd(c,u),C=v.get(T);if(C){nd(o,u,C);return}var D=y?y(w,T,u+"",o,c,v):t,x=D===t;if(x){var U=te(T),G=!U&&Pr(T),J=!U&&!G&&vs(T);D=T,U||G||J?te(w)?D=w:Qe(w)?D=Lt(w):G?(x=!1,D=B_(T,!0)):J?(x=!1,D=q_(T,!0)):D=[]:Ko(T)||mi(T)?(D=w,mi(w)?D=My(w):(!Fe(w)||nr(w))&&(D=sy(T))):x=!1}x&&(v.set(T,D),g(D,T,d,y,v),v.delete(T)),nd(o,u,D)}function C_(o,c){var u=o.length;if(u)return c+=c<0?u:0,tr(c,u)?o[c]:t}function D_(o,c,u){c.length?c=Ne(c,function(y){return te(y)?function(v){return fi(v,y.length===1?y[0]:y)}:y}):c=[Ut];var d=-1;c=Ne(c,Kt(Q()));var g=S_(o,function(y,v,w){var T=Ne(c,function(C){return C(y)});return{criteria:T,index:++d,value:y}});return DS(g,function(y,v){return mP(y,v,u)})}function iP(o,c){return k_(o,c,function(u,d){return Fd(o,d)})}function k_(o,c,u){for(var d=-1,g=c.length,y={};++d<g;){var v=c[d],w=fi(o,v);u(w,v)&&$o(y,Sr(v,o),w)}return y}function sP(o){return function(c){return fi(c,o)}}function hd(o,c,u,d){var g=d?CS:cs,y=-1,v=c.length,w=o;for(o===c&&(c=Lt(c)),u&&(w=Ne(o,Kt(u)));++y<v;)for(var T=0,C=c[y],D=u?u(C):C;(T=g(w,D,T,d))>-1;)w!==o&&Jc.call(w,T,1),Jc.call(o,T,1);return o}function x_(o,c){for(var u=o?c.length:0,d=u-1;u--;){var g=c[u];if(u==d||g!==y){var y=g;tr(g)?Jc.call(o,g,1):gd(o,g)}}return o}function dd(o,c){return o+eu(d_()*(c-o+1))}function oP(o,c,u,d){for(var g=-1,y=nt(Zc((c-o)/(u||1)),0),v=S(y);y--;)v[d?y:++g]=o,o+=u;return v}function fd(o,c){var u="";if(!o||c<1||c>vr)return u;do c%2&&(u+=o),c=eu(c/2),c&&(o+=o);while(c);return u}function oe(o,c){return Dd(cy(o,c,Ut),o+"")}function aP(o){return g_(Is(o))}function cP(o,c){var u=Is(o);return _u(u,di(c,0,u.length))}function $o(o,c,u,d){if(!Fe(o))return o;c=Sr(c,o);for(var g=-1,y=c.length,v=y-1,w=o;w!=null&&++g<y;){var T=bn(c[g]),C=u;if(T==="__proto__"||T==="constructor"||T==="prototype")return o;if(g!=v){var D=w[T];C=d?d(D,T,w):t,C===t&&(C=Fe(D)?D:tr(c[g+1])?[]:{})}Fo(w,T,C),w=w[T]}return o}var N_=tu?function(o,c){return tu.set(o,c),o}:Ut,uP=Xc?function(o,c){return Xc(o,"toString",{configurable:!0,enumerable:!1,value:Bd(c),writable:!0})}:Ut;function lP(o){return _u(Is(o))}function an(o,c,u){var d=-1,g=o.length;c<0&&(c=-c>g?0:g+c),u=u>g?g:u,u<0&&(u+=g),g=c>u?0:u-c>>>0,c>>>=0;for(var y=S(g);++d<g;)y[d]=o[d+c];return y}function hP(o,c){var u;return Ar(o,function(d,g,y){return u=c(d,g,y),!u}),!!u}function cu(o,c,u){var d=0,g=o==null?d:o.length;if(typeof c=="number"&&c===c&&g<=fR){for(;d<g;){var y=d+g>>>1,v=o[y];v!==null&&!jt(v)&&(u?v<=c:v<c)?d=y+1:g=y}return g}return pd(o,c,Ut,u)}function pd(o,c,u,d){var g=0,y=o==null?0:o.length;if(y===0)return 0;c=u(c);for(var v=c!==c,w=c===null,T=jt(c),C=c===t;g<y;){var D=eu((g+y)/2),x=u(o[D]),U=x!==t,G=x===null,J=x===x,se=jt(x);if(v)var X=d||J;else C?X=J&&(d||U):w?X=J&&U&&(d||!G):T?X=J&&U&&!G&&(d||!se):G||se?X=!1:X=d?x<=c:x<c;X?g=D+1:y=D}return It(y,dR)}function V_(o,c){for(var u=-1,d=o.length,g=0,y=[];++u<d;){var v=o[u],w=c?c(v):v;if(!u||!_n(w,T)){var T=w;y[g++]=v===0?0:v}}return y}function O_(o){return typeof o=="number"?o:jt(o)?Nc:+o}function Ht(o){if(typeof o=="string")return o;if(te(o))return Ne(o,Ht)+"";if(jt(o))return f_?f_.call(o):"";var c=o+"";return c=="0"&&1/o==-ai?"-0":c}function Rr(o,c,u){var d=-1,g=qc,y=o.length,v=!0,w=[],T=w;if(u)v=!1,g=Wh;else if(y>=i){var C=c?null:EP(o);if(C)return Wc(C);v=!1,g=xo,T=new hi}else T=c?[]:w;e:for(;++d<y;){var D=o[d],x=c?c(D):D;if(D=u||D!==0?D:0,v&&x===x){for(var U=T.length;U--;)if(T[U]===x)continue e;c&&T.push(x),w.push(D)}else g(T,x,u)||(T!==w&&T.push(x),w.push(D))}return w}function gd(o,c){return c=Sr(c,o),o=uy(o,c),o==null||delete o[bn(cn(c))]}function L_(o,c,u,d){return $o(o,c,u(fi(o,c)),d)}function uu(o,c,u,d){for(var g=o.length,y=d?g:-1;(d?y--:++y<g)&&c(o[y],y,o););return u?an(o,d?0:y,d?y+1:g):an(o,d?y+1:0,d?g:y)}function M_(o,c){var u=o;return u instanceof le&&(u=u.value()),Gh(c,function(d,g){return g.func.apply(g.thisArg,wr([d],g.args))},u)}function md(o,c,u){var d=o.length;if(d<2)return d?Rr(o[0]):[];for(var g=-1,y=S(d);++g<d;)for(var v=o[g],w=-1;++w<d;)w!=g&&(y[g]=Uo(y[g]||v,o[w],c,u));return Rr(ft(y,1),c,u)}function F_(o,c,u){for(var d=-1,g=o.length,y=c.length,v={};++d<g;){var w=d<y?c[d]:t;u(v,o[d],w)}return v}function _d(o){return Qe(o)?o:[]}function yd(o){return typeof o=="function"?o:Ut}function Sr(o,c){return te(o)?o:bd(o,c)?[o]:fy(Ie(o))}var dP=oe;function br(o,c,u){var d=o.length;return u=u===t?d:u,!c&&u>=d?o:an(o,c,u)}var U_=ZS||function(o){return dt.clearTimeout(o)};function B_(o,c){if(c)return o.slice();var u=o.length,d=a_?a_(u):new o.constructor(u);return o.copy(d),d}function vd(o){var c=new o.constructor(o.byteLength);return new Qc(c).set(new Qc(o)),c}function fP(o,c){var u=c?vd(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.byteLength)}function pP(o){var c=new o.constructor(o.source,Tm.exec(o));return c.lastIndex=o.lastIndex,c}function gP(o){return Mo?Se(Mo.call(o)):{}}function q_(o,c){var u=c?vd(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.length)}function $_(o,c){if(o!==c){var u=o!==t,d=o===null,g=o===o,y=jt(o),v=c!==t,w=c===null,T=c===c,C=jt(c);if(!w&&!C&&!y&&o>c||y&&v&&T&&!w&&!C||d&&v&&T||!u&&T||!g)return 1;if(!d&&!y&&!C&&o<c||C&&u&&g&&!d&&!y||w&&u&&g||!v&&g||!T)return-1}return 0}function mP(o,c,u){for(var d=-1,g=o.criteria,y=c.criteria,v=g.length,w=u.length;++d<v;){var T=$_(g[d],y[d]);if(T){if(d>=w)return T;var C=u[d];return T*(C=="desc"?-1:1)}}return o.index-c.index}function W_(o,c,u,d){for(var g=-1,y=o.length,v=u.length,w=-1,T=c.length,C=nt(y-v,0),D=S(T+C),x=!d;++w<T;)D[w]=c[w];for(;++g<v;)(x||g<y)&&(D[u[g]]=o[g]);for(;C--;)D[w++]=o[g++];return D}function G_(o,c,u,d){for(var g=-1,y=o.length,v=-1,w=u.length,T=-1,C=c.length,D=nt(y-w,0),x=S(D+C),U=!d;++g<D;)x[g]=o[g];for(var G=g;++T<C;)x[G+T]=c[T];for(;++v<w;)(U||g<y)&&(x[G+u[v]]=o[g++]);return x}function Lt(o,c){var u=-1,d=o.length;for(c||(c=S(d));++u<d;)c[u]=o[u];return c}function Sn(o,c,u,d){var g=!u;u||(u={});for(var y=-1,v=c.length;++y<v;){var w=c[y],T=d?d(u[w],o[w],w,u,o):t;T===t&&(T=o[w]),g?Xn(u,w,T):Fo(u,w,T)}return u}function _P(o,c){return Sn(o,Sd(o),c)}function yP(o,c){return Sn(o,ry(o),c)}function lu(o,c){return function(u,d){var g=te(u)?TS:Bb,y=c?c():{};return g(u,o,Q(d,2),y)}}function ms(o){return oe(function(c,u){var d=-1,g=u.length,y=g>1?u[g-1]:t,v=g>2?u[2]:t;for(y=o.length>3&&typeof y=="function"?(g--,y):t,v&&bt(u[0],u[1],v)&&(y=g<3?t:y,g=1),c=Se(c);++d<g;){var w=u[d];w&&o(c,w,d,y)}return c})}function z_(o,c){return function(u,d){if(u==null)return u;if(!Mt(u))return o(u,d);for(var g=u.length,y=c?g:-1,v=Se(u);(c?y--:++y<g)&&d(v[y],y,v)!==!1;);return u}}function K_(o){return function(c,u,d){for(var g=-1,y=Se(c),v=d(c),w=v.length;w--;){var T=v[o?w:++g];if(u(y[T],T,y)===!1)break}return c}}function vP(o,c,u){var d=c&V,g=Wo(o);function y(){var v=this&&this!==dt&&this instanceof y?g:o;return v.apply(d?u:this,arguments)}return y}function H_(o){return function(c){c=Ie(c);var u=us(c)?gn(c):t,d=u?u[0]:c.charAt(0),g=u?br(u,1).join(""):c.slice(1);return d[o]()+g}}function _s(o){return function(c){return Gh(zy(Gy(c).replace(uS,"")),o,"")}}function Wo(o){return function(){var c=arguments;switch(c.length){case 0:return new o;case 1:return new o(c[0]);case 2:return new o(c[0],c[1]);case 3:return new o(c[0],c[1],c[2]);case 4:return new o(c[0],c[1],c[2],c[3]);case 5:return new o(c[0],c[1],c[2],c[3],c[4]);case 6:return new o(c[0],c[1],c[2],c[3],c[4],c[5]);case 7:return new o(c[0],c[1],c[2],c[3],c[4],c[5],c[6])}var u=gs(o.prototype),d=o.apply(u,c);return Fe(d)?d:u}}function IP(o,c,u){var d=Wo(o);function g(){for(var y=arguments.length,v=S(y),w=y,T=ys(g);w--;)v[w]=arguments[w];var C=y<3&&v[0]!==T&&v[y-1]!==T?[]:Er(v,T);if(y-=C.length,y<u)return X_(o,c,hu,g.placeholder,t,v,C,t,t,u-y);var D=this&&this!==dt&&this instanceof g?d:o;return zt(D,this,v)}return g}function j_(o){return function(c,u,d){var g=Se(c);if(!Mt(c)){var y=Q(u,3);c=it(c),u=function(w){return y(g[w],w,g)}}var v=o(c,u,d);return v>-1?g[y?c[v]:v]:t}}function Q_(o){return er(function(c){var u=c.length,d=u,g=sn.prototype.thru;for(o&&c.reverse();d--;){var y=c[d];if(typeof y!="function")throw new rn(a);if(g&&!v&&gu(y)=="wrapper")var v=new sn([],!0)}for(d=v?d:u;++d<u;){y=c[d];var w=gu(y),T=w=="wrapper"?Ad(y):t;T&&Pd(T[0])&&T[1]==(we|j|de|Ot)&&!T[4].length&&T[9]==1?v=v[gu(T[0])].apply(v,T[3]):v=y.length==1&&Pd(y)?v[w]():v.thru(y)}return function(){var C=arguments,D=C[0];if(v&&C.length==1&&te(D))return v.plant(D).value();for(var x=0,U=u?c[x].apply(this,C):D;++x<u;)U=c[x].call(this,U);return U}})}function hu(o,c,u,d,g,y,v,w,T,C){var D=c&we,x=c&V,U=c&Y,G=c&(j|ye),J=c&jn,se=U?t:Wo(o);function X(){for(var ce=arguments.length,fe=S(ce),Qt=ce;Qt--;)fe[Qt]=arguments[Qt];if(G)var Pt=ys(X),Yt=xS(fe,Pt);if(d&&(fe=W_(fe,d,g,G)),y&&(fe=G_(fe,y,v,G)),ce-=Yt,G&&ce<C){var Ye=Er(fe,Pt);return X_(o,c,hu,X.placeholder,u,fe,Ye,w,T,C-ce)}var yn=x?u:this,ir=U?yn[o]:o;return ce=fe.length,w?fe=BP(fe,w):J&&ce>1&&fe.reverse(),D&&T<ce&&(fe.length=T),this&&this!==dt&&this instanceof X&&(ir=se||Wo(ir)),ir.apply(yn,fe)}return X}function Y_(o,c){return function(u,d){return jb(u,o,c(d),{})}}function du(o,c){return function(u,d){var g;if(u===t&&d===t)return c;if(u!==t&&(g=u),d!==t){if(g===t)return d;typeof u=="string"||typeof d=="string"?(u=Ht(u),d=Ht(d)):(u=O_(u),d=O_(d)),g=o(u,d)}return g}}function Id(o){return er(function(c){return c=Ne(c,Kt(Q())),oe(function(u){var d=this;return o(c,function(g){return zt(g,d,u)})})})}function fu(o,c){c=c===t?" ":Ht(c);var u=c.length;if(u<2)return u?fd(c,o):c;var d=fd(c,Zc(o/ls(c)));return us(c)?br(gn(d),0,o).join(""):d.slice(0,o)}function wP(o,c,u,d){var g=c&V,y=Wo(o);function v(){for(var w=-1,T=arguments.length,C=-1,D=d.length,x=S(D+T),U=this&&this!==dt&&this instanceof v?y:o;++C<D;)x[C]=d[C];for(;T--;)x[C++]=arguments[++w];return zt(U,g?u:this,x)}return v}function J_(o){return function(c,u,d){return d&&typeof d!="number"&&bt(c,u,d)&&(u=d=t),c=rr(c),u===t?(u=c,c=0):u=rr(u),d=d===t?c<u?1:-1:rr(d),oP(c,u,d,o)}}function pu(o){return function(c,u){return typeof c=="string"&&typeof u=="string"||(c=un(c),u=un(u)),o(c,u)}}function X_(o,c,u,d,g,y,v,w,T,C){var D=c&j,x=D?v:t,U=D?t:v,G=D?y:t,J=D?t:y;c|=D?de:me,c&=~(D?me:de),c&ae||(c&=~(V|Y));var se=[o,c,g,G,x,J,U,w,T,C],X=u.apply(t,se);return Pd(o)&&ly(X,se),X.placeholder=d,hy(X,o,c)}function wd(o){var c=tt[o];return function(u,d){if(u=un(u),d=d==null?0:It(ie(d),292),d&&h_(u)){var g=(Ie(u)+"e").split("e"),y=c(g[0]+"e"+(+g[1]+d));return g=(Ie(y)+"e").split("e"),+(g[0]+"e"+(+g[1]-d))}return c(u)}}var EP=fs&&1/Wc(new fs([,-0]))[1]==ai?function(o){return new fs(o)}:Wd;function Z_(o){return function(c){var u=wt(c);return u==fn?Jh(c):u==pn?US(c):kS(c,o(c))}}function Zn(o,c,u,d,g,y,v,w){var T=c&Y;if(!T&&typeof o!="function")throw new rn(a);var C=d?d.length:0;if(C||(c&=~(de|me),d=g=t),v=v===t?v:nt(ie(v),0),w=w===t?w:ie(w),C-=g?g.length:0,c&me){var D=d,x=g;d=g=t}var U=T?t:Ad(o),G=[o,c,u,d,g,D,x,y,v,w];if(U&&MP(G,U),o=G[0],c=G[1],u=G[2],d=G[3],g=G[4],w=G[9]=G[9]===t?T?0:o.length:nt(G[9]-C,0),!w&&c&(j|ye)&&(c&=~(j|ye)),!c||c==V)var J=vP(o,c,u);else c==j||c==ye?J=IP(o,c,w):(c==de||c==(V|de))&&!g.length?J=wP(o,c,u,d):J=hu.apply(t,G);var se=U?N_:ly;return hy(se(J,G),o,c)}function ey(o,c,u,d){return o===t||_n(o,ds[u])&&!Ee.call(d,u)?c:o}function ty(o,c,u,d,g,y){return Fe(o)&&Fe(c)&&(y.set(c,o),au(o,c,t,ty,y),y.delete(c)),o}function TP(o){return Ko(o)?t:o}function ny(o,c,u,d,g,y){var v=u&L,w=o.length,T=c.length;if(w!=T&&!(v&&T>w))return!1;var C=y.get(o),D=y.get(c);if(C&&D)return C==c&&D==o;var x=-1,U=!0,G=u&M?new hi:t;for(y.set(o,c),y.set(c,o);++x<w;){var J=o[x],se=c[x];if(d)var X=v?d(se,J,x,c,o,y):d(J,se,x,o,c,y);if(X!==t){if(X)continue;U=!1;break}if(G){if(!zh(c,function(ce,fe){if(!xo(G,fe)&&(J===ce||g(J,ce,u,d,y)))return G.push(fe)})){U=!1;break}}else if(!(J===se||g(J,se,u,d,y))){U=!1;break}}return y.delete(o),y.delete(c),U}function AP(o,c,u,d,g,y,v){switch(u){case os:if(o.byteLength!=c.byteLength||o.byteOffset!=c.byteOffset)return!1;o=o.buffer,c=c.buffer;case ko:return!(o.byteLength!=c.byteLength||!y(new Qc(o),new Qc(c)));case Ro:case So:case bo:return _n(+o,+c);case Oc:return o.name==c.name&&o.message==c.message;case Po:case Co:return o==c+"";case fn:var w=Jh;case pn:var T=d&L;if(w||(w=Wc),o.size!=c.size&&!T)return!1;var C=v.get(o);if(C)return C==c;d|=M,v.set(o,c);var D=ny(w(o),w(c),d,g,y,v);return v.delete(o),D;case Mc:if(Mo)return Mo.call(o)==Mo.call(c)}return!1}function RP(o,c,u,d,g,y){var v=u&L,w=Ed(o),T=w.length,C=Ed(c),D=C.length;if(T!=D&&!v)return!1;for(var x=T;x--;){var U=w[x];if(!(v?U in c:Ee.call(c,U)))return!1}var G=y.get(o),J=y.get(c);if(G&&J)return G==c&&J==o;var se=!0;y.set(o,c),y.set(c,o);for(var X=v;++x<T;){U=w[x];var ce=o[U],fe=c[U];if(d)var Qt=v?d(fe,ce,U,c,o,y):d(ce,fe,U,o,c,y);if(!(Qt===t?ce===fe||g(ce,fe,u,d,y):Qt)){se=!1;break}X||(X=U=="constructor")}if(se&&!X){var Pt=o.constructor,Yt=c.constructor;Pt!=Yt&&"constructor"in o&&"constructor"in c&&!(typeof Pt=="function"&&Pt instanceof Pt&&typeof Yt=="function"&&Yt instanceof Yt)&&(se=!1)}return y.delete(o),y.delete(c),se}function er(o){return Dd(cy(o,t,_y),o+"")}function Ed(o){return E_(o,it,Sd)}function Td(o){return E_(o,Ft,ry)}var Ad=tu?function(o){return tu.get(o)}:Wd;function gu(o){for(var c=o.name+"",u=ps[c],d=Ee.call(ps,c)?u.length:0;d--;){var g=u[d],y=g.func;if(y==null||y==o)return g.name}return c}function ys(o){var c=Ee.call(_,"placeholder")?_:o;return c.placeholder}function Q(){var o=_.iteratee||qd;return o=o===qd?R_:o,arguments.length?o(arguments[0],arguments[1]):o}function mu(o,c){var u=o.__data__;return NP(c)?u[typeof c=="string"?"string":"hash"]:u.map}function Rd(o){for(var c=it(o),u=c.length;u--;){var d=c[u],g=o[d];c[u]=[d,g,oy(g)]}return c}function pi(o,c){var u=LS(o,c);return A_(u)?u:t}function SP(o){var c=Ee.call(o,ui),u=o[ui];try{o[ui]=t;var d=!0}catch{}var g=Hc.call(o);return d&&(c?o[ui]=u:delete o[ui]),g}var Sd=Zh?function(o){return o==null?[]:(o=Se(o),Ir(Zh(o),function(c){return u_.call(o,c)}))}:Gd,ry=Zh?function(o){for(var c=[];o;)wr(c,Sd(o)),o=Yc(o);return c}:Gd,wt=St;(ed&&wt(new ed(new ArrayBuffer(1)))!=os||Vo&&wt(new Vo)!=fn||td&&wt(td.resolve())!=vm||fs&&wt(new fs)!=pn||Oo&&wt(new Oo)!=Do)&&(wt=function(o){var c=St(o),u=c==Qn?o.constructor:t,d=u?gi(u):"";if(d)switch(d){case cb:return os;case ub:return fn;case lb:return vm;case hb:return pn;case db:return Do}return c});function bP(o,c,u){for(var d=-1,g=u.length;++d<g;){var y=u[d],v=y.size;switch(y.type){case"drop":o+=v;break;case"dropRight":c-=v;break;case"take":c=It(c,o+v);break;case"takeRight":o=nt(o,c-v);break}}return{start:o,end:c}}function PP(o){var c=o.match(VR);return c?c[1].split(OR):[]}function iy(o,c,u){c=Sr(c,o);for(var d=-1,g=c.length,y=!1;++d<g;){var v=bn(c[d]);if(!(y=o!=null&&u(o,v)))break;o=o[v]}return y||++d!=g?y:(g=o==null?0:o.length,!!g&&Tu(g)&&tr(v,g)&&(te(o)||mi(o)))}function CP(o){var c=o.length,u=new o.constructor(c);return c&&typeof o[0]=="string"&&Ee.call(o,"index")&&(u.index=o.index,u.input=o.input),u}function sy(o){return typeof o.constructor=="function"&&!Go(o)?gs(Yc(o)):{}}function DP(o,c,u){var d=o.constructor;switch(c){case ko:return vd(o);case Ro:case So:return new d(+o);case os:return fP(o,u);case Rh:case Sh:case bh:case Ph:case Ch:case Dh:case kh:case xh:case Nh:return q_(o,u);case fn:return new d;case bo:case Co:return new d(o);case Po:return pP(o);case pn:return new d;case Mc:return gP(o)}}function kP(o,c){var u=c.length;if(!u)return o;var d=u-1;return c[d]=(u>1?"& ":"")+c[d],c=c.join(u>2?", ":" "),o.replace(NR,`{
/* [wrapped with `+c+`] */
`)}function xP(o){return te(o)||mi(o)||!!(l_&&o&&o[l_])}function tr(o,c){var u=typeof o;return c=c??vr,!!c&&(u=="number"||u!="symbol"&&GR.test(o))&&o>-1&&o%1==0&&o<c}function bt(o,c,u){if(!Fe(u))return!1;var d=typeof c;return(d=="number"?Mt(u)&&tr(c,u.length):d=="string"&&c in u)?_n(u[c],o):!1}function bd(o,c){if(te(o))return!1;var u=typeof o;return u=="number"||u=="symbol"||u=="boolean"||o==null||jt(o)?!0:CR.test(o)||!PR.test(o)||c!=null&&o in Se(c)}function NP(o){var c=typeof o;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?o!=="__proto__":o===null}function Pd(o){var c=gu(o),u=_[c];if(typeof u!="function"||!(c in le.prototype))return!1;if(o===u)return!0;var d=Ad(u);return!!d&&o===d[0]}function VP(o){return!!o_&&o_ in o}var OP=zc?nr:zd;function Go(o){var c=o&&o.constructor,u=typeof c=="function"&&c.prototype||ds;return o===u}function oy(o){return o===o&&!Fe(o)}function ay(o,c){return function(u){return u==null?!1:u[o]===c&&(c!==t||o in Se(u))}}function LP(o){var c=wu(o,function(d){return u.size===f&&u.clear(),d}),u=c.cache;return c}function MP(o,c){var u=o[1],d=c[1],g=u|d,y=g<(V|Y|we),v=d==we&&u==j||d==we&&u==Ot&&o[7].length<=c[8]||d==(we|Ot)&&c[7].length<=c[8]&&u==j;if(!(y||v))return o;d&V&&(o[2]=c[2],g|=u&V?0:ae);var w=c[3];if(w){var T=o[3];o[3]=T?W_(T,w,c[4]):w,o[4]=T?Er(o[3],p):c[4]}return w=c[5],w&&(T=o[5],o[5]=T?G_(T,w,c[6]):w,o[6]=T?Er(o[5],p):c[6]),w=c[7],w&&(o[7]=w),d&we&&(o[8]=o[8]==null?c[8]:It(o[8],c[8])),o[9]==null&&(o[9]=c[9]),o[0]=c[0],o[1]=g,o}function FP(o){var c=[];if(o!=null)for(var u in Se(o))c.push(u);return c}function UP(o){return Hc.call(o)}function cy(o,c,u){return c=nt(c===t?o.length-1:c,0),function(){for(var d=arguments,g=-1,y=nt(d.length-c,0),v=S(y);++g<y;)v[g]=d[c+g];g=-1;for(var w=S(c+1);++g<c;)w[g]=d[g];return w[c]=u(v),zt(o,this,w)}}function uy(o,c){return c.length<2?o:fi(o,an(c,0,-1))}function BP(o,c){for(var u=o.length,d=It(c.length,u),g=Lt(o);d--;){var y=c[d];o[d]=tr(y,u)?g[y]:t}return o}function Cd(o,c){if(!(c==="constructor"&&typeof o[c]=="function")&&c!="__proto__")return o[c]}var ly=dy(N_),zo=tb||function(o,c){return dt.setTimeout(o,c)},Dd=dy(uP);function hy(o,c,u){var d=c+"";return Dd(o,kP(d,qP(PP(d),u)))}function dy(o){var c=0,u=0;return function(){var d=sb(),g=cR-(d-u);if(u=d,g>0){if(++c>=aR)return arguments[0]}else c=0;return o.apply(t,arguments)}}function _u(o,c){var u=-1,d=o.length,g=d-1;for(c=c===t?d:c;++u<c;){var y=dd(u,g),v=o[y];o[y]=o[u],o[u]=v}return o.length=c,o}var fy=LP(function(o){var c=[];return o.charCodeAt(0)===46&&c.push(""),o.replace(DR,function(u,d,g,y){c.push(g?y.replace(FR,"$1"):d||u)}),c});function bn(o){if(typeof o=="string"||jt(o))return o;var c=o+"";return c=="0"&&1/o==-ai?"-0":c}function gi(o){if(o!=null){try{return Kc.call(o)}catch{}try{return o+""}catch{}}return""}function qP(o,c){return nn(pR,function(u){var d="_."+u[0];c&u[1]&&!qc(o,d)&&o.push(d)}),o.sort()}function py(o){if(o instanceof le)return o.clone();var c=new sn(o.__wrapped__,o.__chain__);return c.__actions__=Lt(o.__actions__),c.__index__=o.__index__,c.__values__=o.__values__,c}function $P(o,c,u){(u?bt(o,c,u):c===t)?c=1:c=nt(ie(c),0);var d=o==null?0:o.length;if(!d||c<1)return[];for(var g=0,y=0,v=S(Zc(d/c));g<d;)v[y++]=an(o,g,g+=c);return v}function WP(o){for(var c=-1,u=o==null?0:o.length,d=0,g=[];++c<u;){var y=o[c];y&&(g[d++]=y)}return g}function GP(){var o=arguments.length;if(!o)return[];for(var c=S(o-1),u=arguments[0],d=o;d--;)c[d-1]=arguments[d];return wr(te(u)?Lt(u):[u],ft(c,1))}var zP=oe(function(o,c){return Qe(o)?Uo(o,ft(c,1,Qe,!0)):[]}),KP=oe(function(o,c){var u=cn(c);return Qe(u)&&(u=t),Qe(o)?Uo(o,ft(c,1,Qe,!0),Q(u,2)):[]}),HP=oe(function(o,c){var u=cn(c);return Qe(u)&&(u=t),Qe(o)?Uo(o,ft(c,1,Qe,!0),t,u):[]});function jP(o,c,u){var d=o==null?0:o.length;return d?(c=u||c===t?1:ie(c),an(o,c<0?0:c,d)):[]}function QP(o,c,u){var d=o==null?0:o.length;return d?(c=u||c===t?1:ie(c),c=d-c,an(o,0,c<0?0:c)):[]}function YP(o,c){return o&&o.length?uu(o,Q(c,3),!0,!0):[]}function JP(o,c){return o&&o.length?uu(o,Q(c,3),!0):[]}function XP(o,c,u,d){var g=o==null?0:o.length;return g?(u&&typeof u!="number"&&bt(o,c,u)&&(u=0,d=g),Gb(o,c,u,d)):[]}function gy(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=u==null?0:ie(u);return g<0&&(g=nt(d+g,0)),$c(o,Q(c,3),g)}function my(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=d-1;return u!==t&&(g=ie(u),g=u<0?nt(d+g,0):It(g,d-1)),$c(o,Q(c,3),g,!0)}function _y(o){var c=o==null?0:o.length;return c?ft(o,1):[]}function ZP(o){var c=o==null?0:o.length;return c?ft(o,ai):[]}function eC(o,c){var u=o==null?0:o.length;return u?(c=c===t?1:ie(c),ft(o,c)):[]}function tC(o){for(var c=-1,u=o==null?0:o.length,d={};++c<u;){var g=o[c];d[g[0]]=g[1]}return d}function yy(o){return o&&o.length?o[0]:t}function nC(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=u==null?0:ie(u);return g<0&&(g=nt(d+g,0)),cs(o,c,g)}function rC(o){var c=o==null?0:o.length;return c?an(o,0,-1):[]}var iC=oe(function(o){var c=Ne(o,_d);return c.length&&c[0]===o[0]?ad(c):[]}),sC=oe(function(o){var c=cn(o),u=Ne(o,_d);return c===cn(u)?c=t:u.pop(),u.length&&u[0]===o[0]?ad(u,Q(c,2)):[]}),oC=oe(function(o){var c=cn(o),u=Ne(o,_d);return c=typeof c=="function"?c:t,c&&u.pop(),u.length&&u[0]===o[0]?ad(u,t,c):[]});function aC(o,c){return o==null?"":rb.call(o,c)}function cn(o){var c=o==null?0:o.length;return c?o[c-1]:t}function cC(o,c,u){var d=o==null?0:o.length;if(!d)return-1;var g=d;return u!==t&&(g=ie(u),g=g<0?nt(d+g,0):It(g,d-1)),c===c?qS(o,c,g):$c(o,Xm,g,!0)}function uC(o,c){return o&&o.length?C_(o,ie(c)):t}var lC=oe(vy);function vy(o,c){return o&&o.length&&c&&c.length?hd(o,c):o}function hC(o,c,u){return o&&o.length&&c&&c.length?hd(o,c,Q(u,2)):o}function dC(o,c,u){return o&&o.length&&c&&c.length?hd(o,c,t,u):o}var fC=er(function(o,c){var u=o==null?0:o.length,d=rd(o,c);return x_(o,Ne(c,function(g){return tr(g,u)?+g:g}).sort($_)),d});function pC(o,c){var u=[];if(!(o&&o.length))return u;var d=-1,g=[],y=o.length;for(c=Q(c,3);++d<y;){var v=o[d];c(v,d,o)&&(u.push(v),g.push(d))}return x_(o,g),u}function kd(o){return o==null?o:ab.call(o)}function gC(o,c,u){var d=o==null?0:o.length;return d?(u&&typeof u!="number"&&bt(o,c,u)?(c=0,u=d):(c=c==null?0:ie(c),u=u===t?d:ie(u)),an(o,c,u)):[]}function mC(o,c){return cu(o,c)}function _C(o,c,u){return pd(o,c,Q(u,2))}function yC(o,c){var u=o==null?0:o.length;if(u){var d=cu(o,c);if(d<u&&_n(o[d],c))return d}return-1}function vC(o,c){return cu(o,c,!0)}function IC(o,c,u){return pd(o,c,Q(u,2),!0)}function wC(o,c){var u=o==null?0:o.length;if(u){var d=cu(o,c,!0)-1;if(_n(o[d],c))return d}return-1}function EC(o){return o&&o.length?V_(o):[]}function TC(o,c){return o&&o.length?V_(o,Q(c,2)):[]}function AC(o){var c=o==null?0:o.length;return c?an(o,1,c):[]}function RC(o,c,u){return o&&o.length?(c=u||c===t?1:ie(c),an(o,0,c<0?0:c)):[]}function SC(o,c,u){var d=o==null?0:o.length;return d?(c=u||c===t?1:ie(c),c=d-c,an(o,c<0?0:c,d)):[]}function bC(o,c){return o&&o.length?uu(o,Q(c,3),!1,!0):[]}function PC(o,c){return o&&o.length?uu(o,Q(c,3)):[]}var CC=oe(function(o){return Rr(ft(o,1,Qe,!0))}),DC=oe(function(o){var c=cn(o);return Qe(c)&&(c=t),Rr(ft(o,1,Qe,!0),Q(c,2))}),kC=oe(function(o){var c=cn(o);return c=typeof c=="function"?c:t,Rr(ft(o,1,Qe,!0),t,c)});function xC(o){return o&&o.length?Rr(o):[]}function NC(o,c){return o&&o.length?Rr(o,Q(c,2)):[]}function VC(o,c){return c=typeof c=="function"?c:t,o&&o.length?Rr(o,t,c):[]}function xd(o){if(!(o&&o.length))return[];var c=0;return o=Ir(o,function(u){if(Qe(u))return c=nt(u.length,c),!0}),Qh(c,function(u){return Ne(o,Kh(u))})}function Iy(o,c){if(!(o&&o.length))return[];var u=xd(o);return c==null?u:Ne(u,function(d){return zt(c,t,d)})}var OC=oe(function(o,c){return Qe(o)?Uo(o,c):[]}),LC=oe(function(o){return md(Ir(o,Qe))}),MC=oe(function(o){var c=cn(o);return Qe(c)&&(c=t),md(Ir(o,Qe),Q(c,2))}),FC=oe(function(o){var c=cn(o);return c=typeof c=="function"?c:t,md(Ir(o,Qe),t,c)}),UC=oe(xd);function BC(o,c){return F_(o||[],c||[],Fo)}function qC(o,c){return F_(o||[],c||[],$o)}var $C=oe(function(o){var c=o.length,u=c>1?o[c-1]:t;return u=typeof u=="function"?(o.pop(),u):t,Iy(o,u)});function wy(o){var c=_(o);return c.__chain__=!0,c}function WC(o,c){return c(o),o}function yu(o,c){return c(o)}var GC=er(function(o){var c=o.length,u=c?o[0]:0,d=this.__wrapped__,g=function(y){return rd(y,o)};return c>1||this.__actions__.length||!(d instanceof le)||!tr(u)?this.thru(g):(d=d.slice(u,+u+(c?1:0)),d.__actions__.push({func:yu,args:[g],thisArg:t}),new sn(d,this.__chain__).thru(function(y){return c&&!y.length&&y.push(t),y}))});function zC(){return wy(this)}function KC(){return new sn(this.value(),this.__chain__)}function HC(){this.__values__===t&&(this.__values__=Oy(this.value()));var o=this.__index__>=this.__values__.length,c=o?t:this.__values__[this.__index__++];return{done:o,value:c}}function jC(){return this}function QC(o){for(var c,u=this;u instanceof ru;){var d=py(u);d.__index__=0,d.__values__=t,c?g.__wrapped__=d:c=d;var g=d;u=u.__wrapped__}return g.__wrapped__=o,c}function YC(){var o=this.__wrapped__;if(o instanceof le){var c=o;return this.__actions__.length&&(c=new le(this)),c=c.reverse(),c.__actions__.push({func:yu,args:[kd],thisArg:t}),new sn(c,this.__chain__)}return this.thru(kd)}function JC(){return M_(this.__wrapped__,this.__actions__)}var XC=lu(function(o,c,u){Ee.call(o,u)?++o[u]:Xn(o,u,1)});function ZC(o,c,u){var d=te(o)?Ym:Wb;return u&&bt(o,c,u)&&(c=t),d(o,Q(c,3))}function e1(o,c){var u=te(o)?Ir:I_;return u(o,Q(c,3))}var t1=j_(gy),n1=j_(my);function r1(o,c){return ft(vu(o,c),1)}function i1(o,c){return ft(vu(o,c),ai)}function s1(o,c,u){return u=u===t?1:ie(u),ft(vu(o,c),u)}function Ey(o,c){var u=te(o)?nn:Ar;return u(o,Q(c,3))}function Ty(o,c){var u=te(o)?AS:v_;return u(o,Q(c,3))}var o1=lu(function(o,c,u){Ee.call(o,u)?o[u].push(c):Xn(o,u,[c])});function a1(o,c,u,d){o=Mt(o)?o:Is(o),u=u&&!d?ie(u):0;var g=o.length;return u<0&&(u=nt(g+u,0)),Au(o)?u<=g&&o.indexOf(c,u)>-1:!!g&&cs(o,c,u)>-1}var c1=oe(function(o,c,u){var d=-1,g=typeof c=="function",y=Mt(o)?S(o.length):[];return Ar(o,function(v){y[++d]=g?zt(c,v,u):Bo(v,c,u)}),y}),u1=lu(function(o,c,u){Xn(o,u,c)});function vu(o,c){var u=te(o)?Ne:S_;return u(o,Q(c,3))}function l1(o,c,u,d){return o==null?[]:(te(c)||(c=c==null?[]:[c]),u=d?t:u,te(u)||(u=u==null?[]:[u]),D_(o,c,u))}var h1=lu(function(o,c,u){o[u?0:1].push(c)},function(){return[[],[]]});function d1(o,c,u){var d=te(o)?Gh:e_,g=arguments.length<3;return d(o,Q(c,4),u,g,Ar)}function f1(o,c,u){var d=te(o)?RS:e_,g=arguments.length<3;return d(o,Q(c,4),u,g,v_)}function p1(o,c){var u=te(o)?Ir:I_;return u(o,Eu(Q(c,3)))}function g1(o){var c=te(o)?g_:aP;return c(o)}function m1(o,c,u){(u?bt(o,c,u):c===t)?c=1:c=ie(c);var d=te(o)?Fb:cP;return d(o,c)}function _1(o){var c=te(o)?Ub:lP;return c(o)}function y1(o){if(o==null)return 0;if(Mt(o))return Au(o)?ls(o):o.length;var c=wt(o);return c==fn||c==pn?o.size:ud(o).length}function v1(o,c,u){var d=te(o)?zh:hP;return u&&bt(o,c,u)&&(c=t),d(o,Q(c,3))}var I1=oe(function(o,c){if(o==null)return[];var u=c.length;return u>1&&bt(o,c[0],c[1])?c=[]:u>2&&bt(c[0],c[1],c[2])&&(c=[c[0]]),D_(o,ft(c,1),[])}),Iu=eb||function(){return dt.Date.now()};function w1(o,c){if(typeof c!="function")throw new rn(a);return o=ie(o),function(){if(--o<1)return c.apply(this,arguments)}}function Ay(o,c,u){return c=u?t:c,c=o&&c==null?o.length:c,Zn(o,we,t,t,t,t,c)}function Ry(o,c){var u;if(typeof c!="function")throw new rn(a);return o=ie(o),function(){return--o>0&&(u=c.apply(this,arguments)),o<=1&&(c=t),u}}var Nd=oe(function(o,c,u){var d=V;if(u.length){var g=Er(u,ys(Nd));d|=de}return Zn(o,d,c,u,g)}),Sy=oe(function(o,c,u){var d=V|Y;if(u.length){var g=Er(u,ys(Sy));d|=de}return Zn(c,d,o,u,g)});function by(o,c,u){c=u?t:c;var d=Zn(o,j,t,t,t,t,t,c);return d.placeholder=by.placeholder,d}function Py(o,c,u){c=u?t:c;var d=Zn(o,ye,t,t,t,t,t,c);return d.placeholder=Py.placeholder,d}function Cy(o,c,u){var d,g,y,v,w,T,C=0,D=!1,x=!1,U=!0;if(typeof o!="function")throw new rn(a);c=un(c)||0,Fe(u)&&(D=!!u.leading,x="maxWait"in u,y=x?nt(un(u.maxWait)||0,c):y,U="trailing"in u?!!u.trailing:U);function G(Ye){var yn=d,ir=g;return d=g=t,C=Ye,v=o.apply(ir,yn),v}function J(Ye){return C=Ye,w=zo(ce,c),D?G(Ye):v}function se(Ye){var yn=Ye-T,ir=Ye-C,jy=c-yn;return x?It(jy,y-ir):jy}function X(Ye){var yn=Ye-T,ir=Ye-C;return T===t||yn>=c||yn<0||x&&ir>=y}function ce(){var Ye=Iu();if(X(Ye))return fe(Ye);w=zo(ce,se(Ye))}function fe(Ye){return w=t,U&&d?G(Ye):(d=g=t,v)}function Qt(){w!==t&&U_(w),C=0,d=T=g=w=t}function Pt(){return w===t?v:fe(Iu())}function Yt(){var Ye=Iu(),yn=X(Ye);if(d=arguments,g=this,T=Ye,yn){if(w===t)return J(T);if(x)return U_(w),w=zo(ce,c),G(T)}return w===t&&(w=zo(ce,c)),v}return Yt.cancel=Qt,Yt.flush=Pt,Yt}var E1=oe(function(o,c){return y_(o,1,c)}),T1=oe(function(o,c,u){return y_(o,un(c)||0,u)});function A1(o){return Zn(o,jn)}function wu(o,c){if(typeof o!="function"||c!=null&&typeof c!="function")throw new rn(a);var u=function(){var d=arguments,g=c?c.apply(this,d):d[0],y=u.cache;if(y.has(g))return y.get(g);var v=o.apply(this,d);return u.cache=y.set(g,v)||y,v};return u.cache=new(wu.Cache||Jn),u}wu.Cache=Jn;function Eu(o){if(typeof o!="function")throw new rn(a);return function(){var c=arguments;switch(c.length){case 0:return!o.call(this);case 1:return!o.call(this,c[0]);case 2:return!o.call(this,c[0],c[1]);case 3:return!o.call(this,c[0],c[1],c[2])}return!o.apply(this,c)}}function R1(o){return Ry(2,o)}var S1=dP(function(o,c){c=c.length==1&&te(c[0])?Ne(c[0],Kt(Q())):Ne(ft(c,1),Kt(Q()));var u=c.length;return oe(function(d){for(var g=-1,y=It(d.length,u);++g<y;)d[g]=c[g].call(this,d[g]);return zt(o,this,d)})}),Vd=oe(function(o,c){var u=Er(c,ys(Vd));return Zn(o,de,t,c,u)}),Dy=oe(function(o,c){var u=Er(c,ys(Dy));return Zn(o,me,t,c,u)}),b1=er(function(o,c){return Zn(o,Ot,t,t,t,c)});function P1(o,c){if(typeof o!="function")throw new rn(a);return c=c===t?c:ie(c),oe(o,c)}function C1(o,c){if(typeof o!="function")throw new rn(a);return c=c==null?0:nt(ie(c),0),oe(function(u){var d=u[c],g=br(u,0,c);return d&&wr(g,d),zt(o,this,g)})}function D1(o,c,u){var d=!0,g=!0;if(typeof o!="function")throw new rn(a);return Fe(u)&&(d="leading"in u?!!u.leading:d,g="trailing"in u?!!u.trailing:g),Cy(o,c,{leading:d,maxWait:c,trailing:g})}function k1(o){return Ay(o,1)}function x1(o,c){return Vd(yd(c),o)}function N1(){if(!arguments.length)return[];var o=arguments[0];return te(o)?o:[o]}function V1(o){return on(o,A)}function O1(o,c){return c=typeof c=="function"?c:t,on(o,A,c)}function L1(o){return on(o,m|A)}function M1(o,c){return c=typeof c=="function"?c:t,on(o,m|A,c)}function F1(o,c){return c==null||__(o,c,it(c))}function _n(o,c){return o===c||o!==o&&c!==c}var U1=pu(od),B1=pu(function(o,c){return o>=c}),mi=T_(function(){return arguments}())?T_:function(o){return Be(o)&&Ee.call(o,"callee")&&!u_.call(o,"callee")},te=S.isArray,q1=Gm?Kt(Gm):Qb;function Mt(o){return o!=null&&Tu(o.length)&&!nr(o)}function Qe(o){return Be(o)&&Mt(o)}function $1(o){return o===!0||o===!1||Be(o)&&St(o)==Ro}var Pr=nb||zd,W1=zm?Kt(zm):Yb;function G1(o){return Be(o)&&o.nodeType===1&&!Ko(o)}function z1(o){if(o==null)return!0;if(Mt(o)&&(te(o)||typeof o=="string"||typeof o.splice=="function"||Pr(o)||vs(o)||mi(o)))return!o.length;var c=wt(o);if(c==fn||c==pn)return!o.size;if(Go(o))return!ud(o).length;for(var u in o)if(Ee.call(o,u))return!1;return!0}function K1(o,c){return qo(o,c)}function H1(o,c,u){u=typeof u=="function"?u:t;var d=u?u(o,c):t;return d===t?qo(o,c,t,u):!!d}function Od(o){if(!Be(o))return!1;var c=St(o);return c==Oc||c==mR||typeof o.message=="string"&&typeof o.name=="string"&&!Ko(o)}function j1(o){return typeof o=="number"&&h_(o)}function nr(o){if(!Fe(o))return!1;var c=St(o);return c==Lc||c==ym||c==gR||c==yR}function ky(o){return typeof o=="number"&&o==ie(o)}function Tu(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=vr}function Fe(o){var c=typeof o;return o!=null&&(c=="object"||c=="function")}function Be(o){return o!=null&&typeof o=="object"}var xy=Km?Kt(Km):Xb;function Q1(o,c){return o===c||cd(o,c,Rd(c))}function Y1(o,c,u){return u=typeof u=="function"?u:t,cd(o,c,Rd(c),u)}function J1(o){return Ny(o)&&o!=+o}function X1(o){if(OP(o))throw new ee(s);return A_(o)}function Z1(o){return o===null}function eD(o){return o==null}function Ny(o){return typeof o=="number"||Be(o)&&St(o)==bo}function Ko(o){if(!Be(o)||St(o)!=Qn)return!1;var c=Yc(o);if(c===null)return!0;var u=Ee.call(c,"constructor")&&c.constructor;return typeof u=="function"&&u instanceof u&&Kc.call(u)==YS}var Ld=Hm?Kt(Hm):Zb;function tD(o){return ky(o)&&o>=-vr&&o<=vr}var Vy=jm?Kt(jm):eP;function Au(o){return typeof o=="string"||!te(o)&&Be(o)&&St(o)==Co}function jt(o){return typeof o=="symbol"||Be(o)&&St(o)==Mc}var vs=Qm?Kt(Qm):tP;function nD(o){return o===t}function rD(o){return Be(o)&&wt(o)==Do}function iD(o){return Be(o)&&St(o)==IR}var sD=pu(ld),oD=pu(function(o,c){return o<=c});function Oy(o){if(!o)return[];if(Mt(o))return Au(o)?gn(o):Lt(o);if(No&&o[No])return FS(o[No]());var c=wt(o),u=c==fn?Jh:c==pn?Wc:Is;return u(o)}function rr(o){if(!o)return o===0?o:0;if(o=un(o),o===ai||o===-ai){var c=o<0?-1:1;return c*hR}return o===o?o:0}function ie(o){var c=rr(o),u=c%1;return c===c?u?c-u:c:0}function Ly(o){return o?di(ie(o),0,An):0}function un(o){if(typeof o=="number")return o;if(jt(o))return Nc;if(Fe(o)){var c=typeof o.valueOf=="function"?o.valueOf():o;o=Fe(c)?c+"":c}if(typeof o!="string")return o===0?o:+o;o=t_(o);var u=qR.test(o);return u||WR.test(o)?wS(o.slice(2),u?2:8):BR.test(o)?Nc:+o}function My(o){return Sn(o,Ft(o))}function aD(o){return o?di(ie(o),-vr,vr):o===0?o:0}function Ie(o){return o==null?"":Ht(o)}var cD=ms(function(o,c){if(Go(c)||Mt(c)){Sn(c,it(c),o);return}for(var u in c)Ee.call(c,u)&&Fo(o,u,c[u])}),Fy=ms(function(o,c){Sn(c,Ft(c),o)}),Ru=ms(function(o,c,u,d){Sn(c,Ft(c),o,d)}),uD=ms(function(o,c,u,d){Sn(c,it(c),o,d)}),lD=er(rd);function hD(o,c){var u=gs(o);return c==null?u:m_(u,c)}var dD=oe(function(o,c){o=Se(o);var u=-1,d=c.length,g=d>2?c[2]:t;for(g&&bt(c[0],c[1],g)&&(d=1);++u<d;)for(var y=c[u],v=Ft(y),w=-1,T=v.length;++w<T;){var C=v[w],D=o[C];(D===t||_n(D,ds[C])&&!Ee.call(o,C))&&(o[C]=y[C])}return o}),fD=oe(function(o){return o.push(t,ty),zt(Uy,t,o)});function pD(o,c){return Jm(o,Q(c,3),Rn)}function gD(o,c){return Jm(o,Q(c,3),sd)}function mD(o,c){return o==null?o:id(o,Q(c,3),Ft)}function _D(o,c){return o==null?o:w_(o,Q(c,3),Ft)}function yD(o,c){return o&&Rn(o,Q(c,3))}function vD(o,c){return o&&sd(o,Q(c,3))}function ID(o){return o==null?[]:ou(o,it(o))}function wD(o){return o==null?[]:ou(o,Ft(o))}function Md(o,c,u){var d=o==null?t:fi(o,c);return d===t?u:d}function ED(o,c){return o!=null&&iy(o,c,zb)}function Fd(o,c){return o!=null&&iy(o,c,Kb)}var TD=Y_(function(o,c,u){c!=null&&typeof c.toString!="function"&&(c=Hc.call(c)),o[c]=u},Bd(Ut)),AD=Y_(function(o,c,u){c!=null&&typeof c.toString!="function"&&(c=Hc.call(c)),Ee.call(o,c)?o[c].push(u):o[c]=[u]},Q),RD=oe(Bo);function it(o){return Mt(o)?p_(o):ud(o)}function Ft(o){return Mt(o)?p_(o,!0):nP(o)}function SD(o,c){var u={};return c=Q(c,3),Rn(o,function(d,g,y){Xn(u,c(d,g,y),d)}),u}function bD(o,c){var u={};return c=Q(c,3),Rn(o,function(d,g,y){Xn(u,g,c(d,g,y))}),u}var PD=ms(function(o,c,u){au(o,c,u)}),Uy=ms(function(o,c,u,d){au(o,c,u,d)}),CD=er(function(o,c){var u={};if(o==null)return u;var d=!1;c=Ne(c,function(y){return y=Sr(y,o),d||(d=y.length>1),y}),Sn(o,Td(o),u),d&&(u=on(u,m|I|A,TP));for(var g=c.length;g--;)gd(u,c[g]);return u});function DD(o,c){return By(o,Eu(Q(c)))}var kD=er(function(o,c){return o==null?{}:iP(o,c)});function By(o,c){if(o==null)return{};var u=Ne(Td(o),function(d){return[d]});return c=Q(c),k_(o,u,function(d,g){return c(d,g[0])})}function xD(o,c,u){c=Sr(c,o);var d=-1,g=c.length;for(g||(g=1,o=t);++d<g;){var y=o==null?t:o[bn(c[d])];y===t&&(d=g,y=u),o=nr(y)?y.call(o):y}return o}function ND(o,c,u){return o==null?o:$o(o,c,u)}function VD(o,c,u,d){return d=typeof d=="function"?d:t,o==null?o:$o(o,c,u,d)}var qy=Z_(it),$y=Z_(Ft);function OD(o,c,u){var d=te(o),g=d||Pr(o)||vs(o);if(c=Q(c,4),u==null){var y=o&&o.constructor;g?u=d?new y:[]:Fe(o)?u=nr(y)?gs(Yc(o)):{}:u={}}return(g?nn:Rn)(o,function(v,w,T){return c(u,v,w,T)}),u}function LD(o,c){return o==null?!0:gd(o,c)}function MD(o,c,u){return o==null?o:L_(o,c,yd(u))}function FD(o,c,u,d){return d=typeof d=="function"?d:t,o==null?o:L_(o,c,yd(u),d)}function Is(o){return o==null?[]:Yh(o,it(o))}function UD(o){return o==null?[]:Yh(o,Ft(o))}function BD(o,c,u){return u===t&&(u=c,c=t),u!==t&&(u=un(u),u=u===u?u:0),c!==t&&(c=un(c),c=c===c?c:0),di(un(o),c,u)}function qD(o,c,u){return c=rr(c),u===t?(u=c,c=0):u=rr(u),o=un(o),Hb(o,c,u)}function $D(o,c,u){if(u&&typeof u!="boolean"&&bt(o,c,u)&&(c=u=t),u===t&&(typeof c=="boolean"?(u=c,c=t):typeof o=="boolean"&&(u=o,o=t)),o===t&&c===t?(o=0,c=1):(o=rr(o),c===t?(c=o,o=0):c=rr(c)),o>c){var d=o;o=c,c=d}if(u||o%1||c%1){var g=d_();return It(o+g*(c-o+IS("1e-"+((g+"").length-1))),c)}return dd(o,c)}var WD=_s(function(o,c,u){return c=c.toLowerCase(),o+(u?Wy(c):c)});function Wy(o){return Ud(Ie(o).toLowerCase())}function Gy(o){return o=Ie(o),o&&o.replace(zR,NS).replace(lS,"")}function GD(o,c,u){o=Ie(o),c=Ht(c);var d=o.length;u=u===t?d:di(ie(u),0,d);var g=u;return u-=c.length,u>=0&&o.slice(u,g)==c}function zD(o){return o=Ie(o),o&&RR.test(o)?o.replace(wm,VS):o}function KD(o){return o=Ie(o),o&&kR.test(o)?o.replace(Vh,"\\$&"):o}var HD=_s(function(o,c,u){return o+(u?"-":"")+c.toLowerCase()}),jD=_s(function(o,c,u){return o+(u?" ":"")+c.toLowerCase()}),QD=H_("toLowerCase");function YD(o,c,u){o=Ie(o),c=ie(c);var d=c?ls(o):0;if(!c||d>=c)return o;var g=(c-d)/2;return fu(eu(g),u)+o+fu(Zc(g),u)}function JD(o,c,u){o=Ie(o),c=ie(c);var d=c?ls(o):0;return c&&d<c?o+fu(c-d,u):o}function XD(o,c,u){o=Ie(o),c=ie(c);var d=c?ls(o):0;return c&&d<c?fu(c-d,u)+o:o}function ZD(o,c,u){return u||c==null?c=0:c&&(c=+c),ob(Ie(o).replace(Oh,""),c||0)}function ek(o,c,u){return(u?bt(o,c,u):c===t)?c=1:c=ie(c),fd(Ie(o),c)}function tk(){var o=arguments,c=Ie(o[0]);return o.length<3?c:c.replace(o[1],o[2])}var nk=_s(function(o,c,u){return o+(u?"_":"")+c.toLowerCase()});function rk(o,c,u){return u&&typeof u!="number"&&bt(o,c,u)&&(c=u=t),u=u===t?An:u>>>0,u?(o=Ie(o),o&&(typeof c=="string"||c!=null&&!Ld(c))&&(c=Ht(c),!c&&us(o))?br(gn(o),0,u):o.split(c,u)):[]}var ik=_s(function(o,c,u){return o+(u?" ":"")+Ud(c)});function sk(o,c,u){return o=Ie(o),u=u==null?0:di(ie(u),0,o.length),c=Ht(c),o.slice(u,u+c.length)==c}function ok(o,c,u){var d=_.templateSettings;u&&bt(o,c,u)&&(c=t),o=Ie(o),c=Ru({},c,d,ey);var g=Ru({},c.imports,d.imports,ey),y=it(g),v=Yh(g,y),w,T,C=0,D=c.interpolate||Fc,x="__p += '",U=Xh((c.escape||Fc).source+"|"+D.source+"|"+(D===Em?UR:Fc).source+"|"+(c.evaluate||Fc).source+"|$","g"),G="//# sourceURL="+(Ee.call(c,"sourceURL")?(c.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++gS+"]")+`
`;o.replace(U,function(X,ce,fe,Qt,Pt,Yt){return fe||(fe=Qt),x+=o.slice(C,Yt).replace(KR,OS),ce&&(w=!0,x+=`' +
__e(`+ce+`) +
'`),Pt&&(T=!0,x+=`';
`+Pt+`;
__p += '`),fe&&(x+=`' +
((__t = (`+fe+`)) == null ? '' : __t) +
'`),C=Yt+X.length,X}),x+=`';
`;var J=Ee.call(c,"variable")&&c.variable;if(!J)x=`with (obj) {
`+x+`
}
`;else if(MR.test(J))throw new ee(l);x=(T?x.replace(wR,""):x).replace(ER,"$1").replace(TR,"$1;"),x="function("+(J||"obj")+`) {
`+(J?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+x+`return __p
}`;var se=Ky(function(){return ve(y,G+"return "+x).apply(t,v)});if(se.source=x,Od(se))throw se;return se}function ak(o){return Ie(o).toLowerCase()}function ck(o){return Ie(o).toUpperCase()}function uk(o,c,u){if(o=Ie(o),o&&(u||c===t))return t_(o);if(!o||!(c=Ht(c)))return o;var d=gn(o),g=gn(c),y=n_(d,g),v=r_(d,g)+1;return br(d,y,v).join("")}function lk(o,c,u){if(o=Ie(o),o&&(u||c===t))return o.slice(0,s_(o)+1);if(!o||!(c=Ht(c)))return o;var d=gn(o),g=r_(d,gn(c))+1;return br(d,0,g).join("")}function hk(o,c,u){if(o=Ie(o),o&&(u||c===t))return o.replace(Oh,"");if(!o||!(c=Ht(c)))return o;var d=gn(o),g=n_(d,gn(c));return br(d,g).join("")}function dk(o,c){var u=is,d=oR;if(Fe(c)){var g="separator"in c?c.separator:g;u="length"in c?ie(c.length):u,d="omission"in c?Ht(c.omission):d}o=Ie(o);var y=o.length;if(us(o)){var v=gn(o);y=v.length}if(u>=y)return o;var w=u-ls(d);if(w<1)return d;var T=v?br(v,0,w).join(""):o.slice(0,w);if(g===t)return T+d;if(v&&(w+=T.length-w),Ld(g)){if(o.slice(w).search(g)){var C,D=T;for(g.global||(g=Xh(g.source,Ie(Tm.exec(g))+"g")),g.lastIndex=0;C=g.exec(D);)var x=C.index;T=T.slice(0,x===t?w:x)}}else if(o.indexOf(Ht(g),w)!=w){var U=T.lastIndexOf(g);U>-1&&(T=T.slice(0,U))}return T+d}function fk(o){return o=Ie(o),o&&AR.test(o)?o.replace(Im,$S):o}var pk=_s(function(o,c,u){return o+(u?" ":"")+c.toUpperCase()}),Ud=H_("toUpperCase");function zy(o,c,u){return o=Ie(o),c=u?t:c,c===t?MS(o)?zS(o):PS(o):o.match(c)||[]}var Ky=oe(function(o,c){try{return zt(o,t,c)}catch(u){return Od(u)?u:new ee(u)}}),gk=er(function(o,c){return nn(c,function(u){u=bn(u),Xn(o,u,Nd(o[u],o))}),o});function mk(o){var c=o==null?0:o.length,u=Q();return o=c?Ne(o,function(d){if(typeof d[1]!="function")throw new rn(a);return[u(d[0]),d[1]]}):[],oe(function(d){for(var g=-1;++g<c;){var y=o[g];if(zt(y[0],this,d))return zt(y[1],this,d)}})}function _k(o){return $b(on(o,m))}function Bd(o){return function(){return o}}function yk(o,c){return o==null||o!==o?c:o}var vk=Q_(),Ik=Q_(!0);function Ut(o){return o}function qd(o){return R_(typeof o=="function"?o:on(o,m))}function wk(o){return b_(on(o,m))}function Ek(o,c){return P_(o,on(c,m))}var Tk=oe(function(o,c){return function(u){return Bo(u,o,c)}}),Ak=oe(function(o,c){return function(u){return Bo(o,u,c)}});function $d(o,c,u){var d=it(c),g=ou(c,d);u==null&&!(Fe(c)&&(g.length||!d.length))&&(u=c,c=o,o=this,g=ou(c,it(c)));var y=!(Fe(u)&&"chain"in u)||!!u.chain,v=nr(o);return nn(g,function(w){var T=c[w];o[w]=T,v&&(o.prototype[w]=function(){var C=this.__chain__;if(y||C){var D=o(this.__wrapped__),x=D.__actions__=Lt(this.__actions__);return x.push({func:T,args:arguments,thisArg:o}),D.__chain__=C,D}return T.apply(o,wr([this.value()],arguments))})}),o}function Rk(){return dt._===this&&(dt._=JS),this}function Wd(){}function Sk(o){return o=ie(o),oe(function(c){return C_(c,o)})}var bk=Id(Ne),Pk=Id(Ym),Ck=Id(zh);function Hy(o){return bd(o)?Kh(bn(o)):sP(o)}function Dk(o){return function(c){return o==null?t:fi(o,c)}}var kk=J_(),xk=J_(!0);function Gd(){return[]}function zd(){return!1}function Nk(){return{}}function Vk(){return""}function Ok(){return!0}function Lk(o,c){if(o=ie(o),o<1||o>vr)return[];var u=An,d=It(o,An);c=Q(c),o-=An;for(var g=Qh(d,c);++u<o;)c(u);return g}function Mk(o){return te(o)?Ne(o,bn):jt(o)?[o]:Lt(fy(Ie(o)))}function Fk(o){var c=++QS;return Ie(o)+c}var Uk=du(function(o,c){return o+c},0),Bk=wd("ceil"),qk=du(function(o,c){return o/c},1),$k=wd("floor");function Wk(o){return o&&o.length?su(o,Ut,od):t}function Gk(o,c){return o&&o.length?su(o,Q(c,2),od):t}function zk(o){return Zm(o,Ut)}function Kk(o,c){return Zm(o,Q(c,2))}function Hk(o){return o&&o.length?su(o,Ut,ld):t}function jk(o,c){return o&&o.length?su(o,Q(c,2),ld):t}var Qk=du(function(o,c){return o*c},1),Yk=wd("round"),Jk=du(function(o,c){return o-c},0);function Xk(o){return o&&o.length?jh(o,Ut):0}function Zk(o,c){return o&&o.length?jh(o,Q(c,2)):0}return _.after=w1,_.ary=Ay,_.assign=cD,_.assignIn=Fy,_.assignInWith=Ru,_.assignWith=uD,_.at=lD,_.before=Ry,_.bind=Nd,_.bindAll=gk,_.bindKey=Sy,_.castArray=N1,_.chain=wy,_.chunk=$P,_.compact=WP,_.concat=GP,_.cond=mk,_.conforms=_k,_.constant=Bd,_.countBy=XC,_.create=hD,_.curry=by,_.curryRight=Py,_.debounce=Cy,_.defaults=dD,_.defaultsDeep=fD,_.defer=E1,_.delay=T1,_.difference=zP,_.differenceBy=KP,_.differenceWith=HP,_.drop=jP,_.dropRight=QP,_.dropRightWhile=YP,_.dropWhile=JP,_.fill=XP,_.filter=e1,_.flatMap=r1,_.flatMapDeep=i1,_.flatMapDepth=s1,_.flatten=_y,_.flattenDeep=ZP,_.flattenDepth=eC,_.flip=A1,_.flow=vk,_.flowRight=Ik,_.fromPairs=tC,_.functions=ID,_.functionsIn=wD,_.groupBy=o1,_.initial=rC,_.intersection=iC,_.intersectionBy=sC,_.intersectionWith=oC,_.invert=TD,_.invertBy=AD,_.invokeMap=c1,_.iteratee=qd,_.keyBy=u1,_.keys=it,_.keysIn=Ft,_.map=vu,_.mapKeys=SD,_.mapValues=bD,_.matches=wk,_.matchesProperty=Ek,_.memoize=wu,_.merge=PD,_.mergeWith=Uy,_.method=Tk,_.methodOf=Ak,_.mixin=$d,_.negate=Eu,_.nthArg=Sk,_.omit=CD,_.omitBy=DD,_.once=R1,_.orderBy=l1,_.over=bk,_.overArgs=S1,_.overEvery=Pk,_.overSome=Ck,_.partial=Vd,_.partialRight=Dy,_.partition=h1,_.pick=kD,_.pickBy=By,_.property=Hy,_.propertyOf=Dk,_.pull=lC,_.pullAll=vy,_.pullAllBy=hC,_.pullAllWith=dC,_.pullAt=fC,_.range=kk,_.rangeRight=xk,_.rearg=b1,_.reject=p1,_.remove=pC,_.rest=P1,_.reverse=kd,_.sampleSize=m1,_.set=ND,_.setWith=VD,_.shuffle=_1,_.slice=gC,_.sortBy=I1,_.sortedUniq=EC,_.sortedUniqBy=TC,_.split=rk,_.spread=C1,_.tail=AC,_.take=RC,_.takeRight=SC,_.takeRightWhile=bC,_.takeWhile=PC,_.tap=WC,_.throttle=D1,_.thru=yu,_.toArray=Oy,_.toPairs=qy,_.toPairsIn=$y,_.toPath=Mk,_.toPlainObject=My,_.transform=OD,_.unary=k1,_.union=CC,_.unionBy=DC,_.unionWith=kC,_.uniq=xC,_.uniqBy=NC,_.uniqWith=VC,_.unset=LD,_.unzip=xd,_.unzipWith=Iy,_.update=MD,_.updateWith=FD,_.values=Is,_.valuesIn=UD,_.without=OC,_.words=zy,_.wrap=x1,_.xor=LC,_.xorBy=MC,_.xorWith=FC,_.zip=UC,_.zipObject=BC,_.zipObjectDeep=qC,_.zipWith=$C,_.entries=qy,_.entriesIn=$y,_.extend=Fy,_.extendWith=Ru,$d(_,_),_.add=Uk,_.attempt=Ky,_.camelCase=WD,_.capitalize=Wy,_.ceil=Bk,_.clamp=BD,_.clone=V1,_.cloneDeep=L1,_.cloneDeepWith=M1,_.cloneWith=O1,_.conformsTo=F1,_.deburr=Gy,_.defaultTo=yk,_.divide=qk,_.endsWith=GD,_.eq=_n,_.escape=zD,_.escapeRegExp=KD,_.every=ZC,_.find=t1,_.findIndex=gy,_.findKey=pD,_.findLast=n1,_.findLastIndex=my,_.findLastKey=gD,_.floor=$k,_.forEach=Ey,_.forEachRight=Ty,_.forIn=mD,_.forInRight=_D,_.forOwn=yD,_.forOwnRight=vD,_.get=Md,_.gt=U1,_.gte=B1,_.has=ED,_.hasIn=Fd,_.head=yy,_.identity=Ut,_.includes=a1,_.indexOf=nC,_.inRange=qD,_.invoke=RD,_.isArguments=mi,_.isArray=te,_.isArrayBuffer=q1,_.isArrayLike=Mt,_.isArrayLikeObject=Qe,_.isBoolean=$1,_.isBuffer=Pr,_.isDate=W1,_.isElement=G1,_.isEmpty=z1,_.isEqual=K1,_.isEqualWith=H1,_.isError=Od,_.isFinite=j1,_.isFunction=nr,_.isInteger=ky,_.isLength=Tu,_.isMap=xy,_.isMatch=Q1,_.isMatchWith=Y1,_.isNaN=J1,_.isNative=X1,_.isNil=eD,_.isNull=Z1,_.isNumber=Ny,_.isObject=Fe,_.isObjectLike=Be,_.isPlainObject=Ko,_.isRegExp=Ld,_.isSafeInteger=tD,_.isSet=Vy,_.isString=Au,_.isSymbol=jt,_.isTypedArray=vs,_.isUndefined=nD,_.isWeakMap=rD,_.isWeakSet=iD,_.join=aC,_.kebabCase=HD,_.last=cn,_.lastIndexOf=cC,_.lowerCase=jD,_.lowerFirst=QD,_.lt=sD,_.lte=oD,_.max=Wk,_.maxBy=Gk,_.mean=zk,_.meanBy=Kk,_.min=Hk,_.minBy=jk,_.stubArray=Gd,_.stubFalse=zd,_.stubObject=Nk,_.stubString=Vk,_.stubTrue=Ok,_.multiply=Qk,_.nth=uC,_.noConflict=Rk,_.noop=Wd,_.now=Iu,_.pad=YD,_.padEnd=JD,_.padStart=XD,_.parseInt=ZD,_.random=$D,_.reduce=d1,_.reduceRight=f1,_.repeat=ek,_.replace=tk,_.result=xD,_.round=Yk,_.runInContext=E,_.sample=g1,_.size=y1,_.snakeCase=nk,_.some=v1,_.sortedIndex=mC,_.sortedIndexBy=_C,_.sortedIndexOf=yC,_.sortedLastIndex=vC,_.sortedLastIndexBy=IC,_.sortedLastIndexOf=wC,_.startCase=ik,_.startsWith=sk,_.subtract=Jk,_.sum=Xk,_.sumBy=Zk,_.template=ok,_.times=Lk,_.toFinite=rr,_.toInteger=ie,_.toLength=Ly,_.toLower=ak,_.toNumber=un,_.toSafeInteger=aD,_.toString=Ie,_.toUpper=ck,_.trim=uk,_.trimEnd=lk,_.trimStart=hk,_.truncate=dk,_.unescape=fk,_.uniqueId=Fk,_.upperCase=pk,_.upperFirst=Ud,_.each=Ey,_.eachRight=Ty,_.first=yy,$d(_,function(){var o={};return Rn(_,function(c,u){Ee.call(_.prototype,u)||(o[u]=c)}),o}(),{chain:!1}),_.VERSION=r,nn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){_[o].placeholder=_}),nn(["drop","take"],function(o,c){le.prototype[o]=function(u){u=u===t?1:nt(ie(u),0);var d=this.__filtered__&&!c?new le(this):this.clone();return d.__filtered__?d.__takeCount__=It(u,d.__takeCount__):d.__views__.push({size:It(u,An),type:o+(d.__dir__<0?"Right":"")}),d},le.prototype[o+"Right"]=function(u){return this.reverse()[o](u).reverse()}}),nn(["filter","map","takeWhile"],function(o,c){var u=c+1,d=u==_m||u==lR;le.prototype[o]=function(g){var y=this.clone();return y.__iteratees__.push({iteratee:Q(g,3),type:u}),y.__filtered__=y.__filtered__||d,y}}),nn(["head","last"],function(o,c){var u="take"+(c?"Right":"");le.prototype[o]=function(){return this[u](1).value()[0]}}),nn(["initial","tail"],function(o,c){var u="drop"+(c?"":"Right");le.prototype[o]=function(){return this.__filtered__?new le(this):this[u](1)}}),le.prototype.compact=function(){return this.filter(Ut)},le.prototype.find=function(o){return this.filter(o).head()},le.prototype.findLast=function(o){return this.reverse().find(o)},le.prototype.invokeMap=oe(function(o,c){return typeof o=="function"?new le(this):this.map(function(u){return Bo(u,o,c)})}),le.prototype.reject=function(o){return this.filter(Eu(Q(o)))},le.prototype.slice=function(o,c){o=ie(o);var u=this;return u.__filtered__&&(o>0||c<0)?new le(u):(o<0?u=u.takeRight(-o):o&&(u=u.drop(o)),c!==t&&(c=ie(c),u=c<0?u.dropRight(-c):u.take(c-o)),u)},le.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},le.prototype.toArray=function(){return this.take(An)},Rn(le.prototype,function(o,c){var u=/^(?:filter|find|map|reject)|While$/.test(c),d=/^(?:head|last)$/.test(c),g=_[d?"take"+(c=="last"?"Right":""):c],y=d||/^find/.test(c);g&&(_.prototype[c]=function(){var v=this.__wrapped__,w=d?[1]:arguments,T=v instanceof le,C=w[0],D=T||te(v),x=function(ce){var fe=g.apply(_,wr([ce],w));return d&&U?fe[0]:fe};D&&u&&typeof C=="function"&&C.length!=1&&(T=D=!1);var U=this.__chain__,G=!!this.__actions__.length,J=y&&!U,se=T&&!G;if(!y&&D){v=se?v:new le(this);var X=o.apply(v,w);return X.__actions__.push({func:yu,args:[x],thisArg:t}),new sn(X,U)}return J&&se?o.apply(this,w):(X=this.thru(x),J?d?X.value()[0]:X.value():X)})}),nn(["pop","push","shift","sort","splice","unshift"],function(o){var c=Gc[o],u=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",d=/^(?:pop|shift)$/.test(o);_.prototype[o]=function(){var g=arguments;if(d&&!this.__chain__){var y=this.value();return c.apply(te(y)?y:[],g)}return this[u](function(v){return c.apply(te(v)?v:[],g)})}}),Rn(le.prototype,function(o,c){var u=_[c];if(u){var d=u.name+"";Ee.call(ps,d)||(ps[d]=[]),ps[d].push({name:c,func:u})}}),ps[hu(t,Y).name]=[{name:"wrapper",func:t}],le.prototype.clone=fb,le.prototype.reverse=pb,le.prototype.value=gb,_.prototype.at=GC,_.prototype.chain=zC,_.prototype.commit=KC,_.prototype.next=HC,_.prototype.plant=QC,_.prototype.reverse=YC,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=JC,_.prototype.first=_.prototype.head,No&&(_.prototype[No]=jC),_},hs=KS();ci?((ci.exports=hs)._=hs,qh._=hs):dt._=hs}).call(sa)})(n$,ic);const mm=ic;function r$(){return Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)}const rR=document.querySelector(".search__wrapper"),hw=document.querySelector(".search__input"),Pl=document.querySelector(".filters__list"),fp=document.querySelector(".filters__category"),i$=mm.debounce(c$,500);async function s$(n){try{const e=await n.fetchFilters(),r=[...new Set(e.map(({filter:i})=>i))].map((i,s)=>{const a=i.toLowerCase().split(" ").join("-");return s===0?`<li id=${a} class="filters__item active">${i}</li>`:`<li id=${a} class="filters__item">${i}</li>`}).join("");Pl.insertAdjacentHTML("afterbegin",r),Xr()}catch(e){console.log("Error fetching filters:",e)}}function o$(n){const e=n.charAt(0).toUpperCase()+n.slice(1,n.length);fp.innerHTML=`<div>/</div>${e}`,fp.classList.add("active"),rR.classList.add("active")}function a$(){fp.classList.remove("active"),rR.classList.remove("active")}async function c$(n){const e=n.target.value.toLowerCase().trim();Cn.keyword=e,Xr()}function u$(n){const e=n.target,t=n.target.id;e.classList.contains("active")&&(K0({filter:t,bodypart:"",keyword:"",muscles:"",equipment:""},De),Xr()),[...Pl.children].forEach(r=>{r.classList.remove("active")}),e.classList.add("active"),a$(),De.currentPage=1,Xr()}function l$(){if(De.endPoint!=1){const n=new sc;s$(n)}}hw&&hw.addEventListener("input",i$);Pl&&Pl.addEventListener("click",u$);function iR(n){document.querySelector(n).scrollIntoView({behavior:"smooth"})}window.addEventListener("resize",mm.debounce(Xr,1e3));const h$=1440;let Cn={filter:"Muscles",bodypart:"",keyword:"",muscles:"",equipment:""};const De={currentPage:1,endPoint:3},Wn={cardsLinks:null,pageLinks:null,workoutLinks:null};async function Xr(){document.querySelector(".exercise-cards__section").offsetHeight;const e=new sc,t=r$();let r,i;K0(Cn,De),Fu(qe.visuallyHidden,qe.emptyParag),bs(qe.emptyWrapper,qe.exerciseWrapper),t$(De.endPoint,t);try{switch(De.endPoint){case 1:if(Fu(qe.favoriteWrapper,qe.exerciseWrapper),bs(qe.workoutWrapper,qe.exerciseWrapper),r=await _4(De,t),r.currentData.length<1)throw new Error("No data");Mu(),Uu(),p4(r.currentData),t<h$&&mf(De.currentPage,r.totalPages),_f(De.endPoint);break;case 2:if(bs(qe.favoriteWrapper,qe.exerciseWrapper),Fu(qe.workoutWrapper,qe.exerciseWrapper),iR(".exercises"),i=g4(De.currentPage,De.endPoint,e,Cn,i,t),r=await JI(i),r.length<1)throw new Error("No data");Mu(),Uu(),f4(r),mf(De.currentPage,e.maxPages),_f(De.endPoint),g$();break;case 3:bs(qe.workoutWrapper,qe.exerciseWrapper),bs(qe.favoriteWrapper,qe.exerciseWrapper),i=m4(De.currentPage,De.endPoint,e,Cn,i,t),r=await JI(i),Mu(),Uu(),d4(r),mf(De.currentPage,e.maxPages),d$(),_f(De.endPoint);break}}catch(s){console.log("Error: ",s),Mu(),Uu(),Fu(qe.emptyWrapper,qe.exerciseWrapper),De.endPoint!=1?tw(ew.stringHome,qe.exerciseWrapper):tw(ew.stringFavorite,qe.exerciseWrapper),bs(qe.visuallyHidden,qe.emptyParag)}}function d$(){Wn.cardsLinks=document.querySelector(".js-cards"),Wn.cardsLinks?Wn.cardsLinks.addEventListener("click",sR):console.error("Element with class 'js-cards' not found.")}function sR(n){const e=y4(n);o$(e),f$(e),e!=null&&(Cn.filter==="Muscles"?(De.endPoint=2,Cn.muscles=e):Cn.filter==="Body%20parts"?(De.endPoint=2,Cn.bodypart=e):Cn.filter==="Equipment"&&(De.endPoint=2,Cn.equipment=e)),Wn.cardsLinks.removeEventListener("click",sR),De.currentPage=1,Xr()}function f$(n){return n.includes(" ")?n.replace(" ","%20"):n}function _f(){Wn.pageLinks=document.querySelector(".js-pages"),Wn.pageLinks?Wn.pageLinks.addEventListener("click",p$):console.error("Element with class 'js-pages' not found.")}function p$(n){const e=v4(n);console.log("clicked page:",e),iR(window.location.href.includes("/favorites")?".favorites":".exercises"),De.currentPage!=e&&e!=null&&(De.currentPage=+e,Xr())}function g$(){Wn.workoutLinks=document.querySelector(".js-cards"),Wn.workoutLinks?Wn.workoutLinks.addEventListener("click",mm.debounce(m$,300)):console.error("Element with class 'js-cards' not found for workout.")}async function m$(n){const e=I4(n);if(!e)return;const t=new sc;try{t.id=e;const r=await t.fetchExerciseById();if(ic.isEmpty(r))throw new Error("Exercise not found!");r.isFavorite=await Vi.idIsFavorite(e),gm(r)}catch(r){console.error(r)}}function _$(){window.location.href.includes("/favorite")?(De.endPoint=1,Xr()):l$()}_$();document.querySelectorAll(".header__nav");const y$=document.querySelectorAll("section"),v$=n=>{const e={rootMargin:"100px",threshold:.2},t=(i,s)=>{i.forEach(({isIntersecting:a,target:l})=>{a&&(l.classList.add("appear"),s.unobserve(l))})},r=new IntersectionObserver(t,e);n.forEach(i=>r.observe(i))};setTimeout(()=>{v$(y$)},250);export{Hi as d,hp as r,h4 as s};
