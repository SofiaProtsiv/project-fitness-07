import{A as Il}from"./index-4cd4f1ec.js";import{i as TD}from"./index-34529249.js";import"./quotes-16f863e8.js";const GI=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},AD=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],l=n[t++],h=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},zI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,l=a?n[i+1]:0,h=i+2<n.length,f=h?n[i+2]:0,p=s>>2,m=(s&3)<<4|l>>4;let I=(l&15)<<2|f>>6,A=f&63;h||(A=64,a||(I=64)),r.push(t[p],t[m],t[I],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(GI(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):AD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const f=i<n.length?t[n.charAt(i)]:64;++i;const m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||f==null||m==null)throw new RD;const I=s<<2|l>>4;if(r.push(I),f!==64){const A=l<<4&240|f>>2;if(r.push(A),m!==64){const L=f<<6&192|m;r.push(L)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class RD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bD=function(n){const e=GI(n);return zI.encodeByteArray(e,!0)},qc=function(n){return bD(n).replace(/\./g,"")},KI=function(n){try{return zI.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function $c(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!SD(t)||(n[t]=$c(n[t],e[t]));return n}function SD(n){return n!=="__proto__"}function PD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const CD=()=>PD().__FIREBASE_DEFAULTS__,kD=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},DD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&KI(n[1]);return e&&JSON.parse(e)},ip=()=>{try{return CD()||kD()||DD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},HI=()=>{var n;return(n=ip())===null||n===void 0?void 0:n.config},xD=n=>{var e;return(e=ip())===null||e===void 0?void 0:e[`_${n}`]};class ND{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function VD(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n),l="";return[qc(JSON.stringify(t)),qc(JSON.stringify(a)),l].join(".")}function Fe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function OD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fe())}function sp(){var n;const e=(n=ip())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function LD(){return typeof self=="object"&&self.self===self}function jI(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function op(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function QI(){const n=Fe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function MD(){return!sp()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _a(){try{return typeof indexedDB=="object"}catch{return!1}}function FD(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}const UD="FirebaseError";class Dt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=UD,Object.setPrototypeOf(this,Dt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gi.prototype.create)}}class Gi{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?BD(s,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new Dt(i,l,r)}}function BD(n,e){return n.replace(qD,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const qD=/\{\$([^}]+)}/g;function Vy(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function $D(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function lf(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(Oy(s)&&Oy(a)){if(!lf(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Oy(n){return n!==null&&typeof n=="object"}function Xs(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function bs(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Zo(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function YI(n,e){const t=new WD(n,e);return t.subscribe.bind(t)}class WD{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");GD(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Bd),i.error===void 0&&(i.error=Bd),i.complete===void 0&&(i.complete=Bd);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function GD(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Bd(){}function H(n){return n&&n._delegate?n._delegate:n}class qn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const gi="[DEFAULT]";class zD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new ND;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HD(e))try{this.getOrInitializeService({instanceIdentifier:gi})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=gi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=gi){return this.instances.has(e)}getOptions(e=gi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&a.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:KD(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=gi){return this.component?this.component.multipleInstances?e:gi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function KD(n){return n===gi?void 0:n}function HD(n){return n.instantiationMode==="EAGER"}class jD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new zD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ap=[];var ce;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ce||(ce={}));const JI={debug:ce.DEBUG,verbose:ce.VERBOSE,info:ce.INFO,warn:ce.WARN,error:ce.ERROR,silent:ce.SILENT},QD=ce.INFO,YD={[ce.DEBUG]:"log",[ce.VERBOSE]:"log",[ce.INFO]:"info",[ce.WARN]:"warn",[ce.ERROR]:"error"},JD=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=YD[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class wl{constructor(e){this.name=e,this._logLevel=QD,this._logHandler=JD,this._userLogHandler=null,ap.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?JI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ce.DEBUG,...e),this._logHandler(this,ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ce.VERBOSE,...e),this._logHandler(this,ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ce.INFO,...e),this._logHandler(this,ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ce.WARN,...e),this._logHandler(this,ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ce.ERROR,...e),this._logHandler(this,ce.ERROR,...e)}}function XD(n){ap.forEach(e=>{e.setLogLevel(n)})}function ZD(n,e){for(const t of ap){let r=null;e&&e.level&&(r=JI[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...a)=>{const l=a.map(h=>{if(h==null)return null;if(typeof h=="string")return h;if(typeof h=="number"||typeof h=="boolean")return h.toString();if(h instanceof Error)return h.message;try{return JSON.stringify(h)}catch{return null}}).filter(h=>h).join(" ");s>=(r??i.logLevel)&&n({level:ce[s].toLowerCase(),message:l,args:a,type:i.name})}}}const ex=(n,e)=>e.some(t=>n instanceof t);let Ly,My;function tx(){return Ly||(Ly=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function nx(){return My||(My=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const XI=new WeakMap,hf=new WeakMap,ZI=new WeakMap,qd=new WeakMap,up=new WeakMap;function rx(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Lr(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&XI.set(t,n)}).catch(()=>{}),up.set(e,n),e}function ix(n){if(hf.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});hf.set(n,e)}let df={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return hf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ZI.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Lr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function sx(n){df=n(df)}function ox(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call($d(this),e,...t);return ZI.set(r,e.sort?e.sort():[e]),Lr(r)}:nx().includes(n)?function(...e){return n.apply($d(this),e),Lr(XI.get(this))}:function(...e){return Lr(n.apply($d(this),e))}}function ax(n){return typeof n=="function"?ox(n):(n instanceof IDBTransaction&&ix(n),ex(n,tx())?new Proxy(n,df):n)}function Lr(n){if(n instanceof IDBRequest)return rx(n);if(qd.has(n))return qd.get(n);const e=ax(n);return e!==n&&(qd.set(n,e),up.set(e,n)),e}const $d=n=>up.get(n);function ux(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),l=Lr(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Lr(a.result),h.oldVersion,h.newVersion,Lr(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),l.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const cx=["get","getKey","getAll","getAllKeys","count"],lx=["put","add","delete","clear"],Wd=new Map;function Fy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Wd.get(e))return Wd.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=lx.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||cx.includes(t)))return;const s=async function(a,...l){const h=this.transaction(a,i?"readwrite":"readonly");let f=h.store;return r&&(f=f.index(l.shift())),(await Promise.all([f[t](...l),i&&h.done]))[0]};return Wd.set(e,s),s}sx(n=>({...n,get:(e,t,r)=>Fy(e,t)||n.get(e,t,r),has:(e,t)=>!!Fy(e,t)||n.has(e,t)}));class hx{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(dx(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function dx(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ff="@firebase/app",Uy="0.9.25";const Di=new wl("@firebase/app"),fx="@firebase/app-compat",px="@firebase/analytics-compat",gx="@firebase/analytics",mx="@firebase/app-check-compat",_x="@firebase/app-check",yx="@firebase/auth",vx="@firebase/auth-compat",Ix="@firebase/database",wx="@firebase/database-compat",Ex="@firebase/functions",Tx="@firebase/functions-compat",Ax="@firebase/installations",Rx="@firebase/installations-compat",bx="@firebase/messaging",Sx="@firebase/messaging-compat",Px="@firebase/performance",Cx="@firebase/performance-compat",kx="@firebase/remote-config",Dx="@firebase/remote-config-compat",xx="@firebase/storage",Nx="@firebase/storage-compat",Vx="@firebase/firestore",Ox="@firebase/firestore-compat",Lx="firebase",Mx="10.7.1";const Mr="[DEFAULT]",Fx={[ff]:"fire-core",[fx]:"fire-core-compat",[gx]:"fire-analytics",[px]:"fire-analytics-compat",[_x]:"fire-app-check",[mx]:"fire-app-check-compat",[yx]:"fire-auth",[vx]:"fire-auth-compat",[Ix]:"fire-rtdb",[wx]:"fire-rtdb-compat",[Ex]:"fire-fn",[Tx]:"fire-fn-compat",[Ax]:"fire-iid",[Rx]:"fire-iid-compat",[bx]:"fire-fcm",[Sx]:"fire-fcm-compat",[Px]:"fire-perf",[Cx]:"fire-perf-compat",[kx]:"fire-rc",[Dx]:"fire-rc-compat",[xx]:"fire-gcs",[Nx]:"fire-gcs-compat",[Vx]:"fire-fst",[Ox]:"fire-fst-compat","fire-js":"fire-js",[Lx]:"fire-js-all"};const Fr=new Map,ya=new Map;function Wc(n,e){try{n.container.addComponent(e)}catch(t){Di.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ew(n,e){n.container.addOrOverwriteComponent(e)}function Ur(n){const e=n.name;if(ya.has(e))return Di.debug(`There were multiple attempts to register component ${e}.`),!1;ya.set(e,n);for(const t of Fr.values())Wc(t,n);return!0}function tw(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ux(n,e,t=Mr){tw(n,e).clearInstance(t)}function Bx(){ya.clear()}const qx={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},sr=new Gi("app","Firebase",qx);let $x=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new qn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw sr.create("app-deleted",{appName:this._name})}};const Yr=Mx;function cp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Mr,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw sr.create("bad-app-name",{appName:String(i)});if(t||(t=HI()),!t)throw sr.create("no-options");const s=Fr.get(i);if(s){if(lf(t,s.options)&&lf(r,s.config))return s;throw sr.create("duplicate-app",{appName:i})}const a=new jD(i);for(const h of ya.values())a.addComponent(h);const l=new $x(t,r,a);return Fr.set(i,l),l}function Wx(n=Mr){const e=Fr.get(n);if(!e&&n===Mr&&HI())return cp();if(!e)throw sr.create("no-app",{appName:n});return e}function Gx(){return Array.from(Fr.values())}async function nw(n){const e=n.name;Fr.has(e)&&(Fr.delete(e),await Promise.all(n.container.getProviders().map(t=>t.delete())),n.isDeleted=!0)}function Mn(n,e,t){var r;let i=(r=Fx[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Di.warn(l.join(" "));return}Ur(new qn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function rw(n,e){if(n!==null&&typeof n!="function")throw sr.create("invalid-log-argument");ZD(n,e)}function iw(n){XD(n)}const zx="firebase-heartbeat-database",Kx=1,va="firebase-heartbeat-store";let Gd=null;function sw(){return Gd||(Gd=ux(zx,Kx,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(va)}}}).catch(n=>{throw sr.create("idb-open",{originalErrorMessage:n.message})})),Gd}async function Hx(n){try{return await(await sw()).transaction(va).objectStore(va).get(ow(n))}catch(e){if(e instanceof Dt)Di.warn(e.message);else{const t=sr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Di.warn(t.message)}}}async function By(n,e){try{const r=(await sw()).transaction(va,"readwrite");await r.objectStore(va).put(e,ow(n)),await r.done}catch(t){if(t instanceof Dt)Di.warn(t.message);else{const r=sr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Di.warn(r.message)}}}function ow(n){return`${n.name}!${n.options.appId}`}const jx=1024,Qx=30*24*60*60*1e3;class Yx{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Xx(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=qy();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Qx}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=qy(),{heartbeatsToSend:r,unsentEntries:i}=Jx(this._heartbeatsCache.heartbeats),s=qc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function qy(){return new Date().toISOString().substring(0,10)}function Jx(n,e=jx){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),$y(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),$y(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Xx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _a()?FD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Hx(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return By(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return By(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function $y(n){return qc(JSON.stringify({version:2,heartbeats:n})).length}function Zx(n){Ur(new qn("platform-logger",e=>new hx(e),"PRIVATE")),Ur(new qn("heartbeat",e=>new Yx(e),"PRIVATE")),Mn(ff,Uy,n),Mn(ff,Uy,"esm2017"),Mn("fire-js","")}Zx("");const eN=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:Yr,_DEFAULT_ENTRY_NAME:Mr,_addComponent:Wc,_addOrOverwriteComponent:ew,_apps:Fr,_clearComponents:Bx,_components:ya,_getProvider:tw,_registerComponent:Ur,_removeServiceInstance:Ux,deleteApp:nw,getApp:Wx,getApps:Gx,initializeApp:cp,onLog:rw,registerVersion:Mn,setLogLevel:iw,FirebaseError:Dt},Symbol.toStringTag,{value:"Module"}));class tN{constructor(e,t){this._delegate=e,this.firebase=t,Wc(e,new qn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),nw(this._delegate)))}_getService(e,t=Mr){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=Mr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Wc(this._delegate,e)}_addOrOverwriteComponent(e){ew(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const nN={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},Wy=new Gi("app-compat","Firebase",nN);function rN(n){const e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Mn,setLogLevel:iw,onLog:rw,apps:null,SDK_VERSION:Yr,INTERNAL:{registerComponent:l,removeApp:r,useAsService:h,modularAPIs:eN}};t.default=t,Object.defineProperty(t,"apps",{get:a});function r(f){delete e[f]}function i(f){if(f=f||Mr,!Vy(e,f))throw Wy.create("no-app",{appName:f});return e[f]}i.App=n;function s(f,p={}){const m=cp(f,p);if(Vy(e,m.name))return e[m.name];const I=new n(m,t);return e[m.name]=I,I}function a(){return Object.keys(e).map(f=>e[f])}function l(f){const p=f.name,m=p.replace("-compat","");if(Ur(f)&&f.type==="PUBLIC"){const I=(A=i())=>{if(typeof A[m]!="function")throw Wy.create("invalid-app-argument",{appName:p});return A[m]()};f.serviceProps!==void 0&&$c(I,f.serviceProps),t[m]=I,n.prototype[m]=function(...A){return this._getService.bind(this,p).apply(this,f.multipleInstances?A:[])}}return f.type==="PUBLIC"?t[m]:null}function h(f,p){return p==="serverAuth"?null:p}return t}function aw(){const n=rN(tN);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:aw,extendNamespace:e,createSubscribe:YI,ErrorFactory:Gi,deepExtend:$c});function e(t){$c(n,t)}return n}const iN=aw();const Gy=new wl("@firebase/app-compat"),sN="@firebase/app-compat",oN="0.2.25";function aN(n){Mn(sN,oN,n)}if(LD()&&self.firebase!==void 0){Gy.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&Gy.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const Br=iN;aN();var uN="firebase",cN="10.7.1";Br.registerVersion(uN,cN,"app-compat");function lp(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}const Fo={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},gs={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function lN(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is incorrect, malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-password"]:"A non-empty password must be provided",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.",["missing-recaptcha-token"]:"The reCAPTCHA token is missing when sending request to the backend.",["invalid-recaptcha-token"]:"The reCAPTCHA token is invalid when sending request to the backend.",["invalid-recaptcha-action"]:"The reCAPTCHA action is invalid when sending request to the backend.",["recaptcha-not-enabled"]:"reCAPTCHA Enterprise integration is not enabled for this project.",["missing-client-type"]:"The reCAPTCHA client type is missing when sending request to the backend.",["missing-recaptcha-version"]:"The reCAPTCHA version is missing when sending request to the backend.",["invalid-req-type"]:"Invalid request parameters.",["invalid-recaptcha-version"]:"The reCAPTCHA version is invalid when sending request to the backend.",["unsupported-password-policy-schema-version"]:"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.",["password-does-not-meet-requirements"]:"The password does not meet the requirements."}}function uw(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const hN=lN,dN=uw,cw=new Gi("auth","Firebase",uw());const Gc=new wl("@firebase/auth");function fN(n,...e){Gc.logLevel<=ce.WARN&&Gc.warn(`Auth (${Yr}): ${n}`,...e)}function Cc(n,...e){Gc.logLevel<=ce.ERROR&&Gc.error(`Auth (${Yr}): ${n}`,...e)}function _t(n,...e){throw hp(n,...e)}function gt(n,...e){return hp(n,...e)}function lw(n,e,t){const r=Object.assign(Object.assign({},dN()),{[e]:t});return new Gi("auth","Firebase",r).create(e,{appName:n.name})}function Zs(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&_t(n,"argument-error"),lw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function hp(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return cw.create(n,...e)}function O(n,e,...t){if(!n)throw hp(e,...t)}function xn(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Cc(e),new Error(e)}function vn(n,e){n||xn(e)}function Ia(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function dp(){return zy()==="http:"||zy()==="https:"}function zy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function pN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(dp()||jI()||"connection"in navigator)?navigator.onLine:!0}function gN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Ja{constructor(e,t){this.shortDelay=e,this.longDelay=t,vn(t>e,"Short delay should be less than long delay!"),this.isMobile=OD()||op()}get(){return pN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function fp(n,e){vn(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class hw{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;xn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;xn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;xn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const mN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const _N=new Ja(3e4,6e4);function Ge(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function ze(n,e,t,r,i={}){return dw(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const l=Xs(Object.assign({key:n.config.apiKey},a)).slice(1),h=await n._getAdditionalHeaders();return h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode),hw.fetch()(fw(n,n.config.apiHost,t,l),Object.assign({method:e,headers:h,referrerPolicy:"no-referrer"},s))})}async function dw(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},mN),e);try{const i=new vN(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw ea(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const l=s.ok?a.errorMessage:a.error.message,[h,f]=l.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw ea(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw ea(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw ea(n,"user-disabled",a);const p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw lw(n,p,f);_t(n,p)}}catch(i){if(i instanceof Dt)throw i;_t(n,"network-request-failed",{message:String(i)})}}async function hr(n,e,t,r,i={}){const s=await ze(n,e,t,r,i);return"mfaPendingCredential"in s&&_t(n,"multi-factor-auth-required",{_serverResponse:s}),s}function fw(n,e,t,r){const i=`${e}${t}?${r}`;return n.config.emulator?fp(n.config,i):`${n.config.apiScheme}://${i}`}function yN(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class vN{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(gt(this.auth,"network-request-failed")),_N.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ea(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=gt(n,e,r);return i.customData._tokenResponse=t,i}function Ky(n){return n!==void 0&&n.getResponse!==void 0}function Hy(n){return n!==void 0&&n.enterprise!==void 0}class IN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return yN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function wN(n){return(await ze(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function EN(n,e){return ze(n,"GET","/v2/recaptchaConfig",Ge(n,e))}async function TN(n,e){return ze(n,"POST","/v1/accounts:delete",e)}async function AN(n,e){return ze(n,"POST","/v1/accounts:update",e)}async function RN(n,e){return ze(n,"POST","/v1/accounts:lookup",e)}function aa(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bN(n,e=!1){const t=H(n),r=await t.getIdToken(e),i=El(r);O(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:aa(zd(i.auth_time)),issuedAtTime:aa(zd(i.iat)),expirationTime:aa(zd(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function zd(n){return Number(n)*1e3}function El(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Cc("JWT malformed, contained fewer than 3 sections"),null;try{const i=KI(t);return i?JSON.parse(i):(Cc("Failed to decode base64 JWT payload"),null)}catch(i){return Cc("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function SN(n){const e=El(n);return O(e,"internal-error"),O(typeof e.exp<"u","internal-error"),O(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ur(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Dt&&PN(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function PN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class CN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class pw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=aa(this.lastLoginAt),this.creationTime=aa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function wa(n){var e;const t=n.auth,r=await n.getIdToken(),i=await ur(n,RN(t,{idToken:r}));O(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?xN(s.providerUserInfo):[],l=DN(n.providerData,a),h=n.isAnonymous,f=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=h?f:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new pw(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)}async function kN(n){const e=H(n);await wa(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function DN(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function xN(n){return n.map(e=>{var{providerId:t}=e,r=lp(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function NN(n,e){const t=await dw(n,{},async()=>{const r=Xs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=fw(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",hw.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function VN(n,e){return ze(n,"POST","/v2/accounts:revokeToken",Ge(n,e))}class Ea{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){O(e.idToken,"internal-error"),O(typeof e.idToken<"u","internal-error"),O(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):SN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return O(!this.accessToken||this.refreshToken,e,"user-token-expired"),!t&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await NN(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new Ea;return r&&(O(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(O(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(O(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ea,this.toJSON())}_performRefresh(){return xn("not implemented")}}function br(n,e){O(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Si{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=lp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new CN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new pw(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ur(this,this.stsTokenManager.getToken(this.auth,e));return O(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return bN(this,e)}reload(){return kN(this)}_assign(e){this!==e&&(O(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Si(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){O(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await wa(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ur(this,TN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,l,h,f,p;const m=(r=t.displayName)!==null&&r!==void 0?r:void 0,I=(i=t.email)!==null&&i!==void 0?i:void 0,A=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,L=(a=t.photoURL)!==null&&a!==void 0?a:void 0,M=(l=t.tenantId)!==null&&l!==void 0?l:void 0,V=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,Y=(f=t.createdAt)!==null&&f!==void 0?f:void 0,ae=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:j,emailVerified:ye,isAnonymous:de,providerData:me,stsTokenManager:we}=t;O(j&&we,e,"internal-error");const Vt=Ea.fromJSON(this.name,we);O(typeof j=="string",e,"internal-error"),br(m,e.name),br(I,e.name),O(typeof ye=="boolean",e,"internal-error"),O(typeof de=="boolean",e,"internal-error"),br(A,e.name),br(L,e.name),br(M,e.name),br(V,e.name),br(Y,e.name),br(ae,e.name);const zn=new Si({uid:j,auth:e,email:I,emailVerified:ye,displayName:m,isAnonymous:de,photoURL:L,phoneNumber:A,tenantId:M,stsTokenManager:Vt,createdAt:Y,lastLoginAt:ae});return me&&Array.isArray(me)&&(zn.providerData=me.map(Xi=>Object.assign({},Xi))),V&&(zn._redirectEventId=V),zn}static async _fromIdTokenResponse(e,t,r=!1){const i=new Ea;i.updateFromServerResponse(t);const s=new Si({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await wa(s),s}}const jy=new Map;function Jt(n){vn(n instanceof Function,"Expected a class definition");let e=jy.get(n);return e?(vn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,jy.set(n,e),e)}class gw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}gw.type="NONE";const Ms=gw;function Pi(n,e,t){return`firebase:${n}:${e}:${t}`}class Cs{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Pi(this.userKey,i.apiKey,s),this.fullPersistenceKey=Pi("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Si._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Cs(Jt(Ms),e,r);const i=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let s=i[0]||Jt(Ms);const a=Pi(r,e.config.apiKey,e.name);let l=null;for(const f of t)try{const p=await f._get(a);if(p){const m=Si._fromJSON(e,p);f!==s&&(l=m),s=f;break}}catch{}const h=i.filter(f=>f._shouldAllowMigration);return!s._shouldAllowMigration||!h.length?new Cs(s,e,r):(s=h[0],l&&await s._set(a,l.toJSON()),await Promise.all(t.map(async f=>{if(f!==s)try{await f._remove(a)}catch{}})),new Cs(s,e,r))}}function Qy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(yw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(mw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(vw(e))return"Blackberry";if(Iw(e))return"Webos";if(pp(e))return"Safari";if((e.includes("chrome/")||_w(e))&&!e.includes("edge/"))return"Chrome";if(Xa(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function mw(n=Fe()){return/firefox\//i.test(n)}function pp(n=Fe()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _w(n=Fe()){return/crios\//i.test(n)}function yw(n=Fe()){return/iemobile/i.test(n)}function Xa(n=Fe()){return/android/i.test(n)}function vw(n=Fe()){return/blackberry/i.test(n)}function Iw(n=Fe()){return/webos/i.test(n)}function eo(n=Fe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function ON(n=Fe()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function LN(n=Fe()){var e;return eo(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function MN(){return QI()&&document.documentMode===10}function ww(n=Fe()){return eo(n)||Xa(n)||Iw(n)||vw(n)||/windows phone/i.test(n)||yw(n)}function FN(){try{return!!(window&&window!==window.top)}catch{return!1}}function Ew(n,e=[]){let t;switch(n){case"Browser":t=Qy(Fe());break;case"Worker":t=`${Qy(Fe())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Yr}/${r}`}class UN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,l)=>{try{const h=e(s);a(h)}catch(h){l(h)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}async function BN(n,e={}){return ze(n,"GET","/v2/passwordPolicy",Ge(n,e))}const qN=6;class $N{constructor(e){var t,r,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:qN,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,l;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(s=h.containsUppercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(l=h.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),h}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class WN{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Yy(this),this.idTokenSubscription=new Yy(this),this.beforeStateQueue=new UN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Jt(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Cs.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===l)&&(h!=null&&h.user)&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return O(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await wa(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=gN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?H(e):null;return t&&O(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&O(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Jt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await BN(this),t=new $N(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Gi("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await VN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Jt(e)||this._popupRedirectResolver;O(t,this,"argument-error"),this.redirectPersistenceManager=await Cs.create(this,[Jt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(O(l,this,"internal-error"),l.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{const h=e.addObserver(t);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return O(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ew(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&fN(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function qe(n){return H(n)}class Yy{constructor(e){this.auth=e,this.observer=null,this.addObserver=YI(t=>this.observer=t)}get next(){return O(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function GN(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}function gp(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=gt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",GN().appendChild(r)})}function Tw(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const zN="https://www.google.com/recaptcha/enterprise.js?render=",KN="recaptcha-enterprise",HN="NO_RECAPTCHA";class jN{constructor(e){this.type=KN,this.auth=qe(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,l)=>{EN(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const f=new IN(h);return s.tenantId==null?s._agentRecaptchaConfig=f:s._tenantRecaptchaConfigs[s.tenantId]=f,a(f.siteKey)}}).catch(h=>{l(h)})})}function i(s,a,l){const h=window.grecaptcha;Hy(h)?h.enterprise.ready(()=>{h.enterprise.execute(s,{action:e}).then(f=>{a(f)}).catch(()=>{a(HN)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{r(this.auth).then(l=>{if(!t&&Hy(window.grecaptcha))i(l,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}gp(zN+l).then(()=>{i(l,s,a)}).catch(h=>{a(h)})}}).catch(l=>{a(l)})})}}async function Jy(n,e,t,r=!1){const i=new jN(n);let s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Ta(n,e,t,r){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Jy(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Jy(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(s)})}function QN(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Jt);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function YN(n,e,t){const r=qe(n);O(r._canInitEmulator,r,"emulator-config-failed"),O(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),s=Aw(e),{host:a,port:l}=JN(e),h=l===null?"":`:${l}`;r.config.emulator={url:`${s}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||XN()}function Aw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function JN(n){const e=Aw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Xy(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:Xy(a)}}}function Xy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function XN(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class to{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return xn("not implemented")}_getIdTokenResponse(e){return xn("not implemented")}_linkToIdToken(e,t){return xn("not implemented")}_getReauthenticationResolver(e){return xn("not implemented")}}async function Rw(n,e){return ze(n,"POST","/v1/accounts:resetPassword",Ge(n,e))}async function ZN(n,e){return ze(n,"POST","/v1/accounts:update",e)}async function eV(n,e){return ze(n,"POST","/v1/accounts:signUp",e)}async function tV(n,e){return ze(n,"POST","/v1/accounts:update",Ge(n,e))}async function nV(n,e){return hr(n,"POST","/v1/accounts:signInWithPassword",Ge(n,e))}async function Tl(n,e){return ze(n,"POST","/v1/accounts:sendOobCode",Ge(n,e))}async function rV(n,e){return Tl(n,e)}async function iV(n,e){return Tl(n,e)}async function sV(n,e){return Tl(n,e)}async function oV(n,e){return Tl(n,e)}async function aV(n,e){return hr(n,"POST","/v1/accounts:signInWithEmailLink",Ge(n,e))}async function uV(n,e){return hr(n,"POST","/v1/accounts:signInWithEmailLink",Ge(n,e))}class Aa extends to{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Aa(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Aa(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ta(e,t,"signInWithPassword",nV);case"emailLink":return aV(e,{email:this._email,oobCode:this._password});default:_t(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ta(e,r,"signUpPassword",eV);case"emailLink":return uV(e,{idToken:t,email:this._email,oobCode:this._password});default:_t(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function or(n,e){return hr(n,"POST","/v1/accounts:signInWithIdp",Ge(n,e))}const cV="http://localhost";class $n extends to{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new $n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_t("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=lp(t,["providerId","signInMethod"]);if(!r||!i)return null;const a=new $n(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return or(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,or(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,or(e,t)}buildRequest(){const e={requestUri:cV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Xs(t)}return e}}async function lV(n,e){return ze(n,"POST","/v1/accounts:sendVerificationCode",Ge(n,e))}async function hV(n,e){return hr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ge(n,e))}async function dV(n,e){const t=await hr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ge(n,e));if(t.temporaryProof)throw ea(n,"account-exists-with-different-credential",t);return t}const fV={USER_NOT_FOUND:"user-not-found"};async function pV(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return hr(n,"POST","/v1/accounts:signInWithPhoneNumber",Ge(n,t),fV)}class Ci extends to{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ci({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ci({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return hV(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return dV(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return pV(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new Ci({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}}function gV(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function mV(n){const e=bs(Zo(n)).link,t=e?bs(Zo(e)).deep_link_id:null,r=bs(Zo(n)).deep_link_id;return(r?bs(Zo(r)).link:null)||r||t||e||n}class Al{constructor(e){var t,r,i,s,a,l;const h=bs(Zo(e)),f=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,m=gV((i=h.mode)!==null&&i!==void 0?i:null);O(f&&p&&m,"argument-error"),this.apiKey=f,this.operation=m,this.code=p,this.continueUrl=(s=h.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(l=h.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=mV(e);try{return new Al(t)}catch{return null}}}class Jr{constructor(){this.providerId=Jr.PROVIDER_ID}static credential(e,t){return Aa._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Al.parseLink(t);return O(r,"argument-error"),Aa._fromEmailAndCode(e,r.code,r.tenantId)}}Jr.PROVIDER_ID="password";Jr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Jr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class dr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class no extends dr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ks extends no{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return O("providerId"in t&&"signInMethod"in t,"argument-error"),$n._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return O(e.idToken||e.accessToken,"argument-error"),$n._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return ks.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ks.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:a,providerId:l}=e;if(!r&&!i&&!t&&!s||!l)return null;try{return new ks(l)._credential({idToken:t,accessToken:r,nonce:a,pendingToken:s})}catch{return null}}}class Sn extends no{constructor(){super("facebook.com")}static credential(e){return $n._fromParams({providerId:Sn.PROVIDER_ID,signInMethod:Sn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sn.credentialFromTaggedObject(e)}static credentialFromError(e){return Sn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sn.credential(e.oauthAccessToken)}catch{return null}}}Sn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Sn.PROVIDER_ID="facebook.com";class Pn extends no{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return $n._fromParams({providerId:Pn.PROVIDER_ID,signInMethod:Pn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Pn.credentialFromTaggedObject(e)}static credentialFromError(e){return Pn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Pn.credential(t,r)}catch{return null}}}Pn.GOOGLE_SIGN_IN_METHOD="google.com";Pn.PROVIDER_ID="google.com";class Cn extends no{constructor(){super("github.com")}static credential(e){return $n._fromParams({providerId:Cn.PROVIDER_ID,signInMethod:Cn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Cn.credentialFromTaggedObject(e)}static credentialFromError(e){return Cn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Cn.credential(e.oauthAccessToken)}catch{return null}}}Cn.GITHUB_SIGN_IN_METHOD="github.com";Cn.PROVIDER_ID="github.com";const _V="http://localhost";class Fs extends to{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return or(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,or(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,or(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new Fs(r,s)}static _create(e,t){return new Fs(e,t)}buildRequest(){return{requestUri:_V,returnSecureToken:!0,pendingToken:this.pendingToken}}}const yV="saml.";class zc extends dr{constructor(e){O(e.startsWith(yV),"argument-error"),super(e)}static credentialFromResult(e){return zc.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return zc.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Fs.fromJSON(e);return O(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return Fs._create(r,t)}catch{return null}}}class kn extends no{constructor(){super("twitter.com")}static credential(e,t){return $n._fromParams({providerId:kn.PROVIDER_ID,signInMethod:kn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return kn.credentialFromTaggedObject(e)}static credentialFromError(e){return kn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return kn.credential(t,r)}catch{return null}}}kn.TWITTER_SIGN_IN_METHOD="twitter.com";kn.PROVIDER_ID="twitter.com";async function bw(n,e){return hr(n,"POST","/v1/accounts:signUp",Ge(n,e))}class hn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await Si._fromIdTokenResponse(e,r,i),a=Zy(r);return new hn({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=Zy(r);return new hn({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function Zy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function vV(n){var e;const t=qe(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new hn({user:t.currentUser,providerId:null,operationType:"signIn"});const r=await bw(t,{returnSecureToken:!0}),i=await hn._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(i.user),i}class Kc extends Dt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Kc.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Kc(e,t,r,i)}}function Sw(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Kc._fromErrorAndOperation(n,s,e,r):s})}function Pw(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}async function IV(n,e){const t=H(n);await Rl(!0,t,e);const{providerUserInfo:r}=await AN(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=Pw(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function mp(n,e,t=!1){const r=await ur(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return hn._forOperation(n,"link",r)}async function Rl(n,e,t){await wa(e);const r=Pw(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";O(r.has(t)===n,e.auth,i)}async function Cw(n,e,t=!1){const{auth:r}=n,i="reauthenticate";try{const s=await ur(n,Sw(r,i,e,n),t);O(s.idToken,r,"internal-error");const a=El(s.idToken);O(a,r,"internal-error");const{sub:l}=a;return O(n.uid===l,r,"user-mismatch"),hn._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&_t(r,"user-mismatch"),s}}async function kw(n,e,t=!1){const r="signIn",i=await Sw(n,r,e),s=await hn._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function bl(n,e){return kw(qe(n),e)}async function Dw(n,e){const t=H(n);return await Rl(!1,t,e.providerId),mp(t,e)}async function xw(n,e){return Cw(H(n),e)}async function wV(n,e){return hr(n,"POST","/v1/accounts:signInWithCustomToken",Ge(n,e))}async function EV(n,e){const t=qe(n),r=await wV(t,{token:e,returnSecureToken:!0}),i=await hn._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}class Za{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?_p._fromServerResponse(e,t):"totpInfo"in t?yp._fromServerResponse(e,t):_t(e,"internal-error")}}class _p extends Za{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new _p(t)}}class yp extends Za{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new yp(t)}}function Sl(n,e,t){var r;O(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),O(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(O(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(O(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function vp(n){const e=qe(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function TV(n,e,t){const r=qe(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Sl(r,i,t),await Ta(r,i,"getOobCode",iV)}async function AV(n,e,t){await Rw(H(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&vp(n),r})}async function RV(n,e){await tV(H(n),{oobCode:e})}async function Nw(n,e){const t=H(n),r=await Rw(t,{oobCode:e}),i=r.requestType;switch(O(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":O(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":O(r.mfaInfo,t,"internal-error");default:O(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=Za._fromServerResponse(qe(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function bV(n,e){const{data:t}=await Nw(H(n),e);return t.email}async function SV(n,e,t){const r=qe(n),a=await Ta(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",bw).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&vp(n),h}),l=await hn._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function PV(n,e,t){return bl(H(n),Jr.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&vp(n),r})}async function CV(n,e,t){const r=qe(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(a,l){O(l.handleCodeInApp,r,"argument-error"),l&&Sl(r,a,l)}s(i,t),await Ta(r,i,"getOobCode",sV)}function kV(n,e){const t=Al.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function DV(n,e,t){const r=H(n),i=Jr.credentialWithLink(e,t||Ia());return O(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),bl(r,i)}async function xV(n,e){return ze(n,"POST","/v1/accounts:createAuthUri",Ge(n,e))}async function NV(n,e){const t=dp()?Ia():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await xV(H(n),r);return i||[]}async function VV(n,e){const t=H(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Sl(t.auth,i,e);const{email:s}=await rV(t.auth,i);s!==n.email&&await n.reload()}async function OV(n,e,t){const r=H(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Sl(r.auth,s,t);const{email:a}=await oV(r.auth,s);a!==n.email&&await n.reload()}async function LV(n,e){return ze(n,"POST","/v1/accounts:update",e)}async function MV(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=H(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},a=await ur(r,LV(r.auth,s));r.displayName=a.displayName||null,r.photoURL=a.photoUrl||null;const l=r.providerData.find(({providerId:h})=>h==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(a)}function FV(n,e){return Vw(H(n),e,null)}function UV(n,e){return Vw(H(n),null,e)}async function Vw(n,e,t){const{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);const a=await ur(n,ZN(r,s));await n._updateTokensIfNecessary(a,!0)}function BV(n){var e,t;if(!n)return null;const{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(n!=null&&n.idToken)){const a=(t=(e=El(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(a){const l=a!=="anonymous"&&a!=="custom"?a:null;return new Ds(s,l)}}if(!r)return null;switch(r){case"facebook.com":return new qV(s,i);case"github.com":return new $V(s,i);case"google.com":return new WV(s,i);case"twitter.com":return new GV(s,i,n.screenName||null);case"custom":case"anonymous":return new Ds(s,null);default:return new Ds(s,r,i)}}class Ds{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class Ow extends Ds{constructor(e,t,r,i){super(e,t,r),this.username=i}}class qV extends Ds{constructor(e,t){super(e,"facebook.com",t)}}class $V extends Ow{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class WV extends Ds{constructor(e,t){super(e,"google.com",t)}}class GV extends Ow{constructor(e,t,r){super(e,"twitter.com",t,r)}}function zV(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:BV(t)}class Ei{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new Ei("enroll",e,t)}static _fromMfaPendingCredential(e){return new Ei("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return Ei._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Ei._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Ip{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=qe(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(l=>Za._fromServerResponse(r,l));O(i.mfaPendingCredential,r,"internal-error");const a=Ei._fromMfaPendingCredential(i.mfaPendingCredential);return new Ip(a,s,async l=>{const h=await l._process(r,a);delete i.mfaInfo,delete i.mfaPendingCredential;const f=Object.assign(Object.assign({},i),{idToken:h.idToken,refreshToken:h.refreshToken});switch(t.operationType){case"signIn":const p=await hn._fromIdTokenResponse(r,t.operationType,f);return await r._updateCurrentUser(p.user),p;case"reauthenticate":return O(t.user,r,"internal-error"),hn._forOperation(t.user,t.operationType,f);default:_t(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function KV(n,e){var t;const r=H(n),i=e;return O(e.customData.operationType,r,"argument-error"),O((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),Ip._fromError(r,i)}function HV(n,e){return ze(n,"POST","/v2/accounts/mfaEnrollment:start",Ge(n,e))}function jV(n,e){return ze(n,"POST","/v2/accounts/mfaEnrollment:finalize",Ge(n,e))}function QV(n,e){return ze(n,"POST","/v2/accounts/mfaEnrollment:withdraw",Ge(n,e))}class wp{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Za._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new wp(e)}async getSession(){return Ei._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),s=await ur(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await ur(this.user,QV(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Kd=new WeakMap;function YV(n){const e=H(n);return Kd.has(e)||Kd.set(e,wp._fromUser(e)),Kd.get(e)}const Hc="__sak";class Lw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Hc,"1"),this.storage.removeItem(Hc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}function JV(){const n=Fe();return pp(n)||eo(n)}const XV=1e3,ZV=10;class Mw extends Lw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=JV()&&FN(),this.fallbackToPolling=ww(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,l,h)=>{this.notifyListeners(a,h)});return}const r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(r);if(e.newValue!==a)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);MN()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,ZV):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},XV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Mw.type="LOCAL";const Ep=Mw;class Fw extends Lw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Fw.type="SESSION";const xi=Fw;function eO(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Pl{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Pl(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(a).map(async f=>f(t.origin,s)),h=await eO(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Pl.receivers=[];function eu(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class tO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((l,h)=>{const f=eu("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(m){const I=m;if(I.data.eventId===f)switch(I.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(I.data.response);break;default:clearTimeout(p),clearTimeout(s),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Je(){return window}function nO(n){Je().location.href=n}function Tp(){return typeof Je().WorkerGlobalScope<"u"&&typeof Je().importScripts=="function"}async function rO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function iO(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function sO(){return Tp()?self:null}const Uw="firebaseLocalStorageDb",oO=1,jc="firebaseLocalStorage",Bw="fbase_key";class tu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Cl(n,e){return n.transaction([jc],e?"readwrite":"readonly").objectStore(jc)}function aO(){const n=indexedDB.deleteDatabase(Uw);return new tu(n).toPromise()}function pf(){const n=indexedDB.open(Uw,oO);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(jc,{keyPath:Bw})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(jc)?e(r):(r.close(),await aO(),e(await pf()))})})}async function ev(n,e,t){const r=Cl(n,!0).put({[Bw]:e,value:t});return new tu(r).toPromise()}async function uO(n,e){const t=Cl(n,!1).get(e),r=await new tu(t).toPromise();return r===void 0?null:r.value}function tv(n,e){const t=Cl(n,!0).delete(e);return new tu(t).toPromise()}const cO=800,lO=3;class qw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>lO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Tp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Pl._getInstance(sO()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await rO(),!this.activeServiceWorker)return;this.sender=new tO(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||iO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pf();return await ev(e,Hc,"1"),await tv(e,Hc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>ev(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>uO(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>tv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Cl(i,!1).getAll();return new tu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),cO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}qw.type="LOCAL";const Ra=qw;function hO(n,e){return ze(n,"POST","/v2/accounts/mfaSignIn:start",Ge(n,e))}function dO(n,e){return ze(n,"POST","/v2/accounts/mfaSignIn:finalize",Ge(n,e))}const fO=500,pO=6e4,_c=1e12;class gO{constructor(e){this.auth=e,this.counter=_c,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new mO(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;const r=e||_c;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;const r=e||_c;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const r=e||_c;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}}class mO{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;O(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=_O(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},pO)},fO))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function _O(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const Hd=Tw("rcb"),yO=new Ja(3e4,6e4),vO="https://www.google.com/recaptcha/api.js?";class IO{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=Je().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return O(wO(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Ky(Je().grecaptcha)?Promise.resolve(Je().grecaptcha):new Promise((r,i)=>{const s=Je().setTimeout(()=>{i(gt(e,"network-request-failed"))},yO.get());Je()[Hd]=()=>{Je().clearTimeout(s),delete Je()[Hd];const l=Je().grecaptcha;if(!l||!Ky(l)){i(gt(e,"internal-error"));return}const h=l.render;l.render=(f,p)=>{const m=h(f,p);return this.counter++,m},this.hostLanguage=t,r(l)};const a=`${vO}?${Xs({onload:Hd,render:"explicit",hl:t})}`;gp(a).catch(()=>{clearTimeout(s),i(gt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=Je().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function wO(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class EO{async load(e){return new gO(e)}clearedOneInstance(){}}const $w="recaptcha",TO={theme:"light",type:"image"};let AO=class{constructor(e,t,r=Object.assign({},TO)){this.parameters=r,this.type=$w,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=qe(e),this.isInvisible=this.parameters.size==="invisible",O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;O(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new EO:new IO,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const s=a=>{a&&(this.tokenChangeListeners.delete(s),i(a))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){O(!this.parameters.sitekey,this.auth,"argument-error"),O(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),O(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=Je()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){O(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){O(dp()&&!Tp(),this.auth,"internal-error"),await RO(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await wN(this.auth);O(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return O(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function RO(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}class Ap{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Ci._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function bO(n,e,t){const r=qe(n),i=await kl(r,e,H(t));return new Ap(i,s=>bl(r,s))}async function SO(n,e,t){const r=H(n);await Rl(!1,r,"phone");const i=await kl(r.auth,e,H(t));return new Ap(i,s=>Dw(r,s))}async function PO(n,e,t){const r=H(n),i=await kl(r.auth,e,H(t));return new Ap(i,s=>xw(r,s))}async function kl(n,e,t){var r;const i=await t.verify();try{O(typeof i=="string",n,"argument-error"),O(t.type===$w,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const a=s.session;if("phoneNumber"in s)return O(a.type==="enroll",n,"internal-error"),(await HV(n,{idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{O(a.type==="signin",n,"internal-error");const l=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return O(l,n,"missing-multi-factor-info"),(await hO(n,{mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:a}=await lV(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return a}}finally{t._reset()}}async function CO(n,e){await mp(H(n),e)}let Fn=class{constructor(e){this.providerId=Fn.PROVIDER_ID,this.auth=qe(e)}verifyPhoneNumber(e,t){return kl(this.auth,e,H(t))}static credential(e,t){return Ci._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Fn.credentialFromTaggedObject(t)}static credentialFromError(e){return Fn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?Ci._fromTokenResponse(t,r):null}};Fn.PROVIDER_ID="phone";Fn.PHONE_SIGN_IN_METHOD="phone";function zi(n,e){return e?Jt(e):(O(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Rp extends to{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return or(e,this._buildIdpRequest())}_linkToIdToken(e,t){return or(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return or(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function kO(n){return kw(n.auth,new Rp(n),n.bypassAuthState)}function DO(n){const{auth:e,user:t}=n;return O(t,e,"internal-error"),Cw(t,new Rp(n),n.bypassAuthState)}async function xO(n){const{auth:e,user:t}=n;return O(t,e,"internal-error"),mp(t,new Rp(n),n.bypassAuthState)}class Ww{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:l}=e;if(a){this.reject(a);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(h))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return kO;case"linkViaPopup":case"linkViaRedirect":return xO;case"reauthViaPopup":case"reauthViaRedirect":return DO;default:_t(this.auth,"internal-error")}}resolve(e){vn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){vn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const NO=new Ja(2e3,1e4);async function VO(n,e,t){const r=qe(n);Zs(n,e,dr);const i=zi(r,t);return new nr(r,"signInViaPopup",e,i).executeNotNull()}async function OO(n,e,t){const r=H(n);Zs(r.auth,e,dr);const i=zi(r.auth,t);return new nr(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function LO(n,e,t){const r=H(n);Zs(r.auth,e,dr);const i=zi(r.auth,t);return new nr(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class nr extends Ww{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,nr.currentPopupAction&&nr.currentPopupAction.cancel(),nr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return O(e,this.auth,"internal-error"),e}async onExecution(){vn(this.filter.length===1,"Popup operations only handle one event");const e=eu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(gt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(gt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(gt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,NO.get())};e()}}nr.currentPopupAction=null;const MO="pendingRedirect",ua=new Map;class FO extends Ww{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=ua.get(this.auth._key());if(!e){try{const r=await UO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}ua.set(this.auth._key(),e)}return this.bypassAuthState||ua.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function UO(n,e){const t=zw(e),r=Gw(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function bp(n,e){return Gw(n)._set(zw(e),"true")}function BO(){ua.clear()}function Sp(n,e){ua.set(n._key(),e)}function Gw(n){return Jt(n._redirectPersistence)}function zw(n){return Pi(MO,n.config.apiKey,n.name)}function qO(n,e,t){return $O(n,e,t)}async function $O(n,e,t){const r=qe(n);Zs(n,e,dr),await r._initializationPromise;const i=zi(r,t);return await bp(i,r),i._openRedirect(r,e,"signInViaRedirect")}function WO(n,e,t){return GO(n,e,t)}async function GO(n,e,t){const r=H(n);Zs(r.auth,e,dr),await r.auth._initializationPromise;const i=zi(r.auth,t);await bp(i,r.auth);const s=await Kw(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function zO(n,e,t){return KO(n,e,t)}async function KO(n,e,t){const r=H(n);Zs(r.auth,e,dr),await r.auth._initializationPromise;const i=zi(r.auth,t);await Rl(!1,r,e.providerId),await bp(i,r.auth);const s=await Kw(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function HO(n,e){return await qe(n)._initializationPromise,Dl(n,e,!1)}async function Dl(n,e,t=!1){const r=qe(n),i=zi(r,e),a=await new FO(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}async function Kw(n){const e=eu(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}const jO=10*60*1e3;class Hw{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!QO(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!jw(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(gt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jO&&this.cachedEventUids.clear(),this.cachedEventUids.has(nv(e))}saveEventToCache(e){this.cachedEventUids.add(nv(e)),this.lastProcessedEventTime=Date.now()}}function nv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function jw({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function QO(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return jw(n);default:return!1}}async function Qw(n,e={}){return ze(n,"GET","/v1/projects",e)}const YO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,JO=/^https?/;async function XO(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Qw(n);for(const t of e)try{if(ZO(t))return}catch{}_t(n,"unauthorized-domain")}function ZO(n){const e=Ia(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!JO.test(t))return!1;if(YO.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const eL=new Ja(3e4,6e4);function rv(){const n=Je().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function tL(n){return new Promise((e,t)=>{var r,i,s;function a(){rv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rv(),t(gt(n,"network-request-failed"))},timeout:eL.get()})}if(!((i=(r=Je().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Je().gapi)===null||s===void 0)&&s.load)a();else{const l=Tw("iframefcb");return Je()[l]=()=>{gapi.load?a():t(gt(n,"network-request-failed"))},gp(`https://apis.google.com/js/api.js?onload=${l}`).catch(h=>t(h))}}).catch(e=>{throw kc=null,e})}let kc=null;function nL(n){return kc=kc||tL(n),kc}const rL=new Ja(5e3,15e3),iL="__/auth/iframe",sL="emulator/auth/iframe",oL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},aL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uL(n){const e=n.config;O(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?fp(e,sL):`https://${n.config.authDomain}/${iL}`,r={apiKey:e.apiKey,appName:n.name,v:Yr},i=aL.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Xs(r).slice(1)}`}async function cL(n){const e=await nL(n),t=Je().gapi;return O(t,n,"internal-error"),e.open({where:document.body,url:uL(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:oL,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=gt(n,"network-request-failed"),l=Je().setTimeout(()=>{s(a)},rL.get());function h(){Je().clearTimeout(l),i(r)}r.ping(h).then(h,()=>{s(a)})}))}const lL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hL=500,dL=600,fL="_blank",pL="http://localhost";class iv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function gL(n,e,t,r=hL,i=dL){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const h=Object.assign(Object.assign({},lL),{width:r.toString(),height:i.toString(),top:s,left:a}),f=Fe().toLowerCase();t&&(l=_w(f)?fL:t),mw(f)&&(e=e||pL,h.scrollbars="yes");const p=Object.entries(h).reduce((I,[A,L])=>`${I}${A}=${L},`,"");if(LN(f)&&l!=="_self")return mL(e||"",l),new iv(null);const m=window.open(e||"",l,p);O(m,n,"popup-blocked");try{m.focus()}catch{}return new iv(m)}function mL(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const _L="__/auth/handler",yL="emulator/auth/handler",vL=encodeURIComponent("fac");async function gf(n,e,t,r,i,s){O(n.config.authDomain,n,"auth-domain-config-required"),O(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Yr,eventId:i};if(e instanceof dr){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",$D(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries(s||{}))a[p]=m}if(e instanceof no){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);const l=a;for(const p of Object.keys(l))l[p]===void 0&&delete l[p];const h=await n._getAppCheckToken(),f=h?`#${vL}=${encodeURIComponent(h)}`:"";return`${IL(n)}?${Xs(l).slice(1)}${f}`}function IL({config:n}){return n.emulator?fp(n,yL):`https://${n.authDomain}/${_L}`}const jd="webStorageSupport";class wL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xi,this._completeRedirectFn=Dl,this._overrideRedirectResult=Sp}async _openPopup(e,t,r,i){var s;vn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await gf(e,t,r,Ia(),i);return gL(e,a,eu())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await gf(e,t,r,Ia(),i);return nO(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(vn(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await cL(e),r=new Hw(e);return t.register("authEvent",i=>(O(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(jd,{type:jd},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[jd];a!==void 0&&t(!!a),_t(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=XO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ww()||pp()||eo()}}const EL=wL;class TL{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return xn("unexpected MultiFactorSessionType")}}}class Pp extends TL{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Pp(e)}_finalizeEnroll(e,t,r){return jV(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return dO(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Yw{constructor(){}static assertion(e){return Pp._fromCredential(e)}}Yw.FACTOR_ID="phone";var sv="@firebase/auth",ov="1.5.1";class AL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){O(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function RL(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function bL(n){Ur(new qn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;O(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:a,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ew(n)},f=new WN(r,i,s,h);return QN(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ur(new qn("auth-internal",e=>{const t=qe(e.getProvider("auth").getImmediate());return(r=>new AL(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Mn(sv,ov,RL(n)),Mn(sv,ov,"esm2017")}const SL=5*60;xD("authIdTokenMaxAge");bL("Browser");function Ni(){return window}const PL=2e3;async function CL(n,e,t){var r;const{BuildInfo:i}=Ni();vn(e.sessionId,"AuthEvent did not contain a session ID");const s=await VL(e.sessionId),a={};return eo()?a.ibi=i.packageName:Xa()?a.apn=i.packageName:_t(n,"operation-not-supported-in-this-environment"),i.displayName&&(a.appDisplayName=i.displayName),a.sessionId=s,gf(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,a)}async function kL(n){const{BuildInfo:e}=Ni(),t={};eo()?t.iosBundleId=e.packageName:Xa()?t.androidPackageName=e.packageName:_t(n,"operation-not-supported-in-this-environment"),await Qw(n,t)}function DL(n){const{cordova:e}=Ni();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,ON()?"_blank":"_system","location=yes"),t(i)})})}async function xL(n,e,t){const{cordova:r}=Ni();let i=()=>{};try{await new Promise((s,a)=>{let l=null;function h(){var m;s();const I=(m=r.plugins.browsertab)===null||m===void 0?void 0:m.close;typeof I=="function"&&I(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function f(){l||(l=window.setTimeout(()=>{a(gt(n,"redirect-cancelled-by-user"))},PL))}function p(){(document==null?void 0:document.visibilityState)==="visible"&&f()}e.addPassiveListener(h),document.addEventListener("resume",f,!1),Xa()&&document.addEventListener("visibilitychange",p,!1),i=()=>{e.removePassiveListener(h),document.removeEventListener("resume",f,!1),document.removeEventListener("visibilitychange",p,!1),l&&window.clearTimeout(l)}})}finally{i()}}function NL(n){var e,t,r,i,s,a,l,h,f,p;const m=Ni();O(typeof((e=m==null?void 0:m.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),O(typeof((t=m==null?void 0:m.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),O(typeof((s=(i=(r=m==null?void 0:m.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((h=(l=(a=m==null?void 0:m.cordova)===null||a===void 0?void 0:a.plugins)===null||l===void 0?void 0:l.browsertab)===null||h===void 0?void 0:h.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),O(typeof((p=(f=m==null?void 0:m.cordova)===null||f===void 0?void 0:f.InAppBrowser)===null||p===void 0?void 0:p.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function VL(n){const e=OL(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function OL(n){if(vn(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}const LL=20;class ML extends Hw{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function FL(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:qL(),postBody:null,tenantId:n.tenantId,error:gt(n,"no-auth-event")}}function UL(n,e){return mf()._set(_f(n),e)}async function av(n){const e=await mf()._get(_f(n));return e&&await mf()._remove(_f(n)),e}function BL(n,e){var t,r;const i=WL(e);if(i.includes("/__/auth/callback")){const s=Dc(i),a=s.firebaseError?$L(decodeURIComponent(s.firebaseError)):null,l=(r=(t=a==null?void 0:a.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],h=l?gt(l):null;return h?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:h,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function qL(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<LL;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function mf(){return Jt(Ep)}function _f(n){return Pi("authEvent",n.config.apiKey,n.name)}function $L(n){try{return JSON.parse(n)}catch{return null}}function WL(n){const e=Dc(n),t=e.link?decodeURIComponent(e.link):void 0,r=Dc(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Dc(i).link||i||r||t||n}function Dc(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return bs(t.join("?"))}const GL=500;class zL{constructor(){this._redirectPersistence=xi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Dl,this._overrideRedirectResult=Sp}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new ML(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){_t(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){NL(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),BO(),await this._originValidation(e);const a=FL(e,r,i);await UL(e,a);const l=await CL(e,a,t),h=await DL(l);return xL(e,s,h)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=kL(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Ni(),a=setTimeout(async()=>{await av(e),t.onEvent(uv())},GL),l=async p=>{clearTimeout(a);const m=await av(e);let I=null;m&&(p!=null&&p.url)&&(I=BL(m,p.url)),t.onEvent(I||uv())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,l);const h=i,f=`${s.packageName.toLowerCase()}://`;Ni().handleOpenURL=async p=>{if(p.toLowerCase().startsWith(f)&&l({url:p}),typeof h=="function")try{h(p)}catch(m){console.error(m)}}}}const KL=zL;function uv(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:gt("no-auth-event")}}function HL(n,e){qe(n)._logFramework(e)}var jL="@firebase/auth-compat",QL="0.5.1";const YL=1e3;function ca(){var n;return((n=self==null?void 0:self.location)===null||n===void 0?void 0:n.protocol)||null}function JL(){return ca()==="http:"||ca()==="https:"}function Jw(n=Fe()){return!!((ca()==="file:"||ca()==="ionic:"||ca()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function XL(){return op()||sp()}function ZL(){return QI()&&(document==null?void 0:document.documentMode)===11}function eM(n=Fe()){return/Edge\/\d+/.test(n)}function tM(n=Fe()){return ZL()||eM(n)}function Xw(){try{const n=self.localStorage,e=eu();if(n)return n.setItem(e,"1"),n.removeItem(e),tM()?_a():!0}catch{return Cp()&&_a()}return!1}function Cp(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Qd(){return(JL()||jI()||Jw())&&!XL()&&Xw()&&!Cp()}function Zw(){return Jw()&&typeof document<"u"}async function nM(){return Zw()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},YL);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function rM(){return typeof window<"u"?window:null}const Yt={LOCAL:"local",NONE:"none",SESSION:"session"},Uo=O,eE="persistence";function iM(n,e){if(Uo(Object.values(Yt).includes(e),n,"invalid-persistence-type"),op()){Uo(e!==Yt.SESSION,n,"unsupported-persistence-type");return}if(sp()){Uo(e===Yt.NONE,n,"unsupported-persistence-type");return}if(Cp()){Uo(e===Yt.NONE||e===Yt.LOCAL&&_a(),n,"unsupported-persistence-type");return}Uo(e===Yt.NONE||Xw(),n,"unsupported-persistence-type")}async function yf(n){await n._initializationPromise;const e=tE(),t=Pi(eE,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())}function sM(n,e){const t=tE();if(!t)return[];const r=Pi(eE,n,e);switch(t.getItem(r)){case Yt.NONE:return[Ms];case Yt.LOCAL:return[Ra,xi];case Yt.SESSION:return[xi];default:return[]}}function tE(){var n;try{return((n=rM())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}const oM=O;class Nr{constructor(){this.browserResolver=Jt(EL),this.cordovaResolver=Jt(KL),this.underlyingResolver=null,this._redirectPersistence=xi,this._completeRedirectFn=Dl,this._overrideRedirectResult=Sp}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return Zw()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return oM(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await nM();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function nE(n){return n.unwrap()}function aM(n){return n.wrapped()}function uM(n){return rE(n)}function cM(n,e){var t;const r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new lM(n,KV(n,e))}else if(r){const i=rE(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function rE(n){const{_tokenResponse:e}=n instanceof Dt?n.customData:n;if(!e)return null;if(!(n instanceof Dt)&&"temporaryProof"in e&&"phoneNumber"in e)return Fn.credentialFromResult(n);const t=e.providerId;if(!t||t===Fo.PASSWORD)return null;let r;switch(t){case Fo.GOOGLE:r=Pn;break;case Fo.FACEBOOK:r=Sn;break;case Fo.GITHUB:r=Cn;break;case Fo.TWITTER:r=kn;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:h}=e;return!s&&!a&&!i&&!l?null:l?t.startsWith("saml.")?Fs._create(t,l):$n._fromParams({providerId:t,signInMethod:t,pendingToken:l,idToken:i,accessToken:s}):new ks(t).credential({idToken:i,accessToken:s,rawNonce:h})}return n instanceof Dt?r.credentialFromError(n):r.credentialFromResult(n)}function Ut(n,e){return e.catch(t=>{throw t instanceof Dt&&cM(n,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:uM(t),additionalUserInfo:zV(t),user:Vr.getOrCreate(i)}})}async function vf(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>Ut(n,t.confirm(r))}}class lM{constructor(e,t){this.resolver=t,this.auth=aM(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Ut(nE(this.auth),this.resolver.resolveSignIn(e))}}let Vr=class{constructor(e){this._delegate=e,this.multiFactor=YV(e)}static getOrCreate(e){return Vr.USER_MAP.has(e)||Vr.USER_MAP.set(e,new Vr(e)),Vr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Ut(this.auth,Dw(this._delegate,e))}async linkWithPhoneNumber(e,t){return vf(this.auth,SO(this._delegate,e,t))}async linkWithPopup(e){return Ut(this.auth,LO(this._delegate,e,Nr))}async linkWithRedirect(e){return await yf(qe(this.auth)),zO(this._delegate,e,Nr)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Ut(this.auth,xw(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return vf(this.auth,PO(this._delegate,e,t))}reauthenticateWithPopup(e){return Ut(this.auth,OO(this._delegate,e,Nr))}async reauthenticateWithRedirect(e){return await yf(qe(this.auth)),WO(this._delegate,e,Nr)}sendEmailVerification(e){return VV(this._delegate,e)}async unlink(e){return await IV(this._delegate,e),this}updateEmail(e){return FV(this._delegate,e)}updatePassword(e){return UV(this._delegate,e)}updatePhoneNumber(e){return CO(this._delegate,e)}updateProfile(e){return MV(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return OV(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Vr.USER_MAP=new WeakMap;const Bo=O;class If{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Bo(r,"invalid-api-key",{appName:e.name}),Bo(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?Nr:void 0;this._delegate=t.initialize({options:{persistence:hM(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(hN),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Vr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){YN(this._delegate,e,t)}applyActionCode(e){return RV(this._delegate,e)}checkActionCode(e){return Nw(this._delegate,e)}confirmPasswordReset(e,t){return AV(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Ut(this._delegate,SV(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return NV(this._delegate,e)}isSignInWithEmailLink(e){return kV(this._delegate,e)}async getRedirectResult(){Bo(Qd(),this._delegate,"operation-not-supported-in-this-environment");const e=await HO(this._delegate,Nr);return e?Ut(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){HL(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:s,complete:a}=cv(e,t,r);return this._delegate.onAuthStateChanged(i,s,a)}onIdTokenChanged(e,t,r){const{next:i,error:s,complete:a}=cv(e,t,r);return this._delegate.onIdTokenChanged(i,s,a)}sendSignInLinkToEmail(e,t){return CV(this._delegate,e,t)}sendPasswordResetEmail(e,t){return TV(this._delegate,e,t||void 0)}async setPersistence(e){iM(this._delegate,e);let t;switch(e){case Yt.SESSION:t=xi;break;case Yt.LOCAL:t=await Jt(Ra)._isAvailable()?Ra:Ep;break;case Yt.NONE:t=Ms;break;default:return _t("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Ut(this._delegate,vV(this._delegate))}signInWithCredential(e){return Ut(this._delegate,bl(this._delegate,e))}signInWithCustomToken(e){return Ut(this._delegate,EV(this._delegate,e))}signInWithEmailAndPassword(e,t){return Ut(this._delegate,PV(this._delegate,e,t))}signInWithEmailLink(e,t){return Ut(this._delegate,DV(this._delegate,e,t))}signInWithPhoneNumber(e,t){return vf(this._delegate,bO(this._delegate,e,t))}async signInWithPopup(e){return Bo(Qd(),this._delegate,"operation-not-supported-in-this-environment"),Ut(this._delegate,VO(this._delegate,e,Nr))}async signInWithRedirect(e){return Bo(Qd(),this._delegate,"operation-not-supported-in-this-environment"),await yf(this._delegate),qO(this._delegate,e,Nr)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return bV(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}If.Persistence=Yt;function cv(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const i=r;return{next:a=>i(a&&Vr.getOrCreate(a)),error:e,complete:t}}function hM(n,e){const t=sM(n,e);if(typeof self<"u"&&!t.includes(Ra)&&t.push(Ra),typeof window<"u")for(const r of[Ep,xi])t.includes(r)||t.push(r);return t.includes(Ms)||t.push(Ms),t}class kp{constructor(){this.providerId="phone",this._delegate=new Fn(nE(Br.auth()))}static credential(e,t){return Fn.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}kp.PHONE_SIGN_IN_METHOD=Fn.PHONE_SIGN_IN_METHOD;kp.PROVIDER_ID=Fn.PROVIDER_ID;const dM=O;class fM{constructor(e,t,r=Br.app()){var i;dM((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new AO(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const pM="auth-compat";function gM(n){n.INTERNAL.registerComponent(new qn(pM,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new If(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:gs.EMAIL_SIGNIN,PASSWORD_RESET:gs.PASSWORD_RESET,RECOVER_EMAIL:gs.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:gs.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:gs.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:gs.VERIFY_EMAIL}},EmailAuthProvider:Jr,FacebookAuthProvider:Sn,GithubAuthProvider:Cn,GoogleAuthProvider:Pn,OAuthProvider:ks,SAMLAuthProvider:zc,PhoneAuthProvider:kp,PhoneMultiFactorGenerator:Yw,RecaptchaVerifier:fM,TwitterAuthProvider:kn,Auth:If,AuthCredential:to,Error:Dt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(jL,QL)}gM(Br);var mM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},q,Dp=Dp||{},Z=mM||self;function xl(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function nu(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function _M(n){return Object.prototype.hasOwnProperty.call(n,Yd)&&n[Yd]||(n[Yd]=++yM)}var Yd="closure_uid_"+(1e9*Math.random()>>>0),yM=0;function vM(n,e,t){return n.call.apply(n.bind,arguments)}function IM(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function Et(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Et=vM:Et=IM,Et.apply(null,arguments)}function yc(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ot(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var a=Array(arguments.length-2),l=2;l<arguments.length;l++)a[l-2]=arguments[l];return e.prototype[i].apply(r,a)}}function Xr(){this.s=this.s,this.o=this.o}var wM=0;Xr.prototype.s=!1;Xr.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),wM!=0)&&_M(this)};Xr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const iE=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function xp(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function lv(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(xl(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let a=0;a<s;a++)n[i+a]=r[a]}else n.push(r)}}function Tt(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Tt.prototype.h=function(){this.defaultPrevented=!0};var EM=function(){if(!Z.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const t=()=>{};Z.addEventListener("test",t,e),Z.removeEventListener("test",t,e)}catch{}return n}();function ba(n){return/^[\s\xa0]*$/.test(n)}function Nl(){var n=Z.navigator;return n&&(n=n.userAgent)?n:""}function Dn(n){return Nl().indexOf(n)!=-1}function Np(n){return Np[" "](n),n}Np[" "]=function(){};function TM(n,e){var t=gF;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}var AM=Dn("Opera"),Us=Dn("Trident")||Dn("MSIE"),sE=Dn("Edge"),wf=sE||Us,oE=Dn("Gecko")&&!(Nl().toLowerCase().indexOf("webkit")!=-1&&!Dn("Edge"))&&!(Dn("Trident")||Dn("MSIE"))&&!Dn("Edge"),RM=Nl().toLowerCase().indexOf("webkit")!=-1&&!Dn("Edge");function aE(){var n=Z.document;return n?n.documentMode:void 0}var Ef;e:{var Jd="",Xd=function(){var n=Nl();if(oE)return/rv:([^\);]+)(\)|;)/.exec(n);if(sE)return/Edge\/([\d\.]+)/.exec(n);if(Us)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(RM)return/WebKit\/(\S+)/.exec(n);if(AM)return/(?:Version)[ \/]?(\S+)/.exec(n)}();if(Xd&&(Jd=Xd?Xd[1]:""),Us){var Zd=aE();if(Zd!=null&&Zd>parseFloat(Jd)){Ef=String(Zd);break e}}Ef=Jd}var Tf;if(Z.document&&Us){var hv=aE();Tf=hv||parseInt(Ef,10)||void 0}else Tf=void 0;var bM=Tf;function Sa(n,e){if(Tt.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(oE){e:{try{Np(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:SM[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Sa.$.h.call(this)}}ot(Sa,Tt);var SM={2:"touch",3:"pen",4:"mouse"};Sa.prototype.h=function(){Sa.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var ru="closure_listenable_"+(1e6*Math.random()|0),PM=0;function CM(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++PM,this.fa=this.ia=!1}function Vl(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function Vp(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function kM(n,e){for(const t in n)e.call(void 0,n[t],t,n)}function uE(n){const e={};for(const t in n)e[t]=n[t];return e}const dv="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function cE(n,e){let t,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(t in r)n[t]=r[t];for(let s=0;s<dv.length;s++)t=dv[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Ol(n){this.src=n,this.g={},this.h=0}Ol.prototype.add=function(n,e,t,r,i){var s=n.toString();n=this.g[s],n||(n=this.g[s]=[],this.h++);var a=Rf(n,e,r,i);return-1<a?(e=n[a],t||(e.ia=!1)):(e=new CM(e,this.src,s,!!r,i),e.ia=t,n.push(e)),e};function Af(n,e){var t=e.type;if(t in n.g){var r=n.g[t],i=iE(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Vl(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function Rf(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}var Op="closure_lm_"+(1e6*Math.random()|0),ef={};function lE(n,e,t,r,i){if(r&&r.once)return dE(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)lE(n,e[s],t,r,i);return null}return t=Fp(t),n&&n[ru]?n.O(e,t,nu(r)?!!r.capture:!!r,i):hE(n,e,t,!1,r,i)}function hE(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var a=nu(i)?!!i.capture:!!i,l=Mp(n);if(l||(n[Op]=l=new Ol(n)),t=l.add(e,t,r,a,s),t.proxy)return t;if(r=DM(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)EM||(i=a),i===void 0&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(pE(e.toString()),r);else if(n.addListener&&n.removeListener)n.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return t}function DM(){function n(t){return e.call(n.src,n.listener,t)}const e=xM;return n}function dE(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)dE(n,e[s],t,r,i);return null}return t=Fp(t),n&&n[ru]?n.P(e,t,nu(r)?!!r.capture:!!r,i):hE(n,e,t,!0,r,i)}function fE(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)fE(n,e[s],t,r,i);else r=nu(r)?!!r.capture:!!r,t=Fp(t),n&&n[ru]?(n=n.i,e=String(e).toString(),e in n.g&&(s=n.g[e],t=Rf(s,t,r,i),-1<t&&(Vl(s[t]),Array.prototype.splice.call(s,t,1),s.length==0&&(delete n.g[e],n.h--)))):n&&(n=Mp(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Rf(e,t,r,i)),(t=-1<n?e[n]:null)&&Lp(t))}function Lp(n){if(typeof n!="number"&&n&&!n.fa){var e=n.src;if(e&&e[ru])Af(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(pE(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=Mp(e))?(Af(t,n),t.h==0&&(t.src=null,e[Op]=null)):Vl(n)}}}function pE(n){return n in ef?ef[n]:ef[n]="on"+n}function xM(n,e){if(n.fa)n=!0;else{e=new Sa(e,this);var t=n.listener,r=n.la||n.src;n.ia&&Lp(n),n=t.call(r,e)}return n}function Mp(n){return n=n[Op],n instanceof Ol?n:null}var tf="__closure_events_fn_"+(1e9*Math.random()>>>0);function Fp(n){return typeof n=="function"?n:(n[tf]||(n[tf]=function(e){return n.handleEvent(e)}),n[tf])}function st(){Xr.call(this),this.i=new Ol(this),this.S=this,this.J=null}ot(st,Xr);st.prototype[ru]=!0;st.prototype.removeEventListener=function(n,e,t,r){fE(this,n,e,t,r)};function mt(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,typeof e=="string")e=new Tt(e,n);else if(e instanceof Tt)e.target=e.target||n;else{var i=e;e=new Tt(r,n),cE(e,i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var a=e.g=t[s];i=vc(a,r,!0,e)&&i}if(a=e.g=n,i=vc(a,r,!0,e)&&i,i=vc(a,r,!1,e)&&i,t)for(s=0;s<t.length;s++)a=e.g=t[s],i=vc(a,r,!1,e)&&i}st.prototype.N=function(){if(st.$.N.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Vl(t[r]);delete n.g[e],n.h--}}this.J=null};st.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)};st.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};function vc(n,e,t,r){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==t){var l=a.listener,h=a.la||a.src;a.ia&&Af(n.i,a),i=l.call(h,r)!==!1&&i}}return i&&!r.defaultPrevented}var Up=Z.JSON.stringify;class NM{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function VM(){var n=Bp;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}class OM{constructor(){this.h=this.g=null}add(e,t){const r=gE.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}}var gE=new NM(()=>new LM,n=>n.reset());class LM{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function MM(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function FM(n){Z.setTimeout(()=>{throw n},0)}let Pa,Ca=!1,Bp=new OM,mE=()=>{const n=Z.Promise.resolve(void 0);Pa=()=>{n.then(UM)}};var UM=()=>{for(var n;n=VM();){try{n.h.call(n.g)}catch(t){FM(t)}var e=gE;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Ca=!1};function Ll(n,e){st.call(this),this.h=n||1,this.g=e||Z,this.j=Et(this.qb,this),this.l=Date.now()}ot(Ll,st);q=Ll.prototype;q.ga=!1;q.T=null;q.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),mt(this,"tick"),this.ga&&(qp(this),this.start()))}};q.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function qp(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}q.N=function(){Ll.$.N.call(this),qp(this),delete this.g};function $p(n,e,t){if(typeof n=="function")t&&(n=Et(n,t));else if(n&&typeof n.handleEvent=="function")n=Et(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Z.setTimeout(n,e||0)}function _E(n){n.g=$p(()=>{n.g=null,n.i&&(n.i=!1,_E(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}class BM extends Xr{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:_E(this)}N(){super.N(),this.g&&(Z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ka(n){Xr.call(this),this.h=n,this.g={}}ot(ka,Xr);var fv=[];function yE(n,e,t,r){Array.isArray(t)||(t&&(fv[0]=t.toString()),t=fv);for(var i=0;i<t.length;i++){var s=lE(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function vE(n){Vp(n.g,function(e,t){this.g.hasOwnProperty(t)&&Lp(e)},n),n.g={}}ka.prototype.N=function(){ka.$.N.call(this),vE(this)};ka.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Ml(){this.g=!0}Ml.prototype.Ea=function(){this.g=!1};function qM(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var a="",l=s.split("&"),h=0;h<l.length;h++){var f=l[h].split("=");if(1<f.length){var p=f[0];f=f[1];var m=p.split("_");a=2<=m.length&&m[1]=="type"?a+(p+"="+f+"&"):a+(p+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+t+`
`+a})}function $M(n,e,t,r,i,s,a){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+t+`
`+s+" "+a})}function Ss(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+GM(n,t)+(r?" "+r:"")})}function WM(n,e){n.info(function(){return"TIMEOUT: "+e})}Ml.prototype.info=function(){};function GM(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return Up(t)}catch{return e}}var Ki={},pv=null;function Fl(){return pv=pv||new st}Ki.Ta="serverreachability";function IE(n){Tt.call(this,Ki.Ta,n)}ot(IE,Tt);function Da(n){const e=Fl();mt(e,new IE(e))}Ki.STAT_EVENT="statevent";function wE(n,e){Tt.call(this,Ki.STAT_EVENT,n),this.stat=e}ot(wE,Tt);function kt(n){const e=Fl();mt(e,new wE(e,n))}Ki.Ua="timingevent";function EE(n,e){Tt.call(this,Ki.Ua,n),this.size=e}ot(EE,Tt);function iu(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return Z.setTimeout(function(){n()},e)}var Ul={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},TE={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Wp(){}Wp.prototype.h=null;function gv(n){return n.h||(n.h=n.i())}function AE(){}var su={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Gp(){Tt.call(this,"d")}ot(Gp,Tt);function zp(){Tt.call(this,"c")}ot(zp,Tt);var bf;function Bl(){}ot(Bl,Wp);Bl.prototype.g=function(){return new XMLHttpRequest};Bl.prototype.i=function(){return{}};bf=new Bl;function ou(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new ka(this),this.P=zM,n=wf?125:void 0,this.V=new Ll(n),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new RE}function RE(){this.i=null,this.g="",this.h=!1}var zM=45e3,bE={},Sf={};q=ou.prototype;q.setTimeout=function(n){this.P=n};function Pf(n,e,t){n.L=1,n.A=$l(cr(e)),n.u=t,n.S=!0,SE(n,null)}function SE(n,e){n.G=Date.now(),au(n),n.B=cr(n.A);var t=n.B,r=n.W;Array.isArray(r)||(r=[String(r)]),OE(t.i,"t",r),n.o=0,t=n.l.J,n.h=new RE,n.g=nT(n.l,t?e:null,!n.u),0<n.O&&(n.M=new BM(Et(n.Pa,n,n.g),n.O)),yE(n.U,n.g,"readystatechange",n.nb),e=n.I?uE(n.I):{},n.u?(n.v||(n.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,e)):(n.v="GET",n.g.ha(n.B,n.v,null,e)),Da(),qM(n.j,n.v,n.B,n.m,n.W,n.u)}q.nb=function(n){n=n.target;const e=this.M;e&&Nn(n)==3?e.l():this.Pa(n)};q.Pa=function(n){try{if(n==this.g)e:{const p=Nn(this.g);var e=this.g.Ia();const m=this.g.da();if(!(3>p)&&(p!=3||wf||this.g&&(this.h.h||this.g.ja()||vv(this.g)))){this.J||p!=4||e==7||(e==8||0>=m?Da(3):Da(2)),ql(this);var t=this.g.da();this.ca=t;t:if(PE(this)){var r=vv(this.g);n="";var i=r.length,s=Nn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ti(this),la(this);var a="";break t}this.h.i=new Z.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=n,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=t==200,$M(this.j,this.v,this.B,this.m,this.W,p,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var l,h=this.g;if((l=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ba(l)){var f=l;break t}}f=null}if(t=f)Ss(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Cf(this,t);else{this.i=!1,this.s=3,kt(12),Ti(this),la(this);break e}}this.S?(CE(this,p,a),wf&&this.i&&p==3&&(yE(this.U,this.V,"tick",this.mb),this.V.start())):(Ss(this.j,this.m,a,null),Cf(this,a)),p==4&&Ti(this),this.i&&!this.J&&(p==4?XE(this.l,this):(this.i=!1,au(this)))}else dF(this.g),t==400&&0<a.indexOf("Unknown SID")?(this.s=3,kt(12)):(this.s=0,kt(13)),Ti(this),la(this)}}}catch{}finally{}};function PE(n){return n.g?n.v=="GET"&&n.L!=2&&n.l.Ha:!1}function CE(n,e,t){let r=!0,i;for(;!n.J&&n.o<t.length;)if(i=KM(n,t),i==Sf){e==4&&(n.s=4,kt(14),r=!1),Ss(n.j,n.m,null,"[Incomplete Response]");break}else if(i==bE){n.s=4,kt(15),Ss(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}else Ss(n.j,n.m,i,null),Cf(n,i);PE(n)&&n.o!=0&&(n.h.g=n.h.g.slice(n.o),n.o=0),e!=4||t.length!=0||n.h.h||(n.s=1,kt(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,e=n.l,e.g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),Jp(e),e.M=!0,kt(11))):(Ss(n.j,n.m,t,"[Invalid Chunked Response]"),Ti(n),la(n))}q.mb=function(){if(this.g){var n=Nn(this.g),e=this.g.ja();this.o<e.length&&(ql(this),CE(this,n,e),this.i&&n!=4&&au(this))}};function KM(n,e){var t=n.o,r=e.indexOf(`
`,t);return r==-1?Sf:(t=Number(e.substring(t,r)),isNaN(t)?bE:(r+=1,r+t>e.length?Sf:(e=e.slice(r,r+t),n.o=r+t,e)))}q.cancel=function(){this.J=!0,Ti(this)};function au(n){n.Y=Date.now()+n.P,kE(n,n.P)}function kE(n,e){if(n.C!=null)throw Error("WatchDog timer not null");n.C=iu(Et(n.lb,n),e)}function ql(n){n.C&&(Z.clearTimeout(n.C),n.C=null)}q.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(WM(this.j,this.B),this.L!=2&&(Da(),kt(17)),Ti(this),this.s=2,la(this)):kE(this,this.Y-n)};function la(n){n.l.H==0||n.J||XE(n.l,n)}function Ti(n){ql(n);var e=n.M;e&&typeof e.sa=="function"&&e.sa(),n.M=null,qp(n.V),vE(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function Cf(n,e){try{var t=n.l;if(t.H!=0&&(t.g==n||kf(t.i,n))){if(!n.K&&kf(t.i,n)&&t.H==3){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<n.G)Jc(t),Kl(t);else break e;Yp(t),kt(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&t.A==0&&!t.v&&(t.v=iu(Et(t.ib,t),6e3));if(1>=FE(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Ai(t,11)}else if((n.K||t.g==n)&&Jc(t),!ba(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let f=i[e];if(t.V=f[0],f=f[1],t.H==2)if(f[0]=="c"){t.K=f[1],t.pa=f[2];const p=f[3];p!=null&&(t.ra=p,t.l.info("VER="+t.ra));const m=f[4];m!=null&&(t.Ga=m,t.l.info("SVER="+t.Ga));const I=f[5];I!=null&&typeof I=="number"&&0<I&&(r=1.5*I,t.L=r,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const A=n.g;if(A){const L=A.g?A.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(L){var s=r.i;s.g||L.indexOf("spdy")==-1&&L.indexOf("quic")==-1&&L.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Kp(s,s.h),s.h=null))}if(r.F){const M=A.g?A.g.getResponseHeader("X-HTTP-Session-Id"):null;M&&(r.Da=M,ke(r.I,r.F,M))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms")),r=t;var a=n;if(r.wa=tT(r,r.J?r.pa:null,r.Y),a.K){UE(r.i,a);var l=a,h=r.L;h&&l.setTimeout(h),l.C&&(ql(l),au(l)),r.g=a}else YE(r);0<t.j.length&&Hl(t)}else f[0]!="stop"&&f[0]!="close"||Ai(t,7);else t.H==3&&(f[0]=="stop"||f[0]=="close"?f[0]=="stop"?Ai(t,7):Qp(t):f[0]!="noop"&&t.h&&t.h.Aa(f),t.A=0)}}Da(4)}catch{}}function HM(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(xl(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}e=[],t=0;for(r in n)e[t++]=n[r];return e}function jM(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(xl(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}function DE(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(xl(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=jM(n),r=HM(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}var xE=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function QM(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function ki(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof ki){this.h=n.h,Qc(this,n.j),this.s=n.s,this.g=n.g,Yc(this,n.m),this.l=n.l;var e=n.i,t=new xa;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),mv(this,t),this.o=n.o}else n&&(e=String(n).match(xE))?(this.h=!1,Qc(this,e[1]||"",!0),this.s=ta(e[2]||""),this.g=ta(e[3]||"",!0),Yc(this,e[4]),this.l=ta(e[5]||"",!0),mv(this,e[6]||"",!0),this.o=ta(e[7]||"")):(this.h=!1,this.i=new xa(null,this.h))}ki.prototype.toString=function(){var n=[],e=this.j;e&&n.push(na(e,_v,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(na(e,_v,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(na(t,t.charAt(0)=="/"?XM:JM,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",na(t,eF)),n.join("")};function cr(n){return new ki(n)}function Qc(n,e,t){n.j=t?ta(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Yc(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function mv(n,e,t){e instanceof xa?(n.i=e,tF(n.i,n.h)):(t||(e=na(e,ZM)),n.i=new xa(e,n.h))}function ke(n,e,t){n.i.set(e,t)}function $l(n){return ke(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function ta(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function na(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,YM),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function YM(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var _v=/[#\/\?@]/g,JM=/[#\?:]/g,XM=/[#\?]/g,ZM=/[#\?@]/g,eF=/#/g;function xa(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Zr(n){n.g||(n.g=new Map,n.h=0,n.i&&QM(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}q=xa.prototype;q.add=function(n,e){Zr(this),this.i=null,n=ro(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function NE(n,e){Zr(n),e=ro(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function VE(n,e){return Zr(n),e=ro(n,e),n.g.has(e)}q.forEach=function(n,e){Zr(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)};q.ta=function(){Zr(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t};q.Z=function(n){Zr(this);let e=[];if(typeof n=="string")VE(this,n)&&(e=e.concat(this.g.get(ro(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};q.set=function(n,e){return Zr(this),this.i=null,n=ro(this,n),VE(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};q.get=function(n,e){return n?(n=this.Z(n),0<n.length?String(n[0]):e):e};function OE(n,e,t){NE(n,e),0<t.length&&(n.i=null,n.g.set(ro(n,e),xp(t)),n.h+=t.length)}q.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;a[r]!==""&&(i+="="+encodeURIComponent(String(a[r]))),n.push(i)}}return this.i=n.join("&")};function ro(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function tF(n,e){e&&!n.j&&(Zr(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(NE(this,r),OE(this,i,t))},n)),n.j=e}var nF=class{constructor(n,e){this.g=n,this.map=e}};function LE(n){this.l=n||rF,Z.PerformanceNavigationTiming?(n=Z.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(Z.g&&Z.g.Ka&&Z.g.Ka()&&Z.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var rF=10;function ME(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function FE(n){return n.h?1:n.g?n.g.size:0}function kf(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function Kp(n,e){n.g?n.g.add(e):n.h=e}function UE(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}LE.prototype.cancel=function(){if(this.i=BE(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const n of this.g.values())n.cancel();this.g.clear()}};function BE(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return xp(n.i)}var iF=class{stringify(n){return Z.JSON.stringify(n,void 0)}parse(n){return Z.JSON.parse(n,void 0)}};function sF(){this.g=new iF}function oF(n,e,t){const r=t||"";try{DE(n,function(i,s){let a=i;nu(i)&&(a=Up(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function aF(n,e){const t=new Ml;if(Z.Image){const r=new Image;r.onload=yc(Ic,t,r,"TestLoadImage: loaded",!0,e),r.onerror=yc(Ic,t,r,"TestLoadImage: error",!1,e),r.onabort=yc(Ic,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=yc(Ic,t,r,"TestLoadImage: timeout",!1,e),Z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}function Ic(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Wl(n){this.l=n.ec||null,this.j=n.ob||!1}ot(Wl,Wp);Wl.prototype.g=function(){return new Gl(this.l,this.j)};Wl.prototype.i=function(n){return function(){return n}}({});function Gl(n,e){st.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=Hp,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ot(Gl,st);var Hp=0;q=Gl.prototype;q.open=function(n,e){if(this.readyState!=Hp)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Na(this)};q.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||Z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};q.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,uu(this)),this.readyState=Hp};q.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Na(this)),this.g&&(this.readyState=3,Na(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Z.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;qE(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function qE(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}q.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?uu(this):Na(this),this.readyState==3&&qE(this)}};q.Za=function(n){this.g&&(this.response=this.responseText=n,uu(this))};q.Ya=function(n){this.g&&(this.response=n,uu(this))};q.ka=function(){this.g&&uu(this)};function uu(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Na(n)}q.setRequestHeader=function(n,e){this.v.append(n,e)};q.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};q.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function Na(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(Gl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var uF=Z.JSON.parse;function $e(n){st.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=$E,this.L=this.M=!1}ot($e,st);var $E="",cF=/^https?$/i,lF=["POST","PUT"];q=$e.prototype;q.Oa=function(n){this.M=n};q.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():bf.g(),this.C=this.u?gv(this.u):gv(bf),this.g.onreadystatechange=Et(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){yv(this,s);return}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())t.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(t.keys()).find(s=>s.toLowerCase()=="content-type"),i=Z.FormData&&n instanceof Z.FormData,!(0<=iE(lF,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of t)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{zE(this),0<this.B&&((this.L=hF(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Et(this.ua,this)):this.A=$p(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){yv(this,s)}};function hF(n){return Us&&typeof n.timeout=="number"&&n.ontimeout!==void 0}q.ua=function(){typeof Dp<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,mt(this,"timeout"),this.abort(8))};function yv(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,WE(n),zl(n)}function WE(n){n.F||(n.F=!0,mt(n,"complete"),mt(n,"error"))}q.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,mt(this,"complete"),mt(this,"abort"),zl(this))};q.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),zl(this,!0)),$e.$.N.call(this)};q.La=function(){this.s||(this.G||this.v||this.l?GE(this):this.kb())};q.kb=function(){GE(this)};function GE(n){if(n.h&&typeof Dp<"u"&&(!n.C[1]||Nn(n)!=4||n.da()!=2)){if(n.v&&Nn(n)==4)$p(n.La,0,n);else if(mt(n,"readystatechange"),Nn(n)==4){n.h=!1;try{const a=n.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=a===0){var i=String(n.I).match(xE)[1]||null;!i&&Z.self&&Z.self.location&&(i=Z.self.location.protocol.slice(0,-1)),r=!cF.test(i?i.toLowerCase():"")}t=r}if(t)mt(n,"complete"),mt(n,"success");else{n.m=6;try{var s=2<Nn(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",WE(n)}}finally{zl(n)}}}}function zl(n,e){if(n.g){zE(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||mt(n,"ready");try{t.onreadystatechange=r}catch{}}}function zE(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(Z.clearTimeout(n.A),n.A=null)}q.isActive=function(){return!!this.g};function Nn(n){return n.g?n.g.readyState:0}q.da=function(){try{return 2<Nn(this)?this.g.status:-1}catch{return-1}};q.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};q.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),uF(e)}};function vv(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case $E:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function dF(n){const e={};n=(n.g&&2<=Nn(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<n.length;r++){if(ba(n[r]))continue;var t=MM(n[r]);const i=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}kM(e,function(r){return r.join(", ")})}q.Ia=function(){return this.m};q.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function KE(n){let e="";return Vp(n,function(t,r){e+=r,e+=":",e+=t,e+=`\r
`}),e}function jp(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=KE(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):ke(n,e,t))}function qo(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function HE(n){this.Ga=0,this.j=[],this.l=new Ml,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=qo("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=qo("baseRetryDelayMs",5e3,n),this.hb=qo("retryDelaySeedMs",1e4,n),this.eb=qo("forwardChannelMaxRetries",2,n),this.xa=qo("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new LE(n&&n.concurrentRequestLimit),this.Ja=new sF,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}q=HE.prototype;q.ra=8;q.H=1;function Qp(n){if(jE(n),n.H==3){var e=n.W++,t=cr(n.I);if(ke(t,"SID",n.K),ke(t,"RID",e),ke(t,"TYPE","terminate"),cu(n,t),e=new ou(n,n.l,e),e.L=2,e.A=$l(cr(t)),t=!1,Z.navigator&&Z.navigator.sendBeacon)try{t=Z.navigator.sendBeacon(e.A.toString(),"")}catch{}!t&&Z.Image&&(new Image().src=e.A,t=!0),t||(e.g=nT(e.l,null),e.g.ha(e.A)),e.G=Date.now(),au(e)}eT(n)}function Kl(n){n.g&&(Jp(n),n.g.cancel(),n.g=null)}function jE(n){Kl(n),n.u&&(Z.clearTimeout(n.u),n.u=null),Jc(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&Z.clearTimeout(n.m),n.m=null)}function Hl(n){if(!ME(n.i)&&!n.m){n.m=!0;var e=n.Na;Pa||mE(),Ca||(Pa(),Ca=!0),Bp.add(e,n),n.C=0}}function fF(n,e){return FE(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=e.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=iu(Et(n.Na,n,e),ZE(n,n.C)),n.C++,!0)}q.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new ou(this,this.l,n);let s=this.s;if(this.U&&(s?(s=uE(s),cE(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var r=this.j[t];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=QE(this,i,e),t=cr(this.I),ke(t,"RID",n),ke(t,"CVER",22),this.F&&ke(t,"X-HTTP-Session-Id",this.F),cu(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(KE(s)))+"&"+e:this.o&&jp(t,this.o,s)),Kp(this.i,i),this.bb&&ke(t,"TYPE","init"),this.P?(ke(t,"$req",e),ke(t,"SID","null"),i.aa=!0,Pf(i,t,null)):Pf(i,t,e),this.H=2}}else this.H==3&&(n?Iv(this,n):this.j.length==0||ME(this.i)||Iv(this))};function Iv(n,e){var t;e?t=e.m:t=n.W++;const r=cr(n.I);ke(r,"SID",n.K),ke(r,"RID",t),ke(r,"AID",n.V),cu(n,r),n.o&&n.s&&jp(r,n.o,n.s),t=new ou(n,n.l,t,n.C+1),n.o===null&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=QE(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),Kp(n.i,t),Pf(t,r,e)}function cu(n,e){n.na&&Vp(n.na,function(t,r){ke(e,r,t)}),n.h&&DE({},function(t,r){ke(e,r,t)})}function QE(n,e,t){t=Math.min(n.j.length,t);var r=n.h?Et(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const a=["count="+t];s==-1?0<t?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let l=!0;for(let h=0;h<t;h++){let f=i[h].g;const p=i[h].map;if(f-=s,0>f)s=Math.max(0,i[h].g-100),l=!1;else try{oF(p,a,"req"+f+"_")}catch{r&&r(p)}}if(l){r=a.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function YE(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Pa||mE(),Ca||(Pa(),Ca=!0),Bp.add(e,n),n.A=0}}function Yp(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=iu(Et(n.Ma,n),ZE(n,n.A)),n.A++,!0)}q.Ma=function(){if(this.u=null,JE(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=iu(Et(this.jb,this),n)}};q.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,kt(10),Kl(this),JE(this))};function Jp(n){n.B!=null&&(Z.clearTimeout(n.B),n.B=null)}function JE(n){n.g=new ou(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var e=cr(n.wa);ke(e,"RID","rpc"),ke(e,"SID",n.K),ke(e,"AID",n.V),ke(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&ke(e,"TO",n.qa),ke(e,"TYPE","xmlhttp"),cu(n,e),n.o&&n.s&&jp(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.A=$l(cr(e)),t.u=null,t.S=!0,SE(t,n)}q.ib=function(){this.v!=null&&(this.v=null,Kl(this),Yp(this),kt(19))};function Jc(n){n.v!=null&&(Z.clearTimeout(n.v),n.v=null)}function XE(n,e){var t=null;if(n.g==e){Jc(n),Jp(n),n.g=null;var r=2}else if(kf(n.i,e))t=e.F,UE(n.i,e),r=1;else return;if(n.H!=0){if(e.i)if(r==1){t=e.u?e.u.length:0,e=Date.now()-e.G;var i=n.C;r=Fl(),mt(r,new EE(r,t)),Hl(n)}else YE(n);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&fF(n,e)||r==2&&Yp(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Ai(n,5);break;case 4:Ai(n,10);break;case 3:Ai(n,6);break;default:Ai(n,2)}}}function ZE(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Ai(n,e){if(n.l.info("Error code "+e),e==2){var t=null;n.h&&(t=null);var r=Et(n.pb,n);t||(t=new ki("//www.google.com/images/cleardot.gif"),Z.location&&Z.location.protocol=="http"||Qc(t,"https"),$l(t)),aF(t.toString(),r)}else kt(2);n.H=0,n.h&&n.h.za(e),eT(n),jE(n)}q.pb=function(n){n?(this.l.info("Successfully pinged google.com"),kt(2)):(this.l.info("Failed to ping google.com"),kt(1))};function eT(n){if(n.H=0,n.ma=[],n.h){const e=BE(n.i);(e.length!=0||n.j.length!=0)&&(lv(n.ma,e),lv(n.ma,n.j),n.i.i.length=0,xp(n.j),n.j.length=0),n.h.ya()}}function tT(n,e,t){var r=t instanceof ki?cr(t):new ki(t);if(r.g!="")e&&(r.g=e+"."+r.g),Yc(r,r.m);else{var i=Z.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new ki(null);r&&Qc(s,r),e&&(s.g=e),i&&Yc(s,i),t&&(s.l=t),r=s}return t=n.F,e=n.Da,t&&e&&ke(r,t,e),ke(r,"VER",n.ra),cu(n,r),r}function nT(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n.Ha&&!n.va?new $e(new Wl({ob:t})):new $e(n.va),e.Oa(n.J),e}q.isActive=function(){return!!this.h&&this.h.isActive(this)};function rT(){}q=rT.prototype;q.Ba=function(){};q.Aa=function(){};q.za=function(){};q.ya=function(){};q.isActive=function(){return!0};q.Va=function(){};function Xc(){if(Us&&!(10<=Number(bM)))throw Error("Environmental error: no available transport.")}Xc.prototype.g=function(n,e){return new Xt(n,e)};function Xt(n,e){st.call(this),this.g=new HE(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!ba(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ba(e)&&(this.g.F=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new io(this)}ot(Xt,st);Xt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;kt(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=tT(n,null,n.Y),Hl(n)};Xt.prototype.close=function(){Qp(this.g)};Xt.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=Up(n),n=t);e.j.push(new nF(e.fb++,n)),e.H==3&&Hl(e)};Xt.prototype.N=function(){this.g.h=null,delete this.j,Qp(this.g),delete this.g,Xt.$.N.call(this)};function iT(n){Gp.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}ot(iT,Gp);function sT(){zp.call(this),this.status=1}ot(sT,zp);function io(n){this.g=n}ot(io,rT);io.prototype.Ba=function(){mt(this.g,"a")};io.prototype.Aa=function(n){mt(this.g,new iT(n))};io.prototype.za=function(n){mt(this.g,new sT)};io.prototype.ya=function(){mt(this.g,"b")};function pF(){this.blockSize=-1}function In(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ot(In,pF);In.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function nf(n,e,t){t||(t=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=n.g[0],t=n.g[1],i=n.g[2];var s=n.g[3],a=e+(s^t&(i^s))+r[0]+3614090360&4294967295;e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[1]+3905402710&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[3]+3250441966&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[4]+4118548399&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[5]+1200080426&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[7]+4249261313&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[8]+1770035416&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[9]+2336552879&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[11]+2304563134&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(s^t&(i^s))+r[12]+1804603682&4294967295,e=t+(a<<7&4294967295|a>>>25),a=s+(i^e&(t^i))+r[13]+4254626195&4294967295,s=e+(a<<12&4294967295|a>>>20),a=i+(t^s&(e^t))+r[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=t+(e^i&(s^e))+r[15]+1236535329&4294967295,t=i+(a<<22&4294967295|a>>>10),a=e+(i^s&(t^i))+r[1]+4129170786&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[6]+3225465664&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[0]+3921069994&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[5]+3593408605&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[10]+38016083&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[4]+3889429448&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[9]+568446438&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[14]+3275163606&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[8]+1163531501&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(i^s&(t^i))+r[13]+2850285829&4294967295,e=t+(a<<5&4294967295|a>>>27),a=s+(t^i&(e^t))+r[2]+4243563512&4294967295,s=e+(a<<9&4294967295|a>>>23),a=i+(e^t&(s^e))+r[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=t+(s^e&(i^s))+r[12]+2368359562&4294967295,t=i+(a<<20&4294967295|a>>>12),a=e+(t^i^s)+r[5]+4294588738&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[8]+2272392833&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[14]+4259657740&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[1]+2763975236&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[4]+1272893353&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[10]+3200236656&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[13]+681279174&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[0]+3936430074&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[6]+76029189&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(t^i^s)+r[9]+3654602809&4294967295,e=t+(a<<4&4294967295|a>>>28),a=s+(e^t^i)+r[12]+3873151461&4294967295,s=e+(a<<11&4294967295|a>>>21),a=i+(s^e^t)+r[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=t+(i^s^e)+r[2]+3299628645&4294967295,t=i+(a<<23&4294967295|a>>>9),a=e+(i^(t|~s))+r[0]+4096336452&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[7]+1126891415&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[5]+4237533241&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[12]+1700485571&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[3]+2399980690&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[1]+2240044497&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[8]+1873313359&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[15]+4264355552&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[13]+1309151649&4294967295,t=i+(a<<21&4294967295|a>>>11),a=e+(i^(t|~s))+r[4]+4149444226&4294967295,e=t+(a<<6&4294967295|a>>>26),a=s+(t^(e|~i))+r[11]+3174756917&4294967295,s=e+(a<<10&4294967295|a>>>22),a=i+(e^(s|~t))+r[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=t+(s^(i|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}In.prototype.j=function(n,e){e===void 0&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=t;)nf(this,n,s),s+=this.blockSize;if(typeof n=="string"){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){nf(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){nf(this,r),i=0;break}}this.h=i,this.i+=e};In.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=t&255,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};function Ae(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=n[i]|0;r&&s==e||(t[i]=s,r=!1)}this.g=t}var gF={};function Xp(n){return-128<=n&&128>n?TM(n,function(e){return new Ae([e|0],0>e?-1:0)}):new Ae([n|0],0>n?-1:0)}function Vn(n){if(isNaN(n)||!isFinite(n))return xs;if(0>n)return ft(Vn(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=Df;return new Ae(e,0)}function oT(n,e){if(n.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(n.charAt(0)=="-")return ft(oT(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Vn(Math.pow(e,8)),r=xs,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),a=parseInt(n.substring(i,i+s),e);8>s?(s=Vn(Math.pow(e,s)),r=r.R(s).add(Vn(a))):(r=r.R(t),r=r.add(Vn(a)))}return r}var Df=4294967296,xs=Xp(0),xf=Xp(1),wv=Xp(16777216);q=Ae.prototype;q.ea=function(){if(cn(this))return-ft(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:Df+r)*e,e*=Df}return n};q.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(rr(this))return"0";if(cn(this))return"-"+ft(this).toString(n);for(var e=Vn(Math.pow(n,6)),t=this,r="";;){var i=el(t,e).g;t=Zc(t,i.R(e));var s=((0<t.g.length?t.g[0]:t.h)>>>0).toString(n);if(t=i,rr(t))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};q.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function rr(n){if(n.h!=0)return!1;for(var e=0;e<n.g.length;e++)if(n.g[e]!=0)return!1;return!0}function cn(n){return n.h==-1}q.X=function(n){return n=Zc(this,n),cn(n)?-1:rr(n)?0:1};function ft(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new Ae(t,~n.h).add(xf)}q.abs=function(){return cn(this)?ft(this):this};q.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(n.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=a>>>16,s&=65535,a&=65535,t[i]=a<<16|s}return new Ae(t,t[t.length-1]&-2147483648?-1:0)};function Zc(n,e){return n.add(ft(e))}q.R=function(n){if(rr(this)||rr(n))return xs;if(cn(this))return cn(n)?ft(this).R(ft(n)):ft(ft(this).R(n));if(cn(n))return ft(this.R(ft(n)));if(0>this.X(wv)&&0>n.X(wv))return Vn(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,a=this.D(r)&65535,l=n.D(i)>>>16,h=n.D(i)&65535;t[2*r+2*i]+=a*h,wc(t,2*r+2*i),t[2*r+2*i+1]+=s*h,wc(t,2*r+2*i+1),t[2*r+2*i+1]+=a*l,wc(t,2*r+2*i+1),t[2*r+2*i+2]+=s*l,wc(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new Ae(t,0)};function wc(n,e){for(;(n[e]&65535)!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function $o(n,e){this.g=n,this.h=e}function el(n,e){if(rr(e))throw Error("division by zero");if(rr(n))return new $o(xs,xs);if(cn(n))return e=el(ft(n),e),new $o(ft(e.g),ft(e.h));if(cn(e))return e=el(n,ft(e)),new $o(ft(e.g),e.h);if(30<n.g.length){if(cn(n)||cn(e))throw Error("slowDivide_ only works with positive integers.");for(var t=xf,r=e;0>=r.X(n);)t=Ev(t),r=Ev(r);var i=ms(t,1),s=ms(r,1);for(r=ms(r,2),t=ms(t,2);!rr(r);){var a=s.add(r);0>=a.X(n)&&(i=i.add(t),s=a),r=ms(r,1),t=ms(t,1)}return e=Zc(n,i.R(e)),new $o(i,e)}for(i=xs;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=Math.ceil(Math.log(t)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Vn(t),a=s.R(e);cn(a)||0<a.X(n);)t-=r,s=Vn(t),a=s.R(e);rr(s)&&(s=xf),i=i.add(s),n=Zc(n,a)}return new $o(i,n)}q.gb=function(n){return el(this,n).h};q.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new Ae(t,this.h&n.h)};q.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new Ae(t,this.h|n.h)};q.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new Ae(t,this.h^n.h)};function Ev(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new Ae(t,n.h)}function ms(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new Ae(i,n.h)}Xc.prototype.createWebChannel=Xc.prototype.g;Xt.prototype.send=Xt.prototype.u;Xt.prototype.open=Xt.prototype.m;Xt.prototype.close=Xt.prototype.close;Ul.NO_ERROR=0;Ul.TIMEOUT=8;Ul.HTTP_ERROR=6;TE.COMPLETE="complete";AE.EventType=su;su.OPEN="a";su.CLOSE="b";su.ERROR="c";su.MESSAGE="d";st.prototype.listen=st.prototype.O;$e.prototype.listenOnce=$e.prototype.P;$e.prototype.getLastError=$e.prototype.Sa;$e.prototype.getLastErrorCode=$e.prototype.Ia;$e.prototype.getStatus=$e.prototype.da;$e.prototype.getResponseJson=$e.prototype.Wa;$e.prototype.getResponseText=$e.prototype.ja;$e.prototype.send=$e.prototype.ha;$e.prototype.setWithCredentials=$e.prototype.Oa;In.prototype.digest=In.prototype.l;In.prototype.reset=In.prototype.reset;In.prototype.update=In.prototype.j;Ae.prototype.add=Ae.prototype.add;Ae.prototype.multiply=Ae.prototype.R;Ae.prototype.modulo=Ae.prototype.gb;Ae.prototype.compare=Ae.prototype.X;Ae.prototype.toNumber=Ae.prototype.ea;Ae.prototype.toString=Ae.prototype.toString;Ae.prototype.getBits=Ae.prototype.D;Ae.fromNumber=Vn;Ae.fromString=oT;var mF=function(){return new Xc},_F=function(){return Fl()},rf=Ul,yF=TE,vF=Ki,Tv={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Ec=AE,IF=$e,wF=In,Ns=Ae;const Av="@firebase/firestore";class rt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}rt.UNAUTHENTICATED=new rt(null),rt.GOOGLE_CREDENTIALS=new rt("google-credentials-uid"),rt.FIRST_PARTY=new rt("first-party-uid"),rt.MOCK_USER=new rt("mock-user");let so="10.7.0";const qr=new wl("@firebase/firestore");function ws(){return qr.logLevel}function EF(n){qr.setLogLevel(n)}function N(n,...e){if(qr.logLevel<=ce.DEBUG){const t=e.map(Zp);qr.debug(`Firestore (${so}): ${n}`,...t)}}function je(n,...e){if(qr.logLevel<=ce.ERROR){const t=e.map(Zp);qr.error(`Firestore (${so}): ${n}`,...t)}}function wn(n,...e){if(qr.logLevel<=ce.WARN){const t=e.map(Zp);qr.warn(`Firestore (${so}): ${n}`,...t)}}function Zp(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function $(n="Unexpected state"){const e=`FIRESTORE (${so}) INTERNAL ASSERTION FAILED: `+n;throw je(e),new Error(e)}function z(n,e){n||$()}function TF(n,e){n||$()}function B(n,e){return n}const S={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class D extends Dt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class it{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class aT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class AF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(rt.UNAUTHENTICATED))}shutdown(){}}class RF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class bF{constructor(e){this.t=e,this.currentUser=rt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let s=new it;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new it,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const h=s;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},l=h=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>l(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?l(h):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new it)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(z(typeof r.accessToken=="string"),new aT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return z(e===null||typeof e=="string"),new rt(e)}}class SF{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=rt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class PF{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new SF(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(rt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class CF{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class kF{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{s.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,N("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(z(typeof t.token=="string"),this.R=t.token,new CF(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function DF(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class uT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=DF(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function ne(n,e){return n<e?-1:n>e?1:0}function Bs(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function cT(n){return n+"\0"}class Oe{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new D(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new D(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new D(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Oe.fromMillis(Date.now())}static fromDate(e){return Oe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Oe(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class K{constructor(e){this.timestamp=e}static fromTimestamp(e){return new K(e)}static min(){return new K(new Oe(0,0))}static max(){return new K(new Oe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Va{constructor(e,t,r){t===void 0?t=0:t>e.length&&$(),r===void 0?r=e.length-t:r>e.length-t&&$(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Va.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Va?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ge extends Va{construct(e,t,r){return new ge(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new D(S.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new ge(t)}static emptyPath(){return new ge([])}}const xF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ne extends Va{construct(e,t,r){return new Ne(e,t,r)}static isValidIdentifier(e){return xF.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ne.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ne(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new D(S.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new D(S.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new D(S.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(s(),i++)}if(s(),a)throw new D(S.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ne(t)}static emptyPath(){return new Ne([])}}class F{constructor(e){this.path=e}static fromPath(e){return new F(ge.fromString(e))}static fromName(e){return new F(ge.fromString(e).popFirst(5))}static empty(){return new F(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ge.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new ge(e.slice()))}}class tl{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Nf(n){return n.fields.find(e=>e.kind===2)}function mi(n){return n.fields.filter(e=>e.kind!==2)}tl.UNKNOWN_ID=-1;class xc{constructor(e,t){this.fieldPath=e,this.kind=t}}class Oa{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Oa(0,Zt.min())}}function lT(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new Oe(t+1,0):new Oe(t,r));return new Zt(i,F.empty(),e)}function hT(n){return new Zt(n.readTime,n.key,-1)}class Zt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Zt(K.min(),F.empty(),-1)}static max(){return new Zt(K.max(),F.empty(),-1)}}function eg(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:ne(n.largestBatchId,e.largestBatchId))}const dT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function ei(n){if(n.code!==S.FAILED_PRECONDITION||n.message!==dT)throw n;N("LocalStore","Unexpectedly lost primary lease")}class R{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new R((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof R?t:R.resolve(t)}catch(t){return R.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):R.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):R.reject(t)}static resolve(e){return new R((t,r)=>{t(e)})}static reject(e){return new R((t,r)=>{r(e)})}static waitFor(e){return new R((t,r)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&t()},h=>r(h))}),a=!0,s===i&&t()})}static or(e){let t=R.resolve(!1);for(const r of e)t=t.next(i=>i?R.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new R((r,i)=>{const s=e.length,a=new Array(s);let l=0;for(let h=0;h<s;h++){const f=h;t(e[f]).next(p=>{a[f]=p,++l,l===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new R((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}class jl{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new it,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ha(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=tg(r.target.error);this.V.reject(new ha(e,i))}}static open(e,t,r,i){try{return new jl(t,e.transaction(i,r))}catch(s){throw new ha(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(N("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new VF(t)}}class yn{constructor(e,t,r){this.name=e,this.version=t,this.p=r,yn.S(Fe())===12.2&&je("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return N("SimpleDb","Removing database:",e),_i(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!_a())return!1;if(yn.C())return!0;const e=Fe(),t=yn.S(e),r=0<t&&t<10,i=yn.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async O(e){return this.db||(N("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const a=s.target.result;t(a)},i.onblocked=()=>{r(new ha(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const a=s.target.error;a.name==="VersionError"?r(new D(S.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?r(new D(S.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new ha(e,a))},i.onupgradeneeded=s=>{N("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const a=s.target.result;this.p.N(a,i.transaction,s.oldVersion,this.version).next(()=>{N("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.O(e);const l=jl.open(this.db,e,s?"readonly":"readwrite",r),h=i(l).next(f=>(l.g(),f)).catch(f=>(l.abort(f),R.reject(f))).toPromise();return h.catch(()=>{}),await l.m,h}catch(l){const h=l,f=h.name!=="FirebaseError"&&a<3;if(N("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),this.close(),!f)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}class NF{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return _i(this.k.delete())}}class ha extends D{constructor(e,t){super(S.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ti(n){return n.name==="IndexedDbTransactionError"}class VF{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(N("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(N("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),_i(r)}add(e){return N("SimpleDb","ADD",this.store.name,e,e),_i(this.store.add(e))}get(e){return _i(this.store.get(e)).next(t=>(t===void 0&&(t=null),N("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return N("SimpleDb","DELETE",this.store.name,e),_i(this.store.delete(e))}count(){return N("SimpleDb","COUNT",this.store.name),_i(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.G(i,(a,l)=>{s.push(l)}).next(()=>s)}{const i=this.store.getAll(r.range);return new R((s,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{s(l.target.result)}})}}j(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new R((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}H(e,t){N("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.J=!1;const i=this.cursor(r);return this.G(i,(s,a,l)=>l.delete())}Y(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Z(e){const t=this.cursor({});return new R((r,i)=>{t.onerror=s=>{const a=tg(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(l=>{l?a.continue():r()}):r()}})}G(e,t){const r=[];return new R((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const l=a.target.result;if(!l)return void i();const h=new NF(l),f=t(l.primaryKey,l.value,h);if(f instanceof R){const p=f.catch(m=>(h.done(),R.reject(m)));r.push(p)}h.isDone?i():h.$===null?l.continue():l.continue(h.$)}}).next(()=>R.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function _i(n){return new R((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=tg(r.target.error);t(i)}})}let Rv=!1;function tg(n){const e=yn.S(Fe());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new D("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Rv||(Rv=!0,setTimeout(()=>{throw r},0)),r}}return n}class OF{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){N("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{N("IndexBackiller",`Documents written: ${await this.X.te()}`)}catch(t){ti(t)?N("IndexBackiller","Ignoring IndexedDB error during index backfill: ",t):await ei(t)}await this.ee(6e4)})}}class LF{constructor(e,t){this.localStore=e,this.persistence=t}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ne(t,e))}ne(e,t){const r=new Set;let i=t,s=!0;return R.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!r.has(a))return N("IndexBackiller",`Processing collection: ${a}`),this.re(e,a,i).next(l=>{i-=l,r.add(a)});s=!1})).next(()=>t-i)}re(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ie(i,s)).next(l=>(N("IndexBackiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>a.size)}))}ie(e,t){let r=e;return t.changes.forEach((i,s)=>{const a=hT(s);eg(a,r)>0&&(r=a)}),new Zt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class qt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.se(r),this.oe=r=>t.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}qt._e=-1;function lu(n){return n==null}function La(n){return n===0&&1/n==-1/0}function pT(n){return typeof n=="number"&&Number.isInteger(n)&&!La(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function xt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=bv(e)),e=MF(n.get(t),e);return bv(e)}function MF(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function bv(n){return n+""}function On(n){const e=n.length;if(z(e>=2),e===2)return z(n.charAt(0)===""&&n.charAt(1)===""),ge.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf("",s);switch((a<0||a>t)&&$(),n.charAt(a+1)){case"":const l=n.substring(s,a);let h;i.length===0?h=l:(i+=l,h=i,i=""),r.push(h);break;case"":i+=n.substring(s,a),i+="\0";break;case"":i+=n.substring(s,a+1);break;default:$()}s=a+2}return new ge(r)}const Sv=["userId","batchId"];function Nc(n,e){return[n,xt(e)]}function gT(n,e,t){return[n,xt(e),t]}const FF={},UF=["prefixPath","collectionGroup","readTime","documentId"],BF=["prefixPath","collectionGroup","documentId"],qF=["collectionGroup","readTime","prefixPath","documentId"],$F=["canonicalId","targetId"],WF=["targetId","path"],GF=["path","targetId"],zF=["collectionId","parent"],KF=["indexId","uid"],HF=["uid","sequenceNumber"],jF=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],QF=["indexId","uid","orderedDocumentKey"],YF=["userId","collectionPath","documentId"],JF=["userId","collectionPath","largestBatchId"],XF=["userId","collectionGroup","largestBatchId"],mT=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ZF=[...mT,"documentOverlays"],_T=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],yT=_T,e2=[...yT,"indexConfiguration","indexState","indexEntries"];class Vf extends fT{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function at(n,e){const t=B(n);return yn.M(t.ae,e)}function Pv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Hi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function vT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Pe{constructor(e,t){this.comparator=e,this.root=t||dt.EMPTY}insert(e,t){return new Pe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,dt.BLACK,null,null))}remove(e){return new Pe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Tc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Tc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Tc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Tc(this.root,e,this.comparator,!0)}}class Tc{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dt{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??dt.RED,this.left=i??dt.EMPTY,this.right=s??dt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new dt(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return dt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return dt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $();const e=this.left.check();if(e!==this.right.check())throw $();return e+(this.isRed()?0:1)}}dt.EMPTY=null,dt.RED=!0,dt.BLACK=!1;dt.EMPTY=new class{constructor(){this.size=0}get key(){throw $()}get value(){throw $()}get color(){throw $()}get left(){throw $()}get right(){throw $()}copy(e,t,r,i,s){return this}insert(e,t,r){return new dt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Re{constructor(e){this.comparator=e,this.data=new Pe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Cv(this.data.getIterator())}getIteratorFrom(e){return new Cv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Re(this.comparator);return t.data=e,t}}class Cv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function _s(n){return n.hasNext()?n.getNext():void 0}class $t{constructor(e){this.fields=e,e.sort(Ne.comparator)}static empty(){return new $t([])}unionWith(e){let t=new Re(Ne.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new $t(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Bs(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class IT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function t2(){return typeof atob<"u"}class et{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new IT("Invalid base64 string: "+s):s}}(e);return new et(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new et(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}et.EMPTY_BYTE_STRING=new et("");const n2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $r(n){if(z(!!n),typeof n=="string"){let e=0;const t=n2.exec(n);if(z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Be(n.seconds),nanos:Be(n.nanos)}}function Be(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Wr(n){return typeof n=="string"?et.fromBase64String(n):et.fromUint8Array(n)}function Ql(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function ng(n){const e=n.mapValue.fields.__previous_value__;return Ql(e)?ng(e):e}function Ma(n){const e=$r(n.mapValue.fields.__local_write_time__.timestampValue);return new Oe(e.seconds,e.nanos)}class r2{constructor(e,t,r,i,s,a,l,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=f}}class Gr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Gr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Gr&&e.projectId===this.projectId&&e.database===this.database}}const Or={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Vc={nullValue:"NULL_VALUE"};function Vi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ql(n)?4:wT(n)?9007199254740991:10:$()}function Wn(n,e){if(n===e)return!0;const t=Vi(n);if(t!==Vi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ma(n).isEqual(Ma(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=$r(i.timestampValue),l=$r(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Wr(i.bytesValue).isEqual(Wr(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Be(i.geoPointValue.latitude)===Be(s.geoPointValue.latitude)&&Be(i.geoPointValue.longitude)===Be(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Be(i.integerValue)===Be(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Be(i.doubleValue),l=Be(s.doubleValue);return a===l?La(a)===La(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return Bs(n.arrayValue.values||[],e.arrayValue.values||[],Wn);case 10:return function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(Pv(a)!==Pv(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(l[h]===void 0||!Wn(a[h],l[h])))return!1;return!0}(n,e);default:return $()}}function Fa(n,e){return(n.values||[]).find(t=>Wn(t,e))!==void 0}function zr(n,e){if(n===e)return 0;const t=Vi(n),r=Vi(e);if(t!==r)return ne(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ne(n.booleanValue,e.booleanValue);case 2:return function(s,a){const l=Be(s.integerValue||s.doubleValue),h=Be(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return kv(n.timestampValue,e.timestampValue);case 4:return kv(Ma(n),Ma(e));case 5:return ne(n.stringValue,e.stringValue);case 6:return function(s,a){const l=Wr(s),h=Wr(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),h=a.split("/");for(let f=0;f<l.length&&f<h.length;f++){const p=ne(l[f],h[f]);if(p!==0)return p}return ne(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){const l=ne(Be(s.latitude),Be(a.latitude));return l!==0?l:ne(Be(s.longitude),Be(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,a){const l=s.values||[],h=a.values||[];for(let f=0;f<l.length&&f<h.length;++f){const p=zr(l[f],h[f]);if(p)return p}return ne(l.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===Or.mapValue&&a===Or.mapValue)return 0;if(s===Or.mapValue)return 1;if(a===Or.mapValue)return-1;const l=s.fields||{},h=Object.keys(l),f=a.fields||{},p=Object.keys(f);h.sort(),p.sort();for(let m=0;m<h.length&&m<p.length;++m){const I=ne(h[m],p[m]);if(I!==0)return I;const A=zr(l[h[m]],f[p[m]]);if(A!==0)return A}return ne(h.length,p.length)}(n.mapValue,e.mapValue);default:throw $()}}function kv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ne(n,e);const t=$r(n),r=$r(e),i=ne(t.seconds,r.seconds);return i!==0?i:ne(t.nanos,r.nanos)}function qs(n){return Of(n)}function Of(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=$r(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Wr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return F.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Of(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${Of(t.fields[a])}`;return i+"}"}(n.mapValue):$()}function Oi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Lf(n){return!!n&&"integerValue"in n}function Ua(n){return!!n&&"arrayValue"in n}function Dv(n){return!!n&&"nullValue"in n}function xv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Oc(n){return!!n&&"mapValue"in n}function da(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Hi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=da(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=da(n.arrayValue.values[t]);return e}return Object.assign({},n)}function wT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function i2(n){return"nullValue"in n?Vc:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Oi(Gr.empty(),F.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:$()}function s2(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Oi(Gr.empty(),F.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Or:$()}function Nv(n,e){const t=zr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Vv(n,e){const t=zr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class pt{constructor(e){this.value=e}static empty(){return new pt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Oc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=da(t)}setAll(e){let t=Ne.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!t.isImmediateParentOf(l)){const h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=l.popLast()}a?r[l.lastSegment()]=da(a):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Oc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Oc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Hi(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new pt(da(this.value))}}function ET(n){const e=[];return Hi(n.fields,(t,r)=>{const i=new Ne([t]);if(Oc(r)){const s=ET(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new $t(e)}class De{constructor(e,t,r,i,s,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new De(e,0,K.min(),K.min(),K.min(),pt.empty(),0)}static newFoundDocument(e,t,r,i){return new De(e,1,t,K.min(),r,i,0)}static newNoDocument(e,t){return new De(e,2,t,K.min(),K.min(),pt.empty(),0)}static newUnknownDocument(e,t){return new De(e,3,t,K.min(),K.min(),pt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof De&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new De(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Kr{constructor(e,t){this.position=e,this.inclusive=t}}function Ov(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=zr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Lv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Wn(n.position[t],e.position[t]))return!1;return!0}class Ba{constructor(e,t="asc"){this.field=e,this.dir=t}}function o2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class TT{}class he extends TT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new a2(e,t,r):t==="array-contains"?new l2(e,r):t==="in"?new CT(e,r):t==="not-in"?new h2(e,r):t==="array-contains-any"?new d2(e,r):new he(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new u2(e,r):new c2(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(zr(t,this.value)):t!==null&&Vi(this.value)===Vi(t)&&this.matchesComparison(zr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Te extends TT{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Te(e,t)}matches(e){return $s(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function $s(n){return n.op==="and"}function Mf(n){return n.op==="or"}function rg(n){return AT(n)&&$s(n)}function AT(n){for(const e of n.filters)if(e instanceof Te)return!1;return!0}function Ff(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+qs(n.value);if(rg(n))return n.filters.map(e=>Ff(e)).join(",");{const e=n.filters.map(t=>Ff(t)).join(",");return`${n.op}(${e})`}}function RT(n,e){return n instanceof he?function(r,i){return i instanceof he&&r.op===i.op&&r.field.isEqual(i.field)&&Wn(r.value,i.value)}(n,e):n instanceof Te?function(r,i){return i instanceof Te&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,l)=>s&&RT(a,i.filters[l]),!0):!1}(n,e):void $()}function bT(n,e){const t=n.filters.concat(e);return Te.create(t,n.op)}function ST(n){return n instanceof he?function(t){return`${t.field.canonicalString()} ${t.op} ${qs(t.value)}`}(n):n instanceof Te?function(t){return t.op.toString()+" {"+t.getFilters().map(ST).join(" ,")+"}"}(n):"Filter"}class a2 extends he{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){const t=F.comparator(e.key,this.key);return this.matchesComparison(t)}}class u2 extends he{constructor(e,t){super(e,"in",t),this.keys=PT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class c2 extends he{constructor(e,t){super(e,"not-in",t),this.keys=PT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function PT(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>F.fromName(r.referenceValue))}class l2 extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ua(t)&&Fa(t.arrayValue,this.value)}}class CT extends he{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Fa(this.value.arrayValue,t)}}class h2 extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(Fa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Fa(this.value.arrayValue,t)}}class d2 extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ua(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Fa(this.value.arrayValue,r))}}class f2{constructor(e,t=null,r=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.ce=null}}function Uf(n,e=null,t=[],r=[],i=null,s=null,a=null){return new f2(n,e,t,r,i,s,a)}function Li(n){const e=B(n);if(e.ce===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Ff(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),lu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>qs(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>qs(r)).join(",")),e.ce=t}return e.ce}function hu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!o2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!RT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Lv(n.startAt,e.startAt)&&Lv(n.endAt,e.endAt)}function nl(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function rl(n,e){return n.filters.filter(t=>t instanceof he&&t.field.isEqual(e))}function Mv(n,e,t){let r=Vc,i=!0;for(const s of rl(n,e)){let a=Vc,l=!0;switch(s.op){case"<":case"<=":a=i2(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,l=!1;break;case"!=":case"not-in":a=Vc}Nv({value:r,inclusive:i},{value:a,inclusive:l})<0&&(r=a,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Nv({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}function Fv(n,e,t){let r=Or,i=!0;for(const s of rl(n,e)){let a=Or,l=!0;switch(s.op){case">=":case">":a=s2(s.value),l=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,l=!1;break;case"!=":case"not-in":a=Or}Vv({value:r,inclusive:i},{value:a,inclusive:l})>0&&(r=a,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];Vv({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}}return{value:r,inclusive:i}}class fr{constructor(e,t=null,r=[],i=[],s=null,a="F",l=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=h,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function kT(n,e,t,r,i,s,a,l){return new fr(n,e,t,r,i,s,a,l)}function oo(n){return new fr(n)}function Uv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ig(n){return n.collectionGroup!==null}function Vs(n){const e=B(n);if(e.le===null){e.le=[];const t=new Set;for(const s of e.explicitOrderBy)e.le.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Re(Ne.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.le.push(new Ba(s,r))}),t.has(Ne.keyField().canonicalString())||e.le.push(new Ba(Ne.keyField(),r))}return e.le}function Nt(n){const e=B(n);return e.he||(e.he=p2(e,Vs(n))),e.he}function p2(n,e){if(n.limitType==="F")return Uf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ba(i.field,s)});const t=n.endAt?new Kr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Kr(n.startAt.position,n.startAt.inclusive):null;return Uf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Bf(n,e){const t=n.filters.concat([e]);return new fr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function il(n,e,t){return new fr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function du(n,e){return hu(Nt(n),Nt(e))&&n.limitType===e.limitType}function DT(n){return`${Li(Nt(n))}|lt:${n.limitType}`}function Es(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>ST(i)).join(", ")}]`),lu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>qs(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>qs(i)).join(",")),`Target(${r})`}(Nt(n))}; limitType=${n.limitType})`}function fu(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):F.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Vs(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,l,h){const f=Ov(a,l,h);return a.inclusive?f<=0:f<0}(r.startAt,Vs(r),i)||r.endAt&&!function(a,l,h){const f=Ov(a,l,h);return a.inclusive?f>=0:f>0}(r.endAt,Vs(r),i))}(n,e)}function xT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function NT(n){return(e,t)=>{let r=!1;for(const i of Vs(n)){const s=g2(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function g2(n,e,t){const r=n.field.isKeyField()?F.comparator(e.key,t.key):function(s,a,l){const h=a.data.field(s),f=l.data.field(s);return h!==null&&f!==null?zr(h,f):$()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return $()}}class ni{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Hi(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return vT(this.inner)}size(){return this.innerSize}}const m2=new Pe(F.comparator);function Wt(){return m2}const VT=new Pe(F.comparator);function ra(...n){let e=VT;for(const t of n)e=e.insert(t.key,t);return e}function OT(n){let e=VT;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ln(){return fa()}function LT(){return fa()}function fa(){return new ni(n=>n.toString(),(n,e)=>n.isEqual(e))}const _2=new Pe(F.comparator),y2=new Re(F.comparator);function re(...n){let e=y2;for(const t of n)e=e.add(t);return e}const v2=new Re(ne);function sg(){return v2}function MT(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:La(e)?"-0":e}}function FT(n){return{integerValue:""+n}}function UT(n,e){return pT(e)?FT(e):MT(n,e)}class Yl{constructor(){this._=void 0}}function I2(n,e,t){return n instanceof Ws?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Ql(s)&&(s=ng(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof Mi?qT(n,e):n instanceof Fi?$T(n,e):function(i,s){const a=BT(i,s),l=Bv(a)+Bv(i.Ie);return Lf(a)&&Lf(i.Ie)?FT(l):MT(i.serializer,l)}(n,e)}function w2(n,e,t){return n instanceof Mi?qT(n,e):n instanceof Fi?$T(n,e):t}function BT(n,e){return n instanceof Gs?function(r){return Lf(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ws extends Yl{}class Mi extends Yl{constructor(e){super(),this.elements=e}}function qT(n,e){const t=WT(e);for(const r of n.elements)t.some(i=>Wn(i,r))||t.push(r);return{arrayValue:{values:t}}}class Fi extends Yl{constructor(e){super(),this.elements=e}}function $T(n,e){let t=WT(e);for(const r of n.elements)t=t.filter(i=>!Wn(i,r));return{arrayValue:{values:t}}}class Gs extends Yl{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Bv(n){return Be(n.integerValue||n.doubleValue)}function WT(n){return Ua(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class pu{constructor(e,t){this.field=e,this.transform=t}}function E2(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Mi&&i instanceof Mi||r instanceof Fi&&i instanceof Fi?Bs(r.elements,i.elements,Wn):r instanceof Gs&&i instanceof Gs?Wn(r.Ie,i.Ie):r instanceof Ws&&i instanceof Ws}(n.transform,e.transform)}class T2{constructor(e,t){this.version=e,this.transformResults=t}}class Ve{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ve}static exists(e){return new Ve(void 0,e)}static updateTime(e){return new Ve(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Lc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Jl{}function GT(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new uo(n.key,Ve.none()):new ao(n.key,n.data,Ve.none());{const t=n.data,r=pt.empty();let i=new Re(Ne.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new pr(n.key,r,new $t(i.toArray()),Ve.none())}}function A2(n,e,t){n instanceof ao?function(i,s,a){const l=i.value.clone(),h=$v(i.fieldTransforms,s,a.transformResults);l.setAll(h),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof pr?function(i,s,a){if(!Lc(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=$v(i.fieldTransforms,s,a.transformResults),h=s.data;h.setAll(zT(i)),h.setAll(l),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function pa(n,e,t,r){return n instanceof ao?function(s,a,l,h){if(!Lc(s.precondition,a))return l;const f=s.value.clone(),p=Wv(s.fieldTransforms,h,a);return f.setAll(p),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof pr?function(s,a,l,h){if(!Lc(s.precondition,a))return l;const f=Wv(s.fieldTransforms,h,a),p=a.data;return p.setAll(zT(s)),p.setAll(f),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,a,l){return Lc(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(n,e,t)}function R2(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=BT(r.transform,i||null);s!=null&&(t===null&&(t=pt.empty()),t.set(r.field,s))}return t||null}function qv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Bs(r,i,(s,a)=>E2(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ao extends Jl{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class pr extends Jl{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function zT(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function $v(n,e,t){const r=new Map;z(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,l=e.data.field(s.field);r.set(s.field,w2(a,l,t[i]))}return r}function Wv(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,I2(s,a,e))}return r}class uo extends Jl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class og extends Jl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ag{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&A2(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=pa(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=pa(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=LT();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=t.has(i.key)?null:l;const h=GT(a,l);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),re())}isEqual(e){return this.batchId===e.batchId&&Bs(this.mutations,e.mutations,(t,r)=>qv(t,r))&&Bs(this.baseMutations,e.baseMutations,(t,r)=>qv(t,r))}}class ug{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){z(e.mutations.length===r.length);let i=function(){return _2}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new ug(e,t,r,i)}}class cg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class b2{constructor(e,t){this.count=e,this.unchangedNames=t}}var Ye,pe;function KT(n){switch(n){default:return $();case S.CANCELLED:case S.UNKNOWN:case S.DEADLINE_EXCEEDED:case S.RESOURCE_EXHAUSTED:case S.INTERNAL:case S.UNAVAILABLE:case S.UNAUTHENTICATED:return!1;case S.INVALID_ARGUMENT:case S.NOT_FOUND:case S.ALREADY_EXISTS:case S.PERMISSION_DENIED:case S.FAILED_PRECONDITION:case S.ABORTED:case S.OUT_OF_RANGE:case S.UNIMPLEMENTED:case S.DATA_LOSS:return!0}}function HT(n){if(n===void 0)return je("GRPC error has no .code"),S.UNKNOWN;switch(n){case Ye.OK:return S.OK;case Ye.CANCELLED:return S.CANCELLED;case Ye.UNKNOWN:return S.UNKNOWN;case Ye.DEADLINE_EXCEEDED:return S.DEADLINE_EXCEEDED;case Ye.RESOURCE_EXHAUSTED:return S.RESOURCE_EXHAUSTED;case Ye.INTERNAL:return S.INTERNAL;case Ye.UNAVAILABLE:return S.UNAVAILABLE;case Ye.UNAUTHENTICATED:return S.UNAUTHENTICATED;case Ye.INVALID_ARGUMENT:return S.INVALID_ARGUMENT;case Ye.NOT_FOUND:return S.NOT_FOUND;case Ye.ALREADY_EXISTS:return S.ALREADY_EXISTS;case Ye.PERMISSION_DENIED:return S.PERMISSION_DENIED;case Ye.FAILED_PRECONDITION:return S.FAILED_PRECONDITION;case Ye.ABORTED:return S.ABORTED;case Ye.OUT_OF_RANGE:return S.OUT_OF_RANGE;case Ye.UNIMPLEMENTED:return S.UNIMPLEMENTED;case Ye.DATA_LOSS:return S.DATA_LOSS;default:return $()}}(pe=Ye||(Ye={}))[pe.OK=0]="OK",pe[pe.CANCELLED=1]="CANCELLED",pe[pe.UNKNOWN=2]="UNKNOWN",pe[pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pe[pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pe[pe.NOT_FOUND=5]="NOT_FOUND",pe[pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",pe[pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",pe[pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",pe[pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pe[pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pe[pe.ABORTED=10]="ABORTED",pe[pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",pe[pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",pe[pe.INTERNAL=13]="INTERNAL",pe[pe.UNAVAILABLE=14]="UNAVAILABLE",pe[pe.DATA_LOSS=15]="DATA_LOSS";function jT(){return new TextEncoder}const S2=new Ns([4294967295,4294967295],0);function Gv(n){const e=jT().encode(n),t=new wF;return t.update(e),new Uint8Array(t.digest())}function zv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ns([t,r],0),new Ns([i,s],0)]}class lg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ia(`Invalid padding: ${t}`);if(r<0)throw new ia(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ia(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ia(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=Ns.fromNumber(this.Te)}de(e,t,r){let i=e.add(t.multiply(Ns.fromNumber(r)));return i.compare(S2)===1&&(i=new Ns([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const t=Gv(e),[r,i]=zv(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);if(!this.Ae(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new lg(s,i,t);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Te===0)return;const t=Gv(e),[r,i]=zv(t);for(let s=0;s<this.hashCount;s++){const a=this.de(r,i,s);this.Re(a)}}Re(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ia extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class gu{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,mu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new gu(K.min(),i,new Pe(ne),Wt(),re())}}class mu{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new mu(r,t,re(),re(),re())}}class Mc{constructor(e,t,r,i){this.Ve=e,this.removedTargetIds=t,this.key=r,this.me=i}}class QT{constructor(e,t){this.targetId=e,this.fe=t}}class YT{constructor(e,t,r=et.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Kv{constructor(){this.ge=0,this.pe=jv(),this.ye=et.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=re(),t=re(),r=re();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:$()}}),new mu(this.ye,this.we,e,t,r)}Fe(){this.Se=!1,this.pe=jv()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,z(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class P2{constructor(e){this.Le=e,this.ke=new Map,this.qe=Wt(),this.Qe=Hv(),this.Ke=new Pe(ne)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(t);break;case 3:this.je(t)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.Ce(e.resumeToken));break;default:$()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){const t=e.targetId,r=e.fe.count,i=this.Ye(t);if(i){const s=i.target;if(nl(s))if(r===0){const a=new F(s.path);this.We(t,a,De.newNoDocument(a,K.min()))}else z(r===1);else{const a=this.Ze(t);if(a!==r){const l=this.Xe(e),h=l?this.et(l,e,a):1;if(h!==0){this.He(t);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,f)}}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,l;try{a=Wr(r).toUint8Array()}catch(h){if(h instanceof IT)return wn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{l=new lg(a,i,s)}catch(h){return wn(h instanceof ia?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return l.Te===0?null:l}et(e,t,r){return t.fe.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const a=this.Le.nt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.We(t,s,null),i++)}),i}it(e){const t=new Map;this.ke.forEach((s,a)=>{const l=this.Ye(a);if(l){if(s.current&&nl(l.target)){const h=new F(l.target.path);this.qe.get(h)!==null||this.st(a,h)||this.We(a,h,De.newNoDocument(h,e))}s.De&&(t.set(a,s.ve()),s.Fe())}});let r=re();this.Qe.forEach((s,a)=>{let l=!0;a.forEachWhile(h=>{const f=this.Ye(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(e));const i=new gu(e,t,this.Ke,this.qe,r);return this.qe=Wt(),this.Qe=Hv(),this.Ke=new Pe(ne),i}Ue(e,t){if(!this.je(e))return;const r=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,r),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,t)?i.Me(t,1):i.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),r&&(this.qe=this.qe.insert(t,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new Kv,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new Re(ne),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=this.Ye(e)!==null;return t||N("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Kv),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Hv(){return new Pe(F.comparator)}function jv(){return new Pe(F.comparator)}const C2=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),k2=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),D2=(()=>({and:"AND",or:"OR"}))();class x2{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function qf(n,e){return n.useProto3Json||lu(e)?e:{value:e}}function zs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function JT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function N2(n,e){return zs(n,e.toTimestamp())}function Qe(n){return z(!!n),K.fromTimestamp(function(t){const r=$r(t);return new Oe(r.seconds,r.nanos)}(n))}function hg(n,e){return function(r){return new ge(["projects",r.projectId,"databases",r.database])}(n).child("documents").child(e).canonicalString()}function XT(n){const e=ge.fromString(n);return z(aA(e)),e}function qa(n,e){return hg(n.databaseId,e.path)}function Un(n,e){const t=XT(e);if(t.get(1)!==n.databaseId.projectId)throw new D(S.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new D(S.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(eA(t))}function $f(n,e){return hg(n.databaseId,e)}function ZT(n){const e=XT(n);return e.length===4?ge.emptyPath():eA(e)}function $a(n){return new ge(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function eA(n){return z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Qv(n,e,t){return{name:qa(n,e),fields:t.value.mapValue.fields}}function tA(n,e,t){const r=Un(n,e.name),i=Qe(e.updateTime),s=e.createTime?Qe(e.createTime):K.min(),a=new pt({mapValue:{fields:e.fields}}),l=De.newFoundDocument(r,i,s,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function V2(n,e){return"found"in e?function(r,i){z(!!i.found),i.found.name,i.found.updateTime;const s=Un(r,i.found.name),a=Qe(i.found.updateTime),l=i.found.createTime?Qe(i.found.createTime):K.min(),h=new pt({mapValue:{fields:i.found.fields}});return De.newFoundDocument(s,a,l,h)}(n,e):"missing"in e?function(r,i){z(!!i.missing),z(!!i.readTime);const s=Un(r,i.missing),a=Qe(i.readTime);return De.newNoDocument(s,a)}(n,e):$()}function O2(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:$()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(f,p){return f.useProto3Json?(z(p===void 0||typeof p=="string"),et.fromBase64String(p||"")):(z(p===void 0||p instanceof Uint8Array),et.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(f){const p=f.code===void 0?S.UNKNOWN:HT(f.code);return new D(p,f.message||"")}(a);t=new YT(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Un(n,r.document.name),s=Qe(r.document.updateTime),a=r.document.createTime?Qe(r.document.createTime):K.min(),l=new pt({mapValue:{fields:r.document.fields}}),h=De.newFoundDocument(i,s,a,l),f=r.targetIds||[],p=r.removedTargetIds||[];t=new Mc(f,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Un(n,r.document),s=r.readTime?Qe(r.readTime):K.min(),a=De.newNoDocument(i,s),l=r.removedTargetIds||[];t=new Mc([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Un(n,r.document),s=r.removedTargetIds||[];t=new Mc([],s,i,null)}else{if(!("filter"in e))return $();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new b2(i,s),l=r.targetId;t=new QT(l,a)}}return t}function Wa(n,e){let t;if(e instanceof ao)t={update:Qv(n,e.key,e.value)};else if(e instanceof uo)t={delete:qa(n,e.key)};else if(e instanceof pr)t={update:Qv(n,e.key,e.data),updateMask:q2(e.fieldMask)};else{if(!(e instanceof og))return $();t={verify:qa(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const l=a.transform;if(l instanceof Ws)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Mi)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Fi)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Gs)return{fieldPath:a.field.canonicalString(),increment:l.Ie};throw $()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:N2(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:$()}(n,e.precondition)),t}function Wf(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Ve.updateTime(Qe(s.updateTime)):s.exists!==void 0?Ve.exists(s.exists):Ve.none()}(e.currentDocument):Ve.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;if("setToServerValue"in l)z(l.setToServerValue==="REQUEST_TIME"),h=new Ws;else if("appendMissingElements"in l){const p=l.appendMissingElements.values||[];h=new Mi(p)}else if("removeAllFromArray"in l){const p=l.removeAllFromArray.values||[];h=new Fi(p)}else"increment"in l?h=new Gs(a,l.increment):$();const f=Ne.fromServerFormat(l.fieldPath);return new pu(f,h)}(n,i)):[];if(e.update){e.update.name;const i=Un(n,e.update.name),s=new pt({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(h){const f=h.fieldPaths||[];return new $t(f.map(p=>Ne.fromServerFormat(p)))}(e.updateMask);return new pr(i,s,a,t,r)}return new ao(i,s,t,r)}if(e.delete){const i=Un(n,e.delete);return new uo(i,t)}if(e.verify){const i=Un(n,e.verify);return new og(i,t)}return $()}function L2(n,e){return n&&n.length>0?(z(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?Qe(i.updateTime):Qe(s);return a.isEqual(K.min())&&(a=Qe(s)),new T2(a,i.transformResults||[])}(t,e))):[]}function nA(n,e){return{documents:[$f(n,e.path)]}}function rA(n,e){const t={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(t.parent=$f(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=$f(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(h){if(h.length!==0)return oA(Te.create(h,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(h){if(h.length!==0)return h.map(f=>function(m){return{field:Ts(m.field),direction:F2(m.dir)}}(f))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=qf(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),t}function iA(n){let e=ZT(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){z(r===1);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){const I=sA(m);return I instanceof Te&&rg(I)?I.getFilters():[I]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(I=>function(L){return new Ba(As(L.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(L.direction))}(I))}(t.orderBy));let l=null;t.limit&&(l=function(m){let I;return I=typeof m=="object"?m.value:m,lu(I)?null:I}(t.limit));let h=null;t.startAt&&(h=function(m){const I=!!m.before,A=m.values||[];return new Kr(A,I)}(t.startAt));let f=null;return t.endAt&&(f=function(m){const I=!m.before,A=m.values||[];return new Kr(A,I)}(t.endAt)),kT(e,i,a,s,l,"F",h,f)}function M2(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function sA(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=As(t.unaryFilter.field);return he.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=As(t.unaryFilter.field);return he.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=As(t.unaryFilter.field);return he.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=As(t.unaryFilter.field);return he.create(a,"!=",{nullValue:"NULL_VALUE"});default:return $()}}(n):n.fieldFilter!==void 0?function(t){return he.create(As(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Te.create(t.compositeFilter.filters.map(r=>sA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $()}}(t.compositeFilter.op))}(n):$()}function F2(n){return C2[n]}function U2(n){return k2[n]}function B2(n){return D2[n]}function Ts(n){return{fieldPath:n.canonicalString()}}function As(n){return Ne.fromServerFormat(n.fieldPath)}function oA(n){return n instanceof he?function(t){if(t.op==="=="){if(xv(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NAN"}};if(Dv(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(xv(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NOT_NAN"}};if(Dv(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ts(t.field),op:U2(t.op),value:t.value}}}(n):n instanceof Te?function(t){const r=t.getFilters().map(i=>oA(i));return r.length===1?r[0]:{compositeFilter:{op:B2(t.op),filters:r}}}(n):$()}function q2(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function aA(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class ir{constructor(e,t,r,i,s=K.min(),a=K.min(),l=et.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(e){return new ir(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class uA{constructor(e){this.ut=e}}function $2(n,e){let t;if(e.document)t=tA(n.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=F.fromSegments(e.noDocument.path),i=Bi(e.noDocument.readTime);t=De.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return $();{const r=F.fromSegments(e.unknownDocument.path),i=Bi(e.unknownDocument.version);t=De.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Oe(i[0],i[1]);return K.fromTimestamp(s)}(e.readTime)),t}function Yv(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:sl(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,a){return{name:qa(s,a.key),fields:a.data.value.mapValue.fields,updateTime:zs(s,a.version.toTimestamp()),createTime:zs(s,a.createTime.toTimestamp())}}(n.ut,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ui(e.version)};else{if(!e.isUnknownDocument())return $();r.unknownDocument={path:t.path.toArray(),version:Ui(e.version)}}return r}function sl(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ui(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Bi(n){const e=new Oe(n.seconds,n.nanoseconds);return K.fromTimestamp(e)}function yi(n,e){const t=(e.baseMutations||[]).map(s=>Wf(n.ut,s));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];a.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Wf(n.ut,s)),i=Oe.fromMillis(e.localWriteTimeMs);return new ag(e.batchId,i,t,r)}function sa(n){const e=Bi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Bi(n.lastLimboFreeSnapshotVersion):K.min();let r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return z(s.documents.length===1),Nt(oo(ZT(s.documents[0])))}(n.query):function(s){return Nt(iA(s))}(n.query),new ir(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,et.fromBase64String(n.resumeToken))}function cA(n,e){const t=Ui(e.snapshotVersion),r=Ui(e.lastLimboFreeSnapshotVersion);let i;i=nl(e.target)?nA(n.ut,e.target):rA(n.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Li(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function dg(n){const e=iA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?il(e,e.limit,"L"):e}function sf(n,e){return new cg(e.largestBatchId,Wf(n.ut,e.overlayMutation))}function Jv(n,e){const t=e.path.lastSegment();return[n,xt(e.path.popLast()),t]}function Xv(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Ui(r.readTime),documentKey:xt(r.documentKey.path),largestBatchId:r.largestBatchId}}class W2{getBundleMetadata(e,t){return Zv(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Bi(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return Zv(e).put(function(i){return{bundleId:i.id,createTime:Ui(Qe(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return eI(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:dg(s.bundledQuery),readTime:Bi(s.readTime)}}(r)})}saveNamedQuery(e,t){return eI(e).put(function(i){return{name:i.name,readTime:Ui(Qe(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function Zv(n){return at(n,"bundles")}function eI(n){return at(n,"namedQueries")}class Xl{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){const r=t.uid||"";return new Xl(e,r)}getOverlay(e,t){return Wo(e).get(Jv(this.userId,t)).next(r=>r?sf(this.serializer,r):null)}getOverlays(e,t){const r=Ln();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,a)=>{const l=new cg(t,a);i.push(this.lt(e,l))}),R.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(a=>i.add(xt(a.getCollectionPath())));const s=[];return i.forEach(a=>{const l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(Wo(e).H("collectionPathOverlayIndex",l))}),R.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Ln(),s=xt(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Wo(e).W("collectionPathOverlayIndex",a).next(l=>{for(const h of l){const f=sf(this.serializer,h);i.set(f.getKey(),f)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Ln();let a;const l=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Wo(e).Y({index:"collectionGroupOverlayIndex",range:l},(h,f,p)=>{const m=sf(this.serializer,f);s.size()<i||m.largestBatchId===a?(s.set(m.getKey(),m),a=m.largestBatchId):p.done()}).next(()=>s)}lt(e,t){return Wo(e).put(function(i,s,a){const[l,h,f]=Jv(s,a.mutation.key);return{userId:s,collectionPath:h,documentId:f,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Wa(i.ut,a.mutation)}}(this.serializer,this.userId,t))}}function Wo(n){return at(n,"documentOverlays")}class vi{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(Be(e.integerValue));else if("doubleValue"in e){const r=Be(e.doubleValue);isNaN(r)?this.Tt(t,13):(this.Tt(t,15),La(r)?t.Et(0):t.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(t,20),typeof r=="string"?t.dt(r):(t.dt(`${r.seconds||""}`),t.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(Wr(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(t,45),t.Et(r.latitude||0),t.Et(r.longitude||0)}else"mapValue"in e?wT(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):$()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const r=e.fields||{};this.Tt(t,55);for(const i of Object.keys(r))this.At(i,t),this.Pt(r[i],t)}yt(e,t){const r=e.values||[];this.Tt(t,50);for(const i of r)this.Pt(i,t)}ft(e,t){this.Tt(t,37),F.fromName(e).path.forEach(r=>{this.Tt(t,60),this.wt(r,t)})}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}vi.St=new vi;function G2(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function tI(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const a=G2(255&r[s]);if(i+=a,a!==8)break}return i}(n);return Math.ceil(e/8)}class z2{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Dt(r.value),r=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=t.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const t=this.Bt(e),r=tI(t);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}kt(e){const t=this.Bt(e),r=tI(t);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Dt(e){const t=255&e;t===0?(this.Qt(0),this.Qt(255)):t===255?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;t===0?(this.$t(0),this.$t(255)):t===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class K2{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class H2{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class Go{constructor(){this.Wt=new z2,this.Gt=new K2(this.Wt),this.zt=new H2(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class Ii{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ii(this.indexId,this.documentKey,this.arrayValue,r)}}function Sr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=nI(n.arrayValue,e.arrayValue),t!==0?t:(t=nI(n.directionalValue,e.directionalValue),t!==0?t:F.comparator(n.documentKey,e.documentKey)))}function nI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}class rI{constructor(e){this.Jt=new Re((t,r)=>Ne.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const r=t;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(z(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=Nf(e);if(t!==void 0&&!this.tn(t))return!1;const r=mi(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const l=this.Jt.getIterator().getNext();if(!i.has(l.field.canonicalString())){const h=r[s];if(!this.nn(l,h)||!this.rn(this.Yt[a++],h))return!1}++s}for(;s<r.length;++s){const l=r[s];if(a>=this.Yt.length||!this.rn(this.Yt[a++],l))return!1}return!0}sn(){if(this.Xt)return null;let e=new Re(Ne.comparator);const t=[];for(const r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new xc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new xc(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new xc(r.field,r.dir==="asc"?0:1)));return new tl(tl.UNKNOWN_ID,this.collectionId,t,Oa.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function lA(n){var e,t;if(z(n instanceof he||n instanceof Te),n instanceof he){if(n instanceof CT){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>he.create(n.field,"==",s)))||[];return Te.create(i,"or")}return n}const r=n.filters.map(i=>lA(i));return Te.create(r,n.op)}function j2(n){if(n.getFilters().length===0)return[];const e=Kf(lA(n));return z(hA(e)),Gf(e)||zf(e)?[e]:e.getFilters()}function Gf(n){return n instanceof he}function zf(n){return n instanceof Te&&rg(n)}function hA(n){return Gf(n)||zf(n)||function(t){if(t instanceof Te&&Mf(t)){for(const r of t.getFilters())if(!Gf(r)&&!zf(r))return!1;return!0}return!1}(n)}function Kf(n){if(z(n instanceof he||n instanceof Te),n instanceof he)return n;if(n.filters.length===1)return Kf(n.filters[0]);const e=n.filters.map(r=>Kf(r));let t=Te.create(e,n.op);return t=ol(t),hA(t)?t:(z(t instanceof Te),z($s(t)),z(t.filters.length>1),t.filters.reduce((r,i)=>fg(r,i)))}function fg(n,e){let t;return z(n instanceof he||n instanceof Te),z(e instanceof he||e instanceof Te),t=n instanceof he?e instanceof he?function(i,s){return Te.create([i,s],"and")}(n,e):iI(n,e):e instanceof he?iI(e,n):function(i,s){if(z(i.filters.length>0&&s.filters.length>0),$s(i)&&$s(s))return bT(i,s.getFilters());const a=Mf(i)?i:s,l=Mf(i)?s:i,h=a.filters.map(f=>fg(f,l));return Te.create(h,"or")}(n,e),ol(t)}function iI(n,e){if($s(e))return bT(e,n.getFilters());{const t=e.filters.map(r=>fg(n,r));return Te.create(t,"or")}}function ol(n){if(z(n instanceof he||n instanceof Te),n instanceof he)return n;const e=n.getFilters();if(e.length===1)return ol(e[0]);if(AT(n))return n;const t=e.map(i=>ol(i)),r=[];return t.forEach(i=>{i instanceof he?r.push(i):i instanceof Te&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Te.create(r,n.op)}class Q2{constructor(){this.on=new pg}addToCollectionParentIndex(e,t){return this.on.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(Zt.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(Zt.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}}class pg{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Re(ge.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Re(ge.comparator)).toArray()}}const Ac=new Uint8Array(0);class Y2{constructor(e,t){this.user=e,this.databaseId=t,this._n=new pg,this.an=new ni(r=>Li(r),(r,i)=>hu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this._n.add(t)});const s={collectionId:r,parent:xt(i)};return sI(e).put(s)}return R.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[cT(t),""],!1,!0);return sI(e).W(i).next(s=>{for(const a of s){if(a.collectionId!==t)break;r.push(On(a.parent))}return r})}addFieldIndex(e,t){const r=zo(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(t);delete i.indexId;const s=r.add(i);if(t.indexState){const a=vs(e);return s.next(l=>{a.put(Xv(l,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=zo(e),i=vs(e),s=ys(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=zo(e),r=ys(e),i=vs(e);return t.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,t){return R.forEach(this.un(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new rI(r).sn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=ys(e);let i=!0;const s=new Map;return R.forEach(this.un(t),a=>this.cn(e,a).next(l=>{i&&(i=!!l),s.set(a,l)})).next(()=>{if(i){let a=re();const l=[];return R.forEach(s,(h,f)=>{N("IndexedDbIndexManager",`Using index ${function(j){return`id=${j.indexId}|cg=${j.collectionGroup}|f=${j.fields.map(ye=>`${ye.fieldPath}:${ye.kind}`).join(",")}`}(h)} to execute ${Li(t)}`);const p=function(j,ye){const de=Nf(ye);if(de===void 0)return null;for(const me of rl(j,de.fieldPath))switch(me.op){case"array-contains-any":return me.value.arrayValue.values||[];case"array-contains":return[me.value]}return null}(f,h),m=function(j,ye){const de=new Map;for(const me of mi(ye))for(const we of rl(j,me.fieldPath))switch(we.op){case"==":case"in":de.set(me.fieldPath.canonicalString(),we.value);break;case"not-in":case"!=":return de.set(me.fieldPath.canonicalString(),we.value),Array.from(de.values())}return null}(f,h),I=function(j,ye){const de=[];let me=!0;for(const we of mi(ye)){const Vt=we.kind===0?Mv(j,we.fieldPath,j.startAt):Fv(j,we.fieldPath,j.startAt);de.push(Vt.value),me&&(me=Vt.inclusive)}return new Kr(de,me)}(f,h),A=function(j,ye){const de=[];let me=!0;for(const we of mi(ye)){const Vt=we.kind===0?Fv(j,we.fieldPath,j.endAt):Mv(j,we.fieldPath,j.endAt);de.push(Vt.value),me&&(me=Vt.inclusive)}return new Kr(de,me)}(f,h),L=this.ln(h,f,I),M=this.ln(h,f,A),V=this.hn(h,f,m),Y=this.Pn(h.indexId,p,L,I.inclusive,M,A.inclusive,V);return R.forEach(Y,ae=>r.j(ae,t.limit).next(j=>{j.forEach(ye=>{const de=F.fromSegments(ye.documentKey);a.has(de)||(a=a.add(de),l.push(de))})}))}).next(()=>l)}return R.resolve(null)})}un(e){let t=this.an.get(e);return t||(e.filters.length===0?t=[e]:t=j2(Te.create(e.filters,"and")).map(r=>Uf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,t),t)}Pn(e,t,r,i,s,a,l){const h=(t!=null?t.length:1)*Math.max(r.length,s.length),f=h/(t!=null?t.length:1),p=[];for(let m=0;m<h;++m){const I=t?this.In(t[m/f]):Ac,A=this.Tn(e,I,r[m%f],i),L=this.En(e,I,s[m%f],a),M=l.map(V=>this.Tn(e,I,V,!0));p.push(...this.createRange(A,L,M))}return p}Tn(e,t,r,i){const s=new Ii(e,F.empty(),t,r);return i?s:s.Ht()}En(e,t,r,i){const s=new Ii(e,F.empty(),t,r);return i?s.Ht():s}cn(e,t){const r=new rI(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const l of s)r.en(l)&&(!a||l.fields.length>a.fields.length)&&(a=l);return a})}getIndexType(e,t){let r=2;const i=this.un(t);return R.forEach(i,s=>this.cn(e,s).next(a=>{a?r!==0&&a.fields.length<function(h){let f=new Re(Ne.comparator),p=!1;for(const m of h.filters)for(const I of m.getFlattenedFilters())I.field.isKeyField()||(I.op==="array-contains"||I.op==="array-contains-any"?p=!0:f=f.add(I.field));for(const m of h.orderBy)m.field.isKeyField()||(f=f.add(m.field));return f.size+(p?1:0)}(s)&&(r=1):r=0})).next(()=>function(a){return a.limit!==null}(t)&&i.length>1&&r===2?1:r)}dn(e,t){const r=new Go;for(const i of mi(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const a=r.jt(i.kind);vi.St.ht(s,a)}return r.Ut()}In(e){const t=new Go;return vi.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const r=new Go;return vi.St.ht(Oi(this.databaseId,t),r.jt(function(s){const a=mi(s);return a.length===0?0:a[a.length-1].kind}(e))),r.Ut()}hn(e,t,r){if(r===null)return[];let i=[];i.push(new Go);let s=0;for(const a of mi(e)){const l=r[s++];for(const h of i)if(this.Rn(t,a.fieldPath)&&Ua(l))i=this.Vn(i,a,l);else{const f=h.jt(a.kind);vi.St.ht(l,f)}}return this.mn(i)}ln(e,t,r){return this.hn(e,t,r.position)}mn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Ut();return t}Vn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const l of i){const h=new Go;h.seed(l.Ut()),vi.St.ht(a,h.jt(t.kind)),s.push(h)}return s}Rn(e,t){return!!e.filters.find(r=>r instanceof he&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=zo(e),i=vs(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(s=>{const a=[];return R.forEach(s,l=>i.get([l.indexId,this.uid]).next(h=>{a.push(function(p,m){const I=m?new Oa(m.sequenceNumber,new Zt(Bi(m.readTime),new F(On(m.documentKey)),m.largestBatchId)):Oa.empty(),A=p.fields.map(([L,M])=>new xc(Ne.fromServerFormat(L),M));return new tl(p.indexId,p.collectionGroup,A,I)}(l,h))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ne(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=zo(e),s=vs(e);return this.fn(e).next(a=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(l=>R.forEach(l,h=>s.put(Xv(h.indexId,this.user,a,r)))))}updateIndexEntries(e,t){const r=new Map;return R.forEach(t,(i,s)=>{const a=r.get(i.collectionGroup);return(a?R.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(r.set(i.collectionGroup,l),R.forEach(l,h=>this.gn(e,i,h).next(f=>{const p=this.pn(s,h);return f.isEqual(p)?R.resolve():this.yn(e,s,h,f,p)}))))})}wn(e,t,r,i){return ys(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,r,i){return ys(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,t.key),t.key.path.toArray()])}gn(e,t,r){const i=ys(e);let s=new Re(Sr);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,t)])},(a,l)=>{s=s.add(new Ii(r.indexId,t,l.arrayValue,l.directionalValue))}).next(()=>s)}pn(e,t){let r=new Re(Sr);const i=this.dn(t,e);if(i==null)return r;const s=Nf(t);if(s!=null){const a=e.data.field(s.fieldPath);if(Ua(a))for(const l of a.arrayValue.values||[])r=r.add(new Ii(t.indexId,e.key,this.In(l),i))}else r=r.add(new Ii(t.indexId,e.key,Ac,i));return r}yn(e,t,r,i,s){N("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(h,f,p,m,I){const A=h.getIterator(),L=f.getIterator();let M=_s(A),V=_s(L);for(;M||V;){let Y=!1,ae=!1;if(M&&V){const j=p(M,V);j<0?ae=!0:j>0&&(Y=!0)}else M!=null?ae=!0:Y=!0;Y?(m(V),V=_s(L)):ae?(I(M),M=_s(A)):(M=_s(A),V=_s(L))}}(i,s,Sr,l=>{a.push(this.wn(e,t,r,l))},l=>{a.push(this.Sn(e,t,r,l))}),R.waitFor(a)}fn(e){let t=1;return vs(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((a,l)=>Sr(a,l)).filter((a,l,h)=>!l||Sr(a,h[l-1])!==0);const i=[];i.push(e);for(const a of r){const l=Sr(a,e),h=Sr(a,t);if(l===0)i[0]=e.Ht();else if(l>0&&h<0)i.push(a),i.push(a.Ht());else if(h>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.bn(i[a],i[a+1]))return[];const l=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Ac,[]],h=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Ac,[]];s.push(IDBKeyRange.bound(l,h))}return s}bn(e,t){return Sr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(oI)}getMinOffset(e,t){return R.mapArray(this.un(t),r=>this.cn(e,r).next(i=>i||$())).next(oI)}}function sI(n){return at(n,"collectionParents")}function ys(n){return at(n,"indexEntries")}function zo(n){return at(n,"indexConfiguration")}function vs(n){return at(n,"indexState")}function oI(n){z(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;eg(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Zt(e.readTime,e.documentKey,t)}const aI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Bt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Bt(e,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function dA(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let l=0;const h=r.Y({range:a},(p,m,I)=>(l++,I.delete()));s.push(h.next(()=>{z(l===1)}));const f=[];for(const p of t.mutations){const m=gT(e,p.key.path,t.batchId);s.push(i.delete(m)),f.push(p.key)}return R.waitFor(s).next(()=>f)}function al(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw $();e=n.noDocument}return JSON.stringify(e).length}Bt.DEFAULT_COLLECTION_PERCENTILE=10,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bt.DEFAULT=new Bt(41943040,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bt.DISABLED=new Bt(-1,0,0);class Zl{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,t,r,i){z(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Zl(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pr(e).Y({index:"userMutationsIndex",range:r},(i,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Rs(e),a=Pr(e);return a.add({}).next(l=>{z(typeof l=="number");const h=new ag(l,t,r,i),f=function(A,L,M){const V=M.baseMutations.map(ae=>Wa(A.ut,ae)),Y=M.mutations.map(ae=>Wa(A.ut,ae));return{userId:L,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:V,mutations:Y}}(this.serializer,this.userId,h),p=[];let m=new Re((I,A)=>ne(I.canonicalString(),A.canonicalString()));for(const I of i){const A=gT(this.userId,I.key.path,l);m=m.add(I.key.path.popLast()),p.push(a.put(f)),p.push(s.put(A,FF))}return m.forEach(I=>{p.push(this.indexManager.addToCollectionParentIndex(e,I))}),e.addOnCommittedListener(()=>{this.Dn[l]=h.keys()}),R.waitFor(p).next(()=>h)})}lookupMutationBatch(e,t){return Pr(e).get(t).next(r=>r?(z(r.userId===this.userId),yi(this.serializer,r)):null)}Cn(e,t){return this.Dn[t]?R.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Dn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Pr(e).Y({index:"userMutationsIndex",range:i},(a,l,h)=>{l.userId===this.userId&&(z(l.batchId>=r),s=yi(this.serializer,l)),h.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Pr(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(i,s,a)=>{r=s.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Pr(e).W("userMutationsIndex",t).next(r=>r.map(i=>yi(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Nc(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Rs(e).Y({range:i},(a,l,h)=>{const[f,p,m]=a,I=On(p);if(f===this.userId&&t.path.isEqual(I))return Pr(e).get(m).next(A=>{if(!A)throw $();z(A.userId===this.userId),s.push(yi(this.serializer,A))});h.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(ne);const i=[];return t.forEach(s=>{const a=Nc(this.userId,s.path),l=IDBKeyRange.lowerBound(a),h=Rs(e).Y({range:l},(f,p,m)=>{const[I,A,L]=f,M=On(A);I===this.userId&&s.path.isEqual(M)?r=r.add(L):m.done()});i.push(h)}),R.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Nc(this.userId,r),a=IDBKeyRange.lowerBound(s);let l=new Re(ne);return Rs(e).Y({range:a},(h,f,p)=>{const[m,I,A]=h,L=On(I);m===this.userId&&r.isPrefixOf(L)?L.length===i&&(l=l.add(A)):p.done()}).next(()=>this.vn(e,l))}vn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(Pr(e).get(s).next(a=>{if(a===null)throw $();z(a.userId===this.userId),r.push(yi(this.serializer,a))}))}),R.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return dA(e.ae,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Fn(t.batchId)}),R.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return R.resolve();const r=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return Rs(e).Y({range:r},(s,a,l)=>{if(s[0]===this.userId){const h=On(s[1]);i.push(h)}else l.done()}).next(()=>{z(i.length===0)})})}containsKey(e,t){return fA(e,this.userId,t)}Mn(e){return pA(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function fA(n,e,t){const r=Nc(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Rs(n).Y({range:s,J:!0},(l,h,f)=>{const[p,m,I]=l;p===e&&m===i&&(a=!0),f.done()}).next(()=>a)}function Pr(n){return at(n,"mutations")}function Rs(n){return at(n,"documentMutations")}function pA(n){return at(n,"mutationQueues")}class qi{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new qi(0)}static Nn(){return new qi(-1)}}class J2{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const r=new qi(t.highestTargetId);return t.highestTargetId=r.next(),this.Ln(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>K.fromTimestamp(new Oe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Ln(e,i)))}addTargetData(e,t){return this.kn(e,t).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(t,r),this.Ln(e,r))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Is(e).delete(t.targetId)).next(()=>this.Bn(e)).next(r=>(z(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Is(e).Y((a,l)=>{const h=sa(l);h.sequenceNumber<=t&&r.get(h.targetId)===null&&(i++,s.push(this.removeTargetData(e,h)))}).next(()=>R.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Is(e).Y((r,i)=>{const s=sa(i);t(s)})}Bn(e){return uI(e).get("targetGlobalKey").next(t=>(z(t!==null),t))}Ln(e,t){return uI(e).put("targetGlobalKey",t)}kn(e,t){return Is(e).put(cA(this.serializer,t))}qn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Li(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Is(e).Y({range:i,index:"queryTargetsIndex"},(a,l,h)=>{const f=sa(l);hu(t,f.target)&&(s=f,h.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=Dr(e);return t.forEach(a=>{const l=xt(a.path);i.push(s.put({targetId:r,path:l})),i.push(this.referenceDelegate.addReference(e,r,a))}),R.waitFor(i)}removeMatchingKeys(e,t,r){const i=Dr(e);return R.forEach(t,s=>{const a=xt(s.path);return R.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=Dr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Dr(e);let s=re();return i.Y({range:r,J:!0},(a,l,h)=>{const f=On(a[1]),p=new F(f);s=s.add(p)}).next(()=>s)}containsKey(e,t){const r=xt(t.path),i=IDBKeyRange.bound([r],[cT(r)],!1,!0);let s=0;return Dr(e).Y({index:"documentTargetsIndex",J:!0,range:i},([a,l],h,f)=>{a!==0&&(s++,f.done())}).next(()=>s>0)}_t(e,t){return Is(e).get(t).next(r=>r?sa(r):null)}}function Is(n){return at(n,"targets")}function uI(n){return at(n,"targetGlobal")}function Dr(n){return at(n,"targetDocuments")}function cI([n,e],[t,r]){const i=ne(n,t);return i===0?ne(e,r):i}class X2{constructor(e){this.Qn=e,this.buffer=new Re(cI),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();cI(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Z2{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){N("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ti(t)?N("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await ei(t)}await this.Gn(3e5)})}}class eU{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(qt._e);const r=new X2(t);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(N("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(aI)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(N("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),aI):this.Jn(e,t))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let r,i,s,a,l,h,f;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(N("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,a=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,t))).next(m=>(s=m,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(f=Date.now(),ws()<=ce.DEBUG&&N("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${s} targets in `+(h-l)+`ms
	Removed ${m} documents in `+(f-h)+`ms
Total Duration: ${f-p}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function tU(n,e){return new eU(n,e)}class nU{constructor(e,t){this.db=e,this.garbageCollector=tU(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Yn(e){let t=0;return this.Hn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,(r,i)=>t(i))}addReference(e,t,r){return Rc(e,r)}removeReference(e,t,r){return Rc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Rc(e,t)}Xn(e,t){return function(i,s){let a=!1;return pA(i).Z(l=>fA(i,l,s).next(h=>(h&&(a=!0),R.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(a,l)=>{if(l<=t){const h=this.Xn(e,a).next(f=>{if(!f)return s++,r.getEntry(e,a).next(()=>(r.removeEntry(a,K.min()),Dr(e).delete(function(m){return[0,xt(m.path)]}(a))))});i.push(h)}}).next(()=>R.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Rc(e,t)}Zn(e,t){const r=Dr(e);let i,s=qt._e;return r.Y({index:"documentTargetsIndex"},([a,l],{path:h,sequenceNumber:f})=>{a===0?(s!==qt._e&&t(new F(On(i)),s),s=f,i=h):s=qt._e}).next(()=>{s!==qt._e&&t(new F(On(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Rc(n,e){return Dr(n).put(function(r,i){return{targetId:0,path:xt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}class gA{constructor(){this.changes=new ni(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,De.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class rU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return pi(e).put(r)}removeEntry(e,t,r){return pi(e).delete(function(s,a){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],sl(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.er(e,r)))}getEntry(e,t){let r=De.newInvalidDocument(t);return pi(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Ko(t))},(i,s)=>{r=this.tr(t,s)}).next(()=>r)}nr(e,t){let r={size:0,document:De.newInvalidDocument(t)};return pi(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Ko(t))},(i,s)=>{r={document:this.tr(t,s),size:al(s)}}).next(()=>r)}getEntries(e,t){let r=Wt();return this.rr(e,t,(i,s)=>{const a=this.tr(i,s);r=r.insert(i,a)}).next(()=>r)}ir(e,t){let r=Wt(),i=new Pe(F.comparator);return this.rr(e,t,(s,a)=>{const l=this.tr(s,a);r=r.insert(s,l),i=i.insert(s,al(a))}).next(()=>({documents:r,sr:i}))}rr(e,t,r){if(t.isEmpty())return R.resolve();let i=new Re(dI);t.forEach(h=>i=i.add(h));const s=IDBKeyRange.bound(Ko(i.first()),Ko(i.last())),a=i.getIterator();let l=a.getNext();return pi(e).Y({index:"documentKeyIndex",range:s},(h,f,p)=>{const m=F.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;l&&dI(l,m)<0;)r(l,null),l=a.getNext();l&&l.isEqual(m)&&(r(l,f),l=a.hasNext()?a.getNext():null),l?p.U(Ko(l)):p.done()}).next(()=>{for(;l;)r(l,null),l=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const a=t.path,l=[a.popLast().toArray(),a.lastSegment(),sl(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return pi(e).W(IDBKeyRange.bound(l,h,!0)).next(f=>{s==null||s.incrementDocumentReadCount(f.length);let p=Wt();for(const m of f){const I=this.tr(F.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);I.isFoundDocument()&&(fu(t,I)||i.has(I.key))&&(p=p.insert(I.key,I))}return p})}getAllFromCollectionGroup(e,t,r,i){let s=Wt();const a=hI(t,r),l=hI(t,Zt.max());return pi(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,l,!0)},(h,f,p)=>{const m=this.tr(F.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(m.key,m),s.size===i&&p.done()}).next(()=>s)}newChangeBuffer(e){return new iU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return lI(e).get("remoteDocumentGlobalKey").next(t=>(z(!!t),t))}er(e,t){return lI(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const r=$2(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(K.min())))return r}return De.newInvalidDocument(e)}}function mA(n){return new rU(n)}class iU extends gA{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new ni(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Re((s,a)=>ne(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const l=this.ar.get(s);if(t.push(this._r.removeEntry(e,s,l.readTime)),a.isValidDocument()){const h=Yv(this._r.serializer,a);i=i.add(s.path.popLast());const f=al(h);r+=f-l.size,t.push(this._r.addEntry(e,s,h))}else if(r-=l.size,this.trackRemovals){const h=Yv(this._r.serializer,a.convertToNoDocument(K.min()));t.push(this._r.addEntry(e,s,h))}}),i.forEach(s=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),t.push(this._r.updateMetadata(e,r)),R.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next(r=>(this.ar.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this._r.ir(e,t).next(({documents:r,sr:i})=>(i.forEach((s,a)=>{this.ar.set(s,{size:a,readTime:r.get(s).readTime})}),r))}}function lI(n){return at(n,"remoteDocumentGlobal")}function pi(n){return at(n,"remoteDocumentsV14")}function Ko(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function hI(n,e){const t=e.documentKey.path.toArray();return[n,sl(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function dI(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ne(t[s],r[s]),i)return i;return i=ne(t.length,r.length),i||(i=ne(t[t.length-2],r[r.length-2]),i||ne(t[t.length-1],r[r.length-1]))}class sU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class _A{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&pa(r.mutation,i,$t.empty(),Oe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,t,r=re()){const i=Ln();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=ra();return s.forEach((l,h)=>{a=a.insert(l,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=Ln();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,re()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{t.set(a,l)})})}computeViews(e,t,r,i){let s=Wt();const a=fa(),l=function(){return fa()}();return t.forEach((h,f)=>{const p=r.get(f.key);i.has(f.key)&&(p===void 0||p.mutation instanceof pr)?s=s.insert(f.key,f):p!==void 0?(a.set(f.key,p.mutation.getFieldMask()),pa(p.mutation,f,p.mutation.getFieldMask(),Oe.now())):a.set(f.key,$t.empty())}),this.recalculateAndSaveOverlays(e,s).next(h=>(h.forEach((f,p)=>a.set(f,p)),t.forEach((f,p)=>{var m;return l.set(f,new sU(p,(m=a.get(f))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,t){const r=fa();let i=new Pe((a,l)=>a-l),s=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const l of a)l.keys().forEach(h=>{const f=t.get(h);if(f===null)return;let p=r.get(h)||$t.empty();p=l.applyToLocalView(f,p),r.set(h,p);const m=(i.get(l.batchId)||re()).add(h);i=i.insert(l.batchId,m)})}).next(()=>{const a=[],l=i.getReverseIterator();for(;l.hasNext();){const h=l.getNext(),f=h.key,p=h.value,m=LT();p.forEach(I=>{if(!s.has(I)){const A=GT(t.get(I),r.get(I));A!==null&&m.set(I,A),s=s.add(I)}}),a.push(this.documentOverlayCache.saveOverlays(e,f,m))}return R.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ig(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):R.resolve(Ln());let l=-1,h=s;return a.next(f=>R.forEach(f,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(p)?R.resolve():this.remoteDocumentCache.getEntry(e,p).next(I=>{h=h.insert(p,I)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,h,f,re())).next(p=>({batchId:l,changes:OT(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next(r=>{let i=ra();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=ra();return this.indexManager.getCollectionParents(e,s).next(l=>R.forEach(l,h=>{const f=function(m,I){return new fr(I,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,h.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next(p=>{p.forEach((m,I)=>{a=a.insert(m,I)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((h,f)=>{const p=f.getKey();a.get(p)===null&&(a=a.insert(p,De.newInvalidDocument(p)))});let l=ra();return a.forEach((h,f)=>{const p=s.get(h);p!==void 0&&pa(p.mutation,f,$t.empty(),Oe.now()),fu(t,f)&&(l=l.insert(h,f))}),l})}}class oU{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return R.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Qe(i.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,function(i){return{name:i.name,query:dg(i.bundledQuery),readTime:Qe(i.readTime)}}(t)),R.resolve()}}class aU{constructor(){this.overlays=new Pe(F.comparator),this.lr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ln();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.lt(e,t,s)}),R.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){const i=Ln(),s=t.length+1,a=new F(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const h=l.getNext().value,f=h.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&h.largestBatchId>r&&i.set(h.getKey(),h)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Pe((f,p)=>f-p);const a=this.overlays.getIterator();for(;a.hasNext();){const f=a.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let p=s.get(f.largestBatchId);p===null&&(p=Ln(),s=s.insert(f.largestBatchId,p)),p.set(f.getKey(),f)}}const l=Ln(),h=s.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((f,p)=>l.set(f,p)),!(l.size()>=i)););return R.resolve(l)}lt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new cg(t,r));let s=this.lr.get(t);s===void 0&&(s=re(),this.lr.set(t,s)),this.lr.set(t,s.add(r.key))}}class gg{constructor(){this.hr=new Re(nt.Pr),this.Ir=new Re(nt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const r=new nt(e,t);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.dr(new nt(e,t))}Ar(e,t){e.forEach(r=>this.removeReference(r,t))}Rr(e){const t=new F(new ge([])),r=new nt(t,e),i=new nt(t,e+1),s=[];return this.Ir.forEachInRange([r,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new F(new ge([])),r=new nt(t,e),i=new nt(t,e+1);let s=re();return this.Ir.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new nt(e,0),r=this.hr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class nt{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return F.comparator(e.key,t.key)||ne(e.gr,t.gr)}static Tr(e,t){return ne(e.gr,t.gr)||F.comparator(e.key,t.key)}}class uU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new Re(nt.Pr)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ag(s,t,r,i);this.mutationQueue.push(a);for(const l of i)this.yr=this.yr.add(new nt(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Sr(r),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new nt(t,0),i=new nt(t,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],a=>{const l=this.wr(a.gr);s.push(l)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(ne);return t.forEach(i=>{const s=new nt(i,0),a=new nt(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],l=>{r=r.add(l.gr)})}),R.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;F.isDocumentKey(s)||(s=s.child(""));const a=new nt(new F(s),0);let l=new Re(ne);return this.yr.forEachWhile(h=>{const f=h.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(l=l.add(h.gr)),!0)},a),R.resolve(this.br(l))}br(e){const t=[];return e.forEach(r=>{const i=this.wr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){z(this.Dr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return R.forEach(t.mutations,i=>{const s=new nt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,t){const r=new nt(t,0),i=this.yr.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class cU{constructor(e){this.Cr=e,this.docs=function(){return new Pe(F.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Cr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():De.newInvalidDocument(t))}getEntries(e,t){let r=Wt();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():De.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Wt();const a=t.path,l=new F(a.child("")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){const{key:f,value:{document:p}}=h.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||eg(hT(p),r)<=0||(i.has(p.key)||fu(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,t,r,i){$()}vr(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new lU(this)}getSize(e){return R.resolve(this.size)}}class lU extends gA{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class hU{constructor(e){this.persistence=e,this.Fr=new ni(t=>Li(t),hu),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Mr=0,this.Or=new gg,this.targetCount=0,this.Nr=qi.On()}forEachTarget(e,t){return this.Fr.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Mr&&(this.Mr=t),R.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new qi(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.kn(t),R.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Fr.forEach((a,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){const r=this.Fr.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.Or.Er(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.Or.Ar(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),R.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Or.mr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.Or.containsKey(t))}}class yA{constructor(e,t){this.Br={},this.overlays={},this.Lr=new qt(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new hU(this),this.indexManager=new Q2,this.remoteDocumentCache=function(i){return new cU(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new uA(t),this.Kr=new oU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new aU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new uU(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,r){N("MemoryPersistence","Starting transaction:",e);const i=new dU(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,t){return R.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class dU extends fT{constructor(e){super(),this.currentSequenceNumber=e}}class eh{constructor(e){this.persistence=e,this.Gr=new gg,this.zr=null}static jr(e){return new eh(e)}get Hr(){if(this.zr)return this.zr;throw $()}addReference(e,t,r){return this.Gr.addReference(r,t),this.Hr.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Gr.removeReference(r,t),this.Hr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Hr,r=>{const i=F.fromPath(r);return this.Jr(e,i).next(s=>{s||t.removeEntry(i,K.min())})}).next(()=>(this.zr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Jr(e,t).next(r=>{r?this.Hr.delete(t.toString()):this.Hr.add(t.toString())})}Qr(e){return 0}Jr(e,t){return R.or([()=>R.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class fU{constructor(e){this.serializer=e}N(e,t,r,i){const s=new jl("createOrUpgrade",t);r<1&&i>=1&&(function(h){h.createObjectStore("owner")}(e),function(h){h.createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Sv,{unique:!0}),h.createObjectStore("documentMutations")}(e),fI(e),function(h){h.createObjectStore("remoteDocuments")}(e));let a=R.resolve();return r<3&&i>=3&&(r!==0&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),fI(e)),a=a.next(()=>function(h){const f=h.store("targetGlobal"),p={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:K.min().toTimestamp(),targetCount:0};return f.put("targetGlobalKey",p)}(s))),r<4&&i>=4&&(r!==0&&(a=a.next(()=>function(h,f){return f.store("mutations").W().next(p=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Sv,{unique:!0});const m=f.store("mutations"),I=p.map(A=>m.put(A));return R.waitFor(I)})}(e,s))),a=a.next(()=>{(function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(a=a.next(()=>this.Zr(s))),r<6&&i>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(a=a.next(()=>this.ei(s))),r<8&&i>=8&&(a=a.next(()=>this.ti(e,s))),r<9&&i>=9&&(a=a.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(a=a.next(()=>this.ni(s))),r<11&&i>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{(function(h){const f=h.createObjectStore("documentOverlays",{keyPath:YF});f.createIndex("collectionPathOverlayIndex",JF,{unique:!1}),f.createIndex("collectionGroupOverlayIndex",XF,{unique:!1})})(e)})),r<13&&i>=13&&(a=a.next(()=>function(h){const f=h.createObjectStore("remoteDocumentsV14",{keyPath:UF});f.createIndex("documentKeyIndex",BF),f.createIndex("collectionGroupIndex",qF)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.ii(e,s))),r<15&&i>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:KF}).createIndex("sequenceNumberIndex",HF,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:jF}).createIndex("documentKeyIndex",QF,{unique:!1})}(e))),a}Xr(e){let t=0;return e.store("remoteDocuments").Y((r,i)=>{t+=al(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>R.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next(l=>R.forEach(l,h=>{z(h.userId===s.userId);const f=yi(this.serializer,h);return dA(e,s.userId,f).next(()=>{})}))}))}ei(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((a,l)=>{const h=new ge(a),f=function(m){return[0,xt(m)]}(h);s.push(t.get(f).next(p=>p?R.resolve():(m=>t.put({targetId:0,path:xt(m),sequenceNumber:i.highestListenSequenceNumber}))(h)))}).next(()=>R.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:zF});const r=t.store("collectionParents"),i=new pg,s=a=>{if(i.add(a)){const l=a.lastSegment(),h=a.popLast();return r.put({collectionId:l,parent:xt(h)})}};return t.store("remoteDocuments").Y({J:!0},(a,l)=>{const h=new ge(a);return s(h.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([a,l,h],f)=>{const p=On(l);return s(p.popLast())}))}ni(e){const t=e.store("targets");return t.Y((r,i)=>{const s=sa(i),a=cA(this.serializer,s);return t.put(a)})}ri(e,t){const r=t.store("remoteDocuments"),i=[];return r.Y((s,a)=>{const l=t.store("remoteDocumentsV14"),h=function(m){return m.document?new F(ge.fromString(m.document.name).popFirst(5)):m.noDocument?F.fromSegments(m.noDocument.path):m.unknownDocument?F.fromSegments(m.unknownDocument.path):$()}(a).path.toArray(),f={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(l.put(f))}).next(()=>R.waitFor(i))}ii(e,t){const r=t.store("mutations"),i=mA(this.serializer),s=new yA(eh.jr,this.serializer.ut);return r.W().next(a=>{const l=new Map;return a.forEach(h=>{var f;let p=(f=l.get(h.userId))!==null&&f!==void 0?f:re();yi(this.serializer,h).keys().forEach(m=>p=p.add(m)),l.set(h.userId,p)}),R.forEach(l,(h,f)=>{const p=new rt(f),m=Xl.ct(this.serializer,p),I=s.getIndexManager(p),A=Zl.ct(p,this.serializer,I,s.referenceDelegate);return new _A(i,A,m,I).recalculateAndSaveOverlaysForDocumentKeys(new Vf(t,qt._e),h).next()})})}}function fI(n){n.createObjectStore("targetDocuments",{keyPath:WF}).createIndex("documentTargetsIndex",GF,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",$F,{unique:!0}),n.createObjectStore("targetGlobal")}const of="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class mg{constructor(e,t,r,i,s,a,l,h,f,p,m=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.si=s,this.window=a,this.document=l,this.oi=f,this._i=p,this.ai=m,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=I=>Promise.resolve(),!mg.D())throw new D(S.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new nU(this,i),this.Ii=t+"main",this.serializer=new uA(h),this.Ti=new yn(this.Ii,this.ai,new fU(this.serializer)),this.qr=new J2(this.referenceDelegate,this.serializer),this.remoteDocumentCache=mA(this.serializer),this.Kr=new W2,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,p===!1&&je("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new D(S.FAILED_PRECONDITION,of);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new qt(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.di()}))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>bc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(t=>this.isPrimary&&!t?this.pi(e).next(()=>!1):!!t&&this.yi(e).next(()=>!0))).catch(e=>{if(ti(e))return N("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return N("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return Ho(e).get("owner").next(t=>R.resolve(this.wi(t)))}Si(e){return bc(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=at(t,"clientMetadata");return r.W().next(i=>{const s=this.Ci(i,18e5),a=i.filter(l=>s.indexOf(l)===-1);return R.forEach(a,l=>r.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ei)for(const t of e)this.Ei.removeItem(this.vi(t.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?R.resolve(!0):Ho(e).get("owner").next(t=>{if(t!==null&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new D(S.FAILED_PRECONDITION,of);return!1}}return!(!this.networkEnabled||!this.inForeground)||bc(e).W().next(r=>this.Ci(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||a&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&N("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new Vf(e,qt._e);return this.pi(t).next(()=>this.Si(t))}),this.Ti.close(),this.Ni()}Ci(e,t){return e.filter(r=>this.Di(r.updateTimeMs,t)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>bc(e).W().next(t=>this.Ci(t,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,t){return Zl.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Y2(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Xl.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,r){N("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(h){return h===15?e2:h===14?yT:h===13?_T:h===12?ZF:h===11?mT:void $()}(this.ai);let a;return this.Ti.runTransaction(e,i,s,l=>(a=new Vf(l,this.Lr?this.Lr.next():qt._e),t==="readwrite-primary"?this.fi(a).next(h=>!!h||this.gi(a)).next(h=>{if(!h)throw je(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new D(S.FAILED_PRECONDITION,dT);return r(a)}).next(h=>this.yi(a).next(()=>h)):this.Li(a).next(()=>r(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Li(e){return Ho(e).get("owner").next(t=>{if(t!==null&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)&&!this.wi(t)&&!(this._i||this.allowTabSynchronization&&t.allowTabSynchronization))throw new D(S.FAILED_PRECONDITION,of)})}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ho(e).put("owner",t)}static D(){return yn.D()}pi(e){const t=Ho(e);return t.get("owner").next(r=>this.wi(r)?(N("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):R.resolve())}Di(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(je(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();const t=/(?:Version|Mobile)\/1[456]/;MD()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const r=((t=this.Ei)===null||t===void 0?void 0:t.getItem(this.vi(e)))!==null;return N("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return je("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){je("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ho(n){return at(n,"owner")}function bc(n){return at(n,"clientMetadata")}function _g(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class yg{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ki=r,this.qi=i}static Qi(e,t){let r=re(),i=re();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new yg(e,t.fromCache,r,i)}}class pU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class vA{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.zi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new pU;return this.Hi(e,t,a).next(l=>{if(s.result=l,this.$i)return this.Ji(e,t,a,l.size)})}).next(()=>s.result)}Ji(e,t,r,i){return r.documentReadCount<this.Ui?(ws()<=ce.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",Es(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),R.resolve()):(ws()<=ce.DEBUG&&N("QueryEngine","Query:",Es(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(ws()<=ce.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",Es(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Nt(t))):R.resolve())}zi(e,t){if(Uv(t))return R.resolve(null);let r=Nt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=il(t,null,"F"),r=Nt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=re(...s);return this.Gi.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(h=>{const f=this.Yi(t,l);return this.Zi(t,f,a,h.readTime)?this.zi(e,il(t,null,"F")):this.Xi(e,f,t,h)}))})))}ji(e,t,r,i){return Uv(t)||i.isEqual(K.min())?R.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const a=this.Yi(t,s);return this.Zi(t,a,r,i)?R.resolve(null):(ws()<=ce.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Es(t)),this.Xi(e,a,t,lT(i,-1)).next(l=>l))})}Yi(e,t){let r=new Re(NT(e));return t.forEach((i,s)=>{fu(e,s)&&(r=r.add(s))}),r}Zi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,t,r){return ws()<=ce.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",Es(t)),this.Gi.getDocumentsMatchingQuery(e,t,Zt.min(),r)}Xi(e,t,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}class gU{constructor(e,t,r,i){this.persistence=e,this.es=t,this.serializer=i,this.ts=new Pe(ne),this.ns=new ni(s=>Li(s),hu),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _A(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ts))}}function IA(n,e,t,r){return new gU(n,e,t,r)}async function wA(n,e){const t=B(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.os(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],l=[];let h=re();for(const f of i){a.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}for(const f of s){l.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(f=>({_s:f,removedBatchIds:a,addedBatchIds:l}))})})}function mU(n,e){const t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.ss.newChangeBuffer({trackRemovals:!0});return function(l,h,f,p){const m=f.batch,I=m.keys();let A=R.resolve();return I.forEach(L=>{A=A.next(()=>p.getEntry(h,L)).next(M=>{const V=f.docVersions.get(L);z(V!==null),M.version.compareTo(V)<0&&(m.applyToRemoteDocument(M,f),M.isValidDocument()&&(M.setReadTime(f.commitVersion),p.addEntry(M)))})}),A.next(()=>l.mutationQueue.removeMutationBatch(h,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=re();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(h=h.add(l.batch.mutations[f].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function EA(n){const e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.qr.getLastRemoteSnapshotVersion(t))}function _U(n,e){const t=B(n),r=e.snapshotVersion;let i=t.ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.ss.newChangeBuffer({trackRemovals:!0});i=t.ts;const l=[];e.targetChanges.forEach((p,m)=>{const I=i.get(m);if(!I)return;l.push(t.qr.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.qr.addMatchingKeys(s,p.addedDocuments,m)));let A=I.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?A=A.withResumeToken(et.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):p.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(p.resumeToken,r)),i=i.insert(m,A),function(M,V,Y){return M.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0}(I,A,p)&&l.push(t.qr.updateTargetData(s,A))});let h=Wt(),f=re();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(TA(s,a,e.documentUpdates).next(p=>{h=p.us,f=p.cs})),!r.isEqual(K.min())){const p=t.qr.getLastRemoteSnapshotVersion(s).next(m=>t.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(p)}return R.waitFor(l).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,h,f)).next(()=>h)}).then(s=>(t.ts=i,s))}function TA(n,e,t){let r=re(),i=re();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Wt();return t.forEach((l,h)=>{const f=s.get(l);h.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(l)),h.isNoDocument()&&h.version.isEqual(K.min())?(e.removeEntry(l,h.readTime),a=a.insert(l,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(h),a=a.insert(l,h)):N("LocalStore","Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",h.version)}),{us:a,cs:i}})}function yU(n,e){const t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ks(n,e){const t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.qr.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):t.qr.allocateTargetId(r).next(a=>(i=new ir(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ts=t.ts.insert(r.targetId,r),t.ns.set(e,r.targetId)),r})}async function Hs(n,e,t){const r=B(n),i=r.ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!ti(a))throw a;N("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}function ul(n,e,t){const r=B(n);let i=K.min(),s=re();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,f,p){const m=B(h),I=m.ns.get(p);return I!==void 0?R.resolve(m.ts.get(I)):m.qr.getTargetData(f,p)}(r,a,Nt(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(a,l.targetId).next(h=>{s=h})}).next(()=>r.es.getDocumentsMatchingQuery(a,e,t?i:K.min(),t?s:re())).next(l=>(bA(r,xT(e),l),{documents:l,ls:s})))}function AA(n,e){const t=B(n),r=B(t.qr),i=t.ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(a=>a?a.target:null))}function RA(n,e){const t=B(n),r=t.rs.get(e)||K.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ss.getAllFromCollectionGroup(i,e,lT(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(bA(t,e,i),i))}function bA(n,e,t){let r=n.rs.get(e)||K.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.rs.set(e,r)}async function vU(n,e,t,r){const i=B(n);let s=re(),a=Wt();for(const f of t){const p=e.hs(f.metadata.name);f.document&&(s=s.add(p));const m=e.Ps(f);m.setReadTime(e.Is(f.metadata.readTime)),a=a.insert(p,m)}const l=i.ss.newChangeBuffer({trackRemovals:!0}),h=await Ks(i,function(p){return Nt(oo(ge.fromString(`__bundle__/docs/${p}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",f=>TA(f,l,a).next(p=>(l.apply(f),p)).next(p=>i.qr.removeMatchingKeysForTargetId(f,h.targetId).next(()=>i.qr.addMatchingKeys(f,s,h.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(f,p.us,p.cs)).next(()=>p.us)))}async function IU(n,e,t=re()){const r=await Ks(n,Nt(dg(e.bundledQuery))),i=B(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const a=Qe(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return i.Kr.saveNamedQuery(s,e);const l=r.withResumeToken(et.EMPTY_BYTE_STRING,a);return i.ts=i.ts.insert(l.targetId,l),i.qr.updateTargetData(s,l).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,t,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}function pI(n,e){return`firestore_clients_${n}_${e}`}function gI(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function af(n,e){return`firestore_targets_${n}_${e}`}class cl{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ts(e,t,r){const i=JSON.parse(r);let s,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new D(i.error.code,i.error.message))),a?new cl(e,t,i.state,s):(je("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ga{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ts(e,t){const r=JSON.parse(t);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new D(r.error.code,r.error.message))),s?new ga(e,r.state,i):(je("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ll{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=sg();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=pT(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return i?new ll(e,s):(je("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class vg{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new vg(t.clientId,t.onlineState):(je("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Hf{constructor(){this.activeTargetIds=sg()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class uf{constructor(e,t,r,i,s){this.window=e,this.si=t,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Pe(ne),this.started=!1,this.ps=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=pI(this.persistenceKey,this.Rs),this.ws=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new Hf),this.Ss=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.Cs=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.vs=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const r of e){if(r===this.Rs)continue;const i=this.getItem(pI(this.persistenceKey,r));if(i){const s=ll.Ts(r,i);s&&(this.gs=this.gs.insert(s.clientId,s))}}this.Fs();const t=this.storage.getItem(this.Cs);if(t){const r=this.Ms(t);r&&this.xs(r)}for(const r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,r){this.Ns(e,t,r),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(af(this.persistenceKey,e));if(r){const i=ga.Ts(e,r);i&&(t=i.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(af(this.persistenceKey,e))}updateQueryState(e,t,r){this.ks(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return N("SharedClientState","READ",e,t),t}setItem(e,t){N("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){N("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const t=e;if(t.storageArea===this.storage){if(N("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ys)return void je("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Ss.test(t.key)){if(t.newValue==null){const r=this.Ks(t.key);return this.$s(r,null)}{const r=this.Us(t.key,t.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(t.key)){if(t.newValue!==null){const r=this.Ws(t.key,t.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){const r=this.zs(t.key,t.newValue);if(r)return this.js(r)}}else if(t.key===this.Cs){if(t.newValue!==null){const r=this.Ms(t.newValue);if(r)return this.xs(r)}}else if(t.key===this.ws){const r=function(s){let a=qt._e;if(s!=null)try{const l=JSON.parse(s);z(typeof l=="number"),a=l}catch(l){je("SharedClientState","Failed to read sequence number from WebStorage",l)}return a}(t.newValue);r!==qt._e&&this.sequenceNumberHandler(r)}else if(t.key===this.vs){const r=this.Hs(t.newValue);await Promise.all(r.map(i=>this.syncEngine.Js(i)))}}}else this.ps.push(t)})}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,r){const i=new cl(this.currentUser,e,t,r),s=gI(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const t=gI(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){const t={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(t))}ks(e,t,r){const i=af(this.persistenceKey,e),s=new ga(e,t,r);this.setItem(i,s.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const r=this.Ks(e);return ll.Ts(r,t)}Ws(e,t){const r=this.bs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return cl.Ts(new rt(s),i,t)}zs(e,t){const r=this.Ds.exec(e),i=Number(r[1]);return ga.Ts(i,t)}Ms(e){return vg.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);N("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const r=t?this.gs.insert(e,t):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),a=[],l=[];return s.forEach(h=>{i.has(h)||a.push(h)}),i.forEach(h=>{s.has(h)||l.push(h)}),this.syncEngine.Xs(a,l).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=sg();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class SA{constructor(){this.eo=new Hf,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,r){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new Hf,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class wU{ro(e){}shutdown(){}}class mI{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){N("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){N("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Sc=null;function cf(){return Sc===null?Sc=function(){return 268435456+Math.round(2147483648*Math.random())}():Sc++,"0x"+Sc.toString(16)}const EU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class TU{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const It="WebChannelConnection";class AU extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+t.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(t,r,i,s,a){const l=cf(),h=this.So(t,r);N("RestConnection",`Sending RPC '${t}' ${l}:`,h,i);const f={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(f,s,a),this.Do(t,h,f,i).then(p=>(N("RestConnection",`Received RPC '${t}' ${l}: `,p),p),p=>{throw wn("RestConnection",`RPC '${t}' ${l} failed with error: `,p,"url: ",h,"request:",i),p})}Co(t,r,i,s,a,l){return this.wo(t,r,i,s,a)}bo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+so}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}So(t,r){const i=EU[t];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,r,i){const s=cf();return new Promise((a,l)=>{const h=new IF;h.setWithCredentials(!0),h.listenOnce(yF.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case rf.NO_ERROR:const p=h.getResponseJson();N(It,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case rf.TIMEOUT:N(It,`RPC '${e}' ${s} timed out`),l(new D(S.DEADLINE_EXCEEDED,"Request time out"));break;case rf.HTTP_ERROR:const m=h.getStatus();if(N(It,`RPC '${e}' ${s} failed with status:`,m,"response text:",h.getResponseText()),m>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);const A=I==null?void 0:I.error;if(A&&A.status&&A.message){const L=function(V){const Y=V.toLowerCase().replace(/_/g,"-");return Object.values(S).indexOf(Y)>=0?Y:S.UNKNOWN}(A.status);l(new D(L,A.message))}else l(new D(S.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new D(S.UNAVAILABLE,"Connection failed."));break;default:$()}}finally{N(It,`RPC '${e}' ${s} completed.`)}});const f=JSON.stringify(i);N(It,`RPC '${e}' ${s} sending request:`,i),h.send(t,"POST",f,r,15)})}vo(e,t,r){const i=cf(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=mF(),l=_F(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.bo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const p=s.join("");N(It,`Creating RPC '${e}' stream ${i}: ${p}`,h);const m=a.createWebChannel(p,h);let I=!1,A=!1;const L=new TU({co:V=>{A?N(It,`Not sending because RPC '${e}' stream ${i} is closed:`,V):(I||(N(It,`Opening RPC '${e}' stream ${i} transport.`),m.open(),I=!0),N(It,`RPC '${e}' stream ${i} sending:`,V),m.send(V))},lo:()=>m.close()}),M=(V,Y,ae)=>{V.listen(Y,j=>{try{ae(j)}catch(ye){setTimeout(()=>{throw ye},0)}})};return M(m,Ec.EventType.OPEN,()=>{A||N(It,`RPC '${e}' stream ${i} transport opened.`)}),M(m,Ec.EventType.CLOSE,()=>{A||(A=!0,N(It,`RPC '${e}' stream ${i} transport closed`),L.Ro())}),M(m,Ec.EventType.ERROR,V=>{A||(A=!0,wn(It,`RPC '${e}' stream ${i} transport errored:`,V),L.Ro(new D(S.UNAVAILABLE,"The operation could not be completed")))}),M(m,Ec.EventType.MESSAGE,V=>{var Y;if(!A){const ae=V.data[0];z(!!ae);const j=ae,ye=j.error||((Y=j[0])===null||Y===void 0?void 0:Y.error);if(ye){N(It,`RPC '${e}' stream ${i} received error:`,ye);const de=ye.status;let me=function(zn){const Xi=Ye[zn];if(Xi!==void 0)return HT(Xi)}(de),we=ye.message;me===void 0&&(me=S.INTERNAL,we="Unknown error status: "+de+" with message "+ye.message),A=!0,L.Ro(new D(me,we)),m.close()}else N(It,`RPC '${e}' stream ${i} received:`,ae),L.Vo(ae)}}),M(l,vF.STAT_EVENT,V=>{V.stat===Tv.PROXY?N(It,`RPC '${e}' stream ${i} detected buffering proxy`):V.stat===Tv.NOPROXY&&N(It,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{L.Ao()},0),L}}function PA(){return typeof window<"u"?window:null}function Fc(){return typeof document<"u"?document:null}function _u(n){return new x2(n,!0)}class Ig{constructor(e,t,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=t,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,t-r);i>0&&N("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class CA{constructor(e,t,r,i,s,a,l,h){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new Ig(e,t)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,t){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():t&&t.code===S.RESOURCE_EXHAUSTED?(je(t.toString()),je("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):t&&t.code===S.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(t)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===t&&this.s_(r,i)},r=>{e(()=>{const i=new D(S.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,t){const r=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(e){return N("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget(()=>this.Uo===e?t():(N("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class RU extends CA{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=O2(this.serializer,e),r=function(s){if(!("targetChange"in s))return K.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?K.min():a.readTime?Qe(a.readTime):K.min()}(e);return this.listener.a_(t,r)}u_(e){const t={};t.database=$a(this.serializer),t.addTarget=function(s,a){let l;const h=a.target;if(l=nl(h)?{documents:nA(s,h)}:{query:rA(s,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=JT(s,a.resumeToken);const f=qf(s,a.expectedCount);f!==null&&(l.expectedCount=f)}else if(a.snapshotVersion.compareTo(K.min())>0){l.readTime=zs(s,a.snapshotVersion.toTimestamp());const f=qf(s,a.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,e);const r=M2(this.serializer,e);r&&(t.labels=r),this.e_(t)}c_(e){const t={};t.database=$a(this.serializer),t.removeTarget=e,this.e_(t)}}class bU extends CA{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=L2(e.writeResults,e.commitTime),r=Qe(e.commitTime);return this.listener.I_(r,t)}return z(!e.writeResults||e.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=$a(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Wa(this.serializer,r))};this.e_(t)}}class SU extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new D(S.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,t,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new D(S.UNKNOWN,i.toString())})}Co(e,t,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(e,t,r,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new D(S.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class PU{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(je(t),this.f_=!1):N("OnlineStateTracker",t)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}class CU{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget(async()=>{ri(this)&&(N("RemoteStore","Restarting streams for network reachability change."),await async function(h){const f=B(h);f.C_.add(4),await co(f),f.M_.set("Unknown"),f.C_.delete(4),await yu(f)}(this))})}),this.M_=new PU(r,i)}}async function yu(n){if(ri(n))for(const e of n.v_)await e(!0)}async function co(n){for(const e of n.v_)await e(!1)}function th(n,e){const t=B(n);t.D_.has(e.targetId)||(t.D_.set(e.targetId,e),Tg(t)?Eg(t):ho(t).Ho()&&wg(t,e))}function Ga(n,e){const t=B(n),r=ho(t);t.D_.delete(e),r.Ho()&&kA(t,e),t.D_.size===0&&(r.Ho()?r.Zo():ri(t)&&t.M_.set("Unknown"))}function wg(n,e){if(n.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ho(n).u_(e)}function kA(n,e){n.x_.Oe(e),ho(n).c_(e)}function Eg(n){n.x_=new P2({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>n.D_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),ho(n).start(),n.M_.g_()}function Tg(n){return ri(n)&&!ho(n).jo()&&n.D_.size>0}function ri(n){return B(n).C_.size===0}function DA(n){n.x_=void 0}async function kU(n){n.D_.forEach((e,t)=>{wg(n,e)})}async function DU(n,e){DA(n),Tg(n)?(n.M_.w_(e),Eg(n)):n.M_.set("Unknown")}async function xU(n,e,t){if(n.M_.set("Online"),e instanceof YT&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const l of s.targetIds)i.D_.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.D_.delete(l),i.x_.removeTarget(l))}(n,e)}catch(r){N("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await hl(n,r)}else if(e instanceof Mc?n.x_.$e(e):e instanceof QT?n.x_.Je(e):n.x_.Ge(e),!t.isEqual(K.min()))try{const r=await EA(n.localStore);t.compareTo(r)>=0&&await function(s,a){const l=s.x_.it(a);return l.targetChanges.forEach((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const p=s.D_.get(f);p&&s.D_.set(f,p.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach((h,f)=>{const p=s.D_.get(h);if(!p)return;s.D_.set(h,p.withResumeToken(et.EMPTY_BYTE_STRING,p.snapshotVersion)),kA(s,h);const m=new ir(p.target,h,f,p.sequenceNumber);wg(s,m)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(r){N("RemoteStore","Failed to raise snapshot:",r),await hl(n,r)}}async function hl(n,e,t){if(!ti(e))throw e;n.C_.add(1),await co(n),n.M_.set("Offline"),t||(t=()=>EA(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{N("RemoteStore","Retrying IndexedDB access"),await t(),n.C_.delete(1),await yu(n)})}function xA(n,e){return e().catch(t=>hl(n,t,e))}async function lo(n){const e=B(n),t=Hr(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;NU(e);)try{const i=await yU(e.localStore,r);if(i===null){e.b_.length===0&&t.Zo();break}r=i.batchId,VU(e,i)}catch(i){await hl(e,i)}NA(e)&&VA(e)}function NU(n){return ri(n)&&n.b_.length<10}function VU(n,e){n.b_.push(e);const t=Hr(n);t.Ho()&&t.h_&&t.P_(e.mutations)}function NA(n){return ri(n)&&!Hr(n).jo()&&n.b_.length>0}function VA(n){Hr(n).start()}async function OU(n){Hr(n).E_()}async function LU(n){const e=Hr(n);for(const t of n.b_)e.P_(t.mutations)}async function MU(n,e,t){const r=n.b_.shift(),i=ug.from(r,e,t);await xA(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await lo(n)}async function FU(n,e){e&&Hr(n).h_&&await async function(r,i){if(function(a){return KT(a)&&a!==S.ABORTED}(i.code)){const s=r.b_.shift();Hr(r).Yo(),await xA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await lo(r)}}(n,e),NA(n)&&VA(n)}async function _I(n,e){const t=B(n);t.asyncQueue.verifyOperationInProgress(),N("RemoteStore","RemoteStore received new credentials");const r=ri(t);t.C_.add(3),await co(t),r&&t.M_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.C_.delete(3),await yu(t)}async function jf(n,e){const t=B(n);e?(t.C_.delete(2),await yu(t)):e||(t.C_.add(2),await co(t),t.M_.set("Unknown"))}function ho(n){return n.O_||(n.O_=function(t,r,i){const s=B(t);return s.A_(),new RU(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:kU.bind(null,n),Io:DU.bind(null,n),a_:xU.bind(null,n)}),n.v_.push(async e=>{e?(n.O_.Yo(),Tg(n)?Eg(n):n.M_.set("Unknown")):(await n.O_.stop(),DA(n))})),n.O_}function Hr(n){return n.N_||(n.N_=function(t,r,i){const s=B(t);return s.A_(),new bU(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{ho:OU.bind(null,n),Io:FU.bind(null,n),T_:LU.bind(null,n),I_:MU.bind(null,n)}),n.v_.push(async e=>{e?(n.N_.Yo(),await lo(n)):(await n.N_.stop(),n.b_.length>0&&(N("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))})),n.N_}class Ag{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new it,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,l=new Ag(e,t,a,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(S.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fo(n,e){if(je("AsyncQueue",`${e}: ${n}`),ti(n))return new D(S.UNAVAILABLE,`${e}: ${n}`);throw n}class Os{constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=ra(),this.sortedSet=new Pe(this.comparator)}static emptySet(e){return new Os(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Os)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Os;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class yI{constructor(){this.B_=new Pe(F.comparator)}track(e){const t=e.doc.key,r=this.B_.get(t);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(t,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(t):e.type===1&&r.type===2?this.B_=this.B_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):$():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal((t,r)=>{e.push(r)}),e}}class js{constructor(e,t,r,i,s,a,l,h,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new js(e,t,Os.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&du(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class UU{constructor(){this.k_=void 0,this.listeners=[]}}class BU{constructor(){this.queries=new ni(e=>DT(e),du),this.onlineState="Unknown",this.q_=new Set}}async function Rg(n,e){const t=B(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new UU),i)try{s.k_=await t.onListen(r)}catch(a){const l=fo(a,`Initialization of query '${Es(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,s),s.listeners.push(e),e.Q_(t.onlineState),s.k_&&e.K_(s.k_)&&Sg(t)}async function bg(n,e){const t=B(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return t.queries.delete(r),t.onUnlisten(r)}function qU(n,e){const t=B(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const l of a.listeners)l.K_(i)&&(r=!0);a.k_=i}}r&&Sg(t)}function $U(n,e,t){const r=B(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function Sg(n){n.q_.forEach(e=>{e.next()})}class Pg{constructor(e,t,r){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new js(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){if(!e.fromCache)return!0;const r=t!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}z_(e){if(e.docChanges.length>0)return!0;const t=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}H_(e){e=js.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class WU{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class vI{constructor(e){this.serializer=e}hs(e){return Un(this.serializer,e)}Ps(e){return e.metadata.exists?tA(this.serializer,e.document,!1):De.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return Qe(e)}}class GU{constructor(e,t,r){this.X_=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=OA(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const r=ge.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,r=new vI(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const a of i.metadata.queries){const l=(t.get(a)||re()).add(s);t.set(a,l)}}return t}async complete(){const e=await vU(this.localStore,new vI(this.serializer),this.documents,this.X_.id),t=this.ta(this.documents);for(const r of this.queries)await IU(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,na:this.collectionGroups,ra:e}}}function OA(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class LA{constructor(e){this.key=e}}class MA{constructor(e){this.key=e}}class FA{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=re(),this.mutatedKeys=re(),this._a=NT(e),this.aa=new Os(this._a)}get ua(){return this.ia}ca(e,t){const r=t?t.la:new yI,i=t?t.aa:this.aa;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,l=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{const I=i.get(p),A=fu(this.query,m)?m:null,L=!!I&&this.mutatedKeys.has(I.key),M=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let V=!1;I&&A?I.data.isEqual(A.data)?L!==M&&(r.track({type:3,doc:A}),V=!0):this.ha(I,A)||(r.track({type:2,doc:A}),V=!0,(h&&this._a(A,h)>0||f&&this._a(A,f)<0)&&(l=!0)):!I&&A?(r.track({type:0,doc:A}),V=!0):I&&!A&&(r.track({type:1,doc:I}),V=!0,(h||f)&&(l=!0)),V&&(A?(a=a.add(A),s=M?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{aa:a,la:r,Zi:l,mutatedKeys:s}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const a=e.la.L_();a.sort((p,m)=>function(A,L){const M=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $()}};return M(A)-M(L)}(p.type,m.type)||this._a(p.doc,m.doc)),this.Pa(r),i=i!=null&&i;const l=t&&!i?this.Ia():[],h=this.oa.size===0&&this.current&&!i?1:0,f=h!==this.sa;return this.sa=h,a.length!==0||f?{snapshot:new js(this.query,e.aa,s,a,e.mutatedKeys,h===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:l}:{Ta:l}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new yI,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(t=>this.ia=this.ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.ia=this.ia.delete(t)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=re(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const t=[];return e.forEach(r=>{this.oa.has(r)||t.push(new MA(r))}),this.oa.forEach(r=>{e.has(r)||t.push(new LA(r))}),t}da(e){this.ia=e.ls,this.oa=re();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return js.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class zU{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class KU{constructor(e){this.key=e,this.Ra=!1}}class HU{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new ni(l=>DT(l),du),this.fa=new Map,this.ga=new Set,this.pa=new Pe(F.comparator),this.ya=new Map,this.wa=new gg,this.Sa={},this.ba=new Map,this.Da=qi.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function jU(n,e){const t=Ng(n);let r,i;const s=t.ma.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const a=await Ks(t.localStore,Nt(e)),l=t.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=await Cg(t,e,r,l==="current",a.resumeToken),t.isPrimaryClient&&th(t.remoteStore,a)}return i}async function Cg(n,e,t,r,i){n.va=(m,I,A)=>async function(M,V,Y,ae){let j=V.view.ca(Y);j.Zi&&(j=await ul(M.localStore,V.query,!1).then(({documents:we})=>V.view.ca(we,j)));const ye=ae&&ae.targetChanges.get(V.targetId),de=ae&&ae.targetMismatches.get(V.targetId)!=null,me=V.view.applyChanges(j,M.isPrimaryClient,ye,de);return Qf(M,V.targetId,me.Ta),me.snapshot}(n,m,I,A);const s=await ul(n.localStore,e,!0),a=new FA(e,s.ls),l=a.ca(s.documents),h=mu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),f=a.applyChanges(l,n.isPrimaryClient,h);Qf(n,t,f.Ta);const p=new zU(e,t,a);return n.ma.set(e,p),n.fa.has(t)?n.fa.get(t).push(e):n.fa.set(t,[e]),f.snapshot}async function QU(n,e){const t=B(n),r=t.ma.get(e),i=t.fa.get(r.targetId);if(i.length>1)return t.fa.set(r.targetId,i.filter(s=>!du(s,e))),void t.ma.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||await Hs(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Ga(t.remoteStore,r.targetId),Qs(t,r.targetId)}).catch(ei)):(Qs(t,r.targetId),await Hs(t.localStore,r.targetId,!0))}async function YU(n,e,t){const r=Vg(n);try{const i=await function(a,l){const h=B(a),f=Oe.now(),p=l.reduce((A,L)=>A.add(L.key),re());let m,I;return h.persistence.runTransaction("Locally write mutations","readwrite",A=>{let L=Wt(),M=re();return h.ss.getEntries(A,p).next(V=>{L=V,L.forEach((Y,ae)=>{ae.isValidDocument()||(M=M.add(Y))})}).next(()=>h.localDocuments.getOverlayedDocuments(A,L)).next(V=>{m=V;const Y=[];for(const ae of l){const j=R2(ae,m.get(ae.key).overlayedDocument);j!=null&&Y.push(new pr(ae.key,j,ET(j.value.mapValue),Ve.exists(!0)))}return h.mutationQueue.addMutationBatch(A,f,Y,l)}).next(V=>{I=V;const Y=V.applyToLocalDocumentSet(m,M);return h.documentOverlayCache.saveOverlays(A,V.batchId,Y)})}).then(()=>({batchId:I.batchId,changes:OT(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let f=a.Sa[a.currentUser.toKey()];f||(f=new Pe(ne)),f=f.insert(l,h),a.Sa[a.currentUser.toKey()]=f}(r,i.batchId,t),await gr(r,i.changes),await lo(r.remoteStore)}catch(i){const s=fo(i,"Failed to persist write");t.reject(s)}}async function UA(n,e){const t=B(n);try{const r=await _U(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.ya.get(s);a&&(z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?z(a.Ra):i.removedDocuments.size>0&&(z(a.Ra),a.Ra=!1))}),await gr(t,r,e)}catch(r){await ei(r)}}function II(n,e,t){const r=B(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.ma.forEach((s,a)=>{const l=a.view.Q_(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){const h=B(a);h.onlineState=l;let f=!1;h.queries.forEach((p,m)=>{for(const I of m.listeners)I.Q_(l)&&(f=!0)}),f&&Sg(h)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function JU(n,e,t){const r=B(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ya.get(e),s=i&&i.key;if(s){let a=new Pe(F.comparator);a=a.insert(s,De.newNoDocument(s,K.min()));const l=re().add(s),h=new gu(K.min(),new Map,new Pe(ne),a,l);await UA(r,h),r.pa=r.pa.remove(s),r.ya.delete(e),xg(r)}else await Hs(r.localStore,e,!1).then(()=>Qs(r,e,t)).catch(ei)}async function XU(n,e){const t=B(n),r=e.batch.batchId;try{const i=await mU(t.localStore,e);Dg(t,r,null),kg(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await gr(t,i)}catch(i){await ei(i)}}async function ZU(n,e,t){const r=B(n);try{const i=await function(a,l){const h=B(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let p;return h.mutationQueue.lookupMutationBatch(f,l).next(m=>(z(m!==null),p=m.keys(),h.mutationQueue.removeMutationBatch(f,m))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,p,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,p)).next(()=>h.localDocuments.getDocuments(f,p))})}(r.localStore,e);Dg(r,e,t),kg(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await gr(r,i)}catch(i){await ei(i)}}async function eB(n,e){const t=B(n);ri(t.remoteStore)||N("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(a){const l=B(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(r===-1)return void e.resolve();const i=t.ba.get(r)||[];i.push(e),t.ba.set(r,i)}catch(r){const i=fo(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function kg(n,e){(n.ba.get(e)||[]).forEach(t=>{t.resolve()}),n.ba.delete(e)}function Dg(n,e,t){const r=B(n);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Qs(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.fa.get(e))n.ma.delete(r),t&&n.Va.Fa(r,t);n.fa.delete(e),n.isPrimaryClient&&n.wa.Rr(e).forEach(r=>{n.wa.containsKey(r)||BA(n,r)})}function BA(n,e){n.ga.delete(e.path.canonicalString());const t=n.pa.get(e);t!==null&&(Ga(n.remoteStore,t),n.pa=n.pa.remove(e),n.ya.delete(t),xg(n))}function Qf(n,e,t){for(const r of t)r instanceof LA?(n.wa.addReference(r.key,e),tB(n,r)):r instanceof MA?(N("SyncEngine","Document no longer in limbo: "+r.key),n.wa.removeReference(r.key,e),n.wa.containsKey(r.key)||BA(n,r.key)):$()}function tB(n,e){const t=e.key,r=t.path.canonicalString();n.pa.get(t)||n.ga.has(r)||(N("SyncEngine","New document in limbo: "+t),n.ga.add(r),xg(n))}function xg(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const e=n.ga.values().next().value;n.ga.delete(e);const t=new F(ge.fromString(e)),r=n.Da.next();n.ya.set(r,new KU(t)),n.pa=n.pa.insert(t,r),th(n.remoteStore,new ir(Nt(oo(t.path)),r,"TargetPurposeLimboResolution",qt._e))}}async function gr(n,e,t){const r=B(n),i=[],s=[],a=[];r.ma.isEmpty()||(r.ma.forEach((l,h)=>{a.push(r.va(h,e,t).then(f=>{if((f||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(h.targetId,f!=null&&f.fromCache?"not-current":"current"),f){i.push(f);const p=yg.Qi(h.targetId,f);s.push(p)}}))}),await Promise.all(a),r.Va.a_(i),await async function(h,f){const p=B(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>R.forEach(f,I=>R.forEach(I.ki,A=>p.persistence.referenceDelegate.addReference(m,I.targetId,A)).next(()=>R.forEach(I.qi,A=>p.persistence.referenceDelegate.removeReference(m,I.targetId,A)))))}catch(m){if(!ti(m))throw m;N("LocalStore","Failed to update sequence numbers: "+m)}for(const m of f){const I=m.targetId;if(!m.fromCache){const A=p.ts.get(I),L=A.snapshotVersion,M=A.withLastLimboFreeSnapshotVersion(L);p.ts=p.ts.insert(I,M)}}}(r.localStore,s))}async function nB(n,e){const t=B(n);if(!t.currentUser.isEqual(e)){N("SyncEngine","User change. New user:",e.toKey());const r=await wA(t.localStore,e);t.currentUser=e,function(s,a){s.ba.forEach(l=>{l.forEach(h=>{h.reject(new D(S.CANCELLED,a))})}),s.ba.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await gr(t,r._s)}}function rB(n,e){const t=B(n),r=t.ya.get(e);if(r&&r.Ra)return re().add(r.key);{let i=re();const s=t.fa.get(e);if(!s)return i;for(const a of s){const l=t.ma.get(a);i=i.unionWith(l.view.ua)}return i}}async function iB(n,e){const t=B(n),r=await ul(t.localStore,e.query,!0),i=e.view.da(r);return t.isPrimaryClient&&Qf(t,e.targetId,i.Ta),i}async function sB(n,e){const t=B(n);return RA(t.localStore,e).then(r=>gr(t,r))}async function oB(n,e,t,r){const i=B(n),s=await function(l,h){const f=B(l),p=B(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",m=>p.Cn(m,h).next(I=>I?f.localDocuments.getDocuments(m,I):R.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await lo(i.remoteStore):t==="acknowledged"||t==="rejected"?(Dg(i,e,r||null),kg(i,e),function(l,h){B(B(l).mutationQueue).Fn(h)}(i.localStore,e)):$(),await gr(i,s)):N("SyncEngine","Cannot apply mutation batch with id: "+e)}async function aB(n,e){const t=B(n);if(Ng(t),Vg(t),e===!0&&t.Ca!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await wI(t,r.toArray());t.Ca=!0,await jf(t.remoteStore,!0);for(const s of i)th(t.remoteStore,s)}else if(e===!1&&t.Ca!==!1){const r=[];let i=Promise.resolve();t.fa.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(Qs(t,a),Hs(t.localStore,a,!0))),Ga(t.remoteStore,a)}),await i,await wI(t,r),function(a){const l=B(a);l.ya.forEach((h,f)=>{Ga(l.remoteStore,f)}),l.wa.Vr(),l.ya=new Map,l.pa=new Pe(F.comparator)}(t),t.Ca=!1,await jf(t.remoteStore,!1)}}async function wI(n,e,t){const r=B(n),i=[],s=[];for(const a of e){let l;const h=r.fa.get(a);if(h&&h.length!==0){l=await Ks(r.localStore,Nt(h[0]));for(const f of h){const p=r.ma.get(f),m=await iB(r,p);m.snapshot&&s.push(m.snapshot)}}else{const f=await AA(r.localStore,a);l=await Ks(r.localStore,f),await Cg(r,qA(f),a,!1,l.resumeToken)}i.push(l)}return r.Va.a_(s),i}function qA(n){return kT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function uB(n){return function(t){return B(B(t).persistence).Bi()}(B(n).localStore)}async function cB(n,e,t,r){const i=B(n);if(i.Ca)return void N("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=await RA(i.localStore,xT(s[0])),l=gu.createSynthesizedRemoteEventForCurrentChange(e,t==="current",et.EMPTY_BYTE_STRING);await gr(i,a,l);break}case"rejected":await Hs(i.localStore,e,!0),Qs(i,e,r);break;default:$()}}async function lB(n,e,t){const r=Ng(n);if(r.Ca){for(const i of e){if(r.fa.has(i)){N("SyncEngine","Adding an already active target "+i);continue}const s=await AA(r.localStore,i),a=await Ks(r.localStore,s);await Cg(r,qA(s),a.targetId,!1,a.resumeToken),th(r.remoteStore,a)}for(const i of t)r.fa.has(i)&&await Hs(r.localStore,i,!1).then(()=>{Ga(r.remoteStore,i),Qs(r,i)}).catch(ei)}}function Ng(n){const e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=UA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=JU.bind(null,e),e.Va.a_=qU.bind(null,e.eventManager),e.Va.Fa=$U.bind(null,e.eventManager),e}function Vg(n){const e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=XU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ZU.bind(null,e),e}function hB(n,e,t){const r=B(n);(async function(s,a,l){try{const h=await a.getMetadata();if(await function(A,L){const M=B(A),V=Qe(L.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",Y=>M.Kr.getBundleMetadata(Y,L.id)).then(Y=>!!Y&&Y.createTime.compareTo(V)>=0)}(s.localStore,h))return await a.close(),l._completeWith(function(A){return{taskState:"Success",documentsLoaded:A.totalDocuments,bytesLoaded:A.totalBytes,totalDocuments:A.totalDocuments,totalBytes:A.totalBytes}}(h)),Promise.resolve(new Set);l._updateProgress(OA(h));const f=new GU(h,s.localStore,a.serializer);let p=await a.Ma();for(;p;){const I=await f.ea(p);I&&l._updateProgress(I),p=await a.Ma()}const m=await f.complete();return await gr(s,m.ra,void 0),await function(A,L){const M=B(A);return M.persistence.runTransaction("Save bundle","readwrite",V=>M.Kr.saveBundleMetadata(V,L))}(s.localStore,h),l._completeWith(m.progress),Promise.resolve(m.na)}catch(h){return wn("SyncEngine",`Loading bundle failed with ${h}`),l._failWith(h),Promise.resolve(new Set)}})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class Yf{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=_u(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return IA(this.persistence,new vA,e.initialUser,this.serializer)}createPersistence(e){return new yA(eh.jr,this.serializer)}createSharedClientState(e){return new SA}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class $A extends Yf{constructor(e,t,r){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xa.initialize(this,e),await Vg(this.xa.syncEngine),await lo(this.xa.remoteStore),await this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return IA(this.persistence,new vA,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new Z2(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new LF(t,this.persistence);return new OF(e.asyncQueue,r)}createPersistence(e){const t=_g(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Bt.withCacheSize(this.cacheSizeBytes):Bt.DEFAULT;return new mg(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,PA(),Fc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new SA}}class dB extends $A{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xa.syncEngine;this.sharedClientState instanceof uf&&(this.sharedClientState.syncEngine={Ys:oB.bind(null,t),Zs:cB.bind(null,t),Xs:lB.bind(null,t),Bi:uB.bind(null,t),Js:sB.bind(null,t)},await this.sharedClientState.start()),await this.persistence.mi(async r=>{await aB(this.xa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const t=PA();if(!uf.D(t))throw new D(S.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=_g(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new uf(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Og{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>II(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=nB.bind(null,this.syncEngine),await jf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BU}()}createDatastore(e){const t=_u(e.databaseInfo.databaseId),r=function(s){return new AU(s)}(e.databaseInfo);return function(s,a,l,h){return new SU(s,a,l,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,a,l){return new CU(r,i,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,t=>II(this.syncEngine,t,0),function(){return mI.D()?new mI:new wU}())}createSyncEngine(e,t){return function(i,s,a,l,h,f,p){const m=new HU(i,s,a,l,h,f);return p&&(m.Ca=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(t){const r=B(t);N("RemoteStore","RemoteStore shutting down."),r.C_.add(5),await co(r),r.F_.shutdown(),r.M_.set("Unknown")}(this.remoteStore)}}function EI(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class nh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):je("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class fB{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new it,this.buffer=new Uint8Array,this.La=function(){return new TextDecoder("utf-8")}(),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}async getMetadata(){return this.metadata.promise}async Ma(){return await this.getMetadata(),this.ka()}async ka(){const e=await this.qa();if(e===null)return null;const t=this.La.decode(e),r=Number(t);isNaN(r)&&this.Qa(`length string (${t}) is not valid number`);const i=await this.Ka(r);return new WU(JSON.parse(i),e.length+r)}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async qa(){for(;this.$a()<0&&!await this.Ua(););if(this.buffer.length===0)return null;const e=this.$a();e<0&&this.Qa("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Ka(e){for(;this.buffer.length<e;)await this.Ua()&&this.Qa("Reached the end of bundle when more is expected.");const t=this.La.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ua(){const e=await this.Ba.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class pB{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new D(S.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(i,s){const a=B(i),l=$a(a.serializer)+"/documents",h={documents:s.map(I=>qa(a.serializer,I))},f=await a.Co("BatchGetDocuments",l,h,s.length),p=new Map;f.forEach(I=>{const A=V2(a.serializer,I);p.set(A.key.toString(),A)});const m=[];return s.forEach(I=>{const A=p.get(I.toString());z(!!A),m.push(A)}),m}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new uo(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=F.fromPath(r);this.mutations.push(new og(i,this.precondition(i)))}),await async function(r,i){const s=B(r),a=$a(s.serializer)+"/documents",l={writes:i.map(h=>Wa(s.serializer,h))};await s.wo("Commit",a,l)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw $();t=K.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new D(S.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(K.min())?Ve.exists(!1):Ve.updateTime(t):Ve.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(K.min()))throw new D(S.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ve.updateTime(t)}return Ve.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class gB{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new Ig(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko(async()=>{const e=new pB(this.datastore),t=this.za(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ja(i)}))}).catch(r=>{this.ja(r)})})}za(e){try{const t=this.updateFunction(e);return!lu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!KT(t)}return!1}}class mB{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=rt.UNAUTHENTICATED,this.clientId=uT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{N("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(N("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new D(S.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new it;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=fo(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Uc(n,e){n.asyncQueue.verifyOperationInProgress(),N("FirestoreClient","Initializing OfflineComponentProvider");const t=await n.getConfiguration();await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await wA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Jf(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Lg(n);N("FirestoreClient","Initializing OnlineComponentProvider");const r=await n.getConfiguration();await e.initialize(t,r),n.setCredentialChangeListener(i=>_I(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>_I(e.remoteStore,s)),n._onlineComponents=e}function WA(n){return n.name==="FirebaseError"?n.code===S.FAILED_PRECONDITION||n.code===S.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function Lg(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){N("FirestoreClient","Using user provided OfflineComponentProvider");try{await Uc(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!WA(t))throw t;wn("Error using user provided cache. Falling back to memory cache: "+t),await Uc(n,new Yf)}}else N("FirestoreClient","Using default OfflineComponentProvider"),await Uc(n,new Yf);return n._offlineComponents}async function rh(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(N("FirestoreClient","Using user provided OnlineComponentProvider"),await Jf(n,n._uninitializedComponentsProvider._online)):(N("FirestoreClient","Using default OnlineComponentProvider"),await Jf(n,new Og))),n._onlineComponents}function GA(n){return Lg(n).then(e=>e.persistence)}function Mg(n){return Lg(n).then(e=>e.localStore)}function zA(n){return rh(n).then(e=>e.remoteStore)}function Fg(n){return rh(n).then(e=>e.syncEngine)}function _B(n){return rh(n).then(e=>e.datastore)}async function Ys(n){const e=await rh(n),t=e.eventManager;return t.onListen=jU.bind(null,e.syncEngine),t.onUnlisten=QU.bind(null,e.syncEngine),t}function yB(n){return n.asyncQueue.enqueue(async()=>{const e=await GA(n),t=await zA(n);return e.setNetworkEnabled(!0),function(i){const s=B(i);return s.C_.delete(0),yu(s)}(t)})}function vB(n){return n.asyncQueue.enqueue(async()=>{const e=await GA(n),t=await zA(n);return e.setNetworkEnabled(!1),async function(i){const s=B(i);s.C_.add(0),await co(s),s.M_.set("Offline")}(t)})}function IB(n,e){const t=new it;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await function(f,p){const m=B(f);return m.persistence.runTransaction("read document","readonly",I=>m.localDocuments.getDocument(I,p))}(i,s);l.isFoundDocument()?a.resolve(l):l.isNoDocument()?a.resolve(null):a.reject(new D(S.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const h=fo(l,`Failed to get document '${s} from cache`);a.reject(h)}}(await Mg(n),e,t)),t.promise}function KA(n,e,t={}){const r=new it;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const p=new nh({next:I=>{a.enqueueAndForget(()=>bg(s,m));const A=I.docs.has(l);!A&&I.fromCache?f.reject(new D(S.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&I.fromCache&&h&&h.source==="server"?f.reject(new D(S.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(I)},error:I=>f.reject(I)}),m=new Pg(oo(l.path),p,{includeMetadataChanges:!0,J_:!0});return Rg(s,m)}(await Ys(n),n.asyncQueue,e,t,r)),r.promise}function wB(n,e){const t=new it;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,a){try{const l=await ul(i,s,!0),h=new FA(s,l.ls),f=h.ca(l.documents),p=h.applyChanges(f,!1);a.resolve(p.snapshot)}catch(l){const h=fo(l,`Failed to execute query '${s} against cache`);a.reject(h)}}(await Mg(n),e,t)),t.promise}function HA(n,e,t={}){const r=new it;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,l,h,f){const p=new nh({next:I=>{a.enqueueAndForget(()=>bg(s,m)),I.fromCache&&h.source==="server"?f.reject(new D(S.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(I)},error:I=>f.reject(I)}),m=new Pg(l,p,{includeMetadataChanges:!0,J_:!0});return Rg(s,m)}(await Ys(n),n.asyncQueue,e,t,r)),r.promise}function EB(n,e){const t=new nh(e);return n.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).q_.add(s),s.next()}(await Ys(n),t)),()=>{t.Na(),n.asyncQueue.enqueueAndForget(async()=>function(i,s){B(i).q_.delete(s)}(await Ys(n),t))}}function TB(n,e,t,r){const i=function(a,l){let h;return h=typeof a=="string"?jT().encode(a):a,function(p,m){return new fB(p,m)}(function(p,m){if(p instanceof Uint8Array)return EI(p,m);if(p instanceof ArrayBuffer)return EI(new Uint8Array(p),m);if(p instanceof ReadableStream)return p.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),l)}(t,_u(e));n.asyncQueue.enqueueAndForget(async()=>{hB(await Fg(n),i,r)})}function AB(n,e){return n.asyncQueue.enqueue(async()=>function(r,i){const s=B(r);return s.persistence.runTransaction("Get named query","readonly",a=>s.Kr.getNamedQuery(a,i))}(await Mg(n),e))}function jA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const TI=new Map;function Ug(n,e,t){if(!t)throw new D(S.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function QA(n,e,t,r){if(e===!0&&r===!0)throw new D(S.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function AI(n){if(!F.isDocumentKey(n))throw new D(S.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function RI(n){if(F.isDocumentKey(n))throw new D(S.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ih(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$()}function _e(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new D(S.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ih(n);throw new D(S.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function YA(n,e){if(e<=0)throw new D(S.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class bI{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new D(S.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new D(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}QA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jA((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new D(S.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new D(S.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new D(S.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vu{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bI({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new D(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new D(S.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bI(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new AF;switch(r.type){case"firstParty":return new PF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new D(S.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=TI.get(t);r&&(N("ComponentProvider","Removing Datastore"),TI.delete(t),r.terminate())}(this),Promise.resolve()}}function RB(n,e,t,r={}){var i;const s=(n=_e(n,vu))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&wn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let l,h;if(typeof r.mockUserToken=="string")l=r.mockUserToken,h=rt.MOCK_USER;else{l=VD(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new D(S.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new rt(f)}n._authCredentials=new RF(new aT(l,h))}}let At=class{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new At(this.firestore,e,this._query)}},Le=class{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ar(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Le(this.firestore,e,this._key)}},ar=class extends At{constructor(e,t,r){super(e,t,oo(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Le(this.firestore,null,new F(e))}withConverter(e){return new ar(this.firestore,e,this._path)}};function JA(n,e,...t){if(n=H(n),Ug("collection","path",e),n instanceof vu){const r=ge.fromString(e,...t);return RI(r),new ar(n,null,r)}{if(!(n instanceof Le||n instanceof ar))throw new D(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ge.fromString(e,...t));return RI(r),new ar(n.firestore,null,r)}}function bB(n,e){if(n=_e(n,vu),Ug("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new D(S.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new At(n,null,function(r){return new fr(ge.emptyPath(),r)}(e))}function za(n,e,...t){if(n=H(n),arguments.length===1&&(e=uT.newId()),Ug("doc","path",e),n instanceof vu){const r=ge.fromString(e,...t);return AI(r),new Le(n,null,new F(r))}{if(!(n instanceof Le||n instanceof ar))throw new D(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ge.fromString(e,...t));return AI(r),new Le(n.firestore,n instanceof ar?n.converter:null,new F(r))}}function XA(n,e){return n=H(n),e=H(e),(n instanceof Le||n instanceof ar)&&(e instanceof Le||e instanceof ar)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function ZA(n,e){return n=H(n),e=H(e),n instanceof At&&e instanceof At&&n.firestore===e.firestore&&du(n._query,e._query)&&n.converter===e.converter}class SB{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new Ig(this,"async_queue_retry"),this.iu=()=>{const t=Fc();t&&N("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const e=Fc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=Fc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const t=new it;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!ti(e))throw e;N("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(e){const t=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;const i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw je("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=t,t}enqueueAfterDelay(e,t,r){this.su(),this.ru.indexOf(e)>-1&&(t=0);const i=Ag.createAndSchedule(this,e,t,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&$()}verifyOperationInProgress(){}async uu(){let e;do e=this.Ja,await e;while(e!==this.Ja)}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Xa)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function Xf(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class PB{constructor(){this._progressObserver={},this._taskCompletionResolver=new it,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const CB=-1;let We=class extends vu{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new SB}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||e0(this),this._firestoreClient.terminate()}};function ut(n){return n._firestoreClient||e0(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function e0(n){var e,t,r;const i=n._freezeSettings(),s=function(l,h,f,p){return new r2(l,h,f,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,jA(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new mB(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function kB(n,e){n0(n=_e(n,We));const t=ut(n);if(t._uninitializedComponentsProvider)throw new D(S.FAILED_PRECONDITION,"SDK cache is already specified.");wn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new Og;return t0(t,i,new $A(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function DB(n){n0(n=_e(n,We));const e=ut(n);if(e._uninitializedComponentsProvider)throw new D(S.FAILED_PRECONDITION,"SDK cache is already specified.");wn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new Og;return t0(e,r,new dB(r,t.cacheSizeBytes))}function t0(n,e,t){const r=new it;return n.asyncQueue.enqueue(async()=>{try{await Uc(n,t),await Jf(n,e),r.resolve()}catch(i){const s=i;if(!WA(s))throw s;wn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function xB(n){if(n._initialized&&!n._terminated)throw new D(S.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new it;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!yn.D())return Promise.resolve();const i=r+"main";await yn.delete(i)}(_g(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function NB(n){return function(t){const r=new it;return t.asyncQueue.enqueueAndForget(async()=>eB(await Fg(t),r)),r.promise}(ut(n=_e(n,We)))}function VB(n){return yB(ut(n=_e(n,We)))}function OB(n){return vB(ut(n=_e(n,We)))}function LB(n,e){const t=ut(n=_e(n,We)),r=new PB;return TB(t,n._databaseId,e,r),r}function MB(n,e){return AB(ut(n=_e(n,We)),e).then(t=>t?new At(n,null,t.query):null)}function n0(n){if(n._initialized||n._terminated)throw new D(S.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Gn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gn(et.fromBase64String(e))}catch(t){throw new D(S.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Gn(et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}let jr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new D(S.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ne(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let ji=class{constructor(e){this._methodName=e}};class sh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new D(S.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new D(S.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}}const FB=/^__.*__$/;class UB{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new pr(e,this.data,this.fieldMask,t,this.fieldTransforms):new ao(e,this.data,t,this.fieldTransforms)}}class r0{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new pr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function i0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $()}}class oh{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new oh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return dl(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(e.length===0)throw this.mu("Document fields must not be empty");if(i0(this.Iu)&&FB.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class BB{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||_u(e)}pu(e,t,r,i=!1){return new oh({Iu:e,methodName:t,gu:r,path:Ne.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Qi(n){const e=n._freezeSettings(),t=_u(n._databaseId);return new BB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ah(n,e,t,r,i,s={}){const a=n.pu(s.merge||s.mergeFields?2:0,e,t,i);Wg("Data must be an object, but it was:",a,r);const l=a0(r,a);let h,f;if(s.merge)h=new $t(a.fieldMask),f=a.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const I=Zf(e,m,t);if(!a.contains(I))throw new D(S.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);c0(p,I)||p.push(I)}h=new $t(p),f=a.fieldTransforms.filter(m=>h.covers(m.field))}else h=null,f=a.fieldTransforms;return new UB(new pt(l),h,f)}class Iu extends ji{_toFieldTransform(e){if(e.Iu!==2)throw e.Iu===1?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Iu}}function s0(n,e,t){return new oh({Iu:3,gu:e.settings.gu,methodName:n._methodName,du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Bg extends ji{_toFieldTransform(e){return new pu(e.path,new Ws)}isEqual(e){return e instanceof Bg}}class qB extends ji{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=s0(this,e,!0),r=this.yu.map(s=>Yi(s,t)),i=new Mi(r);return new pu(e.path,i)}isEqual(e){return this===e}}class $B extends ji{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=s0(this,e,!0),r=this.yu.map(s=>Yi(s,t)),i=new Fi(r);return new pu(e.path,i)}isEqual(e){return this===e}}class WB extends ji{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new Gs(e.serializer,UT(e.serializer,this.wu));return new pu(e.path,t)}isEqual(e){return this===e}}function qg(n,e,t,r){const i=n.pu(1,e,t);Wg("Data must be an object, but it was:",i,r);const s=[],a=pt.empty();Hi(r,(h,f)=>{const p=Gg(e,h,t);f=H(f);const m=i.Ru(p);if(f instanceof Iu)s.push(p);else{const I=Yi(f,m);I!=null&&(s.push(p),a.set(p,I))}});const l=new $t(s);return new r0(a,l,i.fieldTransforms)}function $g(n,e,t,r,i,s){const a=n.pu(1,e,t),l=[Zf(e,r,t)],h=[i];if(s.length%2!=0)throw new D(S.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<s.length;I+=2)l.push(Zf(e,s[I])),h.push(s[I+1]);const f=[],p=pt.empty();for(let I=l.length-1;I>=0;--I)if(!c0(f,l[I])){const A=l[I];let L=h[I];L=H(L);const M=a.Ru(A);if(L instanceof Iu)f.push(A);else{const V=Yi(L,M);V!=null&&(f.push(A),p.set(A,V))}}const m=new $t(f);return new r0(p,m,a.fieldTransforms)}function o0(n,e,t,r=!1){return Yi(t,n.pu(r?4:3,e))}function Yi(n,e){if(u0(n=H(n)))return Wg("Unsupported field value:",e,n),a0(n,e);if(n instanceof ji)return function(r,i){if(!i0(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.du&&e.Iu!==4)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const l of r){let h=Yi(l,i.Vu(a));h==null&&(h={nullValue:"NULL_VALUE"}),s.push(h),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=H(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return UT(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Oe.fromDate(r);return{timestampValue:zs(i.serializer,s)}}if(r instanceof Oe){const s=new Oe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:zs(i.serializer,s)}}if(r instanceof sh)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Gn)return{bytesValue:JT(i.serializer,r._byteString)};if(r instanceof Le){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:hg(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${ih(r)}`)}(n,e)}function a0(n,e){const t={};return vT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hi(n,(r,i)=>{const s=Yi(i,e.Eu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function u0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Oe||n instanceof sh||n instanceof Gn||n instanceof Le||n instanceof ji)}function Wg(n,e,t){if(!u0(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=ih(t);throw r==="an object"?e.mu(n+" a custom object"):e.mu(n+" "+r)}}function Zf(n,e,t){if((e=H(e))instanceof jr)return e._internalPath;if(typeof e=="string")return Gg(n,e);throw dl("Field path arguments must be of type string or ",n,!1,void 0,t)}const GB=new RegExp("[~\\*/\\[\\]]");function Gg(n,e,t){if(e.search(GB)>=0)throw dl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new jr(...e.split("."))._internalPath}catch{throw dl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function dl(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(s||a)&&(h+=" (found",s&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new D(S.INVALID_ARGUMENT,l+n+h)}function c0(n,e){return n.some(t=>t.isEqual(e))}class Ka{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Le(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new zB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(uh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class zB extends Ka{data(){return super.data()}}function uh(n,e){return typeof e=="string"?Gg(n,e):e instanceof jr?e._internalPath:e._delegate._internalPath}function l0(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new D(S.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zg{}class wu extends zg{}function Cr(n,e,...t){let r=[];e instanceof zg&&r.push(e),r=r.concat(t),function(s){const a=s.filter(h=>h instanceof Kg).length,l=s.filter(h=>h instanceof ch).length;if(a>1||a>0&&l>0)throw new D(S.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class ch extends wu{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new ch(e,t,r)}_apply(e){const t=this._parse(e);return d0(e._query,t),new At(e.firestore,e.converter,Bf(e._query,t))}_parse(e){const t=Qi(e.firestore);return function(s,a,l,h,f,p,m){let I;if(f.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new D(S.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){PI(m,p);const A=[];for(const L of m)A.push(SI(h,s,L));I={arrayValue:{values:A}}}else I=SI(h,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||PI(m,p),I=o0(l,a,m,p==="in"||p==="not-in");return he.create(f,p,I)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function KB(n,e,t){const r=e,i=uh("where",n);return ch._create(i,r,t)}class Kg extends zg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Kg(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Te.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i;const l=s.getFlattenedFilters();for(const h of l)d0(a,h),a=Bf(a,h)}(e._query,t),new At(e.firestore,e.converter,Bf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Hg extends wu{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Hg(e,t)}_apply(e){const t=function(i,s,a){if(i.startAt!==null)throw new D(S.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new D(S.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ba(s,a)}(e._query,this._field,this._direction);return new At(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new fr(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function HB(n,e="asc"){const t=e,r=uh("orderBy",n);return Hg._create(r,t)}class lh extends wu{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new lh(e,t,r)}_apply(e){return new At(e.firestore,e.converter,il(e._query,this._limit,this._limitType))}}function jB(n){return YA("limit",n),lh._create("limit",n,"F")}function QB(n){return YA("limitToLast",n),lh._create("limitToLast",n,"L")}class hh extends wu{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new hh(e,t,r)}_apply(e){const t=h0(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new fr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}}function YB(...n){return hh._create("startAt",n,!0)}function JB(...n){return hh._create("startAfter",n,!1)}class dh extends wu{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new dh(e,t,r)}_apply(e){const t=h0(e,this.type,this._docOrFields,this._inclusive);return new At(e.firestore,e.converter,function(i,s){return new fr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}}function XB(...n){return dh._create("endBefore",n,!1)}function ZB(...n){return dh._create("endAt",n,!0)}function h0(n,e,t,r){if(t[0]=H(t[0]),t[0]instanceof Ka)return function(s,a,l,h,f){if(!h)throw new D(S.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const p=[];for(const m of Vs(s))if(m.field.isKeyField())p.push(Oi(a,h.key));else{const I=h.data.field(m.field);if(Ql(I))throw new D(S.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+m.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(I===null){const A=m.field.canonicalString();throw new D(S.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${A}' (used as the orderBy) does not exist.`)}p.push(I)}return new Kr(p,f)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Qi(n.firestore);return function(a,l,h,f,p,m){const I=a.explicitOrderBy;if(p.length>I.length)throw new D(S.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const A=[];for(let L=0;L<p.length;L++){const M=p[L];if(I[L].field.isKeyField()){if(typeof M!="string")throw new D(S.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof M}`);if(!ig(a)&&M.indexOf("/")!==-1)throw new D(S.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${M}' contains a slash.`);const V=a.path.child(ge.fromString(M));if(!F.isDocumentKey(V))throw new D(S.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${V}' is not because it contains an odd number of segments.`);const Y=new F(V);A.push(Oi(l,Y))}else{const V=o0(h,f,M);A.push(V)}}return new Kr(A,m)}(n._query,n.firestore._databaseId,i,e,t,r)}}function SI(n,e,t){if(typeof(t=H(t))=="string"){if(t==="")throw new D(S.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ig(e)&&t.indexOf("/")!==-1)throw new D(S.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ge.fromString(t));if(!F.isDocumentKey(r))throw new D(S.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Oi(n,new F(r))}if(t instanceof Le)return Oi(n,t._key);throw new D(S.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ih(t)}.`)}function PI(n,e){if(!Array.isArray(n)||n.length===0)throw new D(S.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function d0(n,e){const t=function(i,s){for(const a of i)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new D(S.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(S.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class jg{convertValue(e,t="none"){switch(Vi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Wr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw $()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Hi(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new sh(Be(e.latitude),Be(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=ng(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ma(e));default:return null}}convertTimestamp(e){const t=$r(e);return new Oe(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ge.fromString(e);z(aA(r));const i=new Gr(r.get(1),r.get(3)),s=new F(r.popFirst(5));return i.isEqual(t)||je(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function fh(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class eq extends jg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,t)}}class Ri{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let lr=class extends Ka{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ma(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(uh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},ma=class extends lr{data(e={}){return super.data(e)}},Qr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ri(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ma(this._firestore,this._userDataWriter,r.key,r,new Ri(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new D(S.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{const h=new ma(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ri(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const h=new ma(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ri(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,p=-1;return l.type!==0&&(f=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:tq(l.type),doc:h,oldIndex:f,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function tq(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $()}}function f0(n,e){return n instanceof lr&&e instanceof lr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Qr&&e instanceof Qr&&n._firestore===e._firestore&&ZA(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function p0(n){n=_e(n,Le);const e=_e(n.firestore,We);return KA(ut(e),n._key).then(t=>Qg(e,n,t))}class Ji extends jg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,t)}}function nq(n){n=_e(n,Le);const e=_e(n.firestore,We),t=ut(e),r=new Ji(e);return IB(t,n._key).then(i=>new lr(e,r,n._key,i,new Ri(i!==null&&i.hasLocalMutations,!0),n.converter))}function rq(n){n=_e(n,Le);const e=_e(n.firestore,We);return KA(ut(e),n._key,{source:"server"}).then(t=>Qg(e,n,t))}function iq(n){n=_e(n,At);const e=_e(n.firestore,We),t=ut(e),r=new Ji(e);return l0(n._query),HA(t,n._query).then(i=>new Qr(e,r,n,i))}function sq(n){n=_e(n,At);const e=_e(n.firestore,We),t=ut(e),r=new Ji(e);return wB(t,n._query).then(i=>new Qr(e,r,n,i))}function oq(n){n=_e(n,At);const e=_e(n.firestore,We),t=ut(e),r=new Ji(e);return HA(t,n._query,{source:"server"}).then(i=>new Qr(e,r,n,i))}function CI(n,e,t){n=_e(n,Le);const r=_e(n.firestore,We),i=fh(n.converter,e,t);return Eu(r,[ah(Qi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Ve.none())])}function kI(n,e,t,...r){n=_e(n,Le);const i=_e(n.firestore,We),s=Qi(i);let a;return a=typeof(e=H(e))=="string"||e instanceof jr?$g(s,"updateDoc",n._key,e,t,r):qg(s,"updateDoc",n._key,e),Eu(i,[a.toMutation(n._key,Ve.exists(!0))])}function aq(n){return Eu(_e(n.firestore,We),[new uo(n._key,Ve.none())])}function uq(n,e){const t=_e(n.firestore,We),r=za(n),i=fh(n.converter,e);return Eu(t,[ah(Qi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Ve.exists(!1))]).then(()=>r)}function g0(n,...e){var t,r,i;n=H(n);let s={includeMetadataChanges:!1},a=0;typeof e[a]!="object"||Xf(e[a])||(s=e[a],a++);const l={includeMetadataChanges:s.includeMetadataChanges};if(Xf(e[a])){const m=e[a];e[a]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[a+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[a+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let h,f,p;if(n instanceof Le)f=_e(n.firestore,We),p=oo(n._key.path),h={next:m=>{e[a]&&e[a](Qg(f,n,m))},error:e[a+1],complete:e[a+2]};else{const m=_e(n,At);f=_e(m.firestore,We),p=m._query;const I=new Ji(f);h={next:A=>{e[a]&&e[a](new Qr(f,I,m,A))},error:e[a+1],complete:e[a+2]},l0(n._query)}return function(I,A,L,M){const V=new nh(M),Y=new Pg(A,V,L);return I.asyncQueue.enqueueAndForget(async()=>Rg(await Ys(I),Y)),()=>{V.Na(),I.asyncQueue.enqueueAndForget(async()=>bg(await Ys(I),Y))}}(ut(f),p,l,h)}function cq(n,e){return EB(ut(n=_e(n,We)),Xf(e)?e:{next:e})}function Eu(n,e){return function(r,i){const s=new it;return r.asyncQueue.enqueueAndForget(async()=>YU(await Fg(r),i,s)),s.promise}(ut(n),e)}function Qg(n,e,t){const r=t.docs.get(e._key),i=new Ji(n);return new lr(n,i,e._key,r,new Ri(t.hasPendingWrites,t.fromCache),e.converter)}const lq={maxAttempts:5};let hq=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Qi(e)}set(e,t,r){this._verifyNotCommitted();const i=xr(e,this._firestore),s=fh(i.converter,t,r),a=ah(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(a.toMutation(i._key,Ve.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=xr(e,this._firestore);let a;return a=typeof(t=H(t))=="string"||t instanceof jr?$g(this._dataReader,"WriteBatch.update",s._key,t,r,i):qg(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Ve.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=xr(e,this._firestore);return this._mutations=this._mutations.concat(new uo(t._key,Ve.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new D(S.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function xr(n,e){if((n=H(n)).firestore!==e)throw new D(S.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}let dq=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Qi(t)}get(t){const r=xr(t,this._firestore),i=new eq(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return $();const a=s[0];if(a.isFoundDocument())return new Ka(this._firestore,i,a.key,a,r.converter);if(a.isNoDocument())return new Ka(this._firestore,i,r._key,null,r.converter);throw $()})}set(t,r,i){const s=xr(t,this._firestore),a=fh(s.converter,r,i),l=ah(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(t,r,i,...s){const a=xr(t,this._firestore);let l;return l=typeof(r=H(r))=="string"||r instanceof jr?$g(this._dataReader,"Transaction.update",a._key,r,i,s):qg(this._dataReader,"Transaction.update",a._key,r),this._transaction.update(a._key,l),this}delete(t){const r=xr(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=xr(e,this._firestore),r=new Ji(this._firestore);return super.get(e).then(i=>new lr(this._firestore,r,t._key,i._document,new Ri(!1,!1),t.converter))}};function fq(n,e,t){n=_e(n,We);const r=Object.assign(Object.assign({},lq),t);return function(s){if(s.maxAttempts<1)throw new D(S.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,a,l){const h=new it;return s.asyncQueue.enqueueAndForget(async()=>{const f=await _B(s);new gB(s.asyncQueue,f,l,a,h).run()}),h.promise}(ut(n),i=>e(new dq(n,i)),r)}function pq(){return new Iu("deleteField")}function gq(){return new Bg("serverTimestamp")}function mq(...n){return new qB("arrayUnion",n)}function _q(...n){return new $B("arrayRemove",n)}function yq(n){return new WB("increment",n)}(function(e,t=!0){(function(i){so=i})(Yr),Ur(new qn("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),l=new We(new bF(r.getProvider("auth-internal")),new kF(r.getProvider("app-check-internal")),function(f,p){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new D(S.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gr(f.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Mn(Av,"4.4.0",e),Mn(Av,"4.4.0","esm2017")})();const vq="@firebase/firestore-compat",Iq="0.3.23";function Yg(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new D("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function DI(){if(typeof Uint8Array>"u")throw new D("unimplemented","Uint8Arrays are not available in this environment.")}function xI(){if(!t2())throw new D("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Ha{constructor(e){this._delegate=e}static fromBase64String(e){return xI(),new Ha(Gn.fromBase64String(e))}static fromUint8Array(e){return DI(),new Ha(Gn.fromUint8Array(e))}toBase64(){return xI(),this._delegate.toBase64()}toUint8Array(){return DI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function ep(n){return wq(n,["next","error","complete"])}function wq(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class Eq{enableIndexedDbPersistence(e,t){return kB(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return DB(e._delegate)}clearIndexedDbPersistence(e){return xB(e._delegate)}}class m0{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Gr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&wn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){RB(this._delegate,e,t,r)}enableNetwork(){return VB(this._delegate)}disableNetwork(){return OB(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,QA("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return NB(this._delegate)}onSnapshotsInSync(e){return cq(this._delegate,e)}get app(){if(!this._appCompat)throw new D("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Js(this,JA(this._delegate,e))}catch(t){throw Ct(t,"collection()","Firestore.collection()")}}doc(e){try{return new ln(this,za(this._delegate,e))}catch(t){throw Ct(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Pt(this,bB(this._delegate,e))}catch(t){throw Ct(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return fq(this._delegate,t=>e(new _0(this,t)))}batch(){return ut(this._delegate),new y0(new hq(this._delegate,e=>Eu(this._delegate,e)))}loadBundle(e){return LB(this._delegate,e)}namedQuery(e){return MB(this._delegate,e).then(t=>t?new Pt(this,t):null)}}class ph extends jg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ha(new Gn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return ln.forKey(t,this.firestore,null)}}function Tq(n){EF(n)}class _0{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ph(e)}get(e){const t=bi(e);return this._delegate.get(t).then(r=>new ja(this._firestore,new lr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=bi(e);return r?(Yg("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=bi(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=bi(e);return this._delegate.delete(t),this}}class y0{constructor(e){this._delegate=e}set(e,t,r){const i=bi(e);return r?(Yg("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=bi(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=bi(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class $i{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new ma(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Qa(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=$i.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new $i(e,new ph(e),t),i.set(t,s)),s}}$i.INSTANCES=new WeakMap;class ln{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ph(e)}static forPath(e,t,r){if(e.length%2!==0)throw new D("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new ln(t,new Le(t._delegate,r,new F(e)))}static forKey(e,t,r){return new ln(t,new Le(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Js(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Js(this.firestore,JA(this._delegate,e))}catch(t){throw Ct(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=H(e),e instanceof Le?XA(this._delegate,e):!1}set(e,t){t=Yg("DocumentReference.set",t);try{return t?CI(this._delegate,e,t):CI(this._delegate,e)}catch(r){throw Ct(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?kI(this._delegate,e):kI(this._delegate,e,t,...r)}catch(i){throw Ct(i,"updateDoc()","DocumentReference.update()")}}delete(){return aq(this._delegate)}onSnapshot(...e){const t=v0(e),r=I0(e,i=>new ja(this.firestore,new lr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return g0(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=nq(this._delegate):(e==null?void 0:e.source)==="server"?t=rq(this._delegate):t=p0(this._delegate),t.then(r=>new ja(this.firestore,new lr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new ln(this.firestore,e?this._delegate.withConverter($i.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ct(n,e,t){return n.message=n.message.replace(e,t),n}function v0(n){for(const e of n)if(typeof e=="object"&&!ep(e))return e;return{}}function I0(n,e){var t,r;let i;return ep(n[0])?i=n[0]:ep(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class ja{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new ln(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return f0(this._delegate,e._delegate)}}class Qa extends ja{data(e){const t=this._delegate.data(e);return this._delegate._converter||TF(t!==void 0),t}}class Pt{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ph(e)}where(e,t,r){try{return new Pt(this.firestore,Cr(this._delegate,KB(e,t,r)))}catch(i){throw Ct(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Pt(this.firestore,Cr(this._delegate,HB(e,t)))}catch(r){throw Ct(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Pt(this.firestore,Cr(this._delegate,jB(e)))}catch(t){throw Ct(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Pt(this.firestore,Cr(this._delegate,QB(e)))}catch(t){throw Ct(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Pt(this.firestore,Cr(this._delegate,YB(...e)))}catch(t){throw Ct(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Pt(this.firestore,Cr(this._delegate,JB(...e)))}catch(t){throw Ct(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Pt(this.firestore,Cr(this._delegate,XB(...e)))}catch(t){throw Ct(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Pt(this.firestore,Cr(this._delegate,ZB(...e)))}catch(t){throw Ct(t,"endAt()","Query.endAt()")}}isEqual(e){return ZA(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=sq(this._delegate):(e==null?void 0:e.source)==="server"?t=oq(this._delegate):t=iq(this._delegate),t.then(r=>new tp(this.firestore,new Qr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=v0(e),r=I0(e,i=>new tp(this.firestore,new Qr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return g0(this._delegate,t,r)}withConverter(e){return new Pt(this.firestore,e?this._delegate.withConverter($i.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Aq{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Qa(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class tp{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Pt(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Qa(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Aq(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Qa(this._firestore,r))})}isEqual(e){return f0(this._delegate,e._delegate)}}class Js extends Pt{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new ln(this.firestore,e):null}doc(e){try{return e===void 0?new ln(this.firestore,za(this._delegate)):new ln(this.firestore,za(this._delegate,e))}catch(t){throw Ct(t,"doc()","CollectionReference.doc()")}}add(e){return uq(this._delegate,e).then(t=>new ln(this.firestore,t))}isEqual(e){return XA(this._delegate,e._delegate)}withConverter(e){return new Js(this.firestore,e?this._delegate.withConverter($i.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function bi(n){return _e(n,Le)}class Jg{constructor(...e){this._delegate=new jr(...e)}static documentId(){return new Jg(Ne.keyField().canonicalString())}isEqual(e){return e=H(e),e instanceof jr?this._delegate._internalPath.isEqual(e._internalPath):!1}}class wi{constructor(e){this._delegate=e}static serverTimestamp(){const e=gq();return e._methodName="FieldValue.serverTimestamp",new wi(e)}static delete(){const e=pq();return e._methodName="FieldValue.delete",new wi(e)}static arrayUnion(...e){const t=mq(...e);return t._methodName="FieldValue.arrayUnion",new wi(t)}static arrayRemove(...e){const t=_q(...e);return t._methodName="FieldValue.arrayRemove",new wi(t)}static increment(e){const t=yq(e);return t._methodName="FieldValue.increment",new wi(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Rq={Firestore:m0,GeoPoint:sh,Timestamp:Oe,Blob:Ha,Transaction:_0,WriteBatch:y0,DocumentReference:ln,DocumentSnapshot:ja,Query:Pt,QueryDocumentSnapshot:Qa,QuerySnapshot:tp,CollectionReference:Js,FieldPath:Jg,FieldValue:wi,setLogLevel:Tq,CACHE_SIZE_UNLIMITED:CB};function bq(n,e){n.INTERNAL.registerComponent(new qn("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Rq)))}function Sq(n){bq(n,(e,t)=>new m0(e,t,new Eq)),n.registerVersion(vq,Iq)}Sq(Br);const Pq={apiKey:"AIzaSyCfFGZC07caKFCARPJmMU-qsuAW8jLIu3E",authDomain:"project-fitness-07.firebaseapp.com",projectId:"project-fitness-07",storageBucket:"project-fitness-07.appspot.com",messagingSenderId:"607206642972",appId:"1:607206642972:web:ea1d5c525a976b668cd6d9"},Wi=Br.initializeApp(Pq);async function Cq({email:n,password:e,name:t}){await Wi.auth().createUserWithEmailAndPassword(n,e),await(await Wi.auth().currentUser).updateProfile({displayName:t})}async function kq({email:n,password:e}){try{await Wi.auth().signInWithEmailAndPassword(n,e)}catch(t){console.log(t.message)}}async function Dq(){await Wi.auth().signOut()}const jo={fs:Br.firestore(),getCurrentUserID:async function(){return new Promise((n,e)=>{Wi.auth().onAuthStateChanged(t=>{t?n(t.uid):e("User not authenticated")})})},addData:async function(n,e){const t=await this.getCurrentUserID();this.fs.collection("users").doc(t).set({[n]:e},{merge:!0}).then(()=>!0).catch(r=>(console.error("Error writing document: ",r),!1))},removeData:async function(n){const e=await this.getCurrentUserID();this.fs.collection("users").doc(e).update({[n]:Br.firestore.FieldValue.delete()},{merge:!0}).then(()=>!0).catch(t=>(console.error("Error writing document: ",t),!1))},getData:async function(){const n=await this.getCurrentUserID(),e=za(this.fs,"users",n),t=await p0(e);if(t.exists())return t.data();console.error("No such document")}},Ya=document.querySelector(".user-icon"),fl=document.querySelector(".authModal__backdrop"),w0=document.querySelector(".authModal__button-close"),gh=document.querySelector(".authForm"),NI=document.querySelector(".action__text"),oa=document.querySelector(".action__button"),VI=document.querySelector(".authForm__fieldset.username"),OI=document.querySelector(".authForm__title"),pl=document.querySelector(".header__username"),LI=document.querySelector(".header_main_nav"),gl=document.querySelector(".button-logout");let Bc=!0;const Tu=()=>{fl.classList.remove("open"),w0.removeEventListener("click",Tu),Ya.addEventListener("click",Xg),document.body.style.overflow="visible"},Xg=()=>{fl.classList.add("open"),w0.addEventListener("click",Tu),Ya.removeEventListener("click",Xg),document.body.style.overflow="hidden"},np=()=>{gh.reset()},xq=async n=>{var r;n.preventDefault();const e=[...gh.elements].reduce((i,s)=>(s.name&&(i[s.name]=s.value),i),{});Bc&&await Cq(e),await kq(e),np();const t=(r=await Wi.auth().currentUser)==null?void 0:r.displayName;pl.textContent=t,Tu()},Nq=()=>{Bc?(oa.textContent="Registration",VI.classList.add("hidden"),oa.setAttribute("data-action","log_in"),OI.textContent="Log in",NI.textContent="Don't have an account?",np(),Bc=!1):(oa.textContent="Log in",oa.setAttribute("data-action","reg"),VI.classList.remove("hidden"),OI.textContent="Registration",NI.textContent="Already have an account?",np(),Bc=!0),gh.elements.name.toggleAttribute("required")},Vq=async()=>{await Wi.auth().onAuthStateChanged(n=>{n?(pl.textContent=n.displayName,pl.classList.remove("hidden"),Ya.classList.add("hidden"),LI.classList.add("visible"),gl.classList.add("visible")):(Ya.classList.remove("hidden"),gl.classList.remove("visible"),LI.classList.remove("visible"))})},Oq=async()=>{await Dq(),gl.classList.add("hidden"),pl.classList.add("hidden")};Ya.addEventListener("click",Xg);gh.addEventListener("submit",xq);oa.addEventListener("click",Nq);gl.addEventListener("click",Oq);document.addEventListener("keydown",n=>{n.key==="Escape"&&Tu()});fl.addEventListener("click",n=>{n.target===fl&&Tu()});Vq();function Lq(){const n=document.querySelector(".hero__hashtags-wrap"),e=document.createElement("ul");e.classList.add("hashtags__list");const t=["Sport","Healthy","Workout","Diet"].map(r=>`
  <li class='hashtags__item'>#${r}</li>
`).join("");e.innerHTML=t,n.insertAdjacentElement("beforeend",e)}window.addEventListener("load",Lq);const mh=document.querySelector(".js-cards"),Ls="/project-fitness-07/";function Mq(n){const e=n.map(({filter:t,name:r,imgURL:i})=>`
        <a class="exercise-cards__gallery-link js-card" data-card-name="${r}" href="">
            <div class="exercise-cards__gallery-card">
                <div class="exercise-cards__gradient"></div>
                <img class="exercise-cards__gallery-image"  src="${i}" alt="${t+"-"+r}" loading="lazy" />
                <div class="exercise-cards__gallery-info">
                    <h3 class="exercise-cards__head3-name">${r}</h3>
                    <p class="exercise-cards__parag-filter">${t}</p>
                </div>
            </div>
        </a>
        `).join("");mh.insertAdjacentHTML("beforeend",e)}function Fq(n){const e=n.map(({_id:t,bodyPart:r,name:i,target:s,burnedCalories:a,time:l,rating:h})=>`
        <a class="workout-cards__gallery-link js-workout-card" data-id="${t}"  href="">
            <div class="workout-cards__gallery-card" >
                <div class="workout-cards__first-line-wrapper">
                    <p class="workout-cards__parag-workout">Workout</p>
                    <p class="workout-cards__parag-rating">${Math.round(h*10)/10}</p>
                    <svg class="workout-cards__icon-star">
                        <use href="${Ls}images/icons-sprite.svg#icon-star"></use>
                    </svg>
                    <p class="workout-cards__parag-start">Start</p>
                    <svg class="workout-cards__icon-arrow-up">
                        <use href="${Ls}images/icons-sprite.svg#icon-arrow-up"></use>
                    </svg>
                </div>
                <div class="workout-cards__second-line-wrapper">
                    <div class="workout-cards__wrapper-icon-running-stick">
                        <svg class="workout-cards__icon-running-stick">
                            <use href="${Ls}images/icons-sprite.svg#icon-running-stick"></use>
                        </svg>
                    </div>
                    <h3 class="workout-cards__head3-name">${i}</h3>
                </div>
                <div class="workout-cards__third-line-wrapper">
                    <p class="workout-cards__parag-burned-calories">Burned calories:</p>
                    <p class="workout-cards__parag-burned-calories-result">${a} / ${l} min<p>
                    <p class="workout-cards__parag-body-part">Body part:</p>
                    <p class="workout-cards__parag-body-part-result">${r}<p>
                    <p class="workout-cards__parag-target">Target:</p>
                    <p class="workout-cards__parag-target-result">${s}<p>
                </div>
            </div>
        </a>
        `).join("");mh.insertAdjacentHTML("beforeend",e)}function Uq(n){const e=n.map(({_id:t,bodyPart:r,name:i,target:s,burnedCalories:a,time:l})=>`
        <a class="favori-cards__gallery-link" href="">
            <div class="favorite-cards__gallery-card" data-id="${t}">
                <div class="favorite-cards__first-line-wrapper">
                    <p class="favorite-cards__parag-workout">favorite</p>
                    <svg class="favorite-cards__icon-trash">
                        <use href="${Ls}images/icons-sprite.svg#icon-trash"></use>
                    </svg>
                    <p class="favorite-cards__parag-start">Start</p>
                    <svg class="favorite-cards__icon-arrow-up">
                        <use href="${Ls}images/icons-sprite.svg#icon-arrow-up"></use>
                    </svg>
                </div>
                <div class="favorite-cards__second-line-wrapper">
                    <svg class="favorite-cards__icon-running-stick">
                        <use href="${Ls}images/icons-sprite.svg#icon-running-stick"></use>
                    </svg>
                    <h3 class="favorite-cards__head3-name">${i}</h3>
                </div>
                <div class="favorite-cards__third-line-wrapper">
                    <p class="favorite-cards__parag-burned-calories">
                    Burned calories: <span class="favorite-cards__span-text">${a} / ${l} min<span></p>
                    <p class="favorite-cards__parag-body-part">
                    Body part: <span class="favorite-cards__span-text">${r} min<span></p>
                    <p class="favorite-cards__parag-target">
                    Target: <span class="favorite-cards__span-text">${s} min<span></p>
                </div>
            </div>
        </a>
        `).join("");mh.insertAdjacentHTML("beforeend",e)}function MI(){mh.innerHTML=""}function Bq(){return Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)}function Qo(n){let e="";for(let t=0;t<n;t+=1)e+=`
    <li class="exercises__skeleton-loader">
      <div class="card">
        <div class="cover-image-skeleton"></div>
      </div>
    </li>
    `;return e}const Yo=(n,e)=>{n.innerHTML=e},bn=document.querySelector(".js-cards");function qq(n,e){if(e>=768)return n!=3?(bn.classList.contains("workout-cards__wrapper")||Yo(bn,Qo(10)),10):(bn.classList.contains("workout-cards__wrapper")||Yo(bn,Qo(12)),12);if(e<768){if(n==1)return bn.classList.contains("workout-cards__wrapper")||Yo(bn,Qo(10)),10;if(n==2)return bn.classList.contains("workout-cards__wrapper")||Yo(bn,Qo(8)),8}return bn.classList.contains("workout-cards__wrapper")||Yo(bn,Qo(9)),9}function E0(n){const e={filter:"Body%20parts",bodypart:"",keyword:"",muscles:"",equipment:""};for(const t in n)if(n.hasOwnProperty(t)&&n[t]!==e[t])return!0;return!1}function $q(n,e,t,r,i){return E0(r)?(t.bodyPart=r.bodypart,t.keyword=r.keyword,t.muscles=r.muscles,t.equipment=r.equipment,i=ml(n,e,t).fetchFilteredExercises()):i=ml(n,e,t).fetchExercise(),i}function Wq(n,e,t,r,i){return E0(r)&&(t.filter=r.filter),i=ml(n,e,t).fetchMuscles(),i}function ml(n,e,t){const r=Bq(),i=qq(e,r);return t.pageCounter=n,t.limit=i,t}function FI(n){return n.then(e=>e).catch(e=>{throw console.error("Error in getData:",e),e})}const T0=document.querySelector(".exercise-cards__wrapper");function Gq(){T0.classList.add("workout-cards__wrapper")}function zq(){T0.classList.remove("workout-cards__wrapper")}const rp=document.querySelector(".js-pages");function UI(n,e){const t=[];if(e>1){for(let i=n-3;i<=n+3;i++)if(i>0&&i<=e){const s=i===n?"exercise-cards__wrapper-page exercise-cards__current-page":"exercise-cards__wrapper-page js-pages";t.push(`
                    <div class="${s}">
                        <a class="exercise-cards__page js-page" data-page="${i}" href="">
                            ${i}
                        </a>
                    </div>
                `)}rp.innerHTML="";for(const i of t)rp.insertAdjacentHTML("beforeend",i)}}function BI(){rp.innerHTML=""}function Kq(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-cards")?void 0:e.closest(".js-card").dataset.cardName}function Hq(n){n.preventDefault();const{target:e}=n;return e.classList.contains("js-page")?e.closest(".js-page").dataset.page:void 0}function jq(n){n.preventDefault();const{target:e}=n;if(e.classList.contains("js-cards"))return;const t=e.closest(".js-workout-card");return console.log(t),t.dataset.id}const Qq={add:function(n,e){return new Promise(t=>{try{jo.addData(n,e),t(!0)}catch(r){console.error(r),reject(!1)}})},get:function(){return new Promise(async n=>{try{const e=await jo.getData();n(Object.values(e))}catch(e){console.error(e),n([])}})},idIsFavorite:async function(n){try{return(await this.get()).some(t=>t._id===n)}catch(e){return console.error(e),!1}},getObjectById:async function(n){try{const t=(await this.get()).find(r=>r._id===n)||null;return t?{...t,isFavorite:!0}:null}catch(e){return console.error(e),null}},addAndGet:async function(n,e){return new Promise(async t=>{try{await jo.addData(n,e),setTimeout(async()=>{const r=await jo.getData();t(Object.values(r))},200)}catch(r){console.error(r),t([])}})},remove:async function(n){return new Promise(e=>{try{jo.removeData(n),e(!0)}catch(t){console.error(t),e(!1)}})}},Yq=n=>typeof n!="string"?n:n.split(" ").filter(e=>e).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),qI=n=>typeof n!="string"?n:n.charAt(0).toUpperCase()+n.slice(1),Jq=n=>typeof n!="string"?n:n.replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase(),Xq=n=>{const e=getComputedStyle(document.documentElement).getPropertyValue("--rating-color-inactive"),t=getComputedStyle(document.documentElement).getPropertyValue("--rating-color-active");return`
<!-- DEFINE SVGs -->
<svg height="0" width="0">
  <defs>
    <!-- DEFINE ONE STAR -->
    <symbol viewBox="0 0 32 32" id="iconstar">
      <path
        d="M13.826 3.262c.684-2.106 3.663-2.106 4.348 0l1.932 5.945a2.285 2.285 0 0 0 2.174 1.579h6.251c2.214 0 3.135 2.833 1.344 4.135l-5.057 3.674a2.286 2.286 0 0 0-.83 2.556l1.931 5.945c.684 2.106-1.726 3.857-3.517 2.555l-5.057-3.674a2.286 2.286 0 0 0-2.687 0l-5.057 3.674c-1.791 1.302-4.202-.45-3.517-2.555l1.932-5.945a2.287 2.287 0 0 0-.83-2.556l-5.057-3.674c-1.791-1.302-.871-4.135 1.344-4.135h6.251c.99 0 1.868-.638 2.174-1.579l1.932-5.945z" />
    </symbol>
    <!-- DEFINE PATTERN FOR EMPTY STARS -->
    <pattern id="stars-empty" patternUnits="userSpaceOnUse" width="24" height="24">
      <use x="0" y="0" xlink:href="#iconstar" fill="${e}" height="24" width="24"/>
    </pattern>
    <!-- DEFINE PATTERN FOR FULL STARS -->
    <pattern id="stars-full" patternUnits="userSpaceOnUse" width="24" height="24">
      <use x="0" y="0" xlink:href="#iconstar" fill="${t}" height="24" width="24"/>
    </pattern>
  </defs>
</svg>

<!-- INSERT STARS -->
<svg height="24" viewBox="0 0 120 24" width="120">
  <rect fill="url(#stars-empty)" x="0" y="0" height="24" width="120"/>
  <rect fill="url(#stars-full)" x="0" y="0" height="24" width="${n}%"/>
</svg>
`},_l=document.querySelector(".js-backdrop"),po=document.querySelector(".modalExercise"),A0=po.querySelector(".x-button"),$I=po.querySelector(".modalExercise__img-wrapper"),Jo=po.querySelector(".exercise-content"),Pc=po.querySelector(".button-box"),Zq="/project-fitness-07/",e4=5,t4=n=>{const{gifUrl:e,name:t,rating:r,_id:i,isFavorite:s,description:a}=n,l=n4(n);$I.innerHTML="",$I.insertAdjacentHTML("afterbegin",o4(e,t)),Jo.innerHTML="",Jo.insertAdjacentHTML("beforeend",i4(t)),Jo.insertAdjacentHTML("beforeend",s4(r)),Jo.insertAdjacentHTML("beforeend",a4(l)),Jo.insertAdjacentHTML("beforeend",u4(a)),r4()},n4=n=>({bodyPart:n.bodyPart,equipment:n.equipment,rating:n.rating,burnedCalories:n.burnedCalories,time:n.time,popular:n.popularity}),r4=(n=!1)=>{Pc.innerHTML="",n?Pc.insertAdjacentHTML("beforeend",l4()):Pc.insertAdjacentHTML("beforeend",c4()),Pc.insertAdjacentHTML("beforeend",h4())},i4=n=>`
    <h3 class="title">${Yq(n)}</h3>
  `,s4=n=>{const e=[],t=Math.round(n*10)/10;e.push(`<li class="rating__item value">${t}</li>`);const r=Math.round(n/e4*100);return e.push(`<li ${Xq(r)}</li>`),`<ul class="rating">${e.join("")}</ul>`},o4=(n,e)=>`
    <img src="${n}" alt="${e}"/>
  `,a4=({burnedCalories:n,time:e,...t})=>{const r=[];for(const[i,s]of Object.entries(t)){const a=Jq(i),l=qI(a),h=qI(s);r.push(`
      <li class="exercise_details-item">
        <p class="detail-name">${l}</p>
        <p class="detail-value">${h}</p>
      </li>
    `)}return r.push(`
      <li class="exercise_details-item">
        <p class="detail-name">Burned Calories</p>
        <p class="detail-value">${n}/${e} min</p>
      </li>
  `),`<ul class="exercise_details">${r.join("")}</ul>`},u4=n=>`
    <p class="exercise_description">${n}</p>

  `,c4=()=>Zg({text:"Add to favorites",iconId:"icon-heart",className:"js-toggle-favorite"}),l4=()=>Zg({text:"Remove from favorites",iconId:"icon-trash",className:"js-toggle-favorite"}),h4=()=>Zg({text:"Give a rating",className:"js-give-rating ghost"}),Zg=({text:n,iconId:e,className:t=""})=>{let r;return e&&(r=`
      <svg class="btn-icon">
        <use href=${Zq}images/icons-sprite.svg#${e} />
      </svg>
    `),`
    <button id="js-toggle-favorit" type="button" class="button ${t}">
      <span class="text">${n}</span>
      ${e?r:""}
    </button>
  `},_h=()=>{_l.classList.remove("open"),po.classList.remove("open"),A0.removeEventListener("click",_h),document.body.style.overflow="visible"},R0=n=>{t4(n),_l.classList.add("open"),po.classList.add("open"),A0.addEventListener("click",_h),document.body.style.overflow="hidden"};document.addEventListener("keydown",n=>{n.key==="Escape"&&_h()});_l.addEventListener("click",n=>{n.target===_l&&_h()});const d4=document.querySelector(".header__user"),f4=`
  <button class="button" type="button" data-modal="modal-exercise">
    Show exercise
  </button>`;d4.insertAdjacentHTML("beforeend",f4);const p4=document.querySelector("[data-modal]"),g4={_id:"64f389465ae26083f39b17a2",bodyPart:"waist",equipment:"body weight",gifUrl:"https://ftp.goit.study/img/power-pulse/gifs/0001.gif",name:"3/4 sit-up",target:"abs",description:"This refers to your core muscles, which include the rectus abdominis, obliques, and transverse abdominis. They're essential for maintaining posture, stability, and generating force in many movements. Exercises that target the abs include crunches, leg raises, and planks.",rating:3.61,burnedCalories:220,time:3,popularity:8322,isFavorite:!0},m4=async function(){R0(g4)};p4.addEventListener("click",n=>{m4()});window.addEventListener("resize",go);let kr={filter:"Muscles",bodypart:"",keyword:"",muscles:"",equipment:""};const wt={currentPage:1,endPoint:3},Bn={cardsLinks:null,pageLinks:null,workoutLinks:null};async function go(){document.querySelector(".exercise-cards__section").offsetHeight;const e=new Il;let t,r;try{switch(wt.endPoint){case 1:Uq(t);break;case 2:Gq(),r=$q(wt.currentPage,wt.endPoint,e,kr,r),t=await FI(r),MI(),BI(),Fq(t),UI(wt.currentPage,e.maxPages),WI(wt.endPoint),v4();break;case 3:zq(),r=Wq(wt.currentPage,wt.endPoint,e,kr,r),t=await FI(r),MI(),BI(),Mq(t),UI(wt.currentPage,e.maxPages),_4(),WI(wt.endPoint);break}}catch(i){console.log("Error: ",i)}}function _4(){Bn.cardsLinks=document.querySelector(".js-cards"),Bn.cardsLinks?Bn.cardsLinks.addEventListener("click",b0):console.error("Element with class 'js-cards' not found.")}function b0(n){const e=Kq(n);e!=null&&(kr.filter==="Muscles"?(wt.endPoint=2,kr.muscles=e):kr.filter==="Body%20parts"?(wt.endPoint=2,kr.bodypart=e):kr.filter==="Equipment"&&(wt.endPoint=2,kr.equipment=e)),Bn.cardsLinks.removeEventListener("click",b0),wt.currentPage=1,go()}function WI(){Bn.pageLinks=document.querySelector(".js-pages"),Bn.pageLinks?Bn.pageLinks.addEventListener("click",y4):console.error("Element with class 'js-pages' not found.")}function y4(n){const e=Hq(n);wt.currentPage!=e&&e!=null&&(wt.currentPage=+e,go())}function v4(){Bn.workoutLinks=document.querySelector(".js-cards"),Bn.workoutLinks?Bn.workoutLinks.addEventListener("click",I4):console.error("Element with class 'js-cards' not found for workout.")}async function I4(n){const e=jq(n);if(!e)return;const t=new Il;try{t.id=e;const r=await t.fetchExerciseById();if(!r)throw new Error("Exercise not found!");r.isFavorite=Qq.getObjectById(e),R0(r)}catch(r){console.error(r)}}go();var Xo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yl={},w4={get exports(){return yl},set exports(n){yl=n}};(function(n,e){(function(){var t,r="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",l="Invalid `variable` option passed into `_.template`",h="__lodash_hash_undefined__",f=500,p="__lodash_placeholder__",m=1,I=2,A=4,L=1,M=2,V=1,Y=2,ae=4,j=8,ye=16,de=32,me=64,we=128,Vt=256,zn=512,Xi=30,C0="...",k0=800,D0=16,nm=1,x0=2,N0=3,ii=1/0,mr=9007199254740991,V0=17976931348623157e292,Au=0/0,En=4294967295,O0=En-1,L0=En>>>1,M0=[["ary",we],["bind",V],["bindKey",Y],["curry",j],["curryRight",ye],["flip",zn],["partial",de],["partialRight",me],["rearg",Vt]],Zi="[object Arguments]",Ru="[object Array]",F0="[object AsyncFunction]",mo="[object Boolean]",_o="[object Date]",U0="[object DOMException]",bu="[object Error]",Su="[object Function]",rm="[object GeneratorFunction]",dn="[object Map]",yo="[object Number]",B0="[object Null]",Kn="[object Object]",im="[object Promise]",q0="[object Proxy]",vo="[object RegExp]",fn="[object Set]",Io="[object String]",Pu="[object Symbol]",$0="[object Undefined]",wo="[object WeakMap]",W0="[object WeakSet]",Eo="[object ArrayBuffer]",es="[object DataView]",vh="[object Float32Array]",Ih="[object Float64Array]",wh="[object Int8Array]",Eh="[object Int16Array]",Th="[object Int32Array]",Ah="[object Uint8Array]",Rh="[object Uint8ClampedArray]",bh="[object Uint16Array]",Sh="[object Uint32Array]",G0=/\b__p \+= '';/g,z0=/\b(__p \+=) '' \+/g,K0=/(__e\(.*?\)|\b__t\)) \+\n'';/g,sm=/&(?:amp|lt|gt|quot|#39);/g,om=/[&<>"']/g,H0=RegExp(sm.source),j0=RegExp(om.source),Q0=/<%-([\s\S]+?)%>/g,Y0=/<%([\s\S]+?)%>/g,am=/<%=([\s\S]+?)%>/g,J0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X0=/^\w*$/,Z0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ph=/[\\^$.*+?()[\]{}|]/g,eR=RegExp(Ph.source),Ch=/^\s+/,tR=/\s/,nR=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,rR=/\{\n\/\* \[wrapped with (.+)\] \*/,iR=/,? & /,sR=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,oR=/[()=,{}\[\]\/\s]/,aR=/\\(\\)?/g,uR=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,um=/\w*$/,cR=/^[-+]0x[0-9a-f]+$/i,lR=/^0b[01]+$/i,hR=/^\[object .+?Constructor\]$/,dR=/^0o[0-7]+$/i,fR=/^(?:0|[1-9]\d*)$/,pR=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Cu=/($^)/,gR=/['\n\r\u2028\u2029\\]/g,ku="\\ud800-\\udfff",mR="\\u0300-\\u036f",_R="\\ufe20-\\ufe2f",yR="\\u20d0-\\u20ff",cm=mR+_R+yR,lm="\\u2700-\\u27bf",hm="a-z\\xdf-\\xf6\\xf8-\\xff",vR="\\xac\\xb1\\xd7\\xf7",IR="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",wR="\\u2000-\\u206f",ER=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",dm="A-Z\\xc0-\\xd6\\xd8-\\xde",fm="\\ufe0e\\ufe0f",pm=vR+IR+wR+ER,kh="[']",TR="["+ku+"]",gm="["+pm+"]",Du="["+cm+"]",mm="\\d+",AR="["+lm+"]",_m="["+hm+"]",ym="[^"+ku+pm+mm+lm+hm+dm+"]",Dh="\\ud83c[\\udffb-\\udfff]",RR="(?:"+Du+"|"+Dh+")",vm="[^"+ku+"]",xh="(?:\\ud83c[\\udde6-\\uddff]){2}",Nh="[\\ud800-\\udbff][\\udc00-\\udfff]",ts="["+dm+"]",Im="\\u200d",wm="(?:"+_m+"|"+ym+")",bR="(?:"+ts+"|"+ym+")",Em="(?:"+kh+"(?:d|ll|m|re|s|t|ve))?",Tm="(?:"+kh+"(?:D|LL|M|RE|S|T|VE))?",Am=RR+"?",Rm="["+fm+"]?",SR="(?:"+Im+"(?:"+[vm,xh,Nh].join("|")+")"+Rm+Am+")*",PR="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",CR="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",bm=Rm+Am+SR,kR="(?:"+[AR,xh,Nh].join("|")+")"+bm,DR="(?:"+[vm+Du+"?",Du,xh,Nh,TR].join("|")+")",xR=RegExp(kh,"g"),NR=RegExp(Du,"g"),Vh=RegExp(Dh+"(?="+Dh+")|"+DR+bm,"g"),VR=RegExp([ts+"?"+_m+"+"+Em+"(?="+[gm,ts,"$"].join("|")+")",bR+"+"+Tm+"(?="+[gm,ts+wm,"$"].join("|")+")",ts+"?"+wm+"+"+Em,ts+"+"+Tm,CR,PR,mm,kR].join("|"),"g"),OR=RegExp("["+Im+ku+cm+fm+"]"),LR=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,MR=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],FR=-1,Ce={};Ce[vh]=Ce[Ih]=Ce[wh]=Ce[Eh]=Ce[Th]=Ce[Ah]=Ce[Rh]=Ce[bh]=Ce[Sh]=!0,Ce[Zi]=Ce[Ru]=Ce[Eo]=Ce[mo]=Ce[es]=Ce[_o]=Ce[bu]=Ce[Su]=Ce[dn]=Ce[yo]=Ce[Kn]=Ce[vo]=Ce[fn]=Ce[Io]=Ce[wo]=!1;var Se={};Se[Zi]=Se[Ru]=Se[Eo]=Se[es]=Se[mo]=Se[_o]=Se[vh]=Se[Ih]=Se[wh]=Se[Eh]=Se[Th]=Se[dn]=Se[yo]=Se[Kn]=Se[vo]=Se[fn]=Se[Io]=Se[Pu]=Se[Ah]=Se[Rh]=Se[bh]=Se[Sh]=!0,Se[bu]=Se[Su]=Se[wo]=!1;var UR={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},BR={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},qR={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},$R={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},WR=parseFloat,GR=parseInt,Sm=typeof Xo=="object"&&Xo&&Xo.Object===Object&&Xo,zR=typeof self=="object"&&self&&self.Object===Object&&self,ct=Sm||zR||Function("return this")(),Oh=e&&!e.nodeType&&e,si=Oh&&!0&&n&&!n.nodeType&&n,Pm=si&&si.exports===Oh,Lh=Pm&&Sm.process,en=function(){try{var E=si&&si.require&&si.require("util").types;return E||Lh&&Lh.binding&&Lh.binding("util")}catch{}}(),Cm=en&&en.isArrayBuffer,km=en&&en.isDate,Dm=en&&en.isMap,xm=en&&en.isRegExp,Nm=en&&en.isSet,Vm=en&&en.isTypedArray;function Gt(E,P,b){switch(b.length){case 0:return E.call(P);case 1:return E.call(P,b[0]);case 2:return E.call(P,b[0],b[1]);case 3:return E.call(P,b[0],b[1],b[2])}return E.apply(P,b)}function KR(E,P,b,W){for(var ee=-1,ve=E==null?0:E.length;++ee<ve;){var Xe=E[ee];P(W,Xe,b(Xe),E)}return W}function tn(E,P){for(var b=-1,W=E==null?0:E.length;++b<W&&P(E[b],b,E)!==!1;);return E}function HR(E,P){for(var b=E==null?0:E.length;b--&&P(E[b],b,E)!==!1;);return E}function Om(E,P){for(var b=-1,W=E==null?0:E.length;++b<W;)if(!P(E[b],b,E))return!1;return!0}function _r(E,P){for(var b=-1,W=E==null?0:E.length,ee=0,ve=[];++b<W;){var Xe=E[b];P(Xe,b,E)&&(ve[ee++]=Xe)}return ve}function xu(E,P){var b=E==null?0:E.length;return!!b&&ns(E,P,0)>-1}function Mh(E,P,b){for(var W=-1,ee=E==null?0:E.length;++W<ee;)if(b(P,E[W]))return!0;return!1}function xe(E,P){for(var b=-1,W=E==null?0:E.length,ee=Array(W);++b<W;)ee[b]=P(E[b],b,E);return ee}function yr(E,P){for(var b=-1,W=P.length,ee=E.length;++b<W;)E[ee+b]=P[b];return E}function Fh(E,P,b,W){var ee=-1,ve=E==null?0:E.length;for(W&&ve&&(b=E[++ee]);++ee<ve;)b=P(b,E[ee],ee,E);return b}function jR(E,P,b,W){var ee=E==null?0:E.length;for(W&&ee&&(b=E[--ee]);ee--;)b=P(b,E[ee],ee,E);return b}function Uh(E,P){for(var b=-1,W=E==null?0:E.length;++b<W;)if(P(E[b],b,E))return!0;return!1}var QR=Bh("length");function YR(E){return E.split("")}function JR(E){return E.match(sR)||[]}function Lm(E,P,b){var W;return b(E,function(ee,ve,Xe){if(P(ee,ve,Xe))return W=ve,!1}),W}function Nu(E,P,b,W){for(var ee=E.length,ve=b+(W?1:-1);W?ve--:++ve<ee;)if(P(E[ve],ve,E))return ve;return-1}function ns(E,P,b){return P===P?cb(E,P,b):Nu(E,Mm,b)}function XR(E,P,b,W){for(var ee=b-1,ve=E.length;++ee<ve;)if(W(E[ee],P))return ee;return-1}function Mm(E){return E!==E}function Fm(E,P){var b=E==null?0:E.length;return b?$h(E,P)/b:Au}function Bh(E){return function(P){return P==null?t:P[E]}}function qh(E){return function(P){return E==null?t:E[P]}}function Um(E,P,b,W,ee){return ee(E,function(ve,Xe,be){b=W?(W=!1,ve):P(b,ve,Xe,be)}),b}function ZR(E,P){var b=E.length;for(E.sort(P);b--;)E[b]=E[b].value;return E}function $h(E,P){for(var b,W=-1,ee=E.length;++W<ee;){var ve=P(E[W]);ve!==t&&(b=b===t?ve:b+ve)}return b}function Wh(E,P){for(var b=-1,W=Array(E);++b<E;)W[b]=P(b);return W}function eb(E,P){return xe(P,function(b){return[b,E[b]]})}function Bm(E){return E&&E.slice(0,Gm(E)+1).replace(Ch,"")}function zt(E){return function(P){return E(P)}}function Gh(E,P){return xe(P,function(b){return E[b]})}function To(E,P){return E.has(P)}function qm(E,P){for(var b=-1,W=E.length;++b<W&&ns(P,E[b],0)>-1;);return b}function $m(E,P){for(var b=E.length;b--&&ns(P,E[b],0)>-1;);return b}function tb(E,P){for(var b=E.length,W=0;b--;)E[b]===P&&++W;return W}var nb=qh(UR),rb=qh(BR);function ib(E){return"\\"+$R[E]}function sb(E,P){return E==null?t:E[P]}function rs(E){return OR.test(E)}function ob(E){return LR.test(E)}function ab(E){for(var P,b=[];!(P=E.next()).done;)b.push(P.value);return b}function zh(E){var P=-1,b=Array(E.size);return E.forEach(function(W,ee){b[++P]=[ee,W]}),b}function Wm(E,P){return function(b){return E(P(b))}}function vr(E,P){for(var b=-1,W=E.length,ee=0,ve=[];++b<W;){var Xe=E[b];(Xe===P||Xe===p)&&(E[b]=p,ve[ee++]=b)}return ve}function Vu(E){var P=-1,b=Array(E.size);return E.forEach(function(W){b[++P]=W}),b}function ub(E){var P=-1,b=Array(E.size);return E.forEach(function(W){b[++P]=[W,W]}),b}function cb(E,P,b){for(var W=b-1,ee=E.length;++W<ee;)if(E[W]===P)return W;return-1}function lb(E,P,b){for(var W=b+1;W--;)if(E[W]===P)return W;return W}function is(E){return rs(E)?db(E):QR(E)}function pn(E){return rs(E)?fb(E):YR(E)}function Gm(E){for(var P=E.length;P--&&tR.test(E.charAt(P)););return P}var hb=qh(qR);function db(E){for(var P=Vh.lastIndex=0;Vh.test(E);)++P;return P}function fb(E){return E.match(Vh)||[]}function pb(E){return E.match(VR)||[]}var gb=function E(P){P=P==null?ct:ss.defaults(ct.Object(),P,ss.pick(ct,MR));var b=P.Array,W=P.Date,ee=P.Error,ve=P.Function,Xe=P.Math,be=P.Object,Kh=P.RegExp,mb=P.String,nn=P.TypeError,Ou=b.prototype,_b=ve.prototype,os=be.prototype,Lu=P["__core-js_shared__"],Mu=_b.toString,Ee=os.hasOwnProperty,yb=0,zm=function(){var o=/[^.]+$/.exec(Lu&&Lu.keys&&Lu.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Fu=os.toString,vb=Mu.call(be),Ib=ct._,wb=Kh("^"+Mu.call(Ee).replace(Ph,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Uu=Pm?P.Buffer:t,Ir=P.Symbol,Bu=P.Uint8Array,Km=Uu?Uu.allocUnsafe:t,qu=Wm(be.getPrototypeOf,be),Hm=be.create,jm=os.propertyIsEnumerable,$u=Ou.splice,Qm=Ir?Ir.isConcatSpreadable:t,Ao=Ir?Ir.iterator:t,oi=Ir?Ir.toStringTag:t,Wu=function(){try{var o=hi(be,"defineProperty");return o({},"",{}),o}catch{}}(),Eb=P.clearTimeout!==ct.clearTimeout&&P.clearTimeout,Tb=W&&W.now!==ct.Date.now&&W.now,Ab=P.setTimeout!==ct.setTimeout&&P.setTimeout,Gu=Xe.ceil,zu=Xe.floor,Hh=be.getOwnPropertySymbols,Rb=Uu?Uu.isBuffer:t,Ym=P.isFinite,bb=Ou.join,Sb=Wm(be.keys,be),Ze=Xe.max,yt=Xe.min,Pb=W.now,Cb=P.parseInt,Jm=Xe.random,kb=Ou.reverse,jh=hi(P,"DataView"),Ro=hi(P,"Map"),Qh=hi(P,"Promise"),as=hi(P,"Set"),bo=hi(P,"WeakMap"),So=hi(be,"create"),Ku=bo&&new bo,us={},Db=di(jh),xb=di(Ro),Nb=di(Qh),Vb=di(as),Ob=di(bo),Hu=Ir?Ir.prototype:t,Po=Hu?Hu.valueOf:t,Xm=Hu?Hu.toString:t;function _(o){if(Ue(o)&&!te(o)&&!(o instanceof le)){if(o instanceof rn)return o;if(Ee.call(o,"__wrapped__"))return Z_(o)}return new rn(o)}var cs=function(){function o(){}return function(u){if(!Me(u))return{};if(Hm)return Hm(u);o.prototype=u;var c=new o;return o.prototype=t,c}}();function ju(){}function rn(o,u){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=t}_.templateSettings={escape:Q0,evaluate:Y0,interpolate:am,variable:"",imports:{_}},_.prototype=ju.prototype,_.prototype.constructor=_,rn.prototype=cs(ju.prototype),rn.prototype.constructor=rn;function le(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=En,this.__views__=[]}function Lb(){var o=new le(this.__wrapped__);return o.__actions__=Ot(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=Ot(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=Ot(this.__views__),o}function Mb(){if(this.__filtered__){var o=new le(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function Fb(){var o=this.__wrapped__.value(),u=this.__dir__,c=te(o),d=u<0,g=c?o.length:0,y=YS(0,g,this.__views__),v=y.start,w=y.end,T=w-v,C=d?w:v-1,k=this.__iteratees__,x=k.length,U=0,G=yt(T,this.__takeCount__);if(!c||!d&&g==T&&G==T)return E_(o,this.__actions__);var J=[];e:for(;T--&&U<G;){C+=u;for(var se=-1,X=o[C];++se<x;){var ue=k[se],fe=ue.iteratee,jt=ue.type,St=fe(X);if(jt==x0)X=St;else if(!St){if(jt==nm)continue e;break e}}J[U++]=X}return J}le.prototype=cs(ju.prototype),le.prototype.constructor=le;function ai(o){var u=-1,c=o==null?0:o.length;for(this.clear();++u<c;){var d=o[u];this.set(d[0],d[1])}}function Ub(){this.__data__=So?So(null):{},this.size=0}function Bb(o){var u=this.has(o)&&delete this.__data__[o];return this.size-=u?1:0,u}function qb(o){var u=this.__data__;if(So){var c=u[o];return c===h?t:c}return Ee.call(u,o)?u[o]:t}function $b(o){var u=this.__data__;return So?u[o]!==t:Ee.call(u,o)}function Wb(o,u){var c=this.__data__;return this.size+=this.has(o)?0:1,c[o]=So&&u===t?h:u,this}ai.prototype.clear=Ub,ai.prototype.delete=Bb,ai.prototype.get=qb,ai.prototype.has=$b,ai.prototype.set=Wb;function Hn(o){var u=-1,c=o==null?0:o.length;for(this.clear();++u<c;){var d=o[u];this.set(d[0],d[1])}}function Gb(){this.__data__=[],this.size=0}function zb(o){var u=this.__data__,c=Qu(u,o);if(c<0)return!1;var d=u.length-1;return c==d?u.pop():$u.call(u,c,1),--this.size,!0}function Kb(o){var u=this.__data__,c=Qu(u,o);return c<0?t:u[c][1]}function Hb(o){return Qu(this.__data__,o)>-1}function jb(o,u){var c=this.__data__,d=Qu(c,o);return d<0?(++this.size,c.push([o,u])):c[d][1]=u,this}Hn.prototype.clear=Gb,Hn.prototype.delete=zb,Hn.prototype.get=Kb,Hn.prototype.has=Hb,Hn.prototype.set=jb;function jn(o){var u=-1,c=o==null?0:o.length;for(this.clear();++u<c;){var d=o[u];this.set(d[0],d[1])}}function Qb(){this.size=0,this.__data__={hash:new ai,map:new(Ro||Hn),string:new ai}}function Yb(o){var u=ac(this,o).delete(o);return this.size-=u?1:0,u}function Jb(o){return ac(this,o).get(o)}function Xb(o){return ac(this,o).has(o)}function Zb(o,u){var c=ac(this,o),d=c.size;return c.set(o,u),this.size+=c.size==d?0:1,this}jn.prototype.clear=Qb,jn.prototype.delete=Yb,jn.prototype.get=Jb,jn.prototype.has=Xb,jn.prototype.set=Zb;function ui(o){var u=-1,c=o==null?0:o.length;for(this.__data__=new jn;++u<c;)this.add(o[u])}function eS(o){return this.__data__.set(o,h),this}function tS(o){return this.__data__.has(o)}ui.prototype.add=ui.prototype.push=eS,ui.prototype.has=tS;function gn(o){var u=this.__data__=new Hn(o);this.size=u.size}function nS(){this.__data__=new Hn,this.size=0}function rS(o){var u=this.__data__,c=u.delete(o);return this.size=u.size,c}function iS(o){return this.__data__.get(o)}function sS(o){return this.__data__.has(o)}function oS(o,u){var c=this.__data__;if(c instanceof Hn){var d=c.__data__;if(!Ro||d.length<i-1)return d.push([o,u]),this.size=++c.size,this;c=this.__data__=new jn(d)}return c.set(o,u),this.size=c.size,this}gn.prototype.clear=nS,gn.prototype.delete=rS,gn.prototype.get=iS,gn.prototype.has=sS,gn.prototype.set=oS;function Zm(o,u){var c=te(o),d=!c&&fi(o),g=!c&&!d&&Rr(o),y=!c&&!d&&!g&&fs(o),v=c||d||g||y,w=v?Wh(o.length,mb):[],T=w.length;for(var C in o)(u||Ee.call(o,C))&&!(v&&(C=="length"||g&&(C=="offset"||C=="parent")||y&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||Xn(C,T)))&&w.push(C);return w}function e_(o){var u=o.length;return u?o[od(0,u-1)]:t}function aS(o,u){return uc(Ot(o),ci(u,0,o.length))}function uS(o){return uc(Ot(o))}function Yh(o,u,c){(c!==t&&!mn(o[u],c)||c===t&&!(u in o))&&Qn(o,u,c)}function Co(o,u,c){var d=o[u];(!(Ee.call(o,u)&&mn(d,c))||c===t&&!(u in o))&&Qn(o,u,c)}function Qu(o,u){for(var c=o.length;c--;)if(mn(o[c][0],u))return c;return-1}function cS(o,u,c,d){return wr(o,function(g,y,v){u(d,g,c(g),v)}),d}function t_(o,u){return o&&An(u,tt(u),o)}function lS(o,u){return o&&An(u,Mt(u),o)}function Qn(o,u,c){u=="__proto__"&&Wu?Wu(o,u,{configurable:!0,enumerable:!0,value:c,writable:!0}):o[u]=c}function Jh(o,u){for(var c=-1,d=u.length,g=b(d),y=o==null;++c<d;)g[c]=y?t:Dd(o,u[c]);return g}function ci(o,u,c){return o===o&&(c!==t&&(o=o<=c?o:c),u!==t&&(o=o>=u?o:u)),o}function sn(o,u,c,d,g,y){var v,w=u&m,T=u&I,C=u&A;if(c&&(v=g?c(o,d,g,y):c(o)),v!==t)return v;if(!Me(o))return o;var k=te(o);if(k){if(v=XS(o),!w)return Ot(o,v)}else{var x=vt(o),U=x==Su||x==rm;if(Rr(o))return R_(o,w);if(x==Kn||x==Zi||U&&!g){if(v=T||U?{}:G_(o),!w)return T?qS(o,lS(v,o)):BS(o,t_(v,o))}else{if(!Se[x])return g?o:{};v=ZS(o,x,w)}}y||(y=new gn);var G=y.get(o);if(G)return G;y.set(o,v),vy(o)?o.forEach(function(X){v.add(sn(X,u,c,X,o,y))}):_y(o)&&o.forEach(function(X,ue){v.set(ue,sn(X,u,c,ue,o,y))});var J=C?T?_d:md:T?Mt:tt,se=k?t:J(o);return tn(se||o,function(X,ue){se&&(ue=X,X=o[ue]),Co(v,ue,sn(X,u,c,ue,o,y))}),v}function hS(o){var u=tt(o);return function(c){return n_(c,o,u)}}function n_(o,u,c){var d=c.length;if(o==null)return!d;for(o=be(o);d--;){var g=c[d],y=u[g],v=o[g];if(v===t&&!(g in o)||!y(v))return!1}return!0}function r_(o,u,c){if(typeof o!="function")throw new nn(a);return Lo(function(){o.apply(t,c)},u)}function ko(o,u,c,d){var g=-1,y=xu,v=!0,w=o.length,T=[],C=u.length;if(!w)return T;c&&(u=xe(u,zt(c))),d?(y=Mh,v=!1):u.length>=i&&(y=To,v=!1,u=new ui(u));e:for(;++g<w;){var k=o[g],x=c==null?k:c(k);if(k=d||k!==0?k:0,v&&x===x){for(var U=C;U--;)if(u[U]===x)continue e;T.push(k)}else y(u,x,d)||T.push(k)}return T}var wr=k_(Tn),i_=k_(Zh,!0);function dS(o,u){var c=!0;return wr(o,function(d,g,y){return c=!!u(d,g,y),c}),c}function Yu(o,u,c){for(var d=-1,g=o.length;++d<g;){var y=o[d],v=u(y);if(v!=null&&(w===t?v===v&&!Ht(v):c(v,w)))var w=v,T=y}return T}function fS(o,u,c,d){var g=o.length;for(c=ie(c),c<0&&(c=-c>g?0:g+c),d=d===t||d>g?g:ie(d),d<0&&(d+=g),d=c>d?0:wy(d);c<d;)o[c++]=u;return o}function s_(o,u){var c=[];return wr(o,function(d,g,y){u(d,g,y)&&c.push(d)}),c}function lt(o,u,c,d,g){var y=-1,v=o.length;for(c||(c=tP),g||(g=[]);++y<v;){var w=o[y];u>0&&c(w)?u>1?lt(w,u-1,c,d,g):yr(g,w):d||(g[g.length]=w)}return g}var Xh=D_(),o_=D_(!0);function Tn(o,u){return o&&Xh(o,u,tt)}function Zh(o,u){return o&&o_(o,u,tt)}function Ju(o,u){return _r(u,function(c){return Zn(o[c])})}function li(o,u){u=Tr(u,o);for(var c=0,d=u.length;o!=null&&c<d;)o=o[Rn(u[c++])];return c&&c==d?o:t}function a_(o,u,c){var d=u(o);return te(o)?d:yr(d,c(o))}function Rt(o){return o==null?o===t?$0:B0:oi&&oi in be(o)?QS(o):uP(o)}function ed(o,u){return o>u}function pS(o,u){return o!=null&&Ee.call(o,u)}function gS(o,u){return o!=null&&u in be(o)}function mS(o,u,c){return o>=yt(u,c)&&o<Ze(u,c)}function td(o,u,c){for(var d=c?Mh:xu,g=o[0].length,y=o.length,v=y,w=b(y),T=1/0,C=[];v--;){var k=o[v];v&&u&&(k=xe(k,zt(u))),T=yt(k.length,T),w[v]=!c&&(u||g>=120&&k.length>=120)?new ui(v&&k):t}k=o[0];var x=-1,U=w[0];e:for(;++x<g&&C.length<T;){var G=k[x],J=u?u(G):G;if(G=c||G!==0?G:0,!(U?To(U,J):d(C,J,c))){for(v=y;--v;){var se=w[v];if(!(se?To(se,J):d(o[v],J,c)))continue e}U&&U.push(J),C.push(G)}}return C}function _S(o,u,c,d){return Tn(o,function(g,y,v){u(d,c(g),y,v)}),d}function Do(o,u,c){u=Tr(u,o),o=j_(o,u);var d=o==null?o:o[Rn(an(u))];return d==null?t:Gt(d,o,c)}function u_(o){return Ue(o)&&Rt(o)==Zi}function yS(o){return Ue(o)&&Rt(o)==Eo}function vS(o){return Ue(o)&&Rt(o)==_o}function xo(o,u,c,d,g){return o===u?!0:o==null||u==null||!Ue(o)&&!Ue(u)?o!==o&&u!==u:IS(o,u,c,d,xo,g)}function IS(o,u,c,d,g,y){var v=te(o),w=te(u),T=v?Ru:vt(o),C=w?Ru:vt(u);T=T==Zi?Kn:T,C=C==Zi?Kn:C;var k=T==Kn,x=C==Kn,U=T==C;if(U&&Rr(o)){if(!Rr(u))return!1;v=!0,k=!1}if(U&&!k)return y||(y=new gn),v||fs(o)?q_(o,u,c,d,g,y):HS(o,u,T,c,d,g,y);if(!(c&L)){var G=k&&Ee.call(o,"__wrapped__"),J=x&&Ee.call(u,"__wrapped__");if(G||J){var se=G?o.value():o,X=J?u.value():u;return y||(y=new gn),g(se,X,c,d,y)}}return U?(y||(y=new gn),jS(o,u,c,d,g,y)):!1}function wS(o){return Ue(o)&&vt(o)==dn}function nd(o,u,c,d){var g=c.length,y=g,v=!d;if(o==null)return!y;for(o=be(o);g--;){var w=c[g];if(v&&w[2]?w[1]!==o[w[0]]:!(w[0]in o))return!1}for(;++g<y;){w=c[g];var T=w[0],C=o[T],k=w[1];if(v&&w[2]){if(C===t&&!(T in o))return!1}else{var x=new gn;if(d)var U=d(C,k,T,o,u,x);if(!(U===t?xo(k,C,L|M,d,x):U))return!1}}return!0}function c_(o){if(!Me(o)||rP(o))return!1;var u=Zn(o)?wb:hR;return u.test(di(o))}function ES(o){return Ue(o)&&Rt(o)==vo}function TS(o){return Ue(o)&&vt(o)==fn}function AS(o){return Ue(o)&&pc(o.length)&&!!Ce[Rt(o)]}function l_(o){return typeof o=="function"?o:o==null?Ft:typeof o=="object"?te(o)?f_(o[0],o[1]):d_(o):xy(o)}function rd(o){if(!Oo(o))return Sb(o);var u=[];for(var c in be(o))Ee.call(o,c)&&c!="constructor"&&u.push(c);return u}function RS(o){if(!Me(o))return aP(o);var u=Oo(o),c=[];for(var d in o)d=="constructor"&&(u||!Ee.call(o,d))||c.push(d);return c}function id(o,u){return o<u}function h_(o,u){var c=-1,d=Lt(o)?b(o.length):[];return wr(o,function(g,y,v){d[++c]=u(g,y,v)}),d}function d_(o){var u=vd(o);return u.length==1&&u[0][2]?K_(u[0][0],u[0][1]):function(c){return c===o||nd(c,o,u)}}function f_(o,u){return wd(o)&&z_(u)?K_(Rn(o),u):function(c){var d=Dd(c,o);return d===t&&d===u?xd(c,o):xo(u,d,L|M)}}function Xu(o,u,c,d,g){o!==u&&Xh(u,function(y,v){if(g||(g=new gn),Me(y))bS(o,u,v,c,Xu,d,g);else{var w=d?d(Td(o,v),y,v+"",o,u,g):t;w===t&&(w=y),Yh(o,v,w)}},Mt)}function bS(o,u,c,d,g,y,v){var w=Td(o,c),T=Td(u,c),C=v.get(T);if(C){Yh(o,c,C);return}var k=y?y(w,T,c+"",o,u,v):t,x=k===t;if(x){var U=te(T),G=!U&&Rr(T),J=!U&&!G&&fs(T);k=T,U||G||J?te(w)?k=w:Ke(w)?k=Ot(w):G?(x=!1,k=R_(T,!0)):J?(x=!1,k=b_(T,!0)):k=[]:Mo(T)||fi(T)?(k=w,fi(w)?k=Ey(w):(!Me(w)||Zn(w))&&(k=G_(T))):x=!1}x&&(v.set(T,k),g(k,T,d,y,v),v.delete(T)),Yh(o,c,k)}function p_(o,u){var c=o.length;if(c)return u+=u<0?c:0,Xn(u,c)?o[u]:t}function g_(o,u,c){u.length?u=xe(u,function(y){return te(y)?function(v){return li(v,y.length===1?y[0]:y)}:y}):u=[Ft];var d=-1;u=xe(u,zt(Q()));var g=h_(o,function(y,v,w){var T=xe(u,function(C){return C(y)});return{criteria:T,index:++d,value:y}});return ZR(g,function(y,v){return US(y,v,c)})}function SS(o,u){return m_(o,u,function(c,d){return xd(o,d)})}function m_(o,u,c){for(var d=-1,g=u.length,y={};++d<g;){var v=u[d],w=li(o,v);c(w,v)&&No(y,Tr(v,o),w)}return y}function PS(o){return function(u){return li(u,o)}}function sd(o,u,c,d){var g=d?XR:ns,y=-1,v=u.length,w=o;for(o===u&&(u=Ot(u)),c&&(w=xe(o,zt(c)));++y<v;)for(var T=0,C=u[y],k=c?c(C):C;(T=g(w,k,T,d))>-1;)w!==o&&$u.call(w,T,1),$u.call(o,T,1);return o}function __(o,u){for(var c=o?u.length:0,d=c-1;c--;){var g=u[c];if(c==d||g!==y){var y=g;Xn(g)?$u.call(o,g,1):cd(o,g)}}return o}function od(o,u){return o+zu(Jm()*(u-o+1))}function CS(o,u,c,d){for(var g=-1,y=Ze(Gu((u-o)/(c||1)),0),v=b(y);y--;)v[d?y:++g]=o,o+=c;return v}function ad(o,u){var c="";if(!o||u<1||u>mr)return c;do u%2&&(c+=o),u=zu(u/2),u&&(o+=o);while(u);return c}function oe(o,u){return Ad(H_(o,u,Ft),o+"")}function kS(o){return e_(ps(o))}function DS(o,u){var c=ps(o);return uc(c,ci(u,0,c.length))}function No(o,u,c,d){if(!Me(o))return o;u=Tr(u,o);for(var g=-1,y=u.length,v=y-1,w=o;w!=null&&++g<y;){var T=Rn(u[g]),C=c;if(T==="__proto__"||T==="constructor"||T==="prototype")return o;if(g!=v){var k=w[T];C=d?d(k,T,w):t,C===t&&(C=Me(k)?k:Xn(u[g+1])?[]:{})}Co(w,T,C),w=w[T]}return o}var y_=Ku?function(o,u){return Ku.set(o,u),o}:Ft,xS=Wu?function(o,u){return Wu(o,"toString",{configurable:!0,enumerable:!1,value:Vd(u),writable:!0})}:Ft;function NS(o){return uc(ps(o))}function on(o,u,c){var d=-1,g=o.length;u<0&&(u=-u>g?0:g+u),c=c>g?g:c,c<0&&(c+=g),g=u>c?0:c-u>>>0,u>>>=0;for(var y=b(g);++d<g;)y[d]=o[d+u];return y}function VS(o,u){var c;return wr(o,function(d,g,y){return c=u(d,g,y),!c}),!!c}function Zu(o,u,c){var d=0,g=o==null?d:o.length;if(typeof u=="number"&&u===u&&g<=L0){for(;d<g;){var y=d+g>>>1,v=o[y];v!==null&&!Ht(v)&&(c?v<=u:v<u)?d=y+1:g=y}return g}return ud(o,u,Ft,c)}function ud(o,u,c,d){var g=0,y=o==null?0:o.length;if(y===0)return 0;u=c(u);for(var v=u!==u,w=u===null,T=Ht(u),C=u===t;g<y;){var k=zu((g+y)/2),x=c(o[k]),U=x!==t,G=x===null,J=x===x,se=Ht(x);if(v)var X=d||J;else C?X=J&&(d||U):w?X=J&&U&&(d||!G):T?X=J&&U&&!G&&(d||!se):G||se?X=!1:X=d?x<=u:x<u;X?g=k+1:y=k}return yt(y,O0)}function v_(o,u){for(var c=-1,d=o.length,g=0,y=[];++c<d;){var v=o[c],w=u?u(v):v;if(!c||!mn(w,T)){var T=w;y[g++]=v===0?0:v}}return y}function I_(o){return typeof o=="number"?o:Ht(o)?Au:+o}function Kt(o){if(typeof o=="string")return o;if(te(o))return xe(o,Kt)+"";if(Ht(o))return Xm?Xm.call(o):"";var u=o+"";return u=="0"&&1/o==-ii?"-0":u}function Er(o,u,c){var d=-1,g=xu,y=o.length,v=!0,w=[],T=w;if(c)v=!1,g=Mh;else if(y>=i){var C=u?null:zS(o);if(C)return Vu(C);v=!1,g=To,T=new ui}else T=u?[]:w;e:for(;++d<y;){var k=o[d],x=u?u(k):k;if(k=c||k!==0?k:0,v&&x===x){for(var U=T.length;U--;)if(T[U]===x)continue e;u&&T.push(x),w.push(k)}else g(T,x,c)||(T!==w&&T.push(x),w.push(k))}return w}function cd(o,u){return u=Tr(u,o),o=j_(o,u),o==null||delete o[Rn(an(u))]}function w_(o,u,c,d){return No(o,u,c(li(o,u)),d)}function ec(o,u,c,d){for(var g=o.length,y=d?g:-1;(d?y--:++y<g)&&u(o[y],y,o););return c?on(o,d?0:y,d?y+1:g):on(o,d?y+1:0,d?g:y)}function E_(o,u){var c=o;return c instanceof le&&(c=c.value()),Fh(u,function(d,g){return g.func.apply(g.thisArg,yr([d],g.args))},c)}function ld(o,u,c){var d=o.length;if(d<2)return d?Er(o[0]):[];for(var g=-1,y=b(d);++g<d;)for(var v=o[g],w=-1;++w<d;)w!=g&&(y[g]=ko(y[g]||v,o[w],u,c));return Er(lt(y,1),u,c)}function T_(o,u,c){for(var d=-1,g=o.length,y=u.length,v={};++d<g;){var w=d<y?u[d]:t;c(v,o[d],w)}return v}function hd(o){return Ke(o)?o:[]}function dd(o){return typeof o=="function"?o:Ft}function Tr(o,u){return te(o)?o:wd(o,u)?[o]:X_(Ie(o))}var OS=oe;function Ar(o,u,c){var d=o.length;return c=c===t?d:c,!u&&c>=d?o:on(o,u,c)}var A_=Eb||function(o){return ct.clearTimeout(o)};function R_(o,u){if(u)return o.slice();var c=o.length,d=Km?Km(c):new o.constructor(c);return o.copy(d),d}function fd(o){var u=new o.constructor(o.byteLength);return new Bu(u).set(new Bu(o)),u}function LS(o,u){var c=u?fd(o.buffer):o.buffer;return new o.constructor(c,o.byteOffset,o.byteLength)}function MS(o){var u=new o.constructor(o.source,um.exec(o));return u.lastIndex=o.lastIndex,u}function FS(o){return Po?be(Po.call(o)):{}}function b_(o,u){var c=u?fd(o.buffer):o.buffer;return new o.constructor(c,o.byteOffset,o.length)}function S_(o,u){if(o!==u){var c=o!==t,d=o===null,g=o===o,y=Ht(o),v=u!==t,w=u===null,T=u===u,C=Ht(u);if(!w&&!C&&!y&&o>u||y&&v&&T&&!w&&!C||d&&v&&T||!c&&T||!g)return 1;if(!d&&!y&&!C&&o<u||C&&c&&g&&!d&&!y||w&&c&&g||!v&&g||!T)return-1}return 0}function US(o,u,c){for(var d=-1,g=o.criteria,y=u.criteria,v=g.length,w=c.length;++d<v;){var T=S_(g[d],y[d]);if(T){if(d>=w)return T;var C=c[d];return T*(C=="desc"?-1:1)}}return o.index-u.index}function P_(o,u,c,d){for(var g=-1,y=o.length,v=c.length,w=-1,T=u.length,C=Ze(y-v,0),k=b(T+C),x=!d;++w<T;)k[w]=u[w];for(;++g<v;)(x||g<y)&&(k[c[g]]=o[g]);for(;C--;)k[w++]=o[g++];return k}function C_(o,u,c,d){for(var g=-1,y=o.length,v=-1,w=c.length,T=-1,C=u.length,k=Ze(y-w,0),x=b(k+C),U=!d;++g<k;)x[g]=o[g];for(var G=g;++T<C;)x[G+T]=u[T];for(;++v<w;)(U||g<y)&&(x[G+c[v]]=o[g++]);return x}function Ot(o,u){var c=-1,d=o.length;for(u||(u=b(d));++c<d;)u[c]=o[c];return u}function An(o,u,c,d){var g=!c;c||(c={});for(var y=-1,v=u.length;++y<v;){var w=u[y],T=d?d(c[w],o[w],w,c,o):t;T===t&&(T=o[w]),g?Qn(c,w,T):Co(c,w,T)}return c}function BS(o,u){return An(o,Id(o),u)}function qS(o,u){return An(o,$_(o),u)}function tc(o,u){return function(c,d){var g=te(c)?KR:cS,y=u?u():{};return g(c,o,Q(d,2),y)}}function ls(o){return oe(function(u,c){var d=-1,g=c.length,y=g>1?c[g-1]:t,v=g>2?c[2]:t;for(y=o.length>3&&typeof y=="function"?(g--,y):t,v&&bt(c[0],c[1],v)&&(y=g<3?t:y,g=1),u=be(u);++d<g;){var w=c[d];w&&o(u,w,d,y)}return u})}function k_(o,u){return function(c,d){if(c==null)return c;if(!Lt(c))return o(c,d);for(var g=c.length,y=u?g:-1,v=be(c);(u?y--:++y<g)&&d(v[y],y,v)!==!1;);return c}}function D_(o){return function(u,c,d){for(var g=-1,y=be(u),v=d(u),w=v.length;w--;){var T=v[o?w:++g];if(c(y[T],T,y)===!1)break}return u}}function $S(o,u,c){var d=u&V,g=Vo(o);function y(){var v=this&&this!==ct&&this instanceof y?g:o;return v.apply(d?c:this,arguments)}return y}function x_(o){return function(u){u=Ie(u);var c=rs(u)?pn(u):t,d=c?c[0]:u.charAt(0),g=c?Ar(c,1).join(""):u.slice(1);return d[o]()+g}}function hs(o){return function(u){return Fh(ky(Cy(u).replace(xR,"")),o,"")}}function Vo(o){return function(){var u=arguments;switch(u.length){case 0:return new o;case 1:return new o(u[0]);case 2:return new o(u[0],u[1]);case 3:return new o(u[0],u[1],u[2]);case 4:return new o(u[0],u[1],u[2],u[3]);case 5:return new o(u[0],u[1],u[2],u[3],u[4]);case 6:return new o(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new o(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var c=cs(o.prototype),d=o.apply(c,u);return Me(d)?d:c}}function WS(o,u,c){var d=Vo(o);function g(){for(var y=arguments.length,v=b(y),w=y,T=ds(g);w--;)v[w]=arguments[w];var C=y<3&&v[0]!==T&&v[y-1]!==T?[]:vr(v,T);if(y-=C.length,y<c)return M_(o,u,nc,g.placeholder,t,v,C,t,t,c-y);var k=this&&this!==ct&&this instanceof g?d:o;return Gt(k,this,v)}return g}function N_(o){return function(u,c,d){var g=be(u);if(!Lt(u)){var y=Q(c,3);u=tt(u),c=function(w){return y(g[w],w,g)}}var v=o(u,c,d);return v>-1?g[y?u[v]:v]:t}}function V_(o){return Jn(function(u){var c=u.length,d=c,g=rn.prototype.thru;for(o&&u.reverse();d--;){var y=u[d];if(typeof y!="function")throw new nn(a);if(g&&!v&&oc(y)=="wrapper")var v=new rn([],!0)}for(d=v?d:c;++d<c;){y=u[d];var w=oc(y),T=w=="wrapper"?yd(y):t;T&&Ed(T[0])&&T[1]==(we|j|de|Vt)&&!T[4].length&&T[9]==1?v=v[oc(T[0])].apply(v,T[3]):v=y.length==1&&Ed(y)?v[w]():v.thru(y)}return function(){var C=arguments,k=C[0];if(v&&C.length==1&&te(k))return v.plant(k).value();for(var x=0,U=c?u[x].apply(this,C):k;++x<c;)U=u[x].call(this,U);return U}})}function nc(o,u,c,d,g,y,v,w,T,C){var k=u&we,x=u&V,U=u&Y,G=u&(j|ye),J=u&zn,se=U?t:Vo(o);function X(){for(var ue=arguments.length,fe=b(ue),jt=ue;jt--;)fe[jt]=arguments[jt];if(G)var St=ds(X),Qt=tb(fe,St);if(d&&(fe=P_(fe,d,g,G)),y&&(fe=C_(fe,y,v,G)),ue-=Qt,G&&ue<C){var He=vr(fe,St);return M_(o,u,nc,X.placeholder,c,fe,He,w,T,C-ue)}var _n=x?c:this,tr=U?_n[o]:o;return ue=fe.length,w?fe=cP(fe,w):J&&ue>1&&fe.reverse(),k&&T<ue&&(fe.length=T),this&&this!==ct&&this instanceof X&&(tr=se||Vo(tr)),tr.apply(_n,fe)}return X}function O_(o,u){return function(c,d){return _S(c,o,u(d),{})}}function rc(o,u){return function(c,d){var g;if(c===t&&d===t)return u;if(c!==t&&(g=c),d!==t){if(g===t)return d;typeof c=="string"||typeof d=="string"?(c=Kt(c),d=Kt(d)):(c=I_(c),d=I_(d)),g=o(c,d)}return g}}function pd(o){return Jn(function(u){return u=xe(u,zt(Q())),oe(function(c){var d=this;return o(u,function(g){return Gt(g,d,c)})})})}function ic(o,u){u=u===t?" ":Kt(u);var c=u.length;if(c<2)return c?ad(u,o):u;var d=ad(u,Gu(o/is(u)));return rs(u)?Ar(pn(d),0,o).join(""):d.slice(0,o)}function GS(o,u,c,d){var g=u&V,y=Vo(o);function v(){for(var w=-1,T=arguments.length,C=-1,k=d.length,x=b(k+T),U=this&&this!==ct&&this instanceof v?y:o;++C<k;)x[C]=d[C];for(;T--;)x[C++]=arguments[++w];return Gt(U,g?c:this,x)}return v}function L_(o){return function(u,c,d){return d&&typeof d!="number"&&bt(u,c,d)&&(c=d=t),u=er(u),c===t?(c=u,u=0):c=er(c),d=d===t?u<c?1:-1:er(d),CS(u,c,d,o)}}function sc(o){return function(u,c){return typeof u=="string"&&typeof c=="string"||(u=un(u),c=un(c)),o(u,c)}}function M_(o,u,c,d,g,y,v,w,T,C){var k=u&j,x=k?v:t,U=k?t:v,G=k?y:t,J=k?t:y;u|=k?de:me,u&=~(k?me:de),u&ae||(u&=~(V|Y));var se=[o,u,g,G,x,J,U,w,T,C],X=c.apply(t,se);return Ed(o)&&Q_(X,se),X.placeholder=d,Y_(X,o,u)}function gd(o){var u=Xe[o];return function(c,d){if(c=un(c),d=d==null?0:yt(ie(d),292),d&&Ym(c)){var g=(Ie(c)+"e").split("e"),y=u(g[0]+"e"+(+g[1]+d));return g=(Ie(y)+"e").split("e"),+(g[0]+"e"+(+g[1]-d))}return u(c)}}var zS=as&&1/Vu(new as([,-0]))[1]==ii?function(o){return new as(o)}:Md;function F_(o){return function(u){var c=vt(u);return c==dn?zh(u):c==fn?ub(u):eb(u,o(u))}}function Yn(o,u,c,d,g,y,v,w){var T=u&Y;if(!T&&typeof o!="function")throw new nn(a);var C=d?d.length:0;if(C||(u&=~(de|me),d=g=t),v=v===t?v:Ze(ie(v),0),w=w===t?w:ie(w),C-=g?g.length:0,u&me){var k=d,x=g;d=g=t}var U=T?t:yd(o),G=[o,u,c,d,g,k,x,y,v,w];if(U&&oP(G,U),o=G[0],u=G[1],c=G[2],d=G[3],g=G[4],w=G[9]=G[9]===t?T?0:o.length:Ze(G[9]-C,0),!w&&u&(j|ye)&&(u&=~(j|ye)),!u||u==V)var J=$S(o,u,c);else u==j||u==ye?J=WS(o,u,w):(u==de||u==(V|de))&&!g.length?J=GS(o,u,c,d):J=nc.apply(t,G);var se=U?y_:Q_;return Y_(se(J,G),o,u)}function U_(o,u,c,d){return o===t||mn(o,os[c])&&!Ee.call(d,c)?u:o}function B_(o,u,c,d,g,y){return Me(o)&&Me(u)&&(y.set(u,o),Xu(o,u,t,B_,y),y.delete(u)),o}function KS(o){return Mo(o)?t:o}function q_(o,u,c,d,g,y){var v=c&L,w=o.length,T=u.length;if(w!=T&&!(v&&T>w))return!1;var C=y.get(o),k=y.get(u);if(C&&k)return C==u&&k==o;var x=-1,U=!0,G=c&M?new ui:t;for(y.set(o,u),y.set(u,o);++x<w;){var J=o[x],se=u[x];if(d)var X=v?d(se,J,x,u,o,y):d(J,se,x,o,u,y);if(X!==t){if(X)continue;U=!1;break}if(G){if(!Uh(u,function(ue,fe){if(!To(G,fe)&&(J===ue||g(J,ue,c,d,y)))return G.push(fe)})){U=!1;break}}else if(!(J===se||g(J,se,c,d,y))){U=!1;break}}return y.delete(o),y.delete(u),U}function HS(o,u,c,d,g,y,v){switch(c){case es:if(o.byteLength!=u.byteLength||o.byteOffset!=u.byteOffset)return!1;o=o.buffer,u=u.buffer;case Eo:return!(o.byteLength!=u.byteLength||!y(new Bu(o),new Bu(u)));case mo:case _o:case yo:return mn(+o,+u);case bu:return o.name==u.name&&o.message==u.message;case vo:case Io:return o==u+"";case dn:var w=zh;case fn:var T=d&L;if(w||(w=Vu),o.size!=u.size&&!T)return!1;var C=v.get(o);if(C)return C==u;d|=M,v.set(o,u);var k=q_(w(o),w(u),d,g,y,v);return v.delete(o),k;case Pu:if(Po)return Po.call(o)==Po.call(u)}return!1}function jS(o,u,c,d,g,y){var v=c&L,w=md(o),T=w.length,C=md(u),k=C.length;if(T!=k&&!v)return!1;for(var x=T;x--;){var U=w[x];if(!(v?U in u:Ee.call(u,U)))return!1}var G=y.get(o),J=y.get(u);if(G&&J)return G==u&&J==o;var se=!0;y.set(o,u),y.set(u,o);for(var X=v;++x<T;){U=w[x];var ue=o[U],fe=u[U];if(d)var jt=v?d(fe,ue,U,u,o,y):d(ue,fe,U,o,u,y);if(!(jt===t?ue===fe||g(ue,fe,c,d,y):jt)){se=!1;break}X||(X=U=="constructor")}if(se&&!X){var St=o.constructor,Qt=u.constructor;St!=Qt&&"constructor"in o&&"constructor"in u&&!(typeof St=="function"&&St instanceof St&&typeof Qt=="function"&&Qt instanceof Qt)&&(se=!1)}return y.delete(o),y.delete(u),se}function Jn(o){return Ad(H_(o,t,ny),o+"")}function md(o){return a_(o,tt,Id)}function _d(o){return a_(o,Mt,$_)}var yd=Ku?function(o){return Ku.get(o)}:Md;function oc(o){for(var u=o.name+"",c=us[u],d=Ee.call(us,u)?c.length:0;d--;){var g=c[d],y=g.func;if(y==null||y==o)return g.name}return u}function ds(o){var u=Ee.call(_,"placeholder")?_:o;return u.placeholder}function Q(){var o=_.iteratee||Od;return o=o===Od?l_:o,arguments.length?o(arguments[0],arguments[1]):o}function ac(o,u){var c=o.__data__;return nP(u)?c[typeof u=="string"?"string":"hash"]:c.map}function vd(o){for(var u=tt(o),c=u.length;c--;){var d=u[c],g=o[d];u[c]=[d,g,z_(g)]}return u}function hi(o,u){var c=sb(o,u);return c_(c)?c:t}function QS(o){var u=Ee.call(o,oi),c=o[oi];try{o[oi]=t;var d=!0}catch{}var g=Fu.call(o);return d&&(u?o[oi]=c:delete o[oi]),g}var Id=Hh?function(o){return o==null?[]:(o=be(o),_r(Hh(o),function(u){return jm.call(o,u)}))}:Fd,$_=Hh?function(o){for(var u=[];o;)yr(u,Id(o)),o=qu(o);return u}:Fd,vt=Rt;(jh&&vt(new jh(new ArrayBuffer(1)))!=es||Ro&&vt(new Ro)!=dn||Qh&&vt(Qh.resolve())!=im||as&&vt(new as)!=fn||bo&&vt(new bo)!=wo)&&(vt=function(o){var u=Rt(o),c=u==Kn?o.constructor:t,d=c?di(c):"";if(d)switch(d){case Db:return es;case xb:return dn;case Nb:return im;case Vb:return fn;case Ob:return wo}return u});function YS(o,u,c){for(var d=-1,g=c.length;++d<g;){var y=c[d],v=y.size;switch(y.type){case"drop":o+=v;break;case"dropRight":u-=v;break;case"take":u=yt(u,o+v);break;case"takeRight":o=Ze(o,u-v);break}}return{start:o,end:u}}function JS(o){var u=o.match(rR);return u?u[1].split(iR):[]}function W_(o,u,c){u=Tr(u,o);for(var d=-1,g=u.length,y=!1;++d<g;){var v=Rn(u[d]);if(!(y=o!=null&&c(o,v)))break;o=o[v]}return y||++d!=g?y:(g=o==null?0:o.length,!!g&&pc(g)&&Xn(v,g)&&(te(o)||fi(o)))}function XS(o){var u=o.length,c=new o.constructor(u);return u&&typeof o[0]=="string"&&Ee.call(o,"index")&&(c.index=o.index,c.input=o.input),c}function G_(o){return typeof o.constructor=="function"&&!Oo(o)?cs(qu(o)):{}}function ZS(o,u,c){var d=o.constructor;switch(u){case Eo:return fd(o);case mo:case _o:return new d(+o);case es:return LS(o,c);case vh:case Ih:case wh:case Eh:case Th:case Ah:case Rh:case bh:case Sh:return b_(o,c);case dn:return new d;case yo:case Io:return new d(o);case vo:return MS(o);case fn:return new d;case Pu:return FS(o)}}function eP(o,u){var c=u.length;if(!c)return o;var d=c-1;return u[d]=(c>1?"& ":"")+u[d],u=u.join(c>2?", ":" "),o.replace(nR,`{
/* [wrapped with `+u+`] */
`)}function tP(o){return te(o)||fi(o)||!!(Qm&&o&&o[Qm])}function Xn(o,u){var c=typeof o;return u=u??mr,!!u&&(c=="number"||c!="symbol"&&fR.test(o))&&o>-1&&o%1==0&&o<u}function bt(o,u,c){if(!Me(c))return!1;var d=typeof u;return(d=="number"?Lt(c)&&Xn(u,c.length):d=="string"&&u in c)?mn(c[u],o):!1}function wd(o,u){if(te(o))return!1;var c=typeof o;return c=="number"||c=="symbol"||c=="boolean"||o==null||Ht(o)?!0:X0.test(o)||!J0.test(o)||u!=null&&o in be(u)}function nP(o){var u=typeof o;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?o!=="__proto__":o===null}function Ed(o){var u=oc(o),c=_[u];if(typeof c!="function"||!(u in le.prototype))return!1;if(o===c)return!0;var d=yd(c);return!!d&&o===d[0]}function rP(o){return!!zm&&zm in o}var iP=Lu?Zn:Ud;function Oo(o){var u=o&&o.constructor,c=typeof u=="function"&&u.prototype||os;return o===c}function z_(o){return o===o&&!Me(o)}function K_(o,u){return function(c){return c==null?!1:c[o]===u&&(u!==t||o in be(c))}}function sP(o){var u=dc(o,function(d){return c.size===f&&c.clear(),d}),c=u.cache;return u}function oP(o,u){var c=o[1],d=u[1],g=c|d,y=g<(V|Y|we),v=d==we&&c==j||d==we&&c==Vt&&o[7].length<=u[8]||d==(we|Vt)&&u[7].length<=u[8]&&c==j;if(!(y||v))return o;d&V&&(o[2]=u[2],g|=c&V?0:ae);var w=u[3];if(w){var T=o[3];o[3]=T?P_(T,w,u[4]):w,o[4]=T?vr(o[3],p):u[4]}return w=u[5],w&&(T=o[5],o[5]=T?C_(T,w,u[6]):w,o[6]=T?vr(o[5],p):u[6]),w=u[7],w&&(o[7]=w),d&we&&(o[8]=o[8]==null?u[8]:yt(o[8],u[8])),o[9]==null&&(o[9]=u[9]),o[0]=u[0],o[1]=g,o}function aP(o){var u=[];if(o!=null)for(var c in be(o))u.push(c);return u}function uP(o){return Fu.call(o)}function H_(o,u,c){return u=Ze(u===t?o.length-1:u,0),function(){for(var d=arguments,g=-1,y=Ze(d.length-u,0),v=b(y);++g<y;)v[g]=d[u+g];g=-1;for(var w=b(u+1);++g<u;)w[g]=d[g];return w[u]=c(v),Gt(o,this,w)}}function j_(o,u){return u.length<2?o:li(o,on(u,0,-1))}function cP(o,u){for(var c=o.length,d=yt(u.length,c),g=Ot(o);d--;){var y=u[d];o[d]=Xn(y,c)?g[y]:t}return o}function Td(o,u){if(!(u==="constructor"&&typeof o[u]=="function")&&u!="__proto__")return o[u]}var Q_=J_(y_),Lo=Ab||function(o,u){return ct.setTimeout(o,u)},Ad=J_(xS);function Y_(o,u,c){var d=u+"";return Ad(o,eP(d,lP(JS(d),c)))}function J_(o){var u=0,c=0;return function(){var d=Pb(),g=D0-(d-c);if(c=d,g>0){if(++u>=k0)return arguments[0]}else u=0;return o.apply(t,arguments)}}function uc(o,u){var c=-1,d=o.length,g=d-1;for(u=u===t?d:u;++c<u;){var y=od(c,g),v=o[y];o[y]=o[c],o[c]=v}return o.length=u,o}var X_=sP(function(o){var u=[];return o.charCodeAt(0)===46&&u.push(""),o.replace(Z0,function(c,d,g,y){u.push(g?y.replace(aR,"$1"):d||c)}),u});function Rn(o){if(typeof o=="string"||Ht(o))return o;var u=o+"";return u=="0"&&1/o==-ii?"-0":u}function di(o){if(o!=null){try{return Mu.call(o)}catch{}try{return o+""}catch{}}return""}function lP(o,u){return tn(M0,function(c){var d="_."+c[0];u&c[1]&&!xu(o,d)&&o.push(d)}),o.sort()}function Z_(o){if(o instanceof le)return o.clone();var u=new rn(o.__wrapped__,o.__chain__);return u.__actions__=Ot(o.__actions__),u.__index__=o.__index__,u.__values__=o.__values__,u}function hP(o,u,c){(c?bt(o,u,c):u===t)?u=1:u=Ze(ie(u),0);var d=o==null?0:o.length;if(!d||u<1)return[];for(var g=0,y=0,v=b(Gu(d/u));g<d;)v[y++]=on(o,g,g+=u);return v}function dP(o){for(var u=-1,c=o==null?0:o.length,d=0,g=[];++u<c;){var y=o[u];y&&(g[d++]=y)}return g}function fP(){var o=arguments.length;if(!o)return[];for(var u=b(o-1),c=arguments[0],d=o;d--;)u[d-1]=arguments[d];return yr(te(c)?Ot(c):[c],lt(u,1))}var pP=oe(function(o,u){return Ke(o)?ko(o,lt(u,1,Ke,!0)):[]}),gP=oe(function(o,u){var c=an(u);return Ke(c)&&(c=t),Ke(o)?ko(o,lt(u,1,Ke,!0),Q(c,2)):[]}),mP=oe(function(o,u){var c=an(u);return Ke(c)&&(c=t),Ke(o)?ko(o,lt(u,1,Ke,!0),t,c):[]});function _P(o,u,c){var d=o==null?0:o.length;return d?(u=c||u===t?1:ie(u),on(o,u<0?0:u,d)):[]}function yP(o,u,c){var d=o==null?0:o.length;return d?(u=c||u===t?1:ie(u),u=d-u,on(o,0,u<0?0:u)):[]}function vP(o,u){return o&&o.length?ec(o,Q(u,3),!0,!0):[]}function IP(o,u){return o&&o.length?ec(o,Q(u,3),!0):[]}function wP(o,u,c,d){var g=o==null?0:o.length;return g?(c&&typeof c!="number"&&bt(o,u,c)&&(c=0,d=g),fS(o,u,c,d)):[]}function ey(o,u,c){var d=o==null?0:o.length;if(!d)return-1;var g=c==null?0:ie(c);return g<0&&(g=Ze(d+g,0)),Nu(o,Q(u,3),g)}function ty(o,u,c){var d=o==null?0:o.length;if(!d)return-1;var g=d-1;return c!==t&&(g=ie(c),g=c<0?Ze(d+g,0):yt(g,d-1)),Nu(o,Q(u,3),g,!0)}function ny(o){var u=o==null?0:o.length;return u?lt(o,1):[]}function EP(o){var u=o==null?0:o.length;return u?lt(o,ii):[]}function TP(o,u){var c=o==null?0:o.length;return c?(u=u===t?1:ie(u),lt(o,u)):[]}function AP(o){for(var u=-1,c=o==null?0:o.length,d={};++u<c;){var g=o[u];d[g[0]]=g[1]}return d}function ry(o){return o&&o.length?o[0]:t}function RP(o,u,c){var d=o==null?0:o.length;if(!d)return-1;var g=c==null?0:ie(c);return g<0&&(g=Ze(d+g,0)),ns(o,u,g)}function bP(o){var u=o==null?0:o.length;return u?on(o,0,-1):[]}var SP=oe(function(o){var u=xe(o,hd);return u.length&&u[0]===o[0]?td(u):[]}),PP=oe(function(o){var u=an(o),c=xe(o,hd);return u===an(c)?u=t:c.pop(),c.length&&c[0]===o[0]?td(c,Q(u,2)):[]}),CP=oe(function(o){var u=an(o),c=xe(o,hd);return u=typeof u=="function"?u:t,u&&c.pop(),c.length&&c[0]===o[0]?td(c,t,u):[]});function kP(o,u){return o==null?"":bb.call(o,u)}function an(o){var u=o==null?0:o.length;return u?o[u-1]:t}function DP(o,u,c){var d=o==null?0:o.length;if(!d)return-1;var g=d;return c!==t&&(g=ie(c),g=g<0?Ze(d+g,0):yt(g,d-1)),u===u?lb(o,u,g):Nu(o,Mm,g,!0)}function xP(o,u){return o&&o.length?p_(o,ie(u)):t}var NP=oe(iy);function iy(o,u){return o&&o.length&&u&&u.length?sd(o,u):o}function VP(o,u,c){return o&&o.length&&u&&u.length?sd(o,u,Q(c,2)):o}function OP(o,u,c){return o&&o.length&&u&&u.length?sd(o,u,t,c):o}var LP=Jn(function(o,u){var c=o==null?0:o.length,d=Jh(o,u);return __(o,xe(u,function(g){return Xn(g,c)?+g:g}).sort(S_)),d});function MP(o,u){var c=[];if(!(o&&o.length))return c;var d=-1,g=[],y=o.length;for(u=Q(u,3);++d<y;){var v=o[d];u(v,d,o)&&(c.push(v),g.push(d))}return __(o,g),c}function Rd(o){return o==null?o:kb.call(o)}function FP(o,u,c){var d=o==null?0:o.length;return d?(c&&typeof c!="number"&&bt(o,u,c)?(u=0,c=d):(u=u==null?0:ie(u),c=c===t?d:ie(c)),on(o,u,c)):[]}function UP(o,u){return Zu(o,u)}function BP(o,u,c){return ud(o,u,Q(c,2))}function qP(o,u){var c=o==null?0:o.length;if(c){var d=Zu(o,u);if(d<c&&mn(o[d],u))return d}return-1}function $P(o,u){return Zu(o,u,!0)}function WP(o,u,c){return ud(o,u,Q(c,2),!0)}function GP(o,u){var c=o==null?0:o.length;if(c){var d=Zu(o,u,!0)-1;if(mn(o[d],u))return d}return-1}function zP(o){return o&&o.length?v_(o):[]}function KP(o,u){return o&&o.length?v_(o,Q(u,2)):[]}function HP(o){var u=o==null?0:o.length;return u?on(o,1,u):[]}function jP(o,u,c){return o&&o.length?(u=c||u===t?1:ie(u),on(o,0,u<0?0:u)):[]}function QP(o,u,c){var d=o==null?0:o.length;return d?(u=c||u===t?1:ie(u),u=d-u,on(o,u<0?0:u,d)):[]}function YP(o,u){return o&&o.length?ec(o,Q(u,3),!1,!0):[]}function JP(o,u){return o&&o.length?ec(o,Q(u,3)):[]}var XP=oe(function(o){return Er(lt(o,1,Ke,!0))}),ZP=oe(function(o){var u=an(o);return Ke(u)&&(u=t),Er(lt(o,1,Ke,!0),Q(u,2))}),eC=oe(function(o){var u=an(o);return u=typeof u=="function"?u:t,Er(lt(o,1,Ke,!0),t,u)});function tC(o){return o&&o.length?Er(o):[]}function nC(o,u){return o&&o.length?Er(o,Q(u,2)):[]}function rC(o,u){return u=typeof u=="function"?u:t,o&&o.length?Er(o,t,u):[]}function bd(o){if(!(o&&o.length))return[];var u=0;return o=_r(o,function(c){if(Ke(c))return u=Ze(c.length,u),!0}),Wh(u,function(c){return xe(o,Bh(c))})}function sy(o,u){if(!(o&&o.length))return[];var c=bd(o);return u==null?c:xe(c,function(d){return Gt(u,t,d)})}var iC=oe(function(o,u){return Ke(o)?ko(o,u):[]}),sC=oe(function(o){return ld(_r(o,Ke))}),oC=oe(function(o){var u=an(o);return Ke(u)&&(u=t),ld(_r(o,Ke),Q(u,2))}),aC=oe(function(o){var u=an(o);return u=typeof u=="function"?u:t,ld(_r(o,Ke),t,u)}),uC=oe(bd);function cC(o,u){return T_(o||[],u||[],Co)}function lC(o,u){return T_(o||[],u||[],No)}var hC=oe(function(o){var u=o.length,c=u>1?o[u-1]:t;return c=typeof c=="function"?(o.pop(),c):t,sy(o,c)});function oy(o){var u=_(o);return u.__chain__=!0,u}function dC(o,u){return u(o),o}function cc(o,u){return u(o)}var fC=Jn(function(o){var u=o.length,c=u?o[0]:0,d=this.__wrapped__,g=function(y){return Jh(y,o)};return u>1||this.__actions__.length||!(d instanceof le)||!Xn(c)?this.thru(g):(d=d.slice(c,+c+(u?1:0)),d.__actions__.push({func:cc,args:[g],thisArg:t}),new rn(d,this.__chain__).thru(function(y){return u&&!y.length&&y.push(t),y}))});function pC(){return oy(this)}function gC(){return new rn(this.value(),this.__chain__)}function mC(){this.__values__===t&&(this.__values__=Iy(this.value()));var o=this.__index__>=this.__values__.length,u=o?t:this.__values__[this.__index__++];return{done:o,value:u}}function _C(){return this}function yC(o){for(var u,c=this;c instanceof ju;){var d=Z_(c);d.__index__=0,d.__values__=t,u?g.__wrapped__=d:u=d;var g=d;c=c.__wrapped__}return g.__wrapped__=o,u}function vC(){var o=this.__wrapped__;if(o instanceof le){var u=o;return this.__actions__.length&&(u=new le(this)),u=u.reverse(),u.__actions__.push({func:cc,args:[Rd],thisArg:t}),new rn(u,this.__chain__)}return this.thru(Rd)}function IC(){return E_(this.__wrapped__,this.__actions__)}var wC=tc(function(o,u,c){Ee.call(o,c)?++o[c]:Qn(o,c,1)});function EC(o,u,c){var d=te(o)?Om:dS;return c&&bt(o,u,c)&&(u=t),d(o,Q(u,3))}function TC(o,u){var c=te(o)?_r:s_;return c(o,Q(u,3))}var AC=N_(ey),RC=N_(ty);function bC(o,u){return lt(lc(o,u),1)}function SC(o,u){return lt(lc(o,u),ii)}function PC(o,u,c){return c=c===t?1:ie(c),lt(lc(o,u),c)}function ay(o,u){var c=te(o)?tn:wr;return c(o,Q(u,3))}function uy(o,u){var c=te(o)?HR:i_;return c(o,Q(u,3))}var CC=tc(function(o,u,c){Ee.call(o,c)?o[c].push(u):Qn(o,c,[u])});function kC(o,u,c,d){o=Lt(o)?o:ps(o),c=c&&!d?ie(c):0;var g=o.length;return c<0&&(c=Ze(g+c,0)),gc(o)?c<=g&&o.indexOf(u,c)>-1:!!g&&ns(o,u,c)>-1}var DC=oe(function(o,u,c){var d=-1,g=typeof u=="function",y=Lt(o)?b(o.length):[];return wr(o,function(v){y[++d]=g?Gt(u,v,c):Do(v,u,c)}),y}),xC=tc(function(o,u,c){Qn(o,c,u)});function lc(o,u){var c=te(o)?xe:h_;return c(o,Q(u,3))}function NC(o,u,c,d){return o==null?[]:(te(u)||(u=u==null?[]:[u]),c=d?t:c,te(c)||(c=c==null?[]:[c]),g_(o,u,c))}var VC=tc(function(o,u,c){o[c?0:1].push(u)},function(){return[[],[]]});function OC(o,u,c){var d=te(o)?Fh:Um,g=arguments.length<3;return d(o,Q(u,4),c,g,wr)}function LC(o,u,c){var d=te(o)?jR:Um,g=arguments.length<3;return d(o,Q(u,4),c,g,i_)}function MC(o,u){var c=te(o)?_r:s_;return c(o,fc(Q(u,3)))}function FC(o){var u=te(o)?e_:kS;return u(o)}function UC(o,u,c){(c?bt(o,u,c):u===t)?u=1:u=ie(u);var d=te(o)?aS:DS;return d(o,u)}function BC(o){var u=te(o)?uS:NS;return u(o)}function qC(o){if(o==null)return 0;if(Lt(o))return gc(o)?is(o):o.length;var u=vt(o);return u==dn||u==fn?o.size:rd(o).length}function $C(o,u,c){var d=te(o)?Uh:VS;return c&&bt(o,u,c)&&(u=t),d(o,Q(u,3))}var WC=oe(function(o,u){if(o==null)return[];var c=u.length;return c>1&&bt(o,u[0],u[1])?u=[]:c>2&&bt(u[0],u[1],u[2])&&(u=[u[0]]),g_(o,lt(u,1),[])}),hc=Tb||function(){return ct.Date.now()};function GC(o,u){if(typeof u!="function")throw new nn(a);return o=ie(o),function(){if(--o<1)return u.apply(this,arguments)}}function cy(o,u,c){return u=c?t:u,u=o&&u==null?o.length:u,Yn(o,we,t,t,t,t,u)}function ly(o,u){var c;if(typeof u!="function")throw new nn(a);return o=ie(o),function(){return--o>0&&(c=u.apply(this,arguments)),o<=1&&(u=t),c}}var Sd=oe(function(o,u,c){var d=V;if(c.length){var g=vr(c,ds(Sd));d|=de}return Yn(o,d,u,c,g)}),hy=oe(function(o,u,c){var d=V|Y;if(c.length){var g=vr(c,ds(hy));d|=de}return Yn(u,d,o,c,g)});function dy(o,u,c){u=c?t:u;var d=Yn(o,j,t,t,t,t,t,u);return d.placeholder=dy.placeholder,d}function fy(o,u,c){u=c?t:u;var d=Yn(o,ye,t,t,t,t,t,u);return d.placeholder=fy.placeholder,d}function py(o,u,c){var d,g,y,v,w,T,C=0,k=!1,x=!1,U=!0;if(typeof o!="function")throw new nn(a);u=un(u)||0,Me(c)&&(k=!!c.leading,x="maxWait"in c,y=x?Ze(un(c.maxWait)||0,u):y,U="trailing"in c?!!c.trailing:U);function G(He){var _n=d,tr=g;return d=g=t,C=He,v=o.apply(tr,_n),v}function J(He){return C=He,w=Lo(ue,u),k?G(He):v}function se(He){var _n=He-T,tr=He-C,Ny=u-_n;return x?yt(Ny,y-tr):Ny}function X(He){var _n=He-T,tr=He-C;return T===t||_n>=u||_n<0||x&&tr>=y}function ue(){var He=hc();if(X(He))return fe(He);w=Lo(ue,se(He))}function fe(He){return w=t,U&&d?G(He):(d=g=t,v)}function jt(){w!==t&&A_(w),C=0,d=T=g=w=t}function St(){return w===t?v:fe(hc())}function Qt(){var He=hc(),_n=X(He);if(d=arguments,g=this,T=He,_n){if(w===t)return J(T);if(x)return A_(w),w=Lo(ue,u),G(T)}return w===t&&(w=Lo(ue,u)),v}return Qt.cancel=jt,Qt.flush=St,Qt}var zC=oe(function(o,u){return r_(o,1,u)}),KC=oe(function(o,u,c){return r_(o,un(u)||0,c)});function HC(o){return Yn(o,zn)}function dc(o,u){if(typeof o!="function"||u!=null&&typeof u!="function")throw new nn(a);var c=function(){var d=arguments,g=u?u.apply(this,d):d[0],y=c.cache;if(y.has(g))return y.get(g);var v=o.apply(this,d);return c.cache=y.set(g,v)||y,v};return c.cache=new(dc.Cache||jn),c}dc.Cache=jn;function fc(o){if(typeof o!="function")throw new nn(a);return function(){var u=arguments;switch(u.length){case 0:return!o.call(this);case 1:return!o.call(this,u[0]);case 2:return!o.call(this,u[0],u[1]);case 3:return!o.call(this,u[0],u[1],u[2])}return!o.apply(this,u)}}function jC(o){return ly(2,o)}var QC=OS(function(o,u){u=u.length==1&&te(u[0])?xe(u[0],zt(Q())):xe(lt(u,1),zt(Q()));var c=u.length;return oe(function(d){for(var g=-1,y=yt(d.length,c);++g<y;)d[g]=u[g].call(this,d[g]);return Gt(o,this,d)})}),Pd=oe(function(o,u){var c=vr(u,ds(Pd));return Yn(o,de,t,u,c)}),gy=oe(function(o,u){var c=vr(u,ds(gy));return Yn(o,me,t,u,c)}),YC=Jn(function(o,u){return Yn(o,Vt,t,t,t,u)});function JC(o,u){if(typeof o!="function")throw new nn(a);return u=u===t?u:ie(u),oe(o,u)}function XC(o,u){if(typeof o!="function")throw new nn(a);return u=u==null?0:Ze(ie(u),0),oe(function(c){var d=c[u],g=Ar(c,0,u);return d&&yr(g,d),Gt(o,this,g)})}function ZC(o,u,c){var d=!0,g=!0;if(typeof o!="function")throw new nn(a);return Me(c)&&(d="leading"in c?!!c.leading:d,g="trailing"in c?!!c.trailing:g),py(o,u,{leading:d,maxWait:u,trailing:g})}function e1(o){return cy(o,1)}function t1(o,u){return Pd(dd(u),o)}function n1(){if(!arguments.length)return[];var o=arguments[0];return te(o)?o:[o]}function r1(o){return sn(o,A)}function i1(o,u){return u=typeof u=="function"?u:t,sn(o,A,u)}function s1(o){return sn(o,m|A)}function o1(o,u){return u=typeof u=="function"?u:t,sn(o,m|A,u)}function a1(o,u){return u==null||n_(o,u,tt(u))}function mn(o,u){return o===u||o!==o&&u!==u}var u1=sc(ed),c1=sc(function(o,u){return o>=u}),fi=u_(function(){return arguments}())?u_:function(o){return Ue(o)&&Ee.call(o,"callee")&&!jm.call(o,"callee")},te=b.isArray,l1=Cm?zt(Cm):yS;function Lt(o){return o!=null&&pc(o.length)&&!Zn(o)}function Ke(o){return Ue(o)&&Lt(o)}function h1(o){return o===!0||o===!1||Ue(o)&&Rt(o)==mo}var Rr=Rb||Ud,d1=km?zt(km):vS;function f1(o){return Ue(o)&&o.nodeType===1&&!Mo(o)}function p1(o){if(o==null)return!0;if(Lt(o)&&(te(o)||typeof o=="string"||typeof o.splice=="function"||Rr(o)||fs(o)||fi(o)))return!o.length;var u=vt(o);if(u==dn||u==fn)return!o.size;if(Oo(o))return!rd(o).length;for(var c in o)if(Ee.call(o,c))return!1;return!0}function g1(o,u){return xo(o,u)}function m1(o,u,c){c=typeof c=="function"?c:t;var d=c?c(o,u):t;return d===t?xo(o,u,t,c):!!d}function Cd(o){if(!Ue(o))return!1;var u=Rt(o);return u==bu||u==U0||typeof o.message=="string"&&typeof o.name=="string"&&!Mo(o)}function _1(o){return typeof o=="number"&&Ym(o)}function Zn(o){if(!Me(o))return!1;var u=Rt(o);return u==Su||u==rm||u==F0||u==q0}function my(o){return typeof o=="number"&&o==ie(o)}function pc(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=mr}function Me(o){var u=typeof o;return o!=null&&(u=="object"||u=="function")}function Ue(o){return o!=null&&typeof o=="object"}var _y=Dm?zt(Dm):wS;function y1(o,u){return o===u||nd(o,u,vd(u))}function v1(o,u,c){return c=typeof c=="function"?c:t,nd(o,u,vd(u),c)}function I1(o){return yy(o)&&o!=+o}function w1(o){if(iP(o))throw new ee(s);return c_(o)}function E1(o){return o===null}function T1(o){return o==null}function yy(o){return typeof o=="number"||Ue(o)&&Rt(o)==yo}function Mo(o){if(!Ue(o)||Rt(o)!=Kn)return!1;var u=qu(o);if(u===null)return!0;var c=Ee.call(u,"constructor")&&u.constructor;return typeof c=="function"&&c instanceof c&&Mu.call(c)==vb}var kd=xm?zt(xm):ES;function A1(o){return my(o)&&o>=-mr&&o<=mr}var vy=Nm?zt(Nm):TS;function gc(o){return typeof o=="string"||!te(o)&&Ue(o)&&Rt(o)==Io}function Ht(o){return typeof o=="symbol"||Ue(o)&&Rt(o)==Pu}var fs=Vm?zt(Vm):AS;function R1(o){return o===t}function b1(o){return Ue(o)&&vt(o)==wo}function S1(o){return Ue(o)&&Rt(o)==W0}var P1=sc(id),C1=sc(function(o,u){return o<=u});function Iy(o){if(!o)return[];if(Lt(o))return gc(o)?pn(o):Ot(o);if(Ao&&o[Ao])return ab(o[Ao]());var u=vt(o),c=u==dn?zh:u==fn?Vu:ps;return c(o)}function er(o){if(!o)return o===0?o:0;if(o=un(o),o===ii||o===-ii){var u=o<0?-1:1;return u*V0}return o===o?o:0}function ie(o){var u=er(o),c=u%1;return u===u?c?u-c:u:0}function wy(o){return o?ci(ie(o),0,En):0}function un(o){if(typeof o=="number")return o;if(Ht(o))return Au;if(Me(o)){var u=typeof o.valueOf=="function"?o.valueOf():o;o=Me(u)?u+"":u}if(typeof o!="string")return o===0?o:+o;o=Bm(o);var c=lR.test(o);return c||dR.test(o)?GR(o.slice(2),c?2:8):cR.test(o)?Au:+o}function Ey(o){return An(o,Mt(o))}function k1(o){return o?ci(ie(o),-mr,mr):o===0?o:0}function Ie(o){return o==null?"":Kt(o)}var D1=ls(function(o,u){if(Oo(u)||Lt(u)){An(u,tt(u),o);return}for(var c in u)Ee.call(u,c)&&Co(o,c,u[c])}),Ty=ls(function(o,u){An(u,Mt(u),o)}),mc=ls(function(o,u,c,d){An(u,Mt(u),o,d)}),x1=ls(function(o,u,c,d){An(u,tt(u),o,d)}),N1=Jn(Jh);function V1(o,u){var c=cs(o);return u==null?c:t_(c,u)}var O1=oe(function(o,u){o=be(o);var c=-1,d=u.length,g=d>2?u[2]:t;for(g&&bt(u[0],u[1],g)&&(d=1);++c<d;)for(var y=u[c],v=Mt(y),w=-1,T=v.length;++w<T;){var C=v[w],k=o[C];(k===t||mn(k,os[C])&&!Ee.call(o,C))&&(o[C]=y[C])}return o}),L1=oe(function(o){return o.push(t,B_),Gt(Ay,t,o)});function M1(o,u){return Lm(o,Q(u,3),Tn)}function F1(o,u){return Lm(o,Q(u,3),Zh)}function U1(o,u){return o==null?o:Xh(o,Q(u,3),Mt)}function B1(o,u){return o==null?o:o_(o,Q(u,3),Mt)}function q1(o,u){return o&&Tn(o,Q(u,3))}function $1(o,u){return o&&Zh(o,Q(u,3))}function W1(o){return o==null?[]:Ju(o,tt(o))}function G1(o){return o==null?[]:Ju(o,Mt(o))}function Dd(o,u,c){var d=o==null?t:li(o,u);return d===t?c:d}function z1(o,u){return o!=null&&W_(o,u,pS)}function xd(o,u){return o!=null&&W_(o,u,gS)}var K1=O_(function(o,u,c){u!=null&&typeof u.toString!="function"&&(u=Fu.call(u)),o[u]=c},Vd(Ft)),H1=O_(function(o,u,c){u!=null&&typeof u.toString!="function"&&(u=Fu.call(u)),Ee.call(o,u)?o[u].push(c):o[u]=[c]},Q),j1=oe(Do);function tt(o){return Lt(o)?Zm(o):rd(o)}function Mt(o){return Lt(o)?Zm(o,!0):RS(o)}function Q1(o,u){var c={};return u=Q(u,3),Tn(o,function(d,g,y){Qn(c,u(d,g,y),d)}),c}function Y1(o,u){var c={};return u=Q(u,3),Tn(o,function(d,g,y){Qn(c,g,u(d,g,y))}),c}var J1=ls(function(o,u,c){Xu(o,u,c)}),Ay=ls(function(o,u,c,d){Xu(o,u,c,d)}),X1=Jn(function(o,u){var c={};if(o==null)return c;var d=!1;u=xe(u,function(y){return y=Tr(y,o),d||(d=y.length>1),y}),An(o,_d(o),c),d&&(c=sn(c,m|I|A,KS));for(var g=u.length;g--;)cd(c,u[g]);return c});function Z1(o,u){return Ry(o,fc(Q(u)))}var ek=Jn(function(o,u){return o==null?{}:SS(o,u)});function Ry(o,u){if(o==null)return{};var c=xe(_d(o),function(d){return[d]});return u=Q(u),m_(o,c,function(d,g){return u(d,g[0])})}function tk(o,u,c){u=Tr(u,o);var d=-1,g=u.length;for(g||(g=1,o=t);++d<g;){var y=o==null?t:o[Rn(u[d])];y===t&&(d=g,y=c),o=Zn(y)?y.call(o):y}return o}function nk(o,u,c){return o==null?o:No(o,u,c)}function rk(o,u,c,d){return d=typeof d=="function"?d:t,o==null?o:No(o,u,c,d)}var by=F_(tt),Sy=F_(Mt);function ik(o,u,c){var d=te(o),g=d||Rr(o)||fs(o);if(u=Q(u,4),c==null){var y=o&&o.constructor;g?c=d?new y:[]:Me(o)?c=Zn(y)?cs(qu(o)):{}:c={}}return(g?tn:Tn)(o,function(v,w,T){return u(c,v,w,T)}),c}function sk(o,u){return o==null?!0:cd(o,u)}function ok(o,u,c){return o==null?o:w_(o,u,dd(c))}function ak(o,u,c,d){return d=typeof d=="function"?d:t,o==null?o:w_(o,u,dd(c),d)}function ps(o){return o==null?[]:Gh(o,tt(o))}function uk(o){return o==null?[]:Gh(o,Mt(o))}function ck(o,u,c){return c===t&&(c=u,u=t),c!==t&&(c=un(c),c=c===c?c:0),u!==t&&(u=un(u),u=u===u?u:0),ci(un(o),u,c)}function lk(o,u,c){return u=er(u),c===t?(c=u,u=0):c=er(c),o=un(o),mS(o,u,c)}function hk(o,u,c){if(c&&typeof c!="boolean"&&bt(o,u,c)&&(u=c=t),c===t&&(typeof u=="boolean"?(c=u,u=t):typeof o=="boolean"&&(c=o,o=t)),o===t&&u===t?(o=0,u=1):(o=er(o),u===t?(u=o,o=0):u=er(u)),o>u){var d=o;o=u,u=d}if(c||o%1||u%1){var g=Jm();return yt(o+g*(u-o+WR("1e-"+((g+"").length-1))),u)}return od(o,u)}var dk=hs(function(o,u,c){return u=u.toLowerCase(),o+(c?Py(u):u)});function Py(o){return Nd(Ie(o).toLowerCase())}function Cy(o){return o=Ie(o),o&&o.replace(pR,nb).replace(NR,"")}function fk(o,u,c){o=Ie(o),u=Kt(u);var d=o.length;c=c===t?d:ci(ie(c),0,d);var g=c;return c-=u.length,c>=0&&o.slice(c,g)==u}function pk(o){return o=Ie(o),o&&j0.test(o)?o.replace(om,rb):o}function gk(o){return o=Ie(o),o&&eR.test(o)?o.replace(Ph,"\\$&"):o}var mk=hs(function(o,u,c){return o+(c?"-":"")+u.toLowerCase()}),_k=hs(function(o,u,c){return o+(c?" ":"")+u.toLowerCase()}),yk=x_("toLowerCase");function vk(o,u,c){o=Ie(o),u=ie(u);var d=u?is(o):0;if(!u||d>=u)return o;var g=(u-d)/2;return ic(zu(g),c)+o+ic(Gu(g),c)}function Ik(o,u,c){o=Ie(o),u=ie(u);var d=u?is(o):0;return u&&d<u?o+ic(u-d,c):o}function wk(o,u,c){o=Ie(o),u=ie(u);var d=u?is(o):0;return u&&d<u?ic(u-d,c)+o:o}function Ek(o,u,c){return c||u==null?u=0:u&&(u=+u),Cb(Ie(o).replace(Ch,""),u||0)}function Tk(o,u,c){return(c?bt(o,u,c):u===t)?u=1:u=ie(u),ad(Ie(o),u)}function Ak(){var o=arguments,u=Ie(o[0]);return o.length<3?u:u.replace(o[1],o[2])}var Rk=hs(function(o,u,c){return o+(c?"_":"")+u.toLowerCase()});function bk(o,u,c){return c&&typeof c!="number"&&bt(o,u,c)&&(u=c=t),c=c===t?En:c>>>0,c?(o=Ie(o),o&&(typeof u=="string"||u!=null&&!kd(u))&&(u=Kt(u),!u&&rs(o))?Ar(pn(o),0,c):o.split(u,c)):[]}var Sk=hs(function(o,u,c){return o+(c?" ":"")+Nd(u)});function Pk(o,u,c){return o=Ie(o),c=c==null?0:ci(ie(c),0,o.length),u=Kt(u),o.slice(c,c+u.length)==u}function Ck(o,u,c){var d=_.templateSettings;c&&bt(o,u,c)&&(u=t),o=Ie(o),u=mc({},u,d,U_);var g=mc({},u.imports,d.imports,U_),y=tt(g),v=Gh(g,y),w,T,C=0,k=u.interpolate||Cu,x="__p += '",U=Kh((u.escape||Cu).source+"|"+k.source+"|"+(k===am?uR:Cu).source+"|"+(u.evaluate||Cu).source+"|$","g"),G="//# sourceURL="+(Ee.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++FR+"]")+`
`;o.replace(U,function(X,ue,fe,jt,St,Qt){return fe||(fe=jt),x+=o.slice(C,Qt).replace(gR,ib),ue&&(w=!0,x+=`' +
__e(`+ue+`) +
'`),St&&(T=!0,x+=`';
`+St+`;
__p += '`),fe&&(x+=`' +
((__t = (`+fe+`)) == null ? '' : __t) +
'`),C=Qt+X.length,X}),x+=`';
`;var J=Ee.call(u,"variable")&&u.variable;if(!J)x=`with (obj) {
`+x+`
}
`;else if(oR.test(J))throw new ee(l);x=(T?x.replace(G0,""):x).replace(z0,"$1").replace(K0,"$1;"),x="function("+(J||"obj")+`) {
`+(J?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+x+`return __p
}`;var se=Dy(function(){return ve(y,G+"return "+x).apply(t,v)});if(se.source=x,Cd(se))throw se;return se}function kk(o){return Ie(o).toLowerCase()}function Dk(o){return Ie(o).toUpperCase()}function xk(o,u,c){if(o=Ie(o),o&&(c||u===t))return Bm(o);if(!o||!(u=Kt(u)))return o;var d=pn(o),g=pn(u),y=qm(d,g),v=$m(d,g)+1;return Ar(d,y,v).join("")}function Nk(o,u,c){if(o=Ie(o),o&&(c||u===t))return o.slice(0,Gm(o)+1);if(!o||!(u=Kt(u)))return o;var d=pn(o),g=$m(d,pn(u))+1;return Ar(d,0,g).join("")}function Vk(o,u,c){if(o=Ie(o),o&&(c||u===t))return o.replace(Ch,"");if(!o||!(u=Kt(u)))return o;var d=pn(o),g=qm(d,pn(u));return Ar(d,g).join("")}function Ok(o,u){var c=Xi,d=C0;if(Me(u)){var g="separator"in u?u.separator:g;c="length"in u?ie(u.length):c,d="omission"in u?Kt(u.omission):d}o=Ie(o);var y=o.length;if(rs(o)){var v=pn(o);y=v.length}if(c>=y)return o;var w=c-is(d);if(w<1)return d;var T=v?Ar(v,0,w).join(""):o.slice(0,w);if(g===t)return T+d;if(v&&(w+=T.length-w),kd(g)){if(o.slice(w).search(g)){var C,k=T;for(g.global||(g=Kh(g.source,Ie(um.exec(g))+"g")),g.lastIndex=0;C=g.exec(k);)var x=C.index;T=T.slice(0,x===t?w:x)}}else if(o.indexOf(Kt(g),w)!=w){var U=T.lastIndexOf(g);U>-1&&(T=T.slice(0,U))}return T+d}function Lk(o){return o=Ie(o),o&&H0.test(o)?o.replace(sm,hb):o}var Mk=hs(function(o,u,c){return o+(c?" ":"")+u.toUpperCase()}),Nd=x_("toUpperCase");function ky(o,u,c){return o=Ie(o),u=c?t:u,u===t?ob(o)?pb(o):JR(o):o.match(u)||[]}var Dy=oe(function(o,u){try{return Gt(o,t,u)}catch(c){return Cd(c)?c:new ee(c)}}),Fk=Jn(function(o,u){return tn(u,function(c){c=Rn(c),Qn(o,c,Sd(o[c],o))}),o});function Uk(o){var u=o==null?0:o.length,c=Q();return o=u?xe(o,function(d){if(typeof d[1]!="function")throw new nn(a);return[c(d[0]),d[1]]}):[],oe(function(d){for(var g=-1;++g<u;){var y=o[g];if(Gt(y[0],this,d))return Gt(y[1],this,d)}})}function Bk(o){return hS(sn(o,m))}function Vd(o){return function(){return o}}function qk(o,u){return o==null||o!==o?u:o}var $k=V_(),Wk=V_(!0);function Ft(o){return o}function Od(o){return l_(typeof o=="function"?o:sn(o,m))}function Gk(o){return d_(sn(o,m))}function zk(o,u){return f_(o,sn(u,m))}var Kk=oe(function(o,u){return function(c){return Do(c,o,u)}}),Hk=oe(function(o,u){return function(c){return Do(o,c,u)}});function Ld(o,u,c){var d=tt(u),g=Ju(u,d);c==null&&!(Me(u)&&(g.length||!d.length))&&(c=u,u=o,o=this,g=Ju(u,tt(u)));var y=!(Me(c)&&"chain"in c)||!!c.chain,v=Zn(o);return tn(g,function(w){var T=u[w];o[w]=T,v&&(o.prototype[w]=function(){var C=this.__chain__;if(y||C){var k=o(this.__wrapped__),x=k.__actions__=Ot(this.__actions__);return x.push({func:T,args:arguments,thisArg:o}),k.__chain__=C,k}return T.apply(o,yr([this.value()],arguments))})}),o}function jk(){return ct._===this&&(ct._=Ib),this}function Md(){}function Qk(o){return o=ie(o),oe(function(u){return p_(u,o)})}var Yk=pd(xe),Jk=pd(Om),Xk=pd(Uh);function xy(o){return wd(o)?Bh(Rn(o)):PS(o)}function Zk(o){return function(u){return o==null?t:li(o,u)}}var eD=L_(),tD=L_(!0);function Fd(){return[]}function Ud(){return!1}function nD(){return{}}function rD(){return""}function iD(){return!0}function sD(o,u){if(o=ie(o),o<1||o>mr)return[];var c=En,d=yt(o,En);u=Q(u),o-=En;for(var g=Wh(d,u);++c<o;)u(c);return g}function oD(o){return te(o)?xe(o,Rn):Ht(o)?[o]:Ot(X_(Ie(o)))}function aD(o){var u=++yb;return Ie(o)+u}var uD=rc(function(o,u){return o+u},0),cD=gd("ceil"),lD=rc(function(o,u){return o/u},1),hD=gd("floor");function dD(o){return o&&o.length?Yu(o,Ft,ed):t}function fD(o,u){return o&&o.length?Yu(o,Q(u,2),ed):t}function pD(o){return Fm(o,Ft)}function gD(o,u){return Fm(o,Q(u,2))}function mD(o){return o&&o.length?Yu(o,Ft,id):t}function _D(o,u){return o&&o.length?Yu(o,Q(u,2),id):t}var yD=rc(function(o,u){return o*u},1),vD=gd("round"),ID=rc(function(o,u){return o-u},0);function wD(o){return o&&o.length?$h(o,Ft):0}function ED(o,u){return o&&o.length?$h(o,Q(u,2)):0}return _.after=GC,_.ary=cy,_.assign=D1,_.assignIn=Ty,_.assignInWith=mc,_.assignWith=x1,_.at=N1,_.before=ly,_.bind=Sd,_.bindAll=Fk,_.bindKey=hy,_.castArray=n1,_.chain=oy,_.chunk=hP,_.compact=dP,_.concat=fP,_.cond=Uk,_.conforms=Bk,_.constant=Vd,_.countBy=wC,_.create=V1,_.curry=dy,_.curryRight=fy,_.debounce=py,_.defaults=O1,_.defaultsDeep=L1,_.defer=zC,_.delay=KC,_.difference=pP,_.differenceBy=gP,_.differenceWith=mP,_.drop=_P,_.dropRight=yP,_.dropRightWhile=vP,_.dropWhile=IP,_.fill=wP,_.filter=TC,_.flatMap=bC,_.flatMapDeep=SC,_.flatMapDepth=PC,_.flatten=ny,_.flattenDeep=EP,_.flattenDepth=TP,_.flip=HC,_.flow=$k,_.flowRight=Wk,_.fromPairs=AP,_.functions=W1,_.functionsIn=G1,_.groupBy=CC,_.initial=bP,_.intersection=SP,_.intersectionBy=PP,_.intersectionWith=CP,_.invert=K1,_.invertBy=H1,_.invokeMap=DC,_.iteratee=Od,_.keyBy=xC,_.keys=tt,_.keysIn=Mt,_.map=lc,_.mapKeys=Q1,_.mapValues=Y1,_.matches=Gk,_.matchesProperty=zk,_.memoize=dc,_.merge=J1,_.mergeWith=Ay,_.method=Kk,_.methodOf=Hk,_.mixin=Ld,_.negate=fc,_.nthArg=Qk,_.omit=X1,_.omitBy=Z1,_.once=jC,_.orderBy=NC,_.over=Yk,_.overArgs=QC,_.overEvery=Jk,_.overSome=Xk,_.partial=Pd,_.partialRight=gy,_.partition=VC,_.pick=ek,_.pickBy=Ry,_.property=xy,_.propertyOf=Zk,_.pull=NP,_.pullAll=iy,_.pullAllBy=VP,_.pullAllWith=OP,_.pullAt=LP,_.range=eD,_.rangeRight=tD,_.rearg=YC,_.reject=MC,_.remove=MP,_.rest=JC,_.reverse=Rd,_.sampleSize=UC,_.set=nk,_.setWith=rk,_.shuffle=BC,_.slice=FP,_.sortBy=WC,_.sortedUniq=zP,_.sortedUniqBy=KP,_.split=bk,_.spread=XC,_.tail=HP,_.take=jP,_.takeRight=QP,_.takeRightWhile=YP,_.takeWhile=JP,_.tap=dC,_.throttle=ZC,_.thru=cc,_.toArray=Iy,_.toPairs=by,_.toPairsIn=Sy,_.toPath=oD,_.toPlainObject=Ey,_.transform=ik,_.unary=e1,_.union=XP,_.unionBy=ZP,_.unionWith=eC,_.uniq=tC,_.uniqBy=nC,_.uniqWith=rC,_.unset=sk,_.unzip=bd,_.unzipWith=sy,_.update=ok,_.updateWith=ak,_.values=ps,_.valuesIn=uk,_.without=iC,_.words=ky,_.wrap=t1,_.xor=sC,_.xorBy=oC,_.xorWith=aC,_.zip=uC,_.zipObject=cC,_.zipObjectDeep=lC,_.zipWith=hC,_.entries=by,_.entriesIn=Sy,_.extend=Ty,_.extendWith=mc,Ld(_,_),_.add=uD,_.attempt=Dy,_.camelCase=dk,_.capitalize=Py,_.ceil=cD,_.clamp=ck,_.clone=r1,_.cloneDeep=s1,_.cloneDeepWith=o1,_.cloneWith=i1,_.conformsTo=a1,_.deburr=Cy,_.defaultTo=qk,_.divide=lD,_.endsWith=fk,_.eq=mn,_.escape=pk,_.escapeRegExp=gk,_.every=EC,_.find=AC,_.findIndex=ey,_.findKey=M1,_.findLast=RC,_.findLastIndex=ty,_.findLastKey=F1,_.floor=hD,_.forEach=ay,_.forEachRight=uy,_.forIn=U1,_.forInRight=B1,_.forOwn=q1,_.forOwnRight=$1,_.get=Dd,_.gt=u1,_.gte=c1,_.has=z1,_.hasIn=xd,_.head=ry,_.identity=Ft,_.includes=kC,_.indexOf=RP,_.inRange=lk,_.invoke=j1,_.isArguments=fi,_.isArray=te,_.isArrayBuffer=l1,_.isArrayLike=Lt,_.isArrayLikeObject=Ke,_.isBoolean=h1,_.isBuffer=Rr,_.isDate=d1,_.isElement=f1,_.isEmpty=p1,_.isEqual=g1,_.isEqualWith=m1,_.isError=Cd,_.isFinite=_1,_.isFunction=Zn,_.isInteger=my,_.isLength=pc,_.isMap=_y,_.isMatch=y1,_.isMatchWith=v1,_.isNaN=I1,_.isNative=w1,_.isNil=T1,_.isNull=E1,_.isNumber=yy,_.isObject=Me,_.isObjectLike=Ue,_.isPlainObject=Mo,_.isRegExp=kd,_.isSafeInteger=A1,_.isSet=vy,_.isString=gc,_.isSymbol=Ht,_.isTypedArray=fs,_.isUndefined=R1,_.isWeakMap=b1,_.isWeakSet=S1,_.join=kP,_.kebabCase=mk,_.last=an,_.lastIndexOf=DP,_.lowerCase=_k,_.lowerFirst=yk,_.lt=P1,_.lte=C1,_.max=dD,_.maxBy=fD,_.mean=pD,_.meanBy=gD,_.min=mD,_.minBy=_D,_.stubArray=Fd,_.stubFalse=Ud,_.stubObject=nD,_.stubString=rD,_.stubTrue=iD,_.multiply=yD,_.nth=xP,_.noConflict=jk,_.noop=Md,_.now=hc,_.pad=vk,_.padEnd=Ik,_.padStart=wk,_.parseInt=Ek,_.random=hk,_.reduce=OC,_.reduceRight=LC,_.repeat=Tk,_.replace=Ak,_.result=tk,_.round=vD,_.runInContext=E,_.sample=FC,_.size=qC,_.snakeCase=Rk,_.some=$C,_.sortedIndex=UP,_.sortedIndexBy=BP,_.sortedIndexOf=qP,_.sortedLastIndex=$P,_.sortedLastIndexBy=WP,_.sortedLastIndexOf=GP,_.startCase=Sk,_.startsWith=Pk,_.subtract=ID,_.sum=wD,_.sumBy=ED,_.template=Ck,_.times=sD,_.toFinite=er,_.toInteger=ie,_.toLength=wy,_.toLower=kk,_.toNumber=un,_.toSafeInteger=k1,_.toString=Ie,_.toUpper=Dk,_.trim=xk,_.trimEnd=Nk,_.trimStart=Vk,_.truncate=Ok,_.unescape=Lk,_.uniqueId=aD,_.upperCase=Mk,_.upperFirst=Nd,_.each=ay,_.eachRight=uy,_.first=ry,Ld(_,function(){var o={};return Tn(_,function(u,c){Ee.call(_.prototype,c)||(o[c]=u)}),o}(),{chain:!1}),_.VERSION=r,tn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){_[o].placeholder=_}),tn(["drop","take"],function(o,u){le.prototype[o]=function(c){c=c===t?1:Ze(ie(c),0);var d=this.__filtered__&&!u?new le(this):this.clone();return d.__filtered__?d.__takeCount__=yt(c,d.__takeCount__):d.__views__.push({size:yt(c,En),type:o+(d.__dir__<0?"Right":"")}),d},le.prototype[o+"Right"]=function(c){return this.reverse()[o](c).reverse()}}),tn(["filter","map","takeWhile"],function(o,u){var c=u+1,d=c==nm||c==N0;le.prototype[o]=function(g){var y=this.clone();return y.__iteratees__.push({iteratee:Q(g,3),type:c}),y.__filtered__=y.__filtered__||d,y}}),tn(["head","last"],function(o,u){var c="take"+(u?"Right":"");le.prototype[o]=function(){return this[c](1).value()[0]}}),tn(["initial","tail"],function(o,u){var c="drop"+(u?"":"Right");le.prototype[o]=function(){return this.__filtered__?new le(this):this[c](1)}}),le.prototype.compact=function(){return this.filter(Ft)},le.prototype.find=function(o){return this.filter(o).head()},le.prototype.findLast=function(o){return this.reverse().find(o)},le.prototype.invokeMap=oe(function(o,u){return typeof o=="function"?new le(this):this.map(function(c){return Do(c,o,u)})}),le.prototype.reject=function(o){return this.filter(fc(Q(o)))},le.prototype.slice=function(o,u){o=ie(o);var c=this;return c.__filtered__&&(o>0||u<0)?new le(c):(o<0?c=c.takeRight(-o):o&&(c=c.drop(o)),u!==t&&(u=ie(u),c=u<0?c.dropRight(-u):c.take(u-o)),c)},le.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},le.prototype.toArray=function(){return this.take(En)},Tn(le.prototype,function(o,u){var c=/^(?:filter|find|map|reject)|While$/.test(u),d=/^(?:head|last)$/.test(u),g=_[d?"take"+(u=="last"?"Right":""):u],y=d||/^find/.test(u);g&&(_.prototype[u]=function(){var v=this.__wrapped__,w=d?[1]:arguments,T=v instanceof le,C=w[0],k=T||te(v),x=function(ue){var fe=g.apply(_,yr([ue],w));return d&&U?fe[0]:fe};k&&c&&typeof C=="function"&&C.length!=1&&(T=k=!1);var U=this.__chain__,G=!!this.__actions__.length,J=y&&!U,se=T&&!G;if(!y&&k){v=se?v:new le(this);var X=o.apply(v,w);return X.__actions__.push({func:cc,args:[x],thisArg:t}),new rn(X,U)}return J&&se?o.apply(this,w):(X=this.thru(x),J?d?X.value()[0]:X.value():X)})}),tn(["pop","push","shift","sort","splice","unshift"],function(o){var u=Ou[o],c=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",d=/^(?:pop|shift)$/.test(o);_.prototype[o]=function(){var g=arguments;if(d&&!this.__chain__){var y=this.value();return u.apply(te(y)?y:[],g)}return this[c](function(v){return u.apply(te(v)?v:[],g)})}}),Tn(le.prototype,function(o,u){var c=_[u];if(c){var d=c.name+"";Ee.call(us,d)||(us[d]=[]),us[d].push({name:u,func:c})}}),us[nc(t,Y).name]=[{name:"wrapper",func:t}],le.prototype.clone=Lb,le.prototype.reverse=Mb,le.prototype.value=Fb,_.prototype.at=fC,_.prototype.chain=pC,_.prototype.commit=gC,_.prototype.next=mC,_.prototype.plant=yC,_.prototype.reverse=vC,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=IC,_.prototype.first=_.prototype.head,Ao&&(_.prototype[Ao]=_C),_},ss=gb();si?((si.exports=ss)._=ss,Oh._=ss):ct._=ss}).call(Xo)})(w4,yl);const E4=yl,T4=document.querySelector(".search__input"),em=document.querySelector(".filters__list"),A4=new Il;R4();async function R4(){const n=await A4.fetchFilters(),t=[...new Set(n.map(({filter:r})=>r))].map((r,i)=>{const s=r.toLowerCase().split(" ").join("-");return i===0?`<li id=${s} class="filters__item active">${r}</li>`:`<li id=${s} class="filters__item">${r}</li>`}).join("");em.insertAdjacentHTML("afterbegin",t),go()}function b4(n){const e=n.target.value.toLowerCase().trim();console.log(e)}function S4(n){const e=n.target;n.target.id,[...em.children].forEach(t=>{t.classList.remove("active")}),e.classList.add("active"),wt.currentPage=1,go()}const P4=E4.debounce(b4,500);T4.addEventListener("input",P4);em.addEventListener("click",S4);const Ps={exersiseId:"64f389465ae26083f39b17a2",ratingText:"Rating",iconStar:"/images/icons-sprite.svg#icon-star",ratingMax:5,closeKeyBoardBtn:"Escape",beforeOpen:null,afterOpen:null,beforeClose:null,afterClose:null},C4=document.querySelector("form.modal-form"),vl=document.querySelector(".rating-modal-window"),k4=document.querySelector(".rating-close"),D4=()=>{const n=[];for(let e=0;e<Ps.ratingMax;e++){let t=Ps.ratingMax-e;n.push(`
        <input type="radio" class="visually-hidden" id="star${t}" name="rating" value="${t}">
        <label class="rating-star" for="star${t}">
            <svg class="rating-star-icon">
                <use href=${Ps.iconStar} />
            </svg>
        </label>
        `)}return`
    <div class="rating-wrapper">
        <p class="rating-text">${Ps.ratingText}</p>
        <div class="rating-stars">
            ${n.join("")}
            <p class="rating-count">0.0</p>
        </div>
    </div>
    `},S0=n=>{n.key===Ps.closeKeyBoardBtn&&yh()},P0=n=>{tm.forEach(e=>{delete e.dataset.dataChecked}),n.target.dataset.dataChecked="checked",x4.innerHTML=n.target.value};C4.insertAdjacentHTML("afterbegin",D4());const tm=document.querySelectorAll(".rating-stars input"),x4=document.querySelector(".rating-count"),yh=()=>{tm.forEach(n=>{n.removeEventListener("change",P0)}),vl.classList.remove("open"),document.body.style.overflow="visible",document.removeEventListener("keydown",S0)},N4=()=>{vl.classList.add("open"),document.body.style.overflow="hidden",document.addEventListener("keydown",S0),tm.forEach(n=>{n.addEventListener("change",P0)})};k4.addEventListener("click",yh);vl.addEventListener("click",n=>{n.target===vl&&yh()});const V4={modalConfig:Ps,openRatingModal:N4,closeRatingModal:yh},ht={form:document.querySelector(".modal-form"),ratings:document.querySelectorAll(".rating-stars input"),emailInput:document.querySelector(".modal-form-email"),validateEmailMessage:document.querySelector(".modal-email-validate"),btn:document.querySelector(".feedback-submit")};ht.form.addEventListener("submit",O4);async function O4(n){n.preventDefault();const e=n.target.elements.email.value.trim().toLowerCase();if(TD(e))try{const t=new Il;let r=Array.from(ht.ratings).find(i=>i.dataset.dataChecked);t.rating=parseInt(r.value),t.email=e,t.review=ht.validateEmailMessage.value,t.exerciseId=V4.modalConfig.exersiseId,await t.addRating(),ht.validateEmailMessage.textContent=" Thank you for you subscription",ht.validateEmailMessage.classList.remove("full_hidden","validate-form-message"),ht.validateEmailMessage.classList.add("validate-form-message_ok"),console.log("ok"),n.target.reset()}catch(t){console.log(t),ht.validateEmailMessage.textContent=" This email address was previously added",ht.validateEmailMessage.classList.remove("full_hidden","validate-form-message_ok"),ht.validateEmailMessage.classList.add("validate-form-message_warning")}else ht.validateEmailMessage.textContent=" Your email has wrong format",ht.validateEmailMessage.classList.remove("full_hidden","validate-form-message_ok"),ht.validateEmailMessage.classList.add("validate-form-message_warning")}ht.emailInput.addEventListener("input",L4);function L4(n){n.target.value.trim()?ht.btn.disabled=!1:ht.btn.disabled=!0}ht.emailInput.addEventListener("focus",M4);function M4(){ht.validateEmailMessage.classList.add("full_hidden")}
